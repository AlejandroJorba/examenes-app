import{$ as Ce,$a as Ne,A as y0,Aa as qc,Ab as el,B as Zy,Ba as l1,Bb as x1,C as us,Ca as Kc,Cb as w1,D as co,Da as ft,Db as Sh,E as Zs,Ea as Ue,Eb as R0,F as e1,Fa as A0,Fb as Ch,G as x0,Ga as u1,H as hs,Ha as xh,I as t1,Ia as Xc,J as ea,Ja as S0,K as fs,Ka as Vt,L as w0,La as wh,M as r1,Ma as tn,N as n1,Na as po,O as i1,Oa as h1,P as vh,Pa as f1,Q as Dn,Qa as Yc,R as _h,Ra as fi,S as lr,Sa as na,T as bt,Ta as rn,U as Mi,Ua as Qc,V as Le,Va as Te,W as Kt,Wa as we,X as s1,Xa as xt,Y as tt,Ya as Jc,Z as E0,Za as Dt,_ as je,_a as Vi,a as be,aa as ui,ab as Zc,b as ht,ba as Gc,bb as d1,ca as mr,cb as fn,d as Z,da as tr,db as dn,e as qy,ea as Xt,eb as pn,f as Ky,fa as Nt,fb as nn,g as Ni,ga as qn,gb as rr,h as p0,ha as a1,hb as mo,i as m0,ia as lo,ib as p1,j as li,ja as Li,jb as Eh,k as Cn,ka as Kn,kb as Th,l as Xy,la as uo,lb as C0,m as Yy,ma as ho,mb as bh,n as ls,na as ta,nb as k0,o as g0,oa as fo,ob as ds,p as v0,pa as hi,pb as m1,q as _0,qa as T0,qb as Bi,r as Yr,ra,rb as go,s as We,sa as b0,sb as g1,t as Hc,ta as Xn,tb as v1,u as Qy,ua as Sr,ub as gr,v as Jy,va as o1,vb as D0,w as et,wa as yh,wb as Ih,x as zc,xa as c1,xb as Ah,y as kn,ya as Yn,yb as _1,z as gh,za as I0,zb as y1}from"./chunk-DCF74AAS.js";var rl=class{},Dh=class{},ia=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(r=>{let n=r.indexOf(":");if(n>0){let i=r.slice(0,n),s=i.toLowerCase(),a=r.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((r,n)=>{this.setHeaderEntries(n,r)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([r,n])=>{this.setHeaderEntries(r,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let r=this.headers.get(e.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,r){return this.clone({name:e,value:r,op:"a"})}set(e,r){return this.clone({name:e,value:r,op:"s"})}delete(e,r){return this.clone({name:e,value:r,op:"d"})}maybeSetNormalizedName(e,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(r=>{this.headers.set(r,e.headers.get(r)),this.normalizedNames.set(r,e.normalizedNames.get(r))})}clone(e){let r=new t;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([e]),r}applyUpdate(e){let r=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,r);let i=(e.op==="a"?this.headers.get(r):void 0)||[];i.push(...n),this.headers.set(r,i);break;case"d":let s=e.value;if(!s)this.headers.delete(r),this.normalizedNames.delete(r);else{let a=this.headers.get(r);if(!a)return;a=a.filter(o=>s.indexOf(o)===-1),a.length===0?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,a)}break}}setHeaderEntries(e,r){let n=(Array.isArray(r)?r:[r]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>e(this.normalizedNames.get(r),this.headers.get(r)))}};var F0=class{encodeKey(e){return E1(e)}encodeValue(e){return E1(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function mC(t,e){let r=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,o]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=r.get(a)||[];c.push(o),r.set(a,c)}),r}var gC=/%(\d[a-f0-9])/gi,vC={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function E1(t){return encodeURIComponent(t).replace(gC,(e,r)=>vC[r]??e)}function kh(t){return`${t}`}var ps=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new F0,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=mC(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(r=>{let n=e.fromObject[r],i=Array.isArray(n)?n.map(kh):[kh(n)];this.map.set(r,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let r=this.map.get(e);return r?r[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,r){return this.clone({param:e,value:r,op:"a"})}appendAll(e){let r=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(s=>{r.push({param:n,value:s,op:"a"})}):r.push({param:n,value:i,op:"a"})}),this.clone(r)}set(e,r){return this.clone({param:e,value:r,op:"s"})}delete(e,r){return this.clone({param:e,value:r,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let r=this.encoder.encodeKey(e);return this.map.get(e).map(n=>r+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let r=new t({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat(e),r}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let r=(e.op==="a"?this.map.get(e.param):void 0)||[];r.push(kh(e.value)),this.map.set(e.param,r);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(kh(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var O0=class{constructor(){this.map=new Map}set(e,r){return this.map.set(e,r),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function _C(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function T1(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function b1(t){return typeof Blob<"u"&&t instanceof Blob}function I1(t){return typeof FormData<"u"&&t instanceof FormData}function yC(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var tl=class t{constructor(e,r,n,i){this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(_C(this.method)||i?(this.body=n!==void 0?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new ia,this.context??=new O0,!this.params)this.params=new ps,this.urlWithParams=r;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=r;else{let o=r.indexOf("?"),c=o===-1?"?":o<r.length-1?"&":"";this.urlWithParams=r+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||T1(this.body)||b1(this.body)||I1(this.body)||yC(this.body)?this.body:this.body instanceof ps?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||I1(this.body)?null:b1(this.body)?this.body.type||null:T1(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ps?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let r=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,o=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,h=e.params||this.params,f=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,p)=>d.set(p,e.setHeaders[p]),l)),e.setParams&&(h=Object.keys(e.setParams).reduce((d,p)=>d.set(p,e.setParams[p]),h)),new t(r,n,a,{params:h,headers:l,context:f,reportProgress:c,responseType:i,withCredentials:o,transferCache:s})}},vo=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(vo||{}),nl=class{constructor(e,r=Fh.Ok,n="OK"){this.headers=e.headers||new ia,this.status=e.status!==void 0?e.status:r,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},N0=class t extends nl{constructor(e={}){super(e),this.type=vo.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Rh=class t extends nl{constructor(e={}){super(e),this.type=vo.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ph=class extends nl{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Fh=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(Fh||{});function P0(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var L0=(()=>{let e=class e{constructor(n){this.handler=n}request(n,i,s={}){let a;if(n instanceof tl)a=n;else{let l;s.headers instanceof ia?l=s.headers:l=new ia(s.headers);let h;s.params&&(s.params instanceof ps?h=s.params:h=new ps({fromObject:s.params})),a=new tl(n,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let o=We(a).pipe(Zs(l=>this.handler.handle(l)));if(n instanceof tl||s.observe==="events")return o;let c=o.pipe(us(l=>l instanceof Rh));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return c.pipe(et(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(et(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(et(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(et(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new ps().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,P0(s,i))}post(n,i,s={}){return this.request("POST",n,P0(s,i))}put(n,i,s={}){return this.request("PUT",n,P0(s,i))}};e.\u0275fac=function(i){return new(i||e)(je(rl))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})();function k1(t,e){return e(t)}function xC(t,e){return(r,n)=>e.intercept(r,{handle:i=>t(i,n)})}function wC(t,e,r){return(n,i)=>Li(r,()=>e(n,s=>t(s,i)))}var EC=new tt(""),V0=new tt(""),TC=new tt(""),bC=new tt("");function IC(){let t=null;return(e,r)=>{t===null&&(t=(Ce(EC,{optional:!0})??[]).reduceRight(xC,k1));let n=Ce(Yc),i=n.add();return t(e,r).pipe(ea(()=>n.remove(i)))}}var A1=(()=>{let e=class e extends rl{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=Ce(Yc);let s=Ce(bC,{optional:!0});this.backend=s??n}handle(n){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(V0),...this.injector.get(TC,[])]));this.chain=s.reduceRight((a,o)=>wC(a,o,this.injector),k1)}let i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(ea(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(je(Dh),je(lo))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})();var AC=/^\)\]\}',?\n/;function SC(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var S1=(()=>{let e=class e{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new bt(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Yr(i.\u0275loadImpl()):We(null)).pipe(Dn(()=>new Ni(a=>{let o=i.build();if(o.open(n.method,n.urlWithParams),n.withCredentials&&(o.withCredentials=!0),n.headers.forEach((_,b)=>o.setRequestHeader(_,b.join(","))),n.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let _=n.detectContentTypeHeader();_!==null&&o.setRequestHeader("Content-Type",_)}if(n.responseType){let _=n.responseType.toLowerCase();o.responseType=_!=="json"?_:"text"}let c=n.serializeBody(),l=null,h=()=>{if(l!==null)return l;let _=o.statusText||"OK",b=new ia(o.getAllResponseHeaders()),S=SC(o)||n.url;return l=new N0({headers:b,status:o.status,statusText:_,url:S}),l},f=()=>{let{headers:_,status:b,statusText:S,url:T}=h(),N=null;b!==Fh.NoContent&&(N=typeof o.response>"u"?o.responseText:o.response),b===0&&(b=N?Fh.Ok:0);let M=b>=200&&b<300;if(n.responseType==="json"&&typeof N=="string"){let B=N;N=N.replace(AC,"");try{N=N!==""?JSON.parse(N):null}catch(x){N=B,M&&(M=!1,N={error:x,text:N})}}M?(a.next(new Rh({body:N,headers:_,status:b,statusText:S,url:T||void 0})),a.complete()):a.error(new Ph({error:N,headers:_,status:b,statusText:S,url:T||void 0}))},d=_=>{let{url:b}=h(),S=new Ph({error:_,status:o.status||0,statusText:o.statusText||"Unknown Error",url:b||void 0});a.error(S)},p=!1,v=_=>{p||(a.next(h()),p=!0);let b={type:vo.DownloadProgress,loaded:_.loaded};_.lengthComputable&&(b.total=_.total),n.responseType==="text"&&o.responseText&&(b.partialText=o.responseText),a.next(b)},m=_=>{let b={type:vo.UploadProgress,loaded:_.loaded};_.lengthComputable&&(b.total=_.total),a.next(b)};return o.addEventListener("load",f),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),n.reportProgress&&(o.addEventListener("progress",v),c!==null&&o.upload&&o.upload.addEventListener("progress",m)),o.send(c),a.next({type:vo.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",f),o.removeEventListener("timeout",d),n.reportProgress&&(o.removeEventListener("progress",v),c!==null&&o.upload&&o.upload.removeEventListener("progress",m)),o.readyState!==o.DONE&&o.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(je(Ch))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),D1=new tt(""),CC="XSRF-TOKEN",kC=new tt("",{providedIn:"root",factory:()=>CC}),DC="X-XSRF-TOKEN",RC=new tt("",{providedIn:"root",factory:()=>DC}),Oh=class{},PC=(()=>{let e=class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ah(n,this.cookieName),this.lastCookieString=n),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(je(gr),je(Yn),je(kC))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})();function FC(t,e){let r=t.url.toLowerCase();if(!Ce(D1)||t.method==="GET"||t.method==="HEAD"||r.startsWith("http://")||r.startsWith("https://"))return e(t);let n=Ce(Oh).getToken(),i=Ce(RC);return n!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,n)})),e(t)}var R1=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(R1||{});function OC(t,e){return{\u0275kind:t,\u0275providers:e}}function NC(...t){let e=[L0,S1,A1,{provide:rl,useExisting:A1},{provide:Dh,useExisting:S1},{provide:V0,useValue:FC,multi:!0},{provide:D1,useValue:!0},{provide:Oh,useClass:PC}];for(let r of t)e.push(...r.\u0275providers);return qn(e)}var C1=new tt("");function MC(){return OC(R1.LegacyInterceptors,[{provide:C1,useFactory:IC},{provide:V0,useExisting:C1,multi:!0}])}var P1=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({providers:[NC(MC())]});let t=e;return t})();var j0=class extends v1{constructor(){super(...arguments),this.supportsDOMEvents=!0}},W0=class t extends j0{static makeCurrent(){g1(new t)}onAndCancel(e,r,n){return e.addEventListener(r,n),()=>{e.removeEventListener(r,n)}}dispatchEvent(e,r){e.dispatchEvent(r)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,r){return r=r||this.getDefaultDocument(),r.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,r){return r==="window"?window:r==="document"?e:r==="body"?e.body:null}getBaseHref(e){let r=BC();return r==null?null:UC(r)}resetBaseElement(){il=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ah(document.cookie,e)}},il=null;function BC(){return il=il||document.querySelector("base"),il?il.getAttribute("href"):null}function UC(t){return new URL(t,document.baseURI).pathname}var jC=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),$0=new tt(""),N1=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(a=>a.supports(n)),!i)throw new bt(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)(je($0),je(Vt))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),Nh=class{constructor(e){this._doc=e}},B0="ng-app-id",M1=(()=>{let e=class e{constructor(n,i,s,a={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Sh(a),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${B0}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){let s=this.styleRef;if(s.has(n)){let a=s.get(n);return a.usage+=i,a.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let s=this.styleNodesInDOM,a=s?.get(i);if(a?.parentNode===n)return s.delete(i),a.removeAttribute(B0),a;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(B0,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){let s=this.getStyleElement(n,i),a=this.styleRef,o=a.get(i)?.elements;o?o.push(s):a.set(i,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(je(gr),je(yh),je(qc,8),je(Yn))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),U0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},z0=/%COMP%/g,L1="%COMP%",WC=`_nghost-${L1}`,$C=`_ngcontent-${L1}`,HC=!0,zC=new tt("",{providedIn:"root",factory:()=>HC});function GC(t){return $C.replace(z0,t)}function qC(t){return WC.replace(z0,t)}function V1(t,e){return e.map(r=>r.replace(z0,t))}var Mh=(()=>{let e=class e{constructor(n,i,s,a,o,c,l,h=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=Sh(c),this.defaultRenderer=new sl(n,o,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Gc.ShadowDom&&(i=ht(be({},i),{encapsulation:Gc.Emulated}));let s=this.getOrCreateRenderer(n,i);return s instanceof Lh?s.applyToHost(n):s instanceof al&&s.applyStyles(),s}getOrCreateRenderer(n,i){let s=this.rendererByCompId,a=s.get(i.id);if(!a){let o=this.doc,c=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Gc.Emulated:a=new Lh(l,h,i,this.appId,f,o,c,d);break;case Gc.ShadowDom:return new H0(l,h,n,i,o,c,this.nonce,d);default:a=new al(l,h,i,f,o,c,d);break}s.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(je(N1),je(M1),je(yh),je(zC),je(gr),je(Yn),je(Vt),je(qc))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),sl=class{constructor(e,r,n,i){this.eventManager=e,this.doc=r,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,r){return r?this.doc.createElementNS(U0[r]||r,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,r){(F1(e)?e.content:e).appendChild(r)}insertBefore(e,r,n){e&&(F1(e)?e.content:e).insertBefore(r,n)}removeChild(e,r){e&&e.removeChild(r)}selectRootElement(e,r){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new bt(-5104,!1);return r||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,r,n,i){if(i){r=i+":"+r;let s=U0[i];s?e.setAttributeNS(s,r,n):e.setAttribute(r,n)}else e.setAttribute(r,n)}removeAttribute(e,r,n){if(n){let i=U0[n];i?e.removeAttributeNS(i,r):e.removeAttribute(`${n}:${r}`)}else e.removeAttribute(r)}addClass(e,r){e.classList.add(r)}removeClass(e,r){e.classList.remove(r)}setStyle(e,r,n,i){i&(Kc.DashCase|Kc.Important)?e.style.setProperty(r,n,i&Kc.Important?"important":""):e.style[r]=n}removeStyle(e,r,n){n&Kc.DashCase?e.style.removeProperty(r):e.style[r]=""}setProperty(e,r,n){e!=null&&(e[r]=n)}setValue(e,r){e.nodeValue=r}listen(e,r,n){if(typeof e=="string"&&(e=go().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${r}`);return this.eventManager.addEventListener(e,r,this.decoratePreventDefault(n))}decoratePreventDefault(e){return r=>{if(r==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(r)):e(r))===!1&&r.preventDefault()}}};function F1(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var H0=class extends sl{constructor(e,r,n,i,s,a,o,c){super(e,s,a,c),this.sharedStylesHost=r,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=V1(i.id,i.styles);for(let h of l){let f=document.createElement("style");o&&f.setAttribute("nonce",o),f.textContent=h,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,r){return super.appendChild(this.nodeOrShadowRoot(e),r)}insertBefore(e,r,n){return super.insertBefore(this.nodeOrShadowRoot(e),r,n)}removeChild(e,r){return super.removeChild(this.nodeOrShadowRoot(e),r)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},al=class extends sl{constructor(e,r,n,i,s,a,o,c){super(e,s,a,o),this.sharedStylesHost=r,this.removeStylesOnCompDestroy=i,this.styles=c?V1(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Lh=class extends al{constructor(e,r,n,i,s,a,o,c){let l=i+"-"+n.id;super(e,r,n,s,a,o,c,l),this.contentAttr=GC(l),this.hostAttr=qC(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,r){let n=super.createElement(e,r);return super.setAttribute(n,this.contentAttr,""),n}},KC=(()=>{let e=class e extends Nh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(je(gr))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),O1=["alt","control","meta","shift"],XC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},YC={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},QC=(()=>{let e=class e extends Nh{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,s){let a=e.parseEventName(i),o=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>go().onAndCancel(n,a.domEventName,o))}static parseEventName(n){let i=n.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),O1.forEach(h=>{let f=i.indexOf(h);f>-1&&(i.splice(f,1),o+=h+".")}),o+=a,i.length!=0||a.length===0)return null;let l={};return l.domEventName=s,l.fullKey=o,l}static matchEventFullKeyCode(n,i){let s=XC[n.key]||n.key,a="";return i.indexOf("code.")>-1&&(s=n.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),O1.forEach(o=>{if(o!==s){let c=YC[o];c(n)&&(a+=o+".")}}),a+=s,a===i)}static eventCallback(n,i,s){return a=>{e.matchEventFullKeyCode(a,n)&&s.runGuarded(()=>i(a))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)(je(gr))},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})();function B1(t,e){return m1(be({rootComponent:t},JC(e)))}function JC(t){return{appProviders:[...n2,...t?.providers??[]],platformProviders:r2}}function ZC(){W0.makeCurrent()}function e2(){return new b0}function t2(){return o1(document),document}var r2=[{provide:Yn,useValue:x1},{provide:c1,useValue:ZC,multi:!0},{provide:gr,useFactory:t2,deps:[]}];var n2=[{provide:a1,useValue:"root"},{provide:b0,useFactory:e2,deps:[]},{provide:$0,useClass:KC,multi:!0,deps:[gr,Vt,Yn]},{provide:$0,useClass:QC,multi:!0,deps:[gr]},Mh,M1,N1,{provide:xh,useExisting:Mh},{provide:Ch,useClass:jC,deps:[]},[]];var U1=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)(je(gr))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ge="primary",wl=Symbol("RouteTitle"),Y0=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r[0]:r}return null}getAll(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r:[r]}return[]}get keys(){return Object.keys(this.params)}};function Eo(t){return new Y0(t)}function a2(t,e,r){let n=r.path.split("/");if(n.length>t.length||r.pathMatch==="full"&&(e.hasChildren()||n.length<t.length))return null;let i={};for(let s=0;s<n.length;s++){let a=n[s],o=t[s];if(a.startsWith(":"))i[a.substring(1)]=o;else if(a!==o.path)return null}return{consumed:t.slice(0,n.length),posParams:i}}function o2(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!di(t[r],e[r]))return!1;return!0}function di(t,e){let r=t?Q0(t):void 0,n=e?Q0(e):void 0;if(!r||!n||r.length!=n.length)return!1;let i;for(let s=0;s<r.length;s++)if(i=r[s],!K1(t[i],e[i]))return!1;return!0}function Q0(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function K1(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let r=[...t].sort(),n=[...e].sort();return r.every((i,s)=>n[s]===i)}else return t===e}function X1(t){return t.length>0?t[t.length-1]:null}function _s(t){return Qy(t)?t:Th(t)?Yr(Promise.resolve(t)):We(t)}var c2={exact:Q1,subset:J1},Y1={exact:l2,subset:u2,ignored:()=>!0};function j1(t,e,r){return c2[r.paths](t.root,e.root,r.matrixParams)&&Y1[r.queryParams](t.queryParams,e.queryParams)&&!(r.fragment==="exact"&&t.fragment!==e.fragment)}function l2(t,e){return di(t,e)}function Q1(t,e,r){if(!aa(t.segments,e.segments)||!Uh(t.segments,e.segments,r)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!t.children[n]||!Q1(t.children[n],e.children[n],r))return!1;return!0}function u2(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(r=>K1(t[r],e[r]))}function J1(t,e,r){return Z1(t,e,e.segments,r)}function Z1(t,e,r,n){if(t.segments.length>r.length){let i=t.segments.slice(0,r.length);return!(!aa(i,r)||e.hasChildren()||!Uh(i,r,n))}else if(t.segments.length===r.length){if(!aa(t.segments,r)||!Uh(t.segments,r,n))return!1;for(let i in e.children)if(!t.children[i]||!J1(t.children[i],e.children[i],n))return!1;return!0}else{let i=r.slice(0,t.segments.length),s=r.slice(t.segments.length);return!aa(t.segments,i)||!Uh(t.segments,i,n)||!t.children[Ge]?!1:Z1(t.children[Ge],e,s,n)}}function Uh(t,e,r){return e.every((n,i)=>Y1[r](t[i].parameters,n.parameters))}var ms=class{constructor(e=new dt([],{}),r={},n=null){this.root=e,this.queryParams=r,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Eo(this.queryParams),this._queryParamMap}toString(){return d2.serialize(this)}},dt=class{constructor(e,r){this.segments=e,this.children=r,this.parent=null,Object.values(r).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jh(this)}},sa=class{constructor(e,r){this.path=e,this.parameters=r}get parameterMap(){return this._parameterMap??=Eo(this.parameters),this._parameterMap}toString(){return tx(this)}};function h2(t,e){return aa(t,e)&&t.every((r,n)=>di(r.parameters,e[n].parameters))}function aa(t,e){return t.length!==e.length?!1:t.every((r,n)=>r.path===e[n].path)}function f2(t,e){let r=[];return Object.entries(t.children).forEach(([n,i])=>{n===Ge&&(r=r.concat(e(i,n)))}),Object.entries(t.children).forEach(([n,i])=>{n!==Ge&&(r=r.concat(e(i,n)))}),r}var Tp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:()=>new $h,providedIn:"root"});let t=e;return t})(),$h=class{parse(e){let r=new Z0(e);return new ms(r.parseRootSegment(),r.parseQueryParams(),r.parseFragment())}serialize(e){let r=`/${ol(e.root,!0)}`,n=g2(e.queryParams),i=typeof e.fragment=="string"?`#${p2(e.fragment)}`:"";return`${r}${n}${i}`}},d2=new $h;function jh(t){return t.segments.map(e=>tx(e)).join("/")}function ol(t,e){if(!t.hasChildren())return jh(t);if(e){let r=t.children[Ge]?ol(t.children[Ge],!1):"",n=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Ge&&n.push(`${i}:${ol(s,!1)}`)}),n.length>0?`${r}(${n.join("//")})`:r}else{let r=f2(t,(n,i)=>i===Ge?[ol(t.children[Ge],!1)]:[`${i}:${ol(n,!1)}`]);return Object.keys(t.children).length===1&&t.children[Ge]!=null?`${jh(t)}/${r[0]}`:`${jh(t)}/(${r.join("//")})`}}function ex(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Vh(t){return ex(t).replace(/%3B/gi,";")}function p2(t){return encodeURI(t)}function J0(t){return ex(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wh(t){return decodeURIComponent(t)}function W1(t){return Wh(t.replace(/\+/g,"%20"))}function tx(t){return`${J0(t.path)}${m2(t.parameters)}`}function m2(t){return Object.entries(t).map(([e,r])=>`;${J0(e)}=${J0(r)}`).join("")}function g2(t){let e=Object.entries(t).map(([r,n])=>Array.isArray(n)?n.map(i=>`${Vh(r)}=${Vh(i)}`).join("&"):`${Vh(r)}=${Vh(n)}`).filter(r=>r);return e.length?`?${e.join("&")}`:""}var v2=/^[^\/()?;#]+/;function G0(t){let e=t.match(v2);return e?e[0]:""}var _2=/^[^\/()?;=#]+/;function y2(t){let e=t.match(_2);return e?e[0]:""}var x2=/^[^=?&#]+/;function w2(t){let e=t.match(x2);return e?e[0]:""}var E2=/^[^&#]+/;function T2(t){let e=t.match(E2);return e?e[0]:""}var Z0=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new dt([],{}):new dt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(r).length>0)&&(n[Ge]=new dt(e,r)),n}parseSegment(){let e=G0(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new bt(4009,!1);return this.capture(e),new sa(Wh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let r=y2(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let i=G0(this.remaining);i&&(n=i,this.capture(n))}e[Wh(r)]=Wh(n)}parseQueryParam(e){let r=w2(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let a=T2(this.remaining);a&&(n=a,this.capture(n))}let i=W1(r),s=W1(n);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=G0(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new bt(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ge);let a=this.parseChildren();r[s]=Object.keys(a).length===1?a[Ge]:new dt([],a),this.consumeOptional("//")}return r}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new bt(4011,!1)}};function rx(t){return t.segments.length>0?new dt([],{[Ge]:t}):t}function nx(t){let e={};for(let[n,i]of Object.entries(t.children)){let s=nx(i);if(n===Ge&&s.segments.length===0&&s.hasChildren())for(let[a,o]of Object.entries(s.children))e[a]=o;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let r=new dt(t.segments,e);return b2(r)}function b2(t){if(t.numberOfChildren===1&&t.children[Ge]){let e=t.children[Ge];return new dt(t.segments.concat(e.segments),e.children)}return t}function To(t){return t instanceof ms}function I2(t,e,r=null,n=null){let i=ix(t);return sx(i,e,r,n)}function ix(t){let e;function r(s){let a={};for(let c of s.children){let l=r(c);a[c.outlet]=l}let o=new dt(s.url,a);return s===t&&(e=o),o}let n=r(t.root),i=rx(n);return e??i}function sx(t,e,r,n){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return q0(i,i,i,r,n);let s=A2(e);if(s.toRoot())return q0(i,i,new dt([],{}),r,n);let a=S2(s,i,t),o=a.processChildren?ul(a.segmentGroup,a.index,s.commands):ox(a.segmentGroup,a.index,s.commands);return q0(i,a.segmentGroup,o,r,n)}function Hh(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function dl(t){return typeof t=="object"&&t!=null&&t.outlets}function q0(t,e,r,n,i){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let a;t===e?a=r:a=ax(t,e,r);let o=rx(nx(a));return new ms(o,s,i)}function ax(t,e,r){let n={};return Object.entries(t.children).forEach(([i,s])=>{s===e?n[i]=r:n[i]=ax(s,e,r)}),new dt(t.segments,n)}var zh=class{constructor(e,r,n){if(this.isAbsolute=e,this.numberOfDoubleDots=r,this.commands=n,e&&n.length>0&&Hh(n[0]))throw new bt(4003,!1);let i=n.find(dl);if(i&&i!==X1(n))throw new bt(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function A2(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new zh(!0,0,t);let e=0,r=!1,n=t.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let o={};return Object.entries(s.outlets).forEach(([c,l])=>{o[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:o}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((o,c)=>{c==0&&o==="."||(c==0&&o===""?r=!0:o===".."?e++:o!=""&&i.push(o))}),i):[...i,s]},[]);return new zh(r,e,n)}var xo=class{constructor(e,r,n){this.segmentGroup=e,this.processChildren=r,this.index=n}};function S2(t,e,r){if(t.isAbsolute)return new xo(e,!0,0);if(!r)return new xo(e,!1,NaN);if(r.parent===null)return new xo(r,!0,0);let n=Hh(t.commands[0])?0:1,i=r.segments.length-1+n;return C2(r,i,t.numberOfDoubleDots)}function C2(t,e,r){let n=t,i=e,s=r;for(;s>i;){if(s-=i,n=n.parent,!n)throw new bt(4005,!1);i=n.segments.length}return new xo(n,!1,i-s)}function k2(t){return dl(t[0])?t[0].outlets:{[Ge]:t}}function ox(t,e,r){if(t??=new dt([],{}),t.segments.length===0&&t.hasChildren())return ul(t,e,r);let n=D2(t,e,r),i=r.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){let s=new dt(t.segments.slice(0,n.pathIndex),{});return s.children[Ge]=new dt(t.segments.slice(n.pathIndex),t.children),ul(s,0,i)}else return n.match&&i.length===0?new dt(t.segments,{}):n.match&&!t.hasChildren()?ep(t,e,r):n.match?ul(t,0,i):ep(t,e,r)}function ul(t,e,r){if(r.length===0)return new dt(t.segments,{});{let n=k2(r),i={};if(Object.keys(n).some(s=>s!==Ge)&&t.children[Ge]&&t.numberOfChildren===1&&t.children[Ge].segments.length===0){let s=ul(t.children[Ge],e,r);return new dt(t.segments,s.children)}return Object.entries(n).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=ox(t.children[s],e,a))}),Object.entries(t.children).forEach(([s,a])=>{n[s]===void 0&&(i[s]=a)}),new dt(t.segments,i)}}function D2(t,e,r){let n=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(n>=r.length)return s;let a=t.segments[i],o=r[n];if(dl(o))break;let c=`${o}`,l=n<r.length-1?r[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!H1(c,l,a))return s;n+=2}else{if(!H1(c,{},a))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function ep(t,e,r){let n=t.segments.slice(0,e),i=0;for(;i<r.length;){let s=r[i];if(dl(s)){let c=R2(s.outlets);return new dt(n,c)}if(i===0&&Hh(r[0])){let c=t.segments[e];n.push(new sa(c.path,$1(r[0]))),i++;continue}let a=dl(s)?s.outlets[Ge]:`${s}`,o=i<r.length-1?r[i+1]:null;a&&o&&Hh(o)?(n.push(new sa(a,$1(o))),i+=2):(n.push(new sa(a,{})),i++)}return new dt(n,{})}function R2(t){let e={};return Object.entries(t).forEach(([r,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[r]=ep(new dt([],{}),0,n))}),e}function $1(t){let e={};return Object.entries(t).forEach(([r,n])=>e[r]=`${n}`),e}function H1(t,e,r){return t==r.path&&di(e,r.parameters)}var hl="imperative",Cr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Cr||{}),Rn=class{constructor(e,r){this.id=e,this.url=r}},pl=class extends Rn{constructor(e,r,n="imperative",i=null){super(e,r),this.type=Cr.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},gs=class extends Rn{constructor(e,r,n){super(e,r),this.urlAfterRedirects=n,this.type=Cr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},gn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(gn||{}),tp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(tp||{}),vs=class extends Rn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Cr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},oa=class extends Rn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Cr.NavigationSkipped}},ml=class extends Rn{constructor(e,r,n,i){super(e,r),this.error=n,this.target=i,this.type=Cr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Gh=class extends Rn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Cr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rp=class extends Rn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Cr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},np=class extends Rn{constructor(e,r,n,i,s){super(e,r),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=Cr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},ip=class extends Rn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Cr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sp=class extends Rn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Cr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ap=class{constructor(e){this.route=e,this.type=Cr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},op=class{constructor(e){this.route=e,this.type=Cr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},cp=class{constructor(e){this.snapshot=e,this.type=Cr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},lp=class{constructor(e){this.snapshot=e,this.type=Cr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},up=class{constructor(e){this.snapshot=e,this.type=Cr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hp=class{constructor(e){this.snapshot=e,this.type=Cr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var gl=class{},vl=class{constructor(e){this.url=e}};var fp=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Jh,this.attachRef=null}},Jh=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new fp,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),qh=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let r=this.pathFromRoot(e);return r.length>1?r[r.length-2]:null}children(e){let r=dp(e,this._root);return r?r.children.map(n=>n.value):[]}firstChild(e){let r=dp(e,this._root);return r&&r.children.length>0?r.children[0].value:null}siblings(e){let r=pp(e,this._root);return r.length<2?[]:r[r.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return pp(e,this._root).map(r=>r.value)}};function dp(t,e){if(t===e.value)return e;for(let r of e.children){let n=dp(t,r);if(n)return n}return null}function pp(t,e){if(t===e.value)return[e];for(let r of e.children){let n=pp(t,r);if(n.length)return n.unshift(e),n}return[]}var mn=class{constructor(e,r){this.value=e,this.children=r}toString(){return`TreeNode(${this.value})`}};function yo(t){let e={};return t&&t.children.forEach(r=>e[r.value.outlet]=r),e}var Kh=class extends qh{constructor(e,r){super(e),this.snapshot=r,Ip(this,e)}toString(){return this.snapshot.toString()}};function cx(t){let e=P2(t),r=new Cn([new sa("",{})]),n=new Cn({}),i=new Cn({}),s=new Cn({}),a=new Cn(""),o=new ca(r,n,s,a,i,Ge,t,e.root);return o.snapshot=e.root,new Kh(new mn(o,[]),e)}function P2(t){let e={},r={},n={},i="",s=new _l([],e,n,i,r,Ge,t,null,{});return new Xh("",new mn(s,[]))}var ca=class{constructor(e,r,n,i,s,a,o,c){this.urlSubject=e,this.paramsSubject=r,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=o,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(et(l=>l[wl]))??We(void 0),this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(et(e=>Eo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(et(e=>Eo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function bp(t,e,r="emptyOnly"){let n,{routeConfig:i}=t;return e!==null&&(r==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:be(be({},e.params),t.params),data:be(be({},e.data),t.data),resolve:be(be(be(be({},t.data),e.data),i?.data),t._resolvedData)}:n={params:be({},t.params),data:be({},t.data),resolve:be(be({},t.data),t._resolvedData??{})},i&&ux(i)&&(n.resolve[wl]=i.title),n}var _l=class{get title(){return this.data?.[wl]}constructor(e,r,n,i,s,a,o,c,l){this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=a,this.component=o,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Eo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Eo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),r=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${r}')`}},Xh=class extends qh{constructor(e,r){super(r),this.url=e,Ip(this,r)}toString(){return lx(this._root)}};function Ip(t,e){e.value._routerState=t,e.children.forEach(r=>Ip(t,r))}function lx(t){let e=t.children.length>0?` { ${t.children.map(lx).join(", ")} } `:"";return`${t.value}${e}`}function K0(t){if(t.snapshot){let e=t.snapshot,r=t._futureSnapshot;t.snapshot=r,di(e.queryParams,r.queryParams)||t.queryParamsSubject.next(r.queryParams),e.fragment!==r.fragment&&t.fragmentSubject.next(r.fragment),di(e.params,r.params)||t.paramsSubject.next(r.params),o2(e.url,r.url)||t.urlSubject.next(r.url),di(e.data,r.data)||t.dataSubject.next(r.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function mp(t,e){let r=di(t.params,e.params)&&h2(t.url,e.url),n=!t.parent!=!e.parent;return r&&!n&&(!t.parent||mp(t.parent,e.parent))}function ux(t){return typeof t.title=="string"||t.title===null}var Ap=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ge,this.activateEvents=new Sr,this.deactivateEvents=new Sr,this.attachEvents=new Sr,this.detachEvents=new Sr,this.parentContexts=Ce(Jh),this.location=Ce(wh),this.changeDetector=Ce(ds),this.environmentInjector=Ce(lo),this.inputBinder=Ce(Sp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new bt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new bt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new bt(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new bt(4013,!1);this._activatedRoute=n;let s=this.location,o=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new gp(n,c,s.injector);this.activated=s.createComponent(o,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Nt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Kn]});let t=e;return t})(),gp=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,r,n){this.route=e,this.childContexts=r,this.parent=n}get(e,r){return e===ca?this.route:e===Jh?this.childContexts:this.parent.get(e,r)}},Sp=new tt("");function F2(t,e,r){let n=yl(t,e._root,r?r._root:void 0);return new Kh(n,e)}function yl(t,e,r){if(r&&t.shouldReuseRoute(e.value,r.value.snapshot)){let n=r.value;n._futureSnapshot=e.value;let i=O2(t,e,r);return new mn(n,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(o=>yl(t,o)),a}}let n=N2(e.value),i=e.children.map(s=>yl(t,s));return new mn(n,i)}}function O2(t,e,r){return e.children.map(n=>{for(let i of r.children)if(t.shouldReuseRoute(n.value,i.value.snapshot))return yl(t,n,i);return yl(t,n)})}function N2(t){return new ca(new Cn(t.url),new Cn(t.params),new Cn(t.queryParams),new Cn(t.fragment),new Cn(t.data),t.outlet,t.component,t)}var hx="ngNavigationCancelingError";function fx(t,e){let{redirectTo:r,navigationBehaviorOptions:n}=To(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=dx(!1,gn.Redirect);return i.url=r,i.navigationBehaviorOptions=n,i}function dx(t,e){let r=new Error(`NavigationCancelingError: ${t||""}`);return r[hx]=!0,r.cancellationCode=e,r}function M2(t){return px(t)&&To(t.url)}function px(t){return!!t&&t[hx]}var L2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["ng-component"]],standalone:!0,features:[rr],decls:1,vars:0,template:function(i,s){i&1&&xt(0,"router-outlet")},dependencies:[Ap],encapsulation:2});let t=e;return t})();function V2(t,e){return t.providers&&!t._injector&&(t._injector=f1(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Cp(t){let e=t.children&&t.children.map(Cp),r=e?ht(be({},t),{children:e}):be({},t);return!r.component&&!r.loadComponent&&(e||r.loadChildren)&&r.outlet&&r.outlet!==Ge&&(r.component=L2),r}function pi(t){return t.outlet||Ge}function B2(t,e){let r=t.filter(n=>pi(n)===e);return r.push(...t.filter(n=>pi(n)!==e)),r}function El(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let r=e.routeConfig;if(r?._loadedInjector)return r._loadedInjector;if(r?._injector)return r._injector}return null}var U2=(t,e,r,n)=>et(i=>(new vp(e,i.targetRouterState,i.currentRouterState,r,n).activate(t),i)),vp=class{constructor(e,r,n,i,s){this.routeReuseStrategy=e,this.futureState=r,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let r=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(r,n,e),K0(this.futureState.root),this.activateChildRoutes(r,n,e)}deactivateChildRoutes(e,r,n){let i=yo(r);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],n),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(i===s)if(i.component){let a=n.getContext(i.outlet);a&&this.deactivateChildRoutes(e,r,a.children)}else this.deactivateChildRoutes(e,r,n);else s&&this.deactivateRouteAndItsChildren(r,n)}deactivateRouteAndItsChildren(e,r){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,r):this.deactivateRouteAndOutlet(e,r)}detachAndStoreRouteSubtree(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=yo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(n&&n.outlet){let a=n.outlet.detach(),o=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:o})}}deactivateRouteAndOutlet(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=yo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,r,n){let i=yo(r);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new hp(s.value.snapshot))}),e.children.length&&this.forwardEvent(new lp(e.value.snapshot))}activateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(K0(i),i===s)if(i.component){let a=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,r,a.children)}else this.activateChildRoutes(e,r,n);else if(i.component){let a=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let o=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(o.contexts),a.attachRef=o.componentRef,a.route=o.route.value,a.outlet&&a.outlet.attach(o.componentRef,o.route.value),K0(o.route.value),this.activateChildRoutes(e,null,a.children)}else{let o=El(i.snapshot);a.attachRef=null,a.route=i,a.injector=o,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}},Yh=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},wo=class{constructor(e,r){this.component=e,this.route=r}};function j2(t,e,r){let n=t._root,i=e?e._root:null;return cl(n,i,r,[n.value])}function W2(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Io(t,e){let r=Symbol(),n=e.get(t,r);return n===r?typeof t=="function"&&!s1(t)?t:e.get(t):n}function cl(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=yo(e);return t.children.forEach(a=>{$2(a,s[a.value.outlet],r,n.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,o])=>fl(o,r.getContext(a),i)),i}function $2(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,a=e?e.value:null,o=r?r.getContext(t.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let c=H2(a,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Yh(n)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?cl(t,e,o?o.children:null,n,i):cl(t,e,r,n,i),c&&o&&o.outlet&&o.outlet.isActivated&&i.canDeactivateChecks.push(new wo(o.outlet.component,a))}else a&&fl(e,o,i),i.canActivateChecks.push(new Yh(n)),s.component?cl(t,null,o?o.children:null,n,i):cl(t,null,r,n,i);return i}function H2(t,e,r){if(typeof r=="function")return r(t,e);switch(r){case"pathParamsChange":return!aa(t.url,e.url);case"pathParamsOrQueryParamsChange":return!aa(t.url,e.url)||!di(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!mp(t,e)||!di(t.queryParams,e.queryParams);case"paramsChange":default:return!mp(t,e)}}function fl(t,e,r){let n=yo(t),i=t.value;Object.entries(n).forEach(([s,a])=>{i.component?e?fl(a,e.children.getContext(s),r):fl(a,null,r):fl(a,e,r)}),i.component?e&&e.outlet&&e.outlet.isActivated?r.canDeactivateChecks.push(new wo(e.outlet.component,i)):r.canDeactivateChecks.push(new wo(null,i)):r.canDeactivateChecks.push(new wo(null,i))}function Tl(t){return typeof t=="function"}function z2(t){return typeof t=="boolean"}function G2(t){return t&&Tl(t.canLoad)}function q2(t){return t&&Tl(t.canActivate)}function K2(t){return t&&Tl(t.canActivateChild)}function X2(t){return t&&Tl(t.canDeactivate)}function Y2(t){return t&&Tl(t.canMatch)}function mx(t){return t instanceof Jy||t?.name==="EmptyError"}var Bh=Symbol("INITIAL_VALUE");function bo(){return Dn(t=>zc(t.map(e=>e.pipe(hs(1),vh(Bh)))).pipe(et(e=>{for(let r of e)if(r!==!0){if(r===Bh)return Bh;if(r===!1||r instanceof ms)return r}return!0}),us(e=>e!==Bh),hs(1)))}function Q2(t,e){return kn(r=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=r;return a.length===0&&s.length===0?We(ht(be({},r),{guardsResult:!0})):J2(a,n,i,t).pipe(kn(o=>o&&z2(o)?Z2(n,s,t,e):We(o)),et(o=>ht(be({},r),{guardsResult:o})))})}function J2(t,e,r,n){return Yr(t).pipe(kn(i=>ik(i.component,i.route,r,e,n)),fs(i=>i!==!0,!0))}function Z2(t,e,r,n){return Yr(e).pipe(Zs(i=>gh(tk(i.route.parent,n),ek(i.route,n),nk(t,i.path,r),rk(t,i.route,r))),fs(i=>i!==!0,!0))}function ek(t,e){return t!==null&&e&&e(new up(t)),We(!0)}function tk(t,e){return t!==null&&e&&e(new cp(t)),We(!0)}function rk(t,e,r){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return We(!0);let i=n.map(s=>y0(()=>{let a=El(e)??r,o=Io(s,a),c=q2(o)?o.canActivate(e,t):Li(a,()=>o(e,t));return _s(c).pipe(fs())}));return We(i).pipe(bo())}function nk(t,e,r){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>W2(a)).filter(a=>a!==null).map(a=>y0(()=>{let o=a.guards.map(c=>{let l=El(a.node)??r,h=Io(c,l),f=K2(h)?h.canActivateChild(n,t):Li(l,()=>h(n,t));return _s(f).pipe(fs())});return We(o).pipe(bo())}));return We(s).pipe(bo())}function ik(t,e,r,n,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return We(!0);let a=s.map(o=>{let c=El(e)??i,l=Io(o,c),h=X2(l)?l.canDeactivate(t,e,r,n):Li(c,()=>l(t,e,r,n));return _s(h).pipe(fs())});return We(a).pipe(bo())}function sk(t,e,r,n){let i=e.canLoad;if(i===void 0||i.length===0)return We(!0);let s=i.map(a=>{let o=Io(a,t),c=G2(o)?o.canLoad(e,r):Li(t,()=>o(e,r));return _s(c)});return We(s).pipe(bo(),gx(n))}function gx(t){return Ky(lr(e=>{if(To(e))throw fx(t,e)}),et(e=>e===!0))}function ak(t,e,r,n){let i=e.canMatch;if(!i||i.length===0)return We(!0);let s=i.map(a=>{let o=Io(a,t),c=Y2(o)?o.canMatch(e,r):Li(t,()=>o(e,r));return _s(c)});return We(s).pipe(bo(),gx(n))}var xl=class{constructor(e){this.segmentGroup=e||null}},Qh=class extends Error{constructor(e){super(),this.urlTree=e}};function _o(t){return Hc(new xl(t))}function ok(t){return Hc(new bt(4e3,!1))}function ck(t){return Hc(dx(!1,gn.GuardRejected))}var _p=class{constructor(e,r){this.urlSerializer=e,this.urlTree=r}lineralizeSegments(e,r){let n=[],i=r.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return We(n);if(i.numberOfChildren>1||!i.children[Ge])return ok(e.redirectTo);i=i.children[Ge]}}applyRedirectCommands(e,r,n){let i=this.applyRedirectCreateUrlTree(r,this.urlSerializer.parse(r),e,n);if(r.startsWith("/"))throw new Qh(i);return i}applyRedirectCreateUrlTree(e,r,n,i){let s=this.createSegmentGroup(e,r.root,n,i);return new ms(s,this.createQueryParams(r.queryParams,this.urlTree.queryParams),r.fragment)}createQueryParams(e,r){let n={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let o=s.substring(1);n[i]=r[o]}else n[i]=s}),n}createSegmentGroup(e,r,n,i){let s=this.createSegments(e,r.segments,n,i),a={};return Object.entries(r.children).forEach(([o,c])=>{a[o]=this.createSegmentGroup(e,c,n,i)}),new dt(s,a)}createSegments(e,r,n,i){return r.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,r,n){let i=n[r.path.substring(1)];if(!i)throw new bt(4001,!1);return i}findOrReturn(e,r){let n=0;for(let i of r){if(i.path===e.path)return r.splice(n),i;n++}return e}},yp={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function lk(t,e,r,n,i){let s=kp(t,e,r);return s.matched?(n=V2(e,n),ak(n,e,r,i).pipe(et(a=>a===!0?s:be({},yp)))):We(s)}function kp(t,e,r){if(e.path==="**")return uk(r);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||r.length>0)?be({},yp):{matched:!0,consumedSegments:[],remainingSegments:r,parameters:{},positionalParamSegments:{}};let i=(e.matcher||a2)(r,t,e);if(!i)return be({},yp);let s={};Object.entries(i.posParams??{}).forEach(([o,c])=>{s[o]=c.path});let a=i.consumed.length>0?be(be({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:r.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function uk(t){return{matched:!0,parameters:t.length>0?X1(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function z1(t,e,r,n){return r.length>0&&dk(t,r,n)?{segmentGroup:new dt(e,fk(n,new dt(r,t.children))),slicedSegments:[]}:r.length===0&&pk(t,r,n)?{segmentGroup:new dt(t.segments,hk(t,r,n,t.children)),slicedSegments:r}:{segmentGroup:new dt(t.segments,t.children),slicedSegments:r}}function hk(t,e,r,n){let i={};for(let s of r)if(Zh(t,e,s)&&!n[pi(s)]){let a=new dt([],{});i[pi(s)]=a}return be(be({},n),i)}function fk(t,e){let r={};r[Ge]=e;for(let n of t)if(n.path===""&&pi(n)!==Ge){let i=new dt([],{});r[pi(n)]=i}return r}function dk(t,e,r){return r.some(n=>Zh(t,e,n)&&pi(n)!==Ge)}function pk(t,e,r){return r.some(n=>Zh(t,e,n))}function Zh(t,e,r){return(t.hasChildren()||e.length>0)&&r.pathMatch==="full"?!1:r.path===""}function mk(t,e,r,n){return pi(t)!==n&&(n===Ge||!Zh(e,r,t))?!1:kp(e,t,r).matched}function gk(t,e,r){return e.length===0&&!t.children[r]}var xp=class{};function vk(t,e,r,n,i,s,a="emptyOnly"){return new wp(t,e,r,n,i,a,s).recognize()}var _k=31,wp=class{constructor(e,r,n,i,s,a,o){this.injector=e,this.configLoader=r,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=o,this.applyRedirects=new _p(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new bt(4002,`'${e.segmentGroup}'`)}recognize(){let e=z1(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(et(r=>{let n=new _l([],Object.freeze({}),Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ge,this.rootComponentType,null,{}),i=new mn(n,r),s=new Xh("",i),a=I2(n,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Ge).pipe(co(n=>{if(n instanceof Qh)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof xl?this.noMatchError(n):n}))}inheritParamsAndData(e,r){let n=e.value,i=bp(n,r,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,r,n,i){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,r,n):this.processSegment(e,r,n,n.segments,i,!0).pipe(et(s=>s instanceof mn?[s]:[]))}processChildren(e,r,n){let i=[];for(let s of Object.keys(n.children))s==="primary"?i.unshift(s):i.push(s);return Yr(i).pipe(Zs(s=>{let a=n.children[s],o=B2(r,s);return this.processSegmentGroup(e,o,a,s)}),n1((s,a)=>(s.push(...a),s)),x0(null),r1(),kn(s=>{if(s===null)return _o(n);let a=vx(s);return yk(a),We(a)}))}processSegment(e,r,n,i,s,a){return Yr(r).pipe(Zs(o=>this.processSegmentAgainstRoute(o._injector??e,r,o,n,i,s,a).pipe(co(c=>{if(c instanceof xl)return We(null);throw c}))),fs(o=>!!o),co(o=>{if(mx(o))return gk(n,i,s)?We(new xp):_o(n);throw o}))}processSegmentAgainstRoute(e,r,n,i,s,a,o){return mk(n,i,s,a)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,s,a):this.allowRedirects&&o?this.expandSegmentAgainstRouteUsingRedirect(e,i,r,n,s,a):_o(i):_o(i)}expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,a){let{matched:o,consumedSegments:c,positionalParamSegments:l,remainingSegments:h}=kp(r,i,s);if(!o)return _o(r);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>_k&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(kn(d=>this.processSegment(e,n,r,d.concat(h),a,!1)))}matchSegmentAgainstRoute(e,r,n,i,s){let a=lk(r,n,i,e,this.urlSerializer);return n.path==="**"&&(r.children={}),a.pipe(Dn(o=>o.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Dn(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:h,remainingSegments:f,parameters:d}=o,p=new _l(h,d,Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,wk(n),pi(n),n.component??n._loadedComponent??null,n,Ek(n)),{segmentGroup:v,slicedSegments:m}=z1(r,h,f,c);if(m.length===0&&v.hasChildren())return this.processChildren(l,c,v).pipe(et(b=>b===null?null:new mn(p,b)));if(c.length===0&&m.length===0)return We(new mn(p,[]));let _=pi(n)===s;return this.processSegment(l,c,v,m,_?Ge:s,!0).pipe(et(b=>new mn(p,b instanceof mn?[b]:[])))}))):_o(r)))}getChildConfig(e,r,n){return r.children?We({routes:r.children,injector:e}):r.loadChildren?r._loadedRoutes!==void 0?We({routes:r._loadedRoutes,injector:r._loadedInjector}):sk(e,r,n,this.urlSerializer).pipe(kn(i=>i?this.configLoader.loadChildren(e,r).pipe(lr(s=>{r._loadedRoutes=s.routes,r._loadedInjector=s.injector})):ck(r))):We({routes:[],injector:e})}};function yk(t){t.sort((e,r)=>e.value.outlet===Ge?-1:r.value.outlet===Ge?1:e.value.outlet.localeCompare(r.value.outlet))}function xk(t){let e=t.value.routeConfig;return e&&e.path===""}function vx(t){let e=[],r=new Set;for(let n of t){if(!xk(n)){e.push(n);continue}let i=e.find(s=>n.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...n.children),r.add(i)):e.push(n)}for(let n of r){let i=vx(n.children);e.push(new mn(n.value,i))}return e.filter(n=>!r.has(n))}function wk(t){return t.data||{}}function Ek(t){return t.resolve||{}}function Tk(t,e,r,n,i,s){return kn(a=>vk(t,e,r,n,a.extractedUrl,i,s).pipe(et(({state:o,tree:c})=>ht(be({},a),{targetSnapshot:o,urlAfterRedirects:c}))))}function bk(t,e){return kn(r=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=r;if(!i.length)return We(r);let s=new Set(i.map(c=>c.route)),a=new Set;for(let c of s)if(!a.has(c))for(let l of _x(c))a.add(l);let o=0;return Yr(a).pipe(Zs(c=>s.has(c)?Ik(c,n,t,e):(c.data=bp(c,c.parent,t).resolve,We(void 0))),lr(()=>o++),w0(1),kn(c=>o===a.size?We(r):ls))})}function _x(t){let e=t.children.map(r=>_x(r)).flat();return[t,...e]}function Ik(t,e,r,n){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!ux(i)&&(s[wl]=i.title),Ak(s,t,e,n).pipe(et(a=>(t._resolvedData=a,t.data=bp(t,t.parent,r).resolve,null)))}function Ak(t,e,r,n){let i=Q0(t);if(i.length===0)return We({});let s={};return Yr(i).pipe(kn(a=>Sk(t[a],e,r,n).pipe(fs(),lr(o=>{s[a]=o}))),w0(1),t1(s),co(a=>mx(a)?ls:Hc(a)))}function Sk(t,e,r,n){let i=El(e)??n,s=Io(t,i),a=s.resolve?s.resolve(e,r):Li(i,()=>s(e,r));return _s(a)}function X0(t){return Dn(e=>{let r=t(e);return r?Yr(r).pipe(et(()=>e)):We(e)})}var yx=(()=>{let e=class e{buildTitle(n){let i,s=n.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===Ge);return i}getResolvedTitleForRoute(n){return n.data[wl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:()=>Ce(Ck),providedIn:"root"});let t=e;return t})(),Ck=(()=>{let e=class e extends yx{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(je(U1))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Dp=new tt("",{providedIn:"root",factory:()=>({})}),Rp=new tt(""),kk=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ce(k0)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return We(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=_s(n.loadComponent()).pipe(et(xx),lr(a=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=a}),ea(()=>{this.componentLoaders.delete(n)})),s=new m0(i,()=>new li).pipe(p0());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return We({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=Dk(i,this.compiler,n,this.onLoadEndListener).pipe(ea(()=>{this.childrenLoaders.delete(i)})),o=new m0(a,()=>new li).pipe(p0());return this.childrenLoaders.set(i,o),o}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Dk(t,e,r,n){return _s(t.loadChildren()).pipe(et(xx),kn(i=>i instanceof h1||Array.isArray(i)?We(i):Yr(e.compileModuleAsync(i))),et(i=>{n&&n(t);let s,a,o=!1;return Array.isArray(i)?(a=i,o=!0):(s=i.create(r).injector,a=s.get(Rp,[],{optional:!0,self:!0}).flat()),{routes:a.map(Cp),injector:s}}))}function Rk(t){return t&&typeof t=="object"&&"default"in t}function xx(t){return Rk(t)?t.default:t}var Pp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:()=>Ce(Pk),providedIn:"root"});let t=e;return t})(),Pk=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Fk=new tt("");var Ok=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new li,this.transitionAbortSubject=new li,this.configLoader=Ce(kk),this.environmentInjector=Ce(lo),this.urlSerializer=Ce(Tp),this.rootContexts=Ce(Jh),this.location=Ce(Ih),this.inputBindingEnabled=Ce(Sp,{optional:!0})!==null,this.titleStrategy=Ce(yx),this.options=Ce(Dp,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Ce(Pp),this.createViewTransition=Ce(Fk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>We(void 0),this.rootComponentType=null;let n=s=>this.events.next(new ap(s)),i=s=>this.events.next(new op(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(ht(be(be({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,s){return this.transitions=new Cn({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:hl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(us(a=>a.id!==0),et(a=>ht(be({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Dn(a=>{let o=!1,c=!1;return We(a).pipe(Dn(l=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",gn.SupersededByNewNavigation),ls;this.currentTransition=a,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?ht(be({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!h&&f!=="reload"){let d="";return this.events.next(new oa(l.id,this.urlSerializer.serialize(l.rawUrl),d,tp.IgnoredSameUrlNavigation)),l.resolve(null),ls}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return We(l).pipe(Dn(d=>{let p=this.transitions?.getValue();return this.events.next(new pl(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),p!==this.transitions?.getValue()?ls:Promise.resolve(d)}),Tk(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),lr(d=>{a.targetSnapshot=d.targetSnapshot,a.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=ht(be({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let p=new Gh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:p,source:v,restoredState:m,extras:_}=l,b=new pl(d,this.urlSerializer.serialize(p),v,m);this.events.next(b);let S=cx(this.rootComponentType).snapshot;return this.currentTransition=a=ht(be({},l),{targetSnapshot:S,urlAfterRedirects:p,extras:ht(be({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,We(a)}else{let d="";return this.events.next(new oa(l.id,this.urlSerializer.serialize(l.extractedUrl),d,tp.IgnoredByUrlHandlingStrategy)),l.resolve(null),ls}}),lr(l=>{let h=new rp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),et(l=>(this.currentTransition=a=ht(be({},l),{guards:j2(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),a)),Q2(this.environmentInjector,l=>this.events.next(l)),lr(l=>{if(a.guardsResult=l.guardsResult,To(l.guardsResult))throw fx(this.urlSerializer,l.guardsResult);let h=new np(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),us(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",gn.GuardRejected),!1)),X0(l=>{if(l.guards.canActivateChecks.length)return We(l).pipe(lr(h=>{let f=new ip(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),Dn(h=>{let f=!1;return We(h).pipe(bk(this.paramsInheritanceStrategy,this.environmentInjector),lr({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(h,"",gn.NoDataFromResolver)}}))}),lr(h=>{let f=new sp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}))}),X0(l=>{let h=f=>{let d=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(f.routeConfig).pipe(lr(p=>{f.component=p}),et(()=>{})));for(let p of f.children)d.push(...h(p));return d};return zc(h(l.targetSnapshot.root)).pipe(x0(null),hs(1))}),X0(()=>this.afterPreactivation()),Dn(()=>{let{currentSnapshot:l,targetSnapshot:h}=a,f=this.createViewTransition?.(this.environmentInjector,l.root,h.root);return f?Yr(f).pipe(et(()=>a)):We(a)}),et(l=>{let h=F2(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=a=ht(be({},l),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,a}),lr(()=>{this.events.next(new gl)}),U2(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),hs(1),lr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new gs(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),_h(this.transitionAbortSubject.pipe(lr(l=>{throw l}))),ea(()=>{!o&&!c&&this.cancelNavigationTransition(a,"",gn.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),co(l=>{if(c=!0,px(l))this.events.next(new vs(a.id,this.urlSerializer.serialize(a.extractedUrl),l.message,l.cancellationCode)),M2(l)?this.events.next(new vl(l.url)):a.resolve(!1);else{this.events.next(new ml(a.id,this.urlSerializer.serialize(a.extractedUrl),l,a.targetSnapshot??void 0));try{a.resolve(n.errorHandler(l))}catch(h){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(h)}}return ls}))}))}cancelNavigationTransition(n,i,s){let a=new vs(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(a),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Nk(t){return t!==hl}var Mk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:()=>Ce(Lk),providedIn:"root"});let t=e;return t})(),Ep=class{shouldDetach(e){return!1}store(e,r){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,r){return e.routeConfig===r.routeConfig}},Lk=(()=>{let e=class e extends Ep{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:()=>Ce(Vk),providedIn:"root"});let t=e;return t})(),Vk=(()=>{let e=class e extends wx{constructor(){super(...arguments),this.location=Ce(Ih),this.urlSerializer=Ce(Tp),this.options=Ce(Dp,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Ce(Pp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ms,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=cx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof pl)this.stateMemento=this.createStateMemento();else if(n instanceof oa)this.rawUrlTree=i.initialUrl;else if(n instanceof Gh){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else n instanceof gl?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof vs&&(n.code===gn.GuardRejected||n.code===gn.NoDataFromResolver)?this.restoreHistory(i):n instanceof ml?this.restoreHistory(i,!0):n instanceof gs&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,o=be(be({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",o)}else{let a=be(be({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===n.finalUrl&&a===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ll=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(ll||{});function Bk(t,e){t.events.pipe(us(r=>r instanceof gs||r instanceof vs||r instanceof ml||r instanceof oa),et(r=>r instanceof gs||r instanceof oa?ll.COMPLETE:(r instanceof vs?r.code===gn.Redirect||r.code===gn.SupersededByNewNavigation:!1)?ll.REDIRECTING:ll.FAILED),us(r=>r!==ll.REDIRECTING),hs(1)).subscribe(()=>{e()})}function Uk(t){throw t}var jk={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Wk={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},bl=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Ce(Eh),this.stateManager=Ce(wx),this.options=Ce(Dp,{optional:!0})||{},this.pendingTasks=Ce(Yc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Ce(Ok),this.urlSerializer=Ce(Tp),this.location=Ce(Ih),this.urlHandlingStrategy=Ce(Pp),this._events=new li,this.errorHandler=this.options.errorHandler||Uk,this.navigated=!1,this.routeReuseStrategy=Ce(Mk),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Ce(Rp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Ce(Sp,{optional:!0}),this.eventsSubscription=new qy,this.isNgZoneEnabled=Ce(Vt)instanceof Vt&&Vt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof vs&&i.code!==gn.Redirect&&i.code!==gn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof gs)this.navigated=!0;else if(i instanceof vl){let o=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Nk(s.source)};this.scheduleNavigation(o,hl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}Hk(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),hl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,s){let a={replaceUrl:!0},o=s?.navigationId?s:null;if(s){let l=be({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(a.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,o,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Cp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:s,queryParams:a,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,h=l?this.currentUrlTree.fragment:o,f=null;switch(c){case"merge":f=be(be({},this.currentUrlTree.queryParams),a);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=a||null}f!==null&&(f=this.removeEmptyProps(f));let d;try{let p=s?s.snapshot:this.routerState.snapshot.root;d=ix(p)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),d=this.currentUrlTree.root}return sx(d,n,f,h??null)}navigateByUrl(n,i={skipLocationChange:!1}){let s=To(n)?n:this.parseUrl(n),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,hl,null,i)}navigate(n,i={skipLocationChange:!1}){return $k(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let s;if(i===!0?s=be({},jk):i===!1?s=be({},Wk):s=i,To(n))return j1(this.currentUrlTree,n,s);let a=this.parseUrl(n);return j1(this.currentUrlTree,a,s)}removeEmptyProps(n){return Object.entries(n).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(n,i,s,a,o){if(this.disposed)return Promise.resolve(!1);let c,l,h;o?(c=o.resolve,l=o.reject,h=o.promise):h=new Promise((d,p)=>{c=d,l=p});let f=this.pendingTasks.add();return Bk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:a,resolve:c,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(d=>Promise.reject(d))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function $k(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new bt(4008,!1)}function Hk(t){return!(t instanceof gl)&&!(t instanceof vl)}var Ex=(()=>{let e=class e{constructor(n,i,s,a,o,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=a,this.el=o,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new li,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(h=>{h instanceof gs&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,a,o){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||s||a||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:l1(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let s=this.renderer,a=this.el.nativeElement;i!==null?s.setAttribute(a,n,i):s.removeAttribute(a,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Ue(bl),Ue(ca),T0("tabindex"),Ue(Xc),Ue(Xn),Ue(D0))},e.\u0275dir=Nt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&Dt("click",function(o){return s.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),i&2&&na("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[mr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Bi],skipLocationChange:[mr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Bi],replaceUrl:[mr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Bi],routerLink:"routerLink"},standalone:!0,features:[po,Kn]});let t=e;return t})();var zk=new tt("");function Tx(t,...e){return qn([{provide:Rp,multi:!0,useValue:t},[],{provide:ca,useFactory:Gk,deps:[bl]},{provide:C0,multi:!0,useFactory:qk},e.map(r=>r.\u0275providers)])}function Gk(t){return t.routerState.root}function qk(){let t=Ce(ra);return e=>{let r=t.get(bh);if(e!==r.components[0])return;let n=t.get(bl),i=t.get(Kk);t.get(Xk)===1&&n.initialNavigation(),t.get(Yk,null,E0.Optional)?.setUpPreloading(),t.get(zk,null,E0.Optional)?.init(),n.resetRootComponentType(r.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Kk=new tt("",{factory:()=>new li}),Xk=new tt("",{providedIn:"root",factory:()=>1});var Yk=new tt("");var Px=(()=>{let e=class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(i){return new(i||e)(Ue(Xc),Ue(Xn))},e.\u0275dir=Nt({type:e});let t=e;return t})(),Mp=(()=>{let e=class e extends Px{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275dir=Nt({type:e,features:[tn]});let t=e;return t})(),kl=new tt(""),Jk={provide:kl,useExisting:Mi(()=>Lp),multi:!0},Lp=(()=>{let e=class e extends Mp{writeValue(n){this.setProperty("checked",n)}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275dir=Nt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,s){i&1&&Dt("change",function(o){return s.onChange(o.target.checked)})("blur",function(){return s.onTouched()})},features:[nn([Jk]),tn]});let t=e;return t})(),Zk={provide:kl,useExisting:Mi(()=>ws),multi:!0};function eD(){let t=go()?go().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var tD=new tt(""),ws=(()=>{let e=class e extends Px{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!eD())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(Xc),Ue(Xn),Ue(tD,8))},e.\u0275dir=Nt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Dt("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},features:[nn([Zk]),tn]});let t=e;return t})();function ys(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Fx(t){return t!=null&&typeof t.length=="number"}var Dl=new tt(""),lf=new tt(""),rD=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Cl=class{static min(e){return nD(e)}static max(e){return iD(e)}static required(e){return Ox(e)}static requiredTrue(e){return sD(e)}static email(e){return aD(e)}static minLength(e){return oD(e)}static maxLength(e){return cD(e)}static pattern(e){return lD(e)}static nullValidator(e){return tf(e)}static compose(e){return Ux(e)}static composeAsync(e){return jx(e)}};function nD(t){return e=>{if(ys(e.value)||ys(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r<t?{min:{min:t,actual:e.value}}:null}}function iD(t){return e=>{if(ys(e.value)||ys(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r>t?{max:{max:t,actual:e.value}}:null}}function Ox(t){return ys(t.value)?{required:!0}:null}function sD(t){return t.value===!0?null:{required:!0}}function aD(t){return ys(t.value)||rD.test(t.value)?null:{email:!0}}function oD(t){return e=>ys(e.value)||!Fx(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function cD(t){return e=>Fx(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function lD(t){if(!t)return tf;let e,r;return typeof t=="string"?(r="",t.charAt(0)!=="^"&&(r+="^"),r+=t,t.charAt(t.length-1)!=="$"&&(r+="$"),e=new RegExp(r)):(r=t.toString(),e=t),n=>{if(ys(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:r,actualValue:i}}}}function tf(t){return null}function Nx(t){return t!=null}function Mx(t){return Th(t)?Yr(t):t}function Lx(t){let e={};return t.forEach(r=>{e=r!=null?be(be({},e),r):e}),Object.keys(e).length===0?null:e}function Vx(t,e){return e.map(r=>r(t))}function uD(t){return!t.validate}function Bx(t){return t.map(e=>uD(e)?e:r=>e.validate(r))}function Ux(t){if(!t)return null;let e=t.filter(Nx);return e.length==0?null:function(r){return Lx(Vx(r,e))}}function Vp(t){return t!=null?Ux(Bx(t)):null}function jx(t){if(!t)return null;let e=t.filter(Nx);return e.length==0?null:function(r){let n=Vx(r,e).map(Mx);return Zy(n).pipe(et(Lx))}}function Bp(t){return t!=null?jx(Bx(t)):null}function bx(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function Wx(t){return t._rawValidators}function $x(t){return t._rawAsyncValidators}function Fp(t){return t?Array.isArray(t)?t:[t]:[]}function rf(t,e){return Array.isArray(t)?t.includes(e):t===e}function Ix(t,e){let r=Fp(e);return Fp(t).forEach(i=>{rf(r,i)||r.push(i)}),r}function Ax(t,e){return Fp(e).filter(r=>!rf(t,r))}var nf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Vp(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Bp(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,r){return this.control?this.control.hasError(e,r):!1}getError(e,r){return this.control?this.control.getError(e,r):null}},Ui=class extends nf{get formDirective(){return null}get path(){return null}},la=class extends nf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},sf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},hD={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},X$=ht(be({},hD),{"[class.ng-submitted]":"isSubmitted"}),Co=(()=>{let e=class e extends sf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(la,2))},e.\u0275dir=Nt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Qc("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[tn]});let t=e;return t})(),ko=(()=>{let e=class e extends sf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(Ui,10))},e.\u0275dir=Nt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Qc("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[tn]});let t=e;return t})();var Il="VALID",ef="INVALID",Ao="PENDING",Al="DISABLED";function Up(t){return(uf(t)?t.validators:t)||null}function fD(t){return Array.isArray(t)?Vp(t):t||null}function jp(t,e){return(uf(e)?e.asyncValidators:t)||null}function dD(t){return Array.isArray(t)?Bp(t):t||null}function uf(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function Hx(t,e,r){let n=t.controls;if(!(e?Object.keys(n):n).length)throw new bt(1e3,"");if(!n[r])throw new bt(1001,"")}function zx(t,e,r){t._forEachChild((n,i)=>{if(r[i]===void 0)throw new bt(1002,"")})}var So=class{constructor(e,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(r)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Il}get invalid(){return this.status===ef}get pending(){return this.status==Ao}get disabled(){return this.status===Al}get enabled(){return this.status!==Al}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Ix(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Ix(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Ax(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Ax(e,this._rawAsyncValidators))}hasValidator(e){return rf(this._rawValidators,e)}hasAsyncValidator(e){return rf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(r=>{r.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Ao,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=Al,this.errors=null,this._forEachChild(n=>{n.disable(ht(be({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ht(be({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=Il,this._forEachChild(n=>{n.enable(ht(be({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ht(be({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Il||this.status===Ao)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Al:Il}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Ao,this._hasOwnPendingAsyncValidator=!0;let r=Mx(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,r={}){this.errors=e,this._updateControlsErrors(r.emitEvent!==!1)}get(e){let r=e;return r==null||(Array.isArray(r)||(r=r.split(".")),r.length===0)?null:r.reduce((n,i)=>n&&n._find(i),this)}getError(e,r){let n=r?this.get(r):this;return n&&n.errors?n.errors[e]:null}hasError(e,r){return!!this.getError(e,r)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Sr,this.statusChanges=new Sr}_calculateStatus(){return this._allControlsDisabled()?Al:this.errors?ef:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Ao)?Ao:this._anyControlsHaveStatus(ef)?ef:Il}_anyControlsHaveStatus(e){return this._anyControls(r=>r.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){uf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let r=this._parent&&this._parent.dirty;return!e&&!!r&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=fD(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=dD(this._rawAsyncValidators)}},xs=class extends So{constructor(e,r,n){super(Up(r),jp(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,r){return this.controls[e]?this.controls[e]:(this.controls[e]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(e,r,n={}){this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(e,r,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],r&&this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,r={}){zx(this,!0,e),Object.keys(e).forEach(n=>{Hx(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e={},r={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(e,r,n)=>(e[n]=r.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(r,n)=>n._syncPendingControls()?!0:r);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(r=>{let n=this.controls[r];n&&e(n,r)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[r,n]of Object.entries(this.controls))if(this.contains(r)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(r,n,i)=>((n.enabled||this.disabled)&&(r[i]=n.value),r))}_reduceChildren(e,r){let n=e;return this._forEachChild((i,s)=>{n=r(n,i,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Op=class extends xs{};var Rl=new tt("CallSetDisabledState",{providedIn:"root",factory:()=>hf}),hf="always";function Gx(t,e){return[...e.path,t]}function af(t,e,r=hf){Wp(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||r==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),mD(t,e),vD(t,e),gD(t,e),pD(t,e)}function Sx(t,e,r=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),cf(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function of(t,e){t.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(e)})}function pD(t,e){if(e.valueAccessor.setDisabledState){let r=n=>{e.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(r),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(r)})}}function Wp(t,e){let r=Wx(t);e.validator!==null?t.setValidators(bx(r,e.validator)):typeof r=="function"&&t.setValidators([r]);let n=$x(t);e.asyncValidator!==null?t.setAsyncValidators(bx(n,e.asyncValidator)):typeof n=="function"&&t.setAsyncValidators([n]);let i=()=>t.updateValueAndValidity();of(e._rawValidators,i),of(e._rawAsyncValidators,i)}function cf(t,e){let r=!1;if(t!==null){if(e.validator!==null){let i=Wx(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.validator);s.length!==i.length&&(r=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=$x(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.asyncValidator);s.length!==i.length&&(r=!0,t.setAsyncValidators(s))}}}let n=()=>{};return of(e._rawValidators,n),of(e._rawAsyncValidators,n),r}function mD(t,e){e.valueAccessor.registerOnChange(r=>{t._pendingValue=r,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&qx(t,e)})}function gD(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&qx(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function qx(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function vD(t,e){let r=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};t.registerOnChange(r),e._registerOnDestroy(()=>{t._unregisterOnChange(r)})}function Kx(t,e){t==null,Wp(t,e)}function _D(t,e){return cf(t,e)}function Xx(t,e){if(!t.hasOwnProperty("model"))return!1;let r=t.model;return r.isFirstChange()?!0:!Object.is(e,r.currentValue)}function yD(t){return Object.getPrototypeOf(t.constructor)===Mp}function Yx(t,e){t._syncPendingControls(),e.forEach(r=>{let n=r.control;n.updateOn==="submit"&&n._pendingChange&&(r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function Qx(t,e){if(!e)return null;Array.isArray(e);let r,n,i;return e.forEach(s=>{s.constructor===ws?r=s:yD(s)?n=s:i=s}),i||n||r||null}function xD(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}var wD={provide:Ui,useExisting:Mi(()=>$p)},Sl=Promise.resolve(),$p=(()=>{let e=class e extends Ui{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Sr,this.form=new xs({},Vp(n),Bp(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){Sl.then(()=>{let i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),af(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){Sl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){Sl.then(()=>{let i=this._findContainer(n.path),s=new xs({});Kx(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){Sl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){Sl.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,Yx(this.form,this._directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}};e.\u0275fac=function(i){return new(i||e)(Ue(Dl,10),Ue(lf,10),Ue(Rl,8))},e.\u0275dir=Nt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&Dt("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{options:[mr.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nn([wD]),tn]});let t=e;return t})();function Cx(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}function kx(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var mi=class extends So{constructor(e=null,r,n){super(Up(r),jp(n,r)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),uf(r)&&(r.nonNullable||r.initialValueIsDefault)&&(kx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,r={}){this.value=this._pendingValue=e,this._onChange.length&&r.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,r.emitViewToModelChange!==!1)),this.updateValueAndValidity(r)}patchValue(e,r={}){this.setValue(e,r)}reset(e=this.defaultValue,r={}){this._applyFormState(e),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Cx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Cx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){kx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var ED=t=>t instanceof mi;var TD={provide:la,useExisting:Mi(()=>Pl)},Dx=Promise.resolve(),Pl=(()=>{let e=class e extends la{constructor(n,i,s,a,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new mi,this._registered=!1,this.name="",this.update=new Sr,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=Qx(this,a)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),Xx(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){af(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){Dx.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,s=i!==0&&Bi(i);Dx.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Gx(n,this._parent):[n]}};e.\u0275fac=function(i){return new(i||e)(Ue(Ui,9),Ue(Dl,10),Ue(lf,10),Ue(kl,10),Ue(ds,8),Ue(Rl,8))},e.\u0275dir=Nt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[mr.None,"disabled","isDisabled"],model:[mr.None,"ngModel","model"],options:[mr.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[nn([TD]),tn,Kn]});let t=e;return t})(),Do=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Nt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),bD={provide:kl,useExisting:Mi(()=>Hp),multi:!0},Hp=(()=>{let e=class e extends Mp{writeValue(n){let i=n??"";this.setProperty("value",i)}registerOnChange(n){this.onChange=i=>{n(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275dir=Nt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&Dt("input",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},features:[nn([bD]),tn]});let t=e;return t})();var Jx=new tt("");var ID={provide:Ui,useExisting:Mi(()=>Fl)},Fl=(()=>{let e=class e extends Ui{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Sr,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(cf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let i=this.form.get(n.path);return af(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Sx(n.control||null,n,!1),xD(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,Yx(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let i=n.control,s=this.form.get(n.path);i!==s&&(Sx(i||null,n),ED(s)&&(af(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let i=this.form.get(n.path);Kx(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let i=this.form.get(n.path);i&&_D(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Wp(this.form,this),this._oldForm&&cf(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(Ue(Dl,10),Ue(lf,10),Ue(Rl,8))},e.\u0275dir=Nt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&Dt("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{form:[mr.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[nn([ID]),tn,Kn]});let t=e;return t})();var AD={provide:la,useExisting:Mi(()=>Ol)},Ol=(()=>{let e=class e extends la{set isDisabled(n){}constructor(n,i,s,a,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Sr,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=Qx(this,a)}ngOnChanges(n){this._added||this._setUpControl(),Xx(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return Gx(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(Ue(Ui,13),Ue(Dl,10),Ue(lf,10),Ue(kl,10),Ue(Jx,8))},e.\u0275dir=Nt({type:e,selectors:[["","formControlName",""]],inputs:{name:[mr.None,"formControlName","name"],isDisabled:[mr.None,"disabled","isDisabled"],model:[mr.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[nn([AD]),tn,Kn]});let t=e;return t})();var SD=(()=>{let e=class e{constructor(){this._validator=tf}ngOnChanges(n){if(this.inputName in n){let i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):tf,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Nt({type:e,features:[Kn]});let t=e;return t})();var CD={provide:Dl,useExisting:Mi(()=>ua),multi:!0};var ua=(()=>{let e=class e extends SD{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Bi,this.createValidator=n=>Ox}enabled(n){return n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=hi(e)))(s||e)}})(),e.\u0275dir=Nt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&na("required",s._enabled?"":null)},inputs:{required:"required"},features:[nn([CD]),tn]});let t=e;return t})();var Zx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({});let t=e;return t})(),Np=class extends So{constructor(e,r,n){super(Up(r),jp(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,r={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}insert(e,r,n={}){this.controls.splice(e,0,r),this._registerControl(r),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,r={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:r.emitEvent})}setControl(e,r,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),r&&(this.controls.splice(i,0,r),this._registerControl(r)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,r={}){zx(this,!1,e),e.forEach((n,i)=>{Hx(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e=[],r={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(r=>r._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((r,n)=>n._syncPendingControls()?!0:r,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((r,n)=>{e(r,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(r=>r.enabled&&e(r))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Rx(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var ew=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,i=null){let s=this._reduceControls(n),a={};return Rx(i)?a=i:i!==null&&(a.validators=i.validator,a.asyncValidators=i.asyncValidator),new xs(s,a)}record(n,i=null){let s=this._reduceControls(n);return new Op(s,i)}control(n,i,s){let a={};return this.useNonNullable?(Rx(i)?a=i:(a.validators=i,a.asyncValidators=s),new mi(n,ht(be({},a),{nonNullable:!0}))):new mi(n,i,s)}array(n,i,s){let a=n.map(o=>this._createControl(o));return new Np(a,i,s)}_reduceControls(n){let i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){if(n instanceof mi)return n;if(n instanceof So)return n;if(Array.isArray(n)){let i=n[0],s=n.length>1?n[1]:null,a=n.length>2?n[2]:null;return this.control(i,s,a)}else return this.control(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ro=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:Rl,useValue:n.callSetDisabledState??hf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({imports:[Zx]});let t=e;return t})(),ff=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:Jx,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:Rl,useValue:n.callSetDisabledState??hf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({imports:[Zx]});let t=e;return t})();var tw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({});let t=e;return t})();var rw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({});let t=e;return t})();var Gp;try{Gp=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Gp=!1}var Ml=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?w1(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Gp)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(i){return new(i||e)(je(Yn))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Nl;function DD(){if(Nl==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Nl=!0}))}finally{Nl=Nl||!1}return Nl}function qp(t){return DD()?t:!!t.capture}function nw(t){return t.composedPath?t.composedPath()[0]:t.target}function iw(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Kp(t){return Array.isArray(t)?t:[t]}function Xp(t){return t instanceof Xn?t.nativeElement:t}var aw=new Set,ha,RD=(()=>{let e=class e{constructor(n,i){this._platform=n,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):FD}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&PD(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(i){return new(i||e)(je(Ml),je(qc,8))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function PD(t,e){if(!aw.has(t))try{ha||(ha=document.createElement("style"),e&&ha.setAttribute("nonce",e),ha.setAttribute("type","text/css"),document.head.appendChild(ha)),ha.sheet&&(ha.sheet.insertRule(`@media ${t} {body{ }}`,0),aw.add(t))}catch(r){console.error(r)}}function FD(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var cw=(()=>{let e=class e{constructor(n,i){this._mediaMatcher=n,this._zone=i,this._queries=new Map,this._destroySubject=new li}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return ow(Kp(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=ow(Kp(n)).map(o=>this._registerQuery(o).observable),a=zc(s);return a=gh(a.pipe(hs(1)),a.pipe(i1(1),e1(0))),a.pipe(et(o=>{let c={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:h})=>{c.matches=c.matches||l,c.breakpoints[h]=l}),c}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let i=this._mediaMatcher.matchMedia(n),a={observable:new Ni(o=>{let c=l=>this._zone.run(()=>o.next(l));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(vh(i),et(({matches:o})=>({query:n,matches:o})),_h(this._destroySubject)),mql:i};return this._queries.set(n,a),a}};e.\u0275fac=function(i){return new(i||e)(je(RD),je(Vt))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ow(t){return t.map(e=>e.split(",")).reduce((e,r)=>e.concat(r)).map(e=>e.trim())}function hw(t){return t.buttons===0||t.detail===0}function fw(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var fa=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(fa||{}),lw="cdk-high-contrast-black-on-white",uw="cdk-high-contrast-white-on-black",Yp="cdk-high-contrast-active",dw=(()=>{let e=class e{constructor(n,i){this._platform=n,this._document=i,this._breakpointSubscription=Ce(cw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return fa.NONE;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let i=this._document.defaultView||window,s=i&&i.getComputedStyle?i.getComputedStyle(n):null,a=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return fa.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return fa.BLACK_ON_WHITE}return fa.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(Yp,lw,uw),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===fa.BLACK_ON_WHITE?n.add(Yp,lw):i===fa.WHITE_ON_BLACK&&n.add(Yp,uw)}}};e.\u0275fac=function(i){return new(i||e)(je(Ml),je(gr))},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Qp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({});let t=e;return t})();function BD(){return!0}var UD=new tt("mat-sanity-checks",{providedIn:"root",factory:BD}),xw=(()=>{let e=class e{constructor(n,i,s){this._sanityChecks=i,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return iw()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(i){return new(i||e)(je(dw),je(UD,8),je(gr))},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({imports:[Qp,Qp]});let t=e;return t})();var Pn=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Pn||{}),Jp=class{constructor(e,r,n,i=!1){this._renderer=e,this.element=r,this.config=n,this._animationForciblyDisabledThroughCss=i,this.state=Pn.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},pw=qp({passive:!0,capture:!0}),Zp=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let r=nw(e);r&&this._events.get(e.type)?.forEach((n,i)=>{(i===r||i.contains(r))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,r,n,i){let s=this._events.get(r);if(s){let a=s.get(n);a?a.add(i):s.set(n,new Set([i]))}else this._events.set(r,new Map([[n,new Set([i])]])),e.runOutsideAngular(()=>{document.addEventListener(r,this._delegateEventHandler,pw)})}removeHandler(e,r,n){let i=this._events.get(e);if(!i)return;let s=i.get(r);s&&(s.delete(n),s.size===0&&i.delete(r),i.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,pw)))}},mw={enterDuration:225,exitDuration:150},jD=800,gw=qp({passive:!0,capture:!0}),vw=["mousedown","touchstart"],_w=["mouseup","mouseleave","touchend","touchcancel"],Ll=class Ll{constructor(e,r,n,i){this._target=e,this._ngZone=r,this._platform=i,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=Xp(n))}fadeInRipple(e,r,n={}){let i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=be(be({},mw),n.animation);n.centered&&(e=i.left+i.width/2,r=i.top+i.height/2);let a=n.radius||WD(e,r,i),o=e-i.left,c=r-i.top,l=s.enterDuration,h=document.createElement("div");h.classList.add("mat-ripple-element"),h.style.left=`${o-a}px`,h.style.top=`${c-a}px`,h.style.height=`${a*2}px`,h.style.width=`${a*2}px`,n.color!=null&&(h.style.backgroundColor=n.color),h.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(h);let f=window.getComputedStyle(h),d=f.transitionProperty,p=f.transitionDuration,v=d==="none"||p==="0s"||p==="0s, 0s"||i.width===0&&i.height===0,m=new Jp(this,h,n,v);h.style.transform="scale3d(1, 1, 1)",m.state=Pn.FADING_IN,n.persistent||(this._mostRecentTransientRipple=m);let _=null;return!v&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let b=()=>this._finishRippleTransition(m),S=()=>this._destroyRipple(m);h.addEventListener("transitionend",b),h.addEventListener("transitioncancel",S),_={onTransitionEnd:b,onTransitionCancel:S}}),this._activeRipples.set(m,_),(v||!l)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(e.state===Pn.FADING_OUT||e.state===Pn.HIDDEN)return;let r=e.element,n=be(be({},mw),e.config.animation);r.style.transitionDuration=`${n.exitDuration}ms`,r.style.opacity="0",e.state=Pn.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let r=Xp(e);!this._platform.isBrowser||!r||r===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=r,vw.forEach(n=>{Ll._eventManager.addHandler(this._ngZone,n,r,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{_w.forEach(r=>{this._triggerElement.addEventListener(r,this,gw)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Pn.FADING_IN?this._startFadeOutTransition(e):e.state===Pn.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let r=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Pn.VISIBLE,!n&&(!r||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let r=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Pn.HIDDEN,r!==null&&(e.element.removeEventListener("transitionend",r.onTransitionEnd),e.element.removeEventListener("transitioncancel",r.onTransitionCancel)),e.element.remove()}_onMousedown(e){let r=hw(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+jD;!this._target.rippleDisabled&&!r&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!fw(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let r=e.changedTouches;if(r)for(let n=0;n<r.length;n++)this.fadeInRipple(r[n].clientX,r[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let r=e.state===Pn.VISIBLE||e.config.terminateOnPointerUp&&e.state===Pn.FADING_IN;!e.config.persistent&&r&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(vw.forEach(r=>Ll._eventManager.removeHandler(r,e,this)),this._pointerUpEventsRegistered&&(_w.forEach(r=>e.removeEventListener(r,this,gw)),this._pointerUpEventsRegistered=!1))}};Ll._eventManager=new Zp;var yw=Ll;function WD(t,e,r){let n=Math.max(Math.abs(t-r.left),Math.abs(t-r.right)),i=Math.max(Math.abs(e-r.top),Math.abs(e-r.bottom));return Math.sqrt(n*n+i*i)}var ww=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Xt({type:e}),e.\u0275inj=Kt({imports:[xw,tw,rw]});let t=e;return t})();var Ql={};Ql.version="0.18.5";var xi=1200,Wo=1252,$D=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Am={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Sm=function(t){$D.indexOf(t)!=-1&&(Wo=Am[0]=t)};function HD(){Sm(1252)}var Jn=function(t){xi=t,Sm(t)};function Cm(){Jn(1200),HD()}function pm(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function zD(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function DE(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Ul=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?zD(t.slice(2)):e==254&&r==255?DE(t.slice(2)):e==65279?t.slice(1):t},df=function(e){return String.fromCharCode(e)},Ew=function(e){return String.fromCharCode(e)},pt;var zt=null,Vl=!0,Ts="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Jl(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),s=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,i=t.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Ts.charAt(s)+Ts.charAt(a)+Ts.charAt(o)+Ts.charAt(c);return e}function xn(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)s=Ts.indexOf(t.charAt(l++)),a=Ts.indexOf(t.charAt(l++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ts.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Ts.indexOf(t.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var Ye=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Gi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Is(t){return Ye?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Tw(t){return Ye?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var _n=function(e){return Ye?Gi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Lf(t){if(typeof ArrayBuffer>"u")return _n(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function ks(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function GD(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function km(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return km(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var yr=Ye?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Gi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function qD(t){for(var e=[],r=0,n=t.length+250,i=Is(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Is(65535),n=65530)}return e.push(i.slice(0,r)),yr(e)}var Br=/\u0000/g,jl=/[\u0001-\u0006]/g;function Vo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function Zn(t,e){var r=""+t;return r.length>=e?r:$t("0",e-r.length)+r}function Dm(t,e){var r=""+t;return r.length>=e?r:$t(" ",e-r.length)+r}function bf(t,e){var r=""+t;return r.length>=e?r:r+$t(" ",e-r.length)}function KD(t,e){var r=""+Math.round(t);return r.length>=e?r:$t("0",e-r.length)+r}function XD(t,e){var r=""+t;return r.length>=e?r:$t("0",e-r.length)+r}var bw=Math.pow(2,32);function Po(t,e){if(t>bw||t<-bw)return KD(t,e);var r=Math.round(t);return XD(r,e)}function If(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Iw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],em=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function YD(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Pe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Aw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},QD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Af(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,l=0,h=0,f=Math.floor(i);l<e&&(f=Math.floor(i),o=f*a+s,h=f*l+c,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,c=l,l=h;if(h>e&&(l>e?(h=c,o=s):(h=l,o=a)),!r)return[0,n*o,h];var d=Math.floor(n*o/h);return[d,n*o-d*h,h]}function pa(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=nR(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var RE=new Date(1899,11,31,0,0,0),JD=RE.getTime(),ZD=new Date(1900,2,1,0,0,0);function PE(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=ZD&&(r+=24*60*60*1e3),(r-(JD+(t.getTimezoneOffset()-RE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Rm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function eR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tR(t){var e=t<0?12:11,r=Rm(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function rR(t){var e=Rm(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function Zl(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=tR(t):e===10?r=t.toFixed(10).substr(0,12):r=rR(t),Rm(eR(r.toUpperCase()))}function ya(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Zl(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Un(14,PE(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function nR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function iR(t,e,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return em[r.m-1][1];case 5:return em[r.m-1][0];default:return em[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return Iw[r.q][0];default:return Iw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?Zn(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=Zn(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?Zn(c,l):"";return h}function bs(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var FE=/%/g;function sR(t,e,r){var n=e.replace(FE,""),i=e.length-n.length;return Wi(t,n,r*Math.pow(10,2*i))+$t("%",i)}function aR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function OE(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+OE(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var NE=/# (\?+)( ?)\/( ?)(\d+)/;function oR(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?$t(" ",t[1].length+1+t[4].length):Dm(a,t[1].length)+t[2]+"/"+t[3]+Zn(o,t[4].length))}function cR(t,e,r){return r+(e===0?"":""+e)+$t(" ",t[1].length+2+t[4].length)}var ME=/^#*0*\.([0#]+)/,LE=/\).*[0#]/,VE=/\(###\) ###\\?-####/;function Qr(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Sw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Cw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function lR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function uR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function On(t,e,r){if(t.charCodeAt(0)===40&&!e.match(LE)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?On("n",n,r):"("+On("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return aR(t,e,r);if(e.indexOf("%")!==-1)return sR(t,e,r);if(e.indexOf("E")!==-1)return OE(e,r);if(e.charCodeAt(0)===36)return"$"+On(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Po(c,e.length);if(e.match(/^[#?]+$/))return i=Po(r,0),i==="0"&&(i=""),i.length>e.length?i:Qr(e.substr(0,e.length-i.length))+i;if(s=e.match(NE))return oR(s,c,l);if(e.match(/^#+0+$/))return l+Po(c,e.length-e.indexOf("0"));if(s=e.match(ME))return i=Sw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Qr(s[1])).replace(/\.$/,"."+Qr(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+$t("0",Qr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+Sw(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+bs(Po(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+On(t,e,-r):bs(""+(Math.floor(r)+lR(r,s[1].length)))+"."+Zn(Cw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return On(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Vo(On(t,e.replace(/[\\-]/g,""),r)),a=0,Vo(Vo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(VE))return i=On(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Af(c,Math.pow(10,a)-1,!1),i=""+l,h=Wi("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=bf(o[2],a),h.length<s[4].length&&(h=Qr(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Af(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Dm(o[1],a)+s[2]+"/"+s[3]+bf(o[2],a):$t(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Po(r,0),e.length<=i.length?i:Qr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return Qr(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Cw(r,s[1].length),r<0?"-"+On(t,e,-r):bs(uR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Zn(0,3-v.length):"")+v})+"."+Zn(a,s[1].length);switch(e){case"###,##0.00":return On(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=bs(Po(c,0));return p!=="0"?l+p:"";case"###,###.00":return On(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return On(t,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function hR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return Wi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function fR(t,e,r){var n=e.replace(FE,""),i=e.length-n.length;return Wi(t,n,r*Math.pow(10,2*i))+$t("%",i)}function BE(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+BE(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function vi(t,e,r){if(t.charCodeAt(0)===40&&!e.match(LE)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vi("n",n,r):"("+vi("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return hR(t,e,r);if(e.indexOf("%")!==-1)return fR(t,e,r);if(e.indexOf("E")!==-1)return BE(e,r);if(e.charCodeAt(0)===36)return"$"+vi(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Zn(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:Qr(e.substr(0,e.length-i.length))+i;if(s=e.match(NE))return cR(s,c,l);if(e.match(/^#+0+$/))return l+Zn(c,e.length-e.indexOf("0"));if(s=e.match(ME))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Qr(s[1])).replace(/\.$/,"."+Qr(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+$t("0",Qr(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+bs(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vi(t,e,-r):bs(""+r)+"."+$t("0",s[1].length);if(s=e.match(/^#,#*,#0/))return vi(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Vo(vi(t,e.replace(/[\\-]/g,""),r)),a=0,Vo(Vo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(VE))return i=vi(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Af(c,Math.pow(10,a)-1,!1),i=""+l,h=Wi("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=bf(o[2],a),h.length<s[4].length&&(h=Qr(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Af(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Dm(o[1],a)+s[2]+"/"+s[3]+bf(o[2],a):$t(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:Qr(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return Qr(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+vi(t,e,-r):bs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Zn(0,3-v.length):"")+v})+"."+Zn(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=bs(""+c);return p!=="0"?l+p:"";default:if(e.match(/\.[0#?]*$/))return vi(t,e.slice(0,e.lastIndexOf(".")),r)+Qr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Wi(t,e,r){return(r|0)===r?vi(t,e,r):On(t,e,r)}function dR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var UE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Go(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":If(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(UE))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function pR(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",l,h,f,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!If(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=pa(e,r,t.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=pa(e,r),l==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var m={t:o,v:o};if(l==null&&(l=pa(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(m.v=l.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(m.v=l.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(m.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),m.t="T",a+=5,d="h"):(m.t="t",++a),l==null&&m.t==="T")return"";i[i.length]=m,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(UE)){if(l==null&&(l=pa(e,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Go(t)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,b=0,S;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",_<1&&(_=1);break;case"s":(S=i[a].v.match(/\.0+$/))&&(b=Math.max(b,S[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var T="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=iR(i[a].t.charCodeAt(0),i[a].v,l,b),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;T+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=ya(e,r);break}var M="",B,x;if(T.length>0){T.charCodeAt(0)==40?(B=e<0&&T.charCodeAt(0)===45?-e:e,x=Wi("n",T,B)):(B=e<0&&n>1?-e:e,x=Wi("n",T,B),B<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),N=x.length-1;var w=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){w=a;break}var E=i.length;if(w===i.length&&x.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=x.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=x.substr(0,N+1),N=-1),i[a].t="t",E=a);N>=0&&E<i.length&&(i[E].v=x.substr(0,N+1)+i[E].v)}else if(w!==i.length&&x.indexOf("E")===-1){for(N=x.indexOf(".")-1,a=w;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")-1:i[a].v.length-1,M=i[a].v.substr(h+1);h>=0;--h)N>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(M=x.charAt(N--)+M);i[a].v=M,i[a].t="t",E=a}for(N>=0&&E<i.length&&(i[E].v=x.substr(0,N+1)+i[E].v),N=x.indexOf(".")+1,a=w;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==w)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")+1:0,M=i[a].v.substr(0,h);h<i[a].v.length;++h)N<x.length&&(M+=x.charAt(N++));i[a].v=M,i[a].t="t",E=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=Wi(i[a].t,i[a].v,B),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var kw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Dw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function mR(t,e){var r=dR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(kw),o=r[1].match(kw);return Dw(e,a)?[n,r[0]]:Dw(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Un(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Pe)[t],n==null&&(n=r.table&&r.table[Aw[t]]||Pe[Aw[t]]),n==null&&(n=QD[t]||"General");break}if(If(n,0))return ya(e,r);e instanceof Date&&(e=PE(e,r.date1904));var i=mR(n,e);if(If(i[1]))return ya(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return pR(i[1],e,r,i[0])}function $i(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Pe[r]==null){e<0&&(e=r);continue}if(Pe[r]==t){e=r;break}}e<0&&(e=391)}return Pe[e]=t,e}function Vf(t){for(var e=0;e!=392;++e)t[e]!==void 0&&$i(t[e],e)}function qo(){Pe=YD()}var gR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vR(t){var e=typeof t=="number"?Pe[t]:t;return e=e.replace(jE,"(\\d+)"),new RegExp("^"+e+"$")}function _R(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(jE)||[]).forEach(function(f,d){var p=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:i=p;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?h:l+"T"+h}var yR=function(){var t={};t.version="1.2.0";function e(){for(var x=0,w=new Array(256),E=0;E!=256;++E)x=E,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,w[E]=x;return typeof Int32Array<"u"?new Int32Array(w):w}var r=e();function n(x){var w=0,E=0,C=0,k=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)k[C]=x[C];for(C=0;C!=256;++C)for(E=x[C],w=256+C;w<4096;w+=256)E=k[w]=E>>>8^x[E&255];var A=[];for(C=1;C!=16;++C)A[C-1]=typeof Int32Array<"u"?k.subarray(C*256,C*256+256):k.slice(C*256,C*256+256);return A}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],h=i[5],f=i[6],d=i[7],p=i[8],v=i[9],m=i[10],_=i[11],b=i[12],S=i[13],T=i[14];function N(x,w){for(var E=w^-1,C=0,k=x.length;C<k;)E=E>>>8^r[(E^x.charCodeAt(C++))&255];return~E}function M(x,w){for(var E=w^-1,C=x.length-15,k=0;k<C;)E=T[x[k++]^E&255]^S[x[k++]^E>>8&255]^b[x[k++]^E>>16&255]^_[x[k++]^E>>>24]^m[x[k++]]^v[x[k++]]^p[x[k++]]^d[x[k++]]^f[x[k++]]^h[x[k++]]^l[x[k++]]^c[x[k++]]^o[x[k++]]^a[x[k++]]^s[x[k++]]^r[x[k++]];for(C+=15;k<C;)E=E>>>8^r[(E^x[k++])&255];return~E}function B(x,w){for(var E=w^-1,C=0,k=x.length,A=0,R=0;C<k;)A=x.charCodeAt(C++),A<128?E=E>>>8^r[(E^A)&255]:A<2048?(E=E>>>8^r[(E^(192|A>>6&31))&255],E=E>>>8^r[(E^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,R=x.charCodeAt(C++)&1023,E=E>>>8^r[(E^(240|A>>8&7))&255],E=E>>>8^r[(E^(128|A>>2&63))&255],E=E>>>8^r[(E^(128|R>>6&15|(A&3)<<4))&255],E=E>>>8^r[(E^(128|R&63))&255]):(E=E>>>8^r[(E^(224|A>>12&15))&255],E=E>>>8^r[(E^(128|A>>6&63))&255],E=E>>>8^r[(E^(128|A&63))&255]);return~E}return t.table=r,t.bstr=N,t.buf=M,t.str=B,t}(),ke=function(){var e={};e.version="1.2.1";function r(I,O){for(var P=I.split("/"),F=O.split("/"),L=0,V=0,K=Math.min(P.length,F.length);L<K;++L){if(V=P[L].length-F[L].length)return V;if(P[L]!=F[L])return P[L]<F[L]?-1:1}return P.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var O=I.lastIndexOf("/");return O===-1?I:I.slice(0,O+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var O=I.lastIndexOf("/");return O===-1?I:I.slice(O+1)}function s(I,O){typeof O=="string"&&(O=new Date(O));var P=O.getHours();P=P<<6|O.getMinutes(),P=P<<5|O.getSeconds()>>>1,I.write_shift(2,P);var F=O.getFullYear()-1980;F=F<<4|O.getMonth()+1,F=F<<5|O.getDate(),I.write_shift(2,F)}function a(I){var O=I.read_shift(2)&65535,P=I.read_shift(2)&65535,F=new Date,L=P&31;P>>>=5;var V=P&15;P>>>=4,F.setMilliseconds(0),F.setFullYear(P+1980),F.setMonth(V-1),F.setDate(L);var K=O&31;O>>>=5;var J=O&63;return O>>>=6,F.setHours(O),F.setMinutes(J),F.setSeconds(K<<1),F}function o(I){Dr(I,0);for(var O={},P=0;I.l<=I.length-4;){var F=I.read_shift(2),L=I.read_shift(2),V=I.l+L,K={};switch(F){case 21589:P=I.read_shift(1),P&1&&(K.mtime=I.read_shift(4)),L>5&&(P&2&&(K.atime=I.read_shift(4)),P&4&&(K.ctime=I.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}I.l=V,O[F]=K}return O}var c;function l(){return c||(c={})}function h(I,O){if(I[0]==80&&I[1]==75)return Oc(I,O);if((I[0]|32)==109&&(I[1]|32)==105)return qs(I,O);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var P=3,F=512,L=0,V=0,K=0,J=0,q=0,X=[],Y=I.slice(0,512);Dr(Y,0);var ae=f(Y);switch(P=ae[0],P){case 3:F=512;break;case 4:F=4096;break;case 0:if(ae[1]==0)return Oc(I,O);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}F!==512&&(Y=I.slice(0,F),Dr(Y,28));var fe=I.slice(0,F);d(Y,P);var Ae=Y.read_shift(4,"i");if(P===3&&Ae!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ae);Y.l+=4,K=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),J=Y.read_shift(4,"i"),L=Y.read_shift(4,"i"),q=Y.read_shift(4,"i"),V=Y.read_shift(4,"i");for(var pe=-1,xe=0;xe<109&&(pe=Y.read_shift(4,"i"),!(pe<0));++xe)X[xe]=pe;var Oe=p(I,F);_(q,V,Oe,F,X);var yt=S(Oe,K,X,F);yt[K].name="!Directory",L>0&&J!==R&&(yt[J].name="!MiniFAT"),yt[X[0]].name="!FAT",yt.fat_addrs=X,yt.ssz=F;var pr={},Tt=[],qt=[],Pi=[];T(K,yt,Oe,Tt,L,pr,qt,J),v(qt,Pi,Tt),Tt.shift();var Ys={FileIndex:qt,FullPaths:Pi};return O&&O.raw&&(Ys.raw={header:fe,sectors:Oe}),Ys}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(oe,"Header Signature: "),I.l+=16;var O=I.read_shift(2,"u");return[I.read_shift(2,"u"),O]}function d(I,O){var P=9;switch(I.l+=2,P=I.read_shift(2)){case 9:if(O!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(O!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,O){for(var P=Math.ceil(I.length/O)-1,F=[],L=1;L<P;++L)F[L-1]=I.slice(L*O,(L+1)*O);return F[P-1]=I.slice(P*O),F}function v(I,O,P){for(var F=0,L=0,V=0,K=0,J=0,q=P.length,X=[],Y=[];F<q;++F)X[F]=Y[F]=F,O[F]=P[F];for(;J<Y.length;++J)F=Y[J],L=I[F].L,V=I[F].R,K=I[F].C,X[F]===F&&(L!==-1&&X[L]!==L&&(X[F]=X[L]),V!==-1&&X[V]!==V&&(X[F]=X[V])),K!==-1&&(X[K]=F),L!==-1&&F!=X[F]&&(X[L]=X[F],Y.lastIndexOf(L)<J&&Y.push(L)),V!==-1&&F!=X[F]&&(X[V]=X[F],Y.lastIndexOf(V)<J&&Y.push(V));for(F=1;F<q;++F)X[F]===F&&(V!==-1&&X[V]!==V?X[F]=X[V]:L!==-1&&X[L]!==L&&(X[F]=X[L]));for(F=1;F<q;++F)if(I[F].type!==0){if(J=F,J!=X[J])do J=X[J],O[F]=O[J]+"/"+O[F];while(J!==0&&X[J]!==-1&&J!=X[J]);X[F]=-1}for(O[0]+="/",F=1;F<q;++F)I[F].type!==2&&(O[F]+="/")}function m(I,O,P){for(var F=I.start,L=I.size,V=[],K=F;P&&L>0&&K>=0;)V.push(O.slice(K*A,K*A+A)),L-=A,K=da(P,K*4);return V.length===0?ee(0):yr(V).slice(0,I.size)}function _(I,O,P,F,L){var V=R;if(I===R){if(O!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var K=P[I],J=(F>>>2)-1;if(!K)return;for(var q=0;q<J&&(V=da(K,q*4))!==R;++q)L.push(V);_(da(K,F-4),O-1,P,F,L)}}function b(I,O,P,F,L){var V=[],K=[];L||(L=[]);var J=F-1,q=0,X=0;for(q=O;q>=0;){L[q]=!0,V[V.length]=q,K.push(I[q]);var Y=P[Math.floor(q*4/F)];if(X=q*4&J,F<4+X)throw new Error("FAT boundary crossed: "+q+" 4 "+F);if(!I[Y])break;q=da(I[Y],X)}return{nodes:V,data:Ww([K])}}function S(I,O,P,F){var L=I.length,V=[],K=[],J=[],q=[],X=F-1,Y=0,ae=0,fe=0,Ae=0;for(Y=0;Y<L;++Y)if(J=[],fe=Y+O,fe>=L&&(fe-=L),!K[fe]){q=[];var pe=[];for(ae=fe;ae>=0;){pe[ae]=!0,K[ae]=!0,J[J.length]=ae,q.push(I[ae]);var xe=P[Math.floor(ae*4/F)];if(Ae=ae*4&X,F<4+Ae)throw new Error("FAT boundary crossed: "+ae+" 4 "+F);if(!I[xe]||(ae=da(I[xe],Ae),pe[ae]))break}V[fe]={nodes:J,data:Ww([q])}}return V}function T(I,O,P,F,L,V,K,J){for(var q=0,X=F.length?2:0,Y=O[I].data,ae=0,fe=0,Ae;ae<Y.length;ae+=128){var pe=Y.slice(ae,ae+128);Dr(pe,64),fe=pe.read_shift(2),Ae=Wf(pe,0,fe-X),F.push(Ae);var xe={name:Ae,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},Oe=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Oe!==0&&(xe.ct=N(pe,pe.l-8));var yt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);yt!==0&&(xe.mt=N(pe,pe.l-8)),xe.start=pe.read_shift(4,"i"),xe.size=pe.read_shift(4,"i"),xe.size<0&&xe.start<0&&(xe.size=xe.type=0,xe.start=R,xe.name=""),xe.type===5?(q=xe.start,L>0&&q!==R&&(O[q].name="!StreamData")):xe.size>=4096?(xe.storage="fat",O[xe.start]===void 0&&(O[xe.start]=b(P,xe.start,O.fat_addrs,O.ssz)),O[xe.start].name=xe.name,xe.content=O[xe.start].data.slice(0,xe.size)):(xe.storage="minifat",xe.size<0?xe.size=0:q!==R&&xe.start!==R&&O[q]&&(xe.content=m(xe,O[q].data,(O[J]||{}).data))),xe.content&&Dr(xe.content,0),V[Ae]=xe,K.push(xe)}}function N(I,O){return new Date((_r(I,O+4)/1e7*Math.pow(2,32)+_r(I,O)/1e7-11644473600)*1e3)}function M(I,O){return l(),h(c.readFileSync(I),O)}function B(I,O){var P=O&&O.type;switch(P||Ye&&Buffer.isBuffer(I)&&(P="buffer"),P||"base64"){case"file":return M(I,O);case"base64":return h(_n(xn(I)),O);case"binary":return h(_n(I),O)}return h(I,O)}function x(I,O){var P=O||{},F=P.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),P.CLSID&&(I.FileIndex[0].clsid=P.CLSID),w(I)}function w(I){var O="Sh33tJ5";if(!ke.find(I,"/"+O)){var P=ee(4);P[0]=55,P[1]=P[3]=50,P[2]=54,I.FileIndex.push({name:O,type:2,content:P,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+O),E(I)}}function E(I,O){x(I);for(var P=!1,F=!1,L=I.FullPaths.length-1;L>=0;--L){var V=I.FileIndex[L];switch(V.type){case 0:F?P=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(V.R*V.L*V.C)&&(P=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!O)){var K=new Date(1987,1,19),J=0,q=Object.create?Object.create(null):{},X=[];for(L=0;L<I.FullPaths.length;++L)q[I.FullPaths[L]]=!0,I.FileIndex[L].type!==0&&X.push([I.FullPaths[L],I.FileIndex[L]]);for(L=0;L<X.length;++L){var Y=n(X[L][0]);F=q[Y],F||(X.push([Y,{name:i(Y).replace("/",""),type:1,clsid:Se,ct:K,mt:K,content:null}]),q[Y]=!0)}for(X.sort(function(Ae,pe){return r(Ae[0],pe[0])}),I.FullPaths=[],I.FileIndex=[],L=0;L<X.length;++L)I.FullPaths[L]=X[L][0],I.FileIndex[L]=X[L][1];for(L=0;L<X.length;++L){var ae=I.FileIndex[L],fe=I.FullPaths[L];if(ae.name=i(fe).replace("/",""),ae.L=ae.R=ae.C=-(ae.color=1),ae.size=ae.content?ae.content.length:0,ae.start=0,ae.clsid=ae.clsid||Se,L===0)ae.C=X.length>1?1:-1,ae.size=0,ae.type=5;else if(fe.slice(-1)=="/"){for(J=L+1;J<X.length&&n(I.FullPaths[J])!=fe;++J);for(ae.C=J>=X.length?-1:J,J=L+1;J<X.length&&n(I.FullPaths[J])!=n(fe);++J);ae.R=J>=X.length?-1:J,ae.type=1}else n(I.FullPaths[L+1]||"")==n(fe)&&(ae.R=L+1),ae.type=2}}}function C(I,O){var P=O||{};if(P.fileType=="mad")return sh(I,P);switch(E(I),P.fileType){case"zip":return Gs(I,P)}var F=function(Ae){for(var pe=0,xe=0,Oe=0;Oe<Ae.FileIndex.length;++Oe){var yt=Ae.FileIndex[Oe];if(yt.content){var pr=yt.content.length;pr>0&&(pr<4096?pe+=pr+63>>6:xe+=pr+511>>9)}}for(var Tt=Ae.FullPaths.length+3>>2,qt=pe+7>>3,Pi=pe+127>>7,Ys=qt+xe+Tt+Pi,ci=Ys+127>>7,io=ci<=109?0:Math.ceil((ci-109)/127);Ys+ci+io+127>>7>ci;)io=++ci<=109?0:Math.ceil((ci-109)/127);var Sn=[1,io,ci,Pi,Tt,xe,pe,0];return Ae.FileIndex[0].size=pe<<6,Sn[7]=(Ae.FileIndex[0].start=Sn[0]+Sn[1]+Sn[2]+Sn[3]+Sn[4]+Sn[5])+(Sn[6]+7>>3),Sn}(I),L=ee(F[7]<<9),V=0,K=0;{for(V=0;V<8;++V)L.write_shift(1,se[V]);for(V=0;V<8;++V)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),V=0;V<3;++V)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:R),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:R),L.write_shift(4,F[1]),V=0;V<109;++V)L.write_shift(-4,V<F[2]?F[1]+V:-1)}if(F[1])for(K=0;K<F[1];++K){for(;V<236+K*127;++V)L.write_shift(-4,V<F[2]?F[1]+V:-1);L.write_shift(-4,K===F[1]-1?R:K+1)}var J=function(Ae){for(K+=Ae;V<K-1;++V)L.write_shift(-4,V+1);Ae&&(++V,L.write_shift(-4,R))};for(K=V=0,K+=F[1];V<K;++V)L.write_shift(-4,_e.DIFSECT);for(K+=F[2];V<K;++V)L.write_shift(-4,_e.FATSECT);J(F[3]),J(F[4]);for(var q=0,X=0,Y=I.FileIndex[0];q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=K,J(X+511>>9)));for(J(F[6]+7>>3);L.l&511;)L.write_shift(-4,_e.ENDOFCHAIN);for(K=V=0,q=0;q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=K,J(X+63>>6)));for(;L.l&511;)L.write_shift(-4,_e.ENDOFCHAIN);for(V=0;V<F[4]<<2;++V){var ae=I.FullPaths[V];if(!ae||ae.length===0){for(q=0;q<17;++q)L.write_shift(4,0);for(q=0;q<3;++q)L.write_shift(4,-1);for(q=0;q<12;++q)L.write_shift(4,0);continue}Y=I.FileIndex[V],V===0&&(Y.start=Y.size?Y.start-1:R);var fe=V===0&&P.root||Y.name;if(X=2*(fe.length+1),L.write_shift(64,fe,"utf16le"),L.write_shift(2,X),L.write_shift(1,Y.type),L.write_shift(1,Y.color),L.write_shift(-4,Y.L),L.write_shift(-4,Y.R),L.write_shift(-4,Y.C),Y.clsid)L.write_shift(16,Y.clsid,"hex");else for(q=0;q<4;++q)L.write_shift(4,0);L.write_shift(4,Y.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Y.start),L.write_shift(4,Y.size),L.write_shift(4,0)}for(V=1;V<I.FileIndex.length;++V)if(Y=I.FileIndex[V],Y.size>=4096)if(L.l=Y.start+1<<9,Ye&&Buffer.isBuffer(Y.content))Y.content.copy(L,L.l,0,Y.size),L.l+=Y.size+511&-512;else{for(q=0;q<Y.size;++q)L.write_shift(1,Y.content[q]);for(;q&511;++q)L.write_shift(1,0)}for(V=1;V<I.FileIndex.length;++V)if(Y=I.FileIndex[V],Y.size>0&&Y.size<4096)if(Ye&&Buffer.isBuffer(Y.content))Y.content.copy(L,L.l,0,Y.size),L.l+=Y.size+63&-64;else{for(q=0;q<Y.size;++q)L.write_shift(1,Y.content[q]);for(;q&63;++q)L.write_shift(1,0)}if(Ye)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function k(I,O){var P=I.FullPaths.map(function(q){return q.toUpperCase()}),F=P.map(function(q){var X=q.split("/");return X[X.length-(q.slice(-1)=="/"?2:1)]}),L=!1;O.charCodeAt(0)===47?(L=!0,O=P[0].slice(0,-1)+O):L=O.indexOf("/")!==-1;var V=O.toUpperCase(),K=L===!0?P.indexOf(V):F.indexOf(V);if(K!==-1)return I.FileIndex[K];var J=!V.match(jl);for(V=V.replace(Br,""),J&&(V=V.replace(jl,"!")),K=0;K<P.length;++K)if((J?P[K].replace(jl,"!"):P[K]).replace(Br,"")==V||(J?F[K].replace(jl,"!"):F[K]).replace(Br,"")==V)return I.FileIndex[K];return null}var A=64,R=-2,oe="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],Se="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Se,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Re(I,O,P){l();var F=C(I,P);c.writeFileSync(O,F)}function he(I){for(var O=new Array(I.length),P=0;P<I.length;++P)O[P]=String.fromCharCode(I[P]);return O.join("")}function Ie(I,O){var P=C(I,O);switch(O&&O.type||"buffer"){case"file":return l(),c.writeFileSync(O.filename,P),P;case"binary":return typeof P=="string"?P:he(P);case"base64":return Jl(typeof P=="string"?P:he(P));case"buffer":if(Ye)return Buffer.isBuffer(P)?P:Gi(P);case"array":return typeof P=="string"?_n(P):P}return P}var re;function j(I){try{var O=I.InflateRaw,P=new O;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)re=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function G(I,O){if(!re)return th(I,O);var P=re.InflateRaw,F=new P,L=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,L}function H(I){return re?re.deflateRawSync(I):ze(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ce(I){var O=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(O>>16|O>>8|O)&255}for(var ue=typeof Uint8Array<"u",ne=ue?new Uint8Array(256):[],Be=0;Be<256;++Be)ne[Be]=ce(Be);function U(I,O){var P=ne[I&255];return O<=8?P>>>8-O:(P=P<<8|ne[I>>8&255],O<=16?P>>>16-O:(P=P<<8|ne[I>>16&255],P>>>24-O))}function nt(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=6?0:I[F+1]<<8))>>>P&3}function He(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=5?0:I[F+1]<<8))>>>P&7}function it(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=4?0:I[F+1]<<8))>>>P&15}function Xe(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=3?0:I[F+1]<<8))>>>P&31}function Ee(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=1?0:I[F+1]<<8))>>>P&127}function Lt(I,O,P){var F=O&7,L=O>>>3,V=(1<<P)-1,K=I[L]>>>F;return P<8-F||(K|=I[L+1]<<8-F,P<16-F)||(K|=I[L+2]<<16-F,P<24-F)||(K|=I[L+3]<<24-F),K&V}function Kr(I,O,P){var F=O&7,L=O>>>3;return F<=5?I[L]|=(P&7)<<F:(I[L]|=P<<F&255,I[L+1]=(P&7)>>8-F),O+3}function cn(I,O,P){var F=O&7,L=O>>>3;return P=(P&1)<<F,I[L]|=P,O+1}function ln(I,O,P){var F=O&7,L=O>>>3;return P<<=F,I[L]|=P&255,P>>>=8,I[L+1]=P,O+8}function ss(I,O,P){var F=O&7,L=O>>>3;return P<<=F,I[L]|=P&255,P>>>=8,I[L+1]=P&255,I[L+2]=P>>>8,O+16}function ai(I,O){var P=I.length,F=2*P>O?2*P:O+5,L=0;if(P>=O)return I;if(Ye){var V=Tw(F);if(I.copy)I.copy(V);else for(;L<I.length;++L)V[L]=I[L];return V}else if(ue){var K=new Uint8Array(F);if(K.set)K.set(I);else for(;L<P;++L)K[L]=I[L];return K}return I.length=F,I}function br(I){for(var O=new Array(I),P=0;P<I;++P)O[P]=0;return O}function un(I,O,P){var F=1,L=0,V=0,K=0,J=0,q=I.length,X=ue?new Uint16Array(32):br(32);for(V=0;V<32;++V)X[V]=0;for(V=q;V<P;++V)I[V]=0;q=I.length;var Y=ue?new Uint16Array(q):br(q);for(V=0;V<q;++V)X[L=I[V]]++,F<L&&(F=L),Y[V]=0;for(X[0]=0,V=1;V<=F;++V)X[V+16]=J=J+X[V-1]<<1;for(V=0;V<q;++V)J=I[V],J!=0&&(Y[V]=X[J+16]++);var ae=0;for(V=0;V<q;++V)if(ae=I[V],ae!=0)for(J=U(Y[V],F)>>F-ae,K=(1<<F+4-ae)-1;K>=0;--K)O[J|K<<ae]=ae&15|V<<4;return F}var An=ue?new Uint16Array(512):br(512),jt=ue?new Uint16Array(32):br(32);if(!ue){for(var lt=0;lt<512;++lt)An[lt]=0;for(lt=0;lt<32;++lt)jt[lt]=0}(function(){for(var I=[],O=0;O<32;O++)I.push(5);un(I,jt,32);var P=[];for(O=0;O<=143;O++)P.push(8);for(;O<=255;O++)P.push(9);for(;O<=279;O++)P.push(7);for(;O<=287;O++)P.push(8);un(P,An,288)})();var Xr=function(){for(var O=ue?new Uint8Array(32768):[],P=0,F=0;P<de.length-1;++P)for(;F<de[P+1];++F)O[F]=P;for(;F<32768;++F)O[F]=29;var L=ue?new Uint8Array(259):[];for(P=0,F=0;P<te.length-1;++P)for(;F<te[P+1];++F)L[F]=P;function V(J,q){for(var X=0;X<J.length;){var Y=Math.min(65535,J.length-X),ae=X+Y==J.length;for(q.write_shift(1,+ae),q.write_shift(2,Y),q.write_shift(2,~Y&65535);Y-- >0;)q[q.l++]=J[X++]}return q.l}function K(J,q){for(var X=0,Y=0,ae=ue?new Uint16Array(32768):[];Y<J.length;){var fe=Math.min(65535,J.length-Y);if(fe<10){for(X=Kr(q,X,+(Y+fe==J.length)),X&7&&(X+=8-(X&7)),q.l=X/8|0,q.write_shift(2,fe),q.write_shift(2,~fe&65535);fe-- >0;)q[q.l++]=J[Y++];X=q.l*8;continue}X=Kr(q,X,+(Y+fe==J.length)+2);for(var Ae=0;fe-- >0;){var pe=J[Y];Ae=(Ae<<5^pe)&32767;var xe=-1,Oe=0;if((xe=ae[Ae])&&(xe|=Y&-32768,xe>Y&&(xe-=32768),xe<Y))for(;J[xe+Oe]==J[Y+Oe]&&Oe<250;)++Oe;if(Oe>2){pe=L[Oe],pe<=22?X=ln(q,X,ne[pe+1]>>1)-1:(ln(q,X,3),X+=5,ln(q,X,ne[pe-23]>>5),X+=3);var yt=pe<8?0:pe-4>>2;yt>0&&(ss(q,X,Oe-te[pe]),X+=yt),pe=O[Y-xe],X=ln(q,X,ne[pe]>>3),X-=3;var pr=pe<4?0:pe-2>>1;pr>0&&(ss(q,X,Y-xe-de[pe]),X+=pr);for(var Tt=0;Tt<Oe;++Tt)ae[Ae]=Y&32767,Ae=(Ae<<5^J[Y])&32767,++Y;fe-=Oe-1}else pe<=143?pe=pe+48:X=cn(q,X,1),X=ln(q,X,ne[pe]),ae[Ae]=Y&32767,++Y}X=ln(q,X,0)-1}return q.l=(X+7)/8|0,q.l}return function(q,X){return q.length<8?V(q,X):K(q,X)}}();function ze(I){var O=ee(50+Math.floor(I.length*1.1)),P=Xr(I,O);return O.slice(0,P)}var Ot=ue?new Uint16Array(32768):br(32768),en=ue?new Uint16Array(32768):br(32768),Ct=ue?new Uint16Array(128):br(128),oi=1,Pc=1;function Fc(I,O){var P=Xe(I,O)+257;O+=5;var F=Xe(I,O)+1;O+=5;var L=it(I,O)+4;O+=4;for(var V=0,K=ue?new Uint8Array(19):br(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,X=ue?new Uint8Array(8):br(8),Y=ue?new Uint8Array(8):br(8),ae=K.length,fe=0;fe<L;++fe)K[W[fe]]=V=He(I,O),q<V&&(q=V),X[V]++,O+=3;var Ae=0;for(X[0]=0,fe=1;fe<=q;++fe)Y[fe]=Ae=Ae+X[fe-1]<<1;for(fe=0;fe<ae;++fe)(Ae=K[fe])!=0&&(J[fe]=Y[Ae]++);var pe=0;for(fe=0;fe<ae;++fe)if(pe=K[fe],pe!=0){Ae=ne[J[fe]]>>8-pe;for(var xe=(1<<7-pe)-1;xe>=0;--xe)Ct[Ae|xe<<pe]=pe&7|fe<<3}var Oe=[];for(q=1;Oe.length<P+F;)switch(Ae=Ct[Ee(I,O)],O+=Ae&7,Ae>>>=3){case 16:for(V=3+nt(I,O),O+=2,Ae=Oe[Oe.length-1];V-- >0;)Oe.push(Ae);break;case 17:for(V=3+He(I,O),O+=3;V-- >0;)Oe.push(0);break;case 18:for(V=11+Ee(I,O),O+=7;V-- >0;)Oe.push(0);break;default:Oe.push(Ae),q<Ae&&(q=Ae);break}var yt=Oe.slice(0,P),pr=Oe.slice(P);for(fe=P;fe<286;++fe)yt[fe]=0;for(fe=F;fe<30;++fe)pr[fe]=0;return oi=un(yt,Ot,286),Pc=un(pr,en,30),O}function s0(I,O){if(I[0]==3&&!(I[1]&3))return[Is(O),2];for(var P=0,F=0,L=Tw(O||1<<18),V=0,K=L.length>>>0,J=0,q=0;!(F&1);){if(F=He(I,P),P+=3,F>>>1)F>>1==1?(J=9,q=5):(P=Fc(I,P),J=oi,q=Pc);else{P&7&&(P+=8-(P&7));var X=I[P>>>3]|I[(P>>>3)+1]<<8;if(P+=32,X>0)for(!O&&K<V+X&&(L=ai(L,V+X),K=L.length);X-- >0;)L[V++]=I[P>>>3],P+=8;continue}for(;;){!O&&K<V+32767&&(L=ai(L,V+32767),K=L.length);var Y=Lt(I,P,J),ae=F>>>1==1?An[Y]:Ot[Y];if(P+=ae&15,ae>>>=4,!(ae>>>8&255))L[V++]=ae;else{if(ae==256)break;ae-=257;var fe=ae<8?0:ae-4>>2;fe>5&&(fe=0);var Ae=V+te[ae];fe>0&&(Ae+=Lt(I,P,fe),P+=fe),Y=Lt(I,P,q),ae=F>>>1==1?jt[Y]:en[Y],P+=ae&15,ae>>>=4;var pe=ae<4?0:ae-2>>1,xe=de[ae];for(pe>0&&(xe+=Lt(I,P,pe),P+=pe),!O&&K<Ae&&(L=ai(L,Ae+100),K=L.length);V<Ae;)L[V]=L[V-xe],++V}}}return O?[L,P+7>>>3]:[L.slice(0,V),P+7>>>3]}function th(I,O){var P=I.slice(I.l||0),F=s0(P,O);return I.l+=F[1],F[0]}function to(I,O){if(I)typeof console<"u"&&console.error(O);else throw new Error(O)}function Oc(I,O){var P=I;Dr(P,0);var F=[],L=[],V={FileIndex:F,FullPaths:L};x(V,{root:O.root});for(var K=P.length-4;(P[K]!=80||P[K+1]!=75||P[K+2]!=5||P[K+3]!=6)&&K>=0;)--K;P.l=K+4,P.l+=4;var J=P.read_shift(2);P.l+=6;var q=P.read_shift(4);for(P.l=q,K=0;K<J;++K){P.l+=20;var X=P.read_shift(4),Y=P.read_shift(4),ae=P.read_shift(2),fe=P.read_shift(2),Ae=P.read_shift(2);P.l+=8;var pe=P.read_shift(4),xe=o(P.slice(P.l+ae,P.l+ae+fe));P.l+=ae+fe+Ae;var Oe=P.l;P.l=pe+4,rh(P,X,Y,V,xe),P.l=Oe}return V}function rh(I,O,P,F,L){I.l+=2;var V=I.read_shift(2),K=I.read_shift(2),J=a(I);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var q=I.read_shift(4),X=I.read_shift(4),Y=I.read_shift(4),ae=I.read_shift(2),fe=I.read_shift(2),Ae="",pe=0;pe<ae;++pe)Ae+=String.fromCharCode(I[I.l++]);if(fe){var xe=o(I.slice(I.l,I.l+fe));(xe[21589]||{}).mt&&(J=xe[21589].mt),((L||{})[21589]||{}).mt&&(J=L[21589].mt)}I.l+=fe;var Oe=I.slice(I.l,I.l+X);switch(K){case 8:Oe=G(I,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var yt=!1;V&8&&(q=I.read_shift(4),q==134695760&&(q=I.read_shift(4),yt=!0),X=I.read_shift(4),Y=I.read_shift(4)),X!=O&&to(yt,"Bad compressed size: "+O+" != "+X),Y!=P&&to(yt,"Bad uncompressed size: "+P+" != "+Y),no(F,Ae,Oe,{unsafe:!0,mt:J})}function Gs(I,O){var P=O||{},F=[],L=[],V=ee(1),K=P.compression?8:0,J=0,q=!1;q&&(J|=8);var X=0,Y=0,ae=0,fe=0,Ae=I.FullPaths[0],pe=Ae,xe=I.FileIndex[0],Oe=[],yt=0;for(X=1;X<I.FullPaths.length;++X)if(pe=I.FullPaths[X].slice(Ae.length),xe=I.FileIndex[X],!(!xe.size||!xe.content||pe=="Sh33tJ5")){var pr=ae,Tt=ee(pe.length);for(Y=0;Y<pe.length;++Y)Tt.write_shift(1,pe.charCodeAt(Y)&127);Tt=Tt.slice(0,Tt.l),Oe[fe]=yR.buf(xe.content,0);var qt=xe.content;K==8&&(qt=H(qt)),V=ee(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,J),V.write_shift(2,K),xe.mt?s(V,xe.mt):V.write_shift(4,0),V.write_shift(-4,J&8?0:Oe[fe]),V.write_shift(4,J&8?0:qt.length),V.write_shift(4,J&8?0:xe.content.length),V.write_shift(2,Tt.length),V.write_shift(2,0),ae+=V.length,F.push(V),ae+=Tt.length,F.push(Tt),ae+=qt.length,F.push(qt),J&8&&(V=ee(12),V.write_shift(-4,Oe[fe]),V.write_shift(4,qt.length),V.write_shift(4,xe.content.length),ae+=V.l,F.push(V)),V=ee(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,J),V.write_shift(2,K),V.write_shift(4,0),V.write_shift(-4,Oe[fe]),V.write_shift(4,qt.length),V.write_shift(4,xe.content.length),V.write_shift(2,Tt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,pr),yt+=V.l,L.push(V),yt+=Tt.length,L.push(Tt),++fe}return V=ee(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,fe),V.write_shift(2,fe),V.write_shift(4,yt),V.write_shift(4,ae),V.write_shift(2,0),yr([yr(F),yr(L),V])}var as={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Nc(I,O){if(I.ctype)return I.ctype;var P=I.name||"",F=P.match(/\.([^\.]+)$/);return F&&as[F[1]]||O&&(F=(P=O).match(/[\.\\]([^\.\\])+$/),F&&as[F[1]])?as[F[1]]:"application/octet-stream"}function Ri(I){for(var O=Jl(I),P=[],F=0;F<O.length;F+=76)P.push(O.slice(F,F+76));return P.join(`\r
`)+`\r
`}function nh(I){var O=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});O=O.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),O.charAt(0)==`
`&&(O="=0D"+O.slice(1)),O=O.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],F=O.split(`\r
`),L=0;L<F.length;++L){var V=F[L];if(V.length==0){P.push("");continue}for(var K=0;K<V.length;){var J=76,q=V.slice(K,K+J);q.charAt(J-1)=="="?J--:q.charAt(J-2)=="="?J-=2:q.charAt(J-3)=="="&&(J-=3),q=V.slice(K,K+J),K+=J,K<V.length&&(q+="="),P.push(q)}}return P.join(`\r
`)}function ro(I){for(var O=[],P=0;P<I.length;++P){for(var F=I[P];P<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++P];O.push(F)}for(var L=0;L<O.length;++L)O[L]=O[L].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return _n(O.join(`\r
`))}function ih(I,O,P){for(var F="",L="",V="",K,J=0;J<10;++J){var q=O[J];if(!q||q.match(/^\s*$/))break;var X=q.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":F=X[2].trim();break;case"content-type":V=X[2].trim();break;case"content-transfer-encoding":L=X[2].trim();break}}switch(++J,L.toLowerCase()){case"base64":K=_n(xn(O.slice(J).join("")));break;case"quoted-printable":K=ro(O.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Y=no(I,F.slice(P.length),K,{unsafe:!0});V&&(Y.ctype=V)}function qs(I,O){if(he(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=O&&O.root||"",F=(Ye&&Buffer.isBuffer(I)?I.toString("binary"):he(I)).split(`\r
`),L=0,V="";for(L=0;L<F.length;++L)if(V=F[L],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),P||(P=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),V.slice(0,P.length)!=P););var K=(F[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var J="--"+(K[1]||""),q=[],X=[],Y={FileIndex:q,FullPaths:X};x(Y);var ae,fe=0;for(L=0;L<F.length;++L){var Ae=F[L];Ae!==J&&Ae!==J+"--"||(fe++&&ih(Y,F.slice(ae,L),P),ae=L)}return Y}function sh(I,O){var P=O||{},F=P.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],V=I.FullPaths[0],K=V,J=I.FileIndex[0],q=1;q<I.FullPaths.length;++q)if(K=I.FullPaths[q].slice(V.length),J=I.FileIndex[q],!(!J.size||!J.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var X=J.content,Y=Ye&&Buffer.isBuffer(X)?X.toString("binary"):he(X),ae=0,fe=Math.min(1024,Y.length),Ae=0,pe=0;pe<=fe;++pe)(Ae=Y.charCodeAt(pe))>=32&&Ae<128&&++ae;var xe=ae>=fe*4/5;L.push(F),L.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+K),L.push("Content-Transfer-Encoding: "+(xe?"quoted-printable":"base64")),L.push("Content-Type: "+Nc(J,K)),L.push(""),L.push(xe?nh(Y):Ri(Y))}return L.push(F+`--\r
`),L.join(`\r
`)}function Ir(I){var O={};return x(O,I),O}function no(I,O,P,F){var L=F&&F.unsafe;L||x(I);var V=!L&&ke.find(I,O);if(!V){var K=I.FullPaths[0];O.slice(0,K.length)==K?K=O:(K.slice(-1)!="/"&&(K+="/"),K=(K+O).replace("//","/")),V={name:i(O),type:2},I.FileIndex.push(V),I.FullPaths.push(K),L||ke.utils.cfb_gc(I)}return V.content=P,V.size=P?P.length:0,F&&(F.CLSID&&(V.clsid=F.CLSID),F.mt&&(V.mt=F.mt),F.ct&&(V.ct=F.ct)),V}function Ks(I,O){x(I);var P=ke.find(I,O);if(P){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==P)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function Xs(I,O,P){x(I);var F=ke.find(I,O);if(F){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==F)return I.FileIndex[L].name=i(P),I.FullPaths[L]=P,!0}return!1}function a0(I){E(I,!0)}return e.find=k,e.read=B,e.parse=h,e.write=Ie,e.writeFile=Re,e.utils={cfb_new:Ir,cfb_add:no,cfb_del:Ks,cfb_mov:Xs,cfb_gc:a0,ReadShift:$l,CheckField:sT,prep_blob:Dr,bconcat:yr,use_zlib:j,_deflateRaw:ze,_inflateRaw:th,consts:_e},e}(),Mo;function xR(t){return typeof t=="string"?Lf(t):Array.isArray(t)?GD(t):t}function hu(t,e,r){if(typeof Mo<"u"&&Mo.writeFileSync)return r?Mo.writeFileSync(t,e,r):Mo.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Lf(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?yi(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([xR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=ks(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function wR(t){if(typeof Mo<"u")return Mo.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Gt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Rw(t,e){for(var r=[],n=Gt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function Bf(t){for(var e=[],r=Gt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Uf(t){for(var e=[],r=Gt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function ER(t){for(var e=[],r=Gt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Sf=new Date(1899,11,30,0,0,0);function hr(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=Sf.getTime()+(t.getTimezoneOffset()-Sf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var WE=new Date,TR=Sf.getTime()+(WE.getTimezoneOffset()-Sf.getTimezoneOffset())*6e4,Pw=WE.getTimezoneOffset();function jf(t){var e=new Date;return e.setTime(t*24*60*60*1e3+TR),e.getTimezoneOffset()!==Pw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Pw)*6e4),e}function bR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}e+=r*parseInt(i[s],10)}return e}var Fw=new Date("2017-02-19T19:06:09.000Z"),$E=isNaN(Fw.getFullYear())?new Date("2/19/17"):Fw,IR=$E.getFullYear()==2017;function Pt(t,e){var r=new Date(t);if(IR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if($E.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xa(t,e){if(Ye&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return yi(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return yi(DE(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return yi(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return yi(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Ft(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ft(t[r]));return e}function $t(t,e){for(var r="";r.length<e;)r+=t;return r}function ei(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var AR=["january","february","march","april","may","june","july","august","september","october","november","december"];function $o(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&AR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var SR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function HE(t){return t?t.content&&t.type?xa(t.content,!0):t.data?Ul(t.data):t.asNodeBuffer&&Ye?Ul(t.asNodeBuffer().toString("binary")):t.asBinary?Ul(t.asBinary()):t._data&&t._data.getContent?Ul(xa(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function zE(t){if(!t)return null;if(t.data)return pm(t.data);if(t.asNodeBuffer&&Ye)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?pm(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function CR(t){return t&&t.name.slice(-4)===".bin"?zE(t):HE(t)}function Ln(t,e){for(var r=t.FullPaths||Gt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Pm(t,e){var r=Ln(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ir(t,e,r){if(!r)return CR(Pm(t,e));if(!e)return null;try{return ir(t,e)}catch{return null}}function yn(t,e,r){if(!r)return HE(Pm(t,e));if(!e)return null;try{return yn(t,e)}catch{return null}}function GE(t,e,r){if(!r)return zE(Pm(t,e));if(!e)return null;try{return GE(t,e)}catch{return null}}function Ow(t){for(var e=t.FullPaths||Gt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function qe(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ye?n=Gi(r):n=qD(r),ke.utils.cfb_add(t,e,n)}ke.utils.cfb_add(t,e,r)}else t.file(e,r)}function Fm(){return ke.utils.cfb_new()}function qE(t,e){switch(e.type){case"base64":return ke.read(t,{type:"base64"});case"binary":return ke.read(t,{type:"binary"});case"buffer":case"array":return ke.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Wl(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var Jt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,kR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Nw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,DR=/<[^>]*>/g,Wr=Jt.match(Nw)?Nw:DR,RR=/<\w*:/,PR=/<(\/?)\w+:/;function Ve(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(kR),o=0,c="",l=0,h="",f="",d=1;if(a)for(l=0;l!=a.length;++l){for(f=a[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+d,f.length-d),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,r||(n[h.toLowerCase()]=c);else{var p=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[p]&&h.slice(o-3,o)=="ext")continue;n[p]=c,r||(n[p.toLowerCase()]=c)}}return n}function wi(t){return t.replace(PR,"<$1")}var KE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Om=Bf(KE),st=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,c){return KE[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Nm=/[&<>'"]/g,FR=/[\u0000-\u0008\u000b-\u001f]/g;function vt(t){var e=t+"";return e.replace(Nm,function(r){return Om[r]}).replace(FR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Mw(t){return vt(t).replace(/ /g,"_x0020_")}var XE=/[\u0000-\u001f]/g;function Mm(t){var e=t+"";return e.replace(Nm,function(r){return Om[r]}).replace(/\n/g,"<br/>").replace(XE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function OR(t){var e=t+"";return e.replace(Nm,function(r){return Om[r]}).replace(XE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Lw=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function NR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Rt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function tm(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function Vw(t){var e=Is(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Bw(t){return Gi(t,"binary").toString("utf8")}var pf="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",wt=Ye&&(Bw(pf)==tm(pf)&&Bw||Vw(pf)==tm(pf)&&Vw)||tm,yi=Ye?function(t){return Gi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},eu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),YE=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),MR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),LR=/<\/?(?:vt:)?variant>/g,VR=/<(?:vt:)([^>]*)>([\s\S]*)</;function Uw(t,e){var r=Ve(t),n=t.match(MR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(LR,"").match(VR);a&&i.push({v:wt(a[2]),t:a[1]})}),i}var QE=/(^\s|\s$|\n)/;function Rr(t,e){return"<"+t+(e.match(QE)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function tu(t){return Gt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function me(t,e,r){return"<"+t+(r!=null?tu(r):"")+(e!=null?(e.match(QE)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function mm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function BR(t,e){switch(typeof t){case"string":var r=me("vt:lpwstr",vt(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return me((t|0)==t?"vt:i4":"vt:r8",vt(String(t)));case"boolean":return me("vt:bool",t?"true":"false")}if(t instanceof Date)return me("vt:filetime",mm(t));throw new Error("Unable to serialize "+t)}function Lm(t){if(Ye&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return wt(ks(km(t)));throw new Error("Bad input format: expected Buffer or string")}var ru=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,ur={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ia=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],vn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function UR(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function jR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var jw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},Ww=Ye?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Gi(e)})):jw(t)}:jw,$w=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(ji(t,i)));return n.join("").replace(Br,"")},Wf=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Br,""):$w(t,e,r)}:$w,Hw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},JE=Ye?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):Hw(t,e,r)}:Hw,zw=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(No(t,i)));return n.join("")},Ko=Ye?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):zw(e,r,n)}:zw,ZE=function(t,e){var r=_r(t,e);return r>0?Ko(t,e+4,e+4+r-1):""},Vm=ZE,eT=function(t,e){var r=_r(t,e);return r>0?Ko(t,e+4,e+4+r-1):""},Bm=eT,tT=function(t,e){var r=2*_r(t,e);return r>0?Ko(t,e+4,e+4+r-1):""},Um=tT,rT=function(e,r){var n=_r(e,r);return n>0?Wf(e,r+4,r+4+n):""},jm=rT,nT=function(t,e){var r=_r(t,e);return r>0?Ko(t,e+4,e+4+r):""},Wm=nT,iT=function(t,e){return UR(t,e)},Cf=iT,$m=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ye&&(Vm=function(e,r){if(!Buffer.isBuffer(e))return ZE(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Bm=function(e,r){if(!Buffer.isBuffer(e))return eT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Um=function(e,r){if(!Buffer.isBuffer(e))return tT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},jm=function(e,r){if(!Buffer.isBuffer(e))return rT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Wm=function(e,r){if(!Buffer.isBuffer(e))return nT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Cf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):iT(e,r)},$m=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function WR(){Wf=function(t,e,r){return pt.utils.decode(1200,t.slice(e,r)).replace(Br,"")},Ko=function(t,e,r){return pt.utils.decode(65001,t.slice(e,r))},Vm=function(t,e){var r=_r(t,e);return r>0?pt.utils.decode(Wo,t.slice(e+4,e+4+r-1)):""},Bm=function(t,e){var r=_r(t,e);return r>0?pt.utils.decode(xi,t.slice(e+4,e+4+r-1)):""},Um=function(t,e){var r=2*_r(t,e);return r>0?pt.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},jm=function(t,e){var r=_r(t,e);return r>0?pt.utils.decode(1200,t.slice(e+4,e+4+r)):""},Wm=function(t,e){var r=_r(t,e);return r>0?pt.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof pt<"u"&&WR();var No=function(t,e){return t[e]},ji=function(t,e){return t[e+1]*256+t[e]},$R=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},_r=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},da=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},HR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function $l(t,e){var r="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Ye&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(ji(this,l)),l+=2;t*=2;break;case"utf8":r=Ko(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Wf(this,this.l,this.l+t);break;case"wstr":if(typeof pt<"u")r=pt.utils.decode(xi,this.slice(this.l,this.l+2*t));else return $l.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=Vm(this,this.l),t=4+_r(this,this.l);break;case"lpstr-cp":r=Bm(this,this.l),t=4+_r(this,this.l);break;case"lpwstr":r=Um(this,this.l),t=4+2*_r(this,this.l);break;case"lpp4":t=4+_r(this,this.l),r=jm(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+_r(this,this.l),r=Wm(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=No(this,this.l+t++))!==0;)s.push(df(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=ji(this,this.l+t))!==0;)s.push(df(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=No(this,l),this.l=l+1,o=$l.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(df(ji(this,l))),l+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof pt<"u"){r=pt.utils.decode(xi,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=No(this,l),this.l=l+1,o=$l.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(df(No(this,l))),l+=1}r=s.join("");break;default:switch(t){case 1:return n=No(this,this.l),this.l++,n;case 2:return n=(e==="i"?$R:ji)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?da:HR)(this,this.l),this.l+=4,n):(i=_r(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Cf(this,this.l):i=Cf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=JE(this,this.l,t);break}}return this.l+=t,r}var zR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},GR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},qR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function KR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)qR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof pt<"u"&&Wo==874)for(i=0;i!=e.length;++i){var s=pt.utils.encode(Wo,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,zR(this,e,this.l);break;case 8:if(n=8,r==="f"){jR(this,e,this.l);break}case 16:break;case-4:n=4,GR(this,e,this.l);break}return this.l+=n,this}function sT(t,e){var r=JE(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Dr(t,e){t.l=e,t.read_shift=$l,t.chk=sT,t.write_shift=KR}function jr(t,e){t.l+=e}function ee(t){var e=Is(t);return Dr(e,0),e}function qi(t,e,r){if(t){var n,i,s;Dr(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=cu[o]||cu[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;c=t.l+s;var h=l.f&&l.f(t,s,r);if(t.l=c,e(h,l,o))return}}}function an(){var t=[],e=Ye?256:2048,r=function(l){var h=ee(l);return Dr(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,e)))},a=function(){return i(),yr(t)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ie(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=cu[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&$m(r)&&t.push(r)}}function Hl(t,e,r){var n=Ft(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Gw(t,e,r){var n=Ft(t);return n.s=Hl(n.s,e.s,r),n.e=Hl(n.e,e.s,r),n}function zl(t,e){if(t.cRel&&t.c<0)for(t=Ft(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ft(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Me(t);return!t.cRel&&t.cRel!=null&&(r=QR(r)),!t.rRel&&t.rRel!=null&&(r=XR(r)),r}function rm(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Bt(t.s.c)+":"+(t.e.cRel?"":"$")+Bt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Qt(t.s.r)+":"+(t.e.rRel?"":"$")+Qt(t.e.r):zl(t.s,e.biff)+":"+zl(t.e,e.biff)}function Hm(t){return parseInt(YR(t),10)-1}function Qt(t){return""+(t+1)}function XR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function YR(t){return t.replace(/\$(\d+)$/,"$1")}function zm(t){for(var e=JR(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Bt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function QR(t){return t.replace(/^([A-Z])/,"$$$1")}function JR(t){return t.replace(/^\$([A-Z])/,"$1")}function ZR(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ut(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Me(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function on(t){var e=t.indexOf(":");return e==-1?{s:Ut(t),e:Ut(t)}:{s:Ut(t.slice(0,e)),e:Ut(t.slice(e+1))}}function $e(t,e){return typeof e>"u"||typeof e=="number"?$e(t.s,t.e):(typeof t!="string"&&(t=Me(t)),typeof e!="string"&&(e=Me(e)),t==e?t:t+":"+e)}function at(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function qw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Un(t.z,r?hr(e):e)}catch{}try{return t.w=Un((t.XF||{}).numFmtId||(r?14:0),r?hr(e):e)}catch{return""+e}}function zi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Ki[t.v]||t.v:e==null?qw(t,t.v):qw(t,e))}function Ds(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function aT(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense;zt!=null&&i==null&&(i=zt);var s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=at(s["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[f].length;++d)if(!(typeof e[f][d]>"u")){var p={v:e[f][d]},v=a+f,m=o+d;if(l.s.r>v&&(l.s.r=v),l.s.c>m&&(l.s.c=m),l.e.r<v&&(l.e.r=v),l.e.c<m&&(l.e.c=m),e[f][d]&&typeof e[f][d]=="object"&&!Array.isArray(e[f][d])&&!(e[f][d]instanceof Date))p=e[f][d];else if(Array.isArray(p.v)&&(p.f=e[f][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Pe[14],n.cellDates?(p.t="d",p.w=Un(p.z,hr(p.v))):(p.t="n",p.v=hr(p.v),p.w=Un(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var _=Me({c:m,r:v});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return l.s.c<1e7&&(s["!ref"]=$e(l)),s}function Xo(t,e){return aT(null,t,e)}function eP(t){return t.read_shift(4,"i")}function ti(t,e){return e||(e=ee(4)),e.write_shift(4,t),e}function Ur(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function xr(t,e){var r=!1;return e==null&&(r=!0,e=ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function tP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function rP(t,e){return e||(e=ee(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Gm(t,e){var r=t.l,n=t.read_shift(1),i=Ur(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(tP(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function nP(t,e){var r=!1;return e==null&&(r=!0,e=ee(15+4*t.t.length)),e.write_shift(1,0),xr(t.t,e),r?e.slice(0,e.l):e}var iP=Gm;function sP(t,e){var r=!1;return e==null&&(r=!0,e=ee(23+4*t.t.length)),e.write_shift(1,1),xr(t.t,e),e.write_shift(4,1),rP({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function jn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Aa(t,e){return e==null&&(e=ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Sa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ca(t,e){return e==null&&(e=ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var aP=Ur,oT=xr;function qm(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function kf(t,e){var r=!1;return e==null&&(r=!0,e=ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var oP=Ur,gm=qm,Km=kf;function Xm(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Cf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):da(e,0)>>2;return r?i/100:i}function cT(t,e){e==null&&(e=ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function lT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function cP(t,e){return e||(e=ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var ka=lT,Yo=cP;function Vr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function wa(t,e){return(e||ee(8)).write_shift(8,t,"f")}function lP(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=ma[i];l&&(e.rgb=iu(l));break;case 2:e.rgb=iu([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Df(t,e){if(e||(e=ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function uP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function hP(t,e){e||(e=ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function uT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function fP(t){return uT(t,1)}function dP(t){return uT(t,2)}var Ym=2,sn=3,mf=11,Kw=12,Rf=19;var gf=64,pP=65,mP=71;var gP=4108,vP=4126,vr=80,hT=81,_P=[vr,hT],vm={1:{n:"CodePage",t:Ym},2:{n:"Category",t:vr},3:{n:"PresentationFormat",t:vr},4:{n:"ByteCount",t:sn},5:{n:"LineCount",t:sn},6:{n:"ParagraphCount",t:sn},7:{n:"SlideCount",t:sn},8:{n:"NoteCount",t:sn},9:{n:"HiddenCount",t:sn},10:{n:"MultimediaClipCount",t:sn},11:{n:"ScaleCrop",t:mf},12:{n:"HeadingPairs",t:gP},13:{n:"TitlesOfParts",t:vP},14:{n:"Manager",t:vr},15:{n:"Company",t:vr},16:{n:"LinksUpToDate",t:mf},17:{n:"CharacterCount",t:sn},19:{n:"SharedDoc",t:mf},22:{n:"HyperlinksChanged",t:mf},23:{n:"AppVersion",t:sn,p:"version"},24:{n:"DigSig",t:pP},26:{n:"ContentType",t:vr},27:{n:"ContentStatus",t:vr},28:{n:"Language",t:vr},29:{n:"Version",t:vr},255:{},2147483648:{n:"Locale",t:Rf},2147483651:{n:"Behavior",t:Rf},1919054434:{}},_m={1:{n:"CodePage",t:Ym},2:{n:"Title",t:vr},3:{n:"Subject",t:vr},4:{n:"Author",t:vr},5:{n:"Keywords",t:vr},6:{n:"Comments",t:vr},7:{n:"Template",t:vr},8:{n:"LastAuthor",t:vr},9:{n:"RevNumber",t:vr},10:{n:"EditTime",t:gf},11:{n:"LastPrinted",t:gf},12:{n:"CreatedDate",t:gf},13:{n:"ModifiedDate",t:gf},14:{n:"PageCount",t:sn},15:{n:"WordCount",t:sn},16:{n:"CharCount",t:sn},17:{n:"Thumbnail",t:mP},18:{n:"Application",t:vr},19:{n:"DocSecurity",t:sn},255:{},2147483648:{n:"Locale",t:Rf},2147483651:{n:"Behavior",t:Rf},1919054434:{}},Xw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function xP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var wP=xP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ma=Ft(wP),Ki={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},fT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ym={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},vf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Qm(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function EP(t){var e=Qm();if(!t||!t.match)return e;var r={};if((t.match(Wr)||[]).forEach(function(n){var i=Ve(n);switch(i[0].replace(RR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[ym[i.ContentType]]!==void 0&&e[ym[i.ContentType]].push(i.PartName);break}}),e.xmlns!==ur.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function dT(t,e){var r=ER(ym),n=[],i;n[n.length]=Jt,n[n.length]=me("Types",null,{xmlns:ur.CT,"xmlns:xsd":ur.xsd,"xmlns:xsi":ur.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return me("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=me("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:vf[c][e.bookType]||vf[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(l){n[n.length]=me("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:vf[c][e.bookType]||vf[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(l){n[n.length]=me("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ke={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nu(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Gl(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Wr)||[]).forEach(function(i){var s=Ve(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Wl(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function Bo(t){var e=[Jt,me("Relationships",null,{xmlns:ur.RELS})];return Gt(t["!id"]).forEach(function(r){e[e.length]=me("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function gt(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,s?i.TargetMode=s:[Ke.HLINK,Ke.XPATH,Ke.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var TP="application/vnd.oasis.opendocument.spreadsheet";function bP(t,e){for(var r=Lm(t),n,i;n=ru.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ve(n[0],!1),i.path=="/"&&i.type!==TP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function IP(t){var e=[Jt];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Yw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function AP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function SP(t){var e=[Jt];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Yw(t[r][0],t[r][1])),e.push(AP("",t[r][0]));return e.push(Yw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function pT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Ql.version+"</meta:generator></office:meta></office:document-meta>"}var Bn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CP=function(){for(var t=new Array(Bn.length),e=0;e<Bn.length;++e){var r=Bn[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function mT(t){var e={};t=wt(t);for(var r=0;r<Bn.length;++r){var n=Bn[r],i=t.match(CP[r]);i!=null&&i.length>0&&(e[n[1]]=st(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Pt(e[n[1]]))}return e}function nm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=vt(e),n[n.length]=r?me(t,e,r):Rr(t,e))}function gT(t,e){var r=e||{},n=[Jt,me("cp:coreProperties",null,{"xmlns:cp":ur.CORE_PROPS,"xmlns:dc":ur.dc,"xmlns:dcterms":ur.dcterms,"xmlns:dcmitype":ur.dcmitype,"xmlns:xsi":ur.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&nm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:mm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&nm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:mm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Bn.length;++s){var a=Bn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&nm(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var ga=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],vT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function _T(t,e,r,n){var i=[];if(typeof t=="string")i=Uw(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(h){return{v:h}}));var a=typeof e=="string"?Uw(e,n).map(function(h){return h.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function kP(t,e,r){var n={};return e||(e={}),t=wt(t),ga.forEach(function(i){var s=(t.match(eu(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=st(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&_T(n.HeadingPairs,n.TitlesOfParts,e,r),e}function yT(t){var e=[],r=me;return t||(t={}),t.Application="SheetJS",e[e.length]=Jt,e[e.length]=me("Properties",null,{xmlns:ur.EXT_PROPS,"xmlns:vt":ur.vt}),ga.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=vt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+vt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var DP=/<[^>]+>[^<]*/g;function RP(t,e){var r={},n="",i=t.match(DP);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ve(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=st(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),h=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=st(h);break;case"bool":r[n]=Rt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Pt(h);break;case"cy":case"error":r[n]=st(h);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function xT(t){var e=[Jt,me("Properties",null,{xmlns:ur.CUST_PROPS,"xmlns:vt":ur.vt})];if(!t)return e.join("");var r=1;return Gt(t).forEach(function(i){++r,e[e.length]=me("property",BR(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:vt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var xm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},im;function PP(t,e,r){im||(im=Bf(xm)),e=im[e]||e,t[e]=r}function FP(t,e){var r=[];return Gt(xm).map(function(n){for(var i=0;i<Bn.length;++i)if(Bn[i][1]==n)return Bn[i];for(i=0;i<ga.length;++i)if(ga[i][1]==n)return ga[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Rr(xm[n[1]]||n[1],i))}}),me("DocumentProperties",r.join(""),{xmlns:vn.o})}function OP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Gt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<Bn.length;++a)if(s==Bn[a][1])return;for(a=0;a<ga.length;++a)if(s==ga[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(me(Mw(s),o,{"dt:dt":c}))}}),e&&Gt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(me(Mw(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+vn.o+'">'+i.join("")+"</"+n+">"}function Jm(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function NP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function wT(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function ET(t,e,r){var n=t.read_shift(0,"lpwstr");return r&&(t.l+=4-(n.length+1&3)&3),n}function TT(t,e,r){return e===31?ET(t):wT(t,e,r)}function wm(t,e,r){return TT(t,e,r===!1?0:4)}function MP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return TT(t,e,0)}function LP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Br,""),t.l-i&2&&(t.l+=2)}return r}function VP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Br,"");return r}function BP(t){var e=t.l,r=Pf(t,hT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Pf(t,sn);return[r,n]}function UP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(BP(t));return r}function Qw(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Br,"").replace(jl,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function bT(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function jP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Pf(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Kw&&n!==e&&_P.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Kw?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return wT(t,n,4).replace(Br,"");case 31:return ET(t);case 64:return Jm(t);case 65:return bT(t);case 71:return jP(t);case 80:return wm(t,n,!s.raw).replace(Br,"");case 81:return MP(t,n).replace(Br,"");case 4108:return UP(t);case 4126:case 4127:return n==4127?LP(t):VP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function Jw(t,e){var r=ee(4),n=ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=NP(e);break;case 31:case 80:for(n=ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return yr([r,n])}function Zw(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var h=t.read_shift(4),f=t.read_shift(4);s[a]=[h,f+r]}s.sort(function(S,T){return S[1]-T[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=Pf(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Jn(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=Pf(t,Ym),Jn(o),c!==-1){var m=t.l;t.l=s[c][1],l=Qw(t,o),t.l=m}}else if(s[a][0]===0){if(o===0){c=a,t.l=s[a+1][1];continue}l=Qw(t,o)}else{var _=l[s[a][0]],b;switch(t[t.l]){case 65:t.l+=4,b=bT(t);break;case 30:t.l+=4,b=wm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,b=wm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,b=t.read_shift(4,"i");break;case 19:t.l+=4,b=t.read_shift(4);break;case 5:t.l+=4,b=t.read_shift(8,"f");break;case 11:t.l+=4,b=Yt(t,4);break;case 64:t.l+=4,b=Pt(Jm(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=b}}return t.l=r+n,d}var IT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function WP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eE(t,e,r){var n=ee(8),i=[],s=[],a=8,o=0,c=ee(8),l=ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!e){l=ee(8),l.write_shift(4,0),i.unshift(l);var h=[ee(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(c=ee(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=yr(h),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(IT.indexOf(t[o][0])>-1||vT.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],p=0;if(e){p=+e[t[o][0]];var v=r[p];if(v.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}c=Jw(v.t,d)}else{var _=WP(d);_==-1&&(_=31,d=String(d)),c=Jw(_,d)}s.push(c),l=ee(8),l.write_shift(4,e?p:2+o),i.push(l),a+=8+c.length}var b=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,b),b+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),yr([n].concat(i).concat(s))}function tE(t,e,r){var n=t.content;if(!n)return{};Dr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),h=n.read_shift(16);if(h!==ke.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var f=Zw(n,e),d={SystemIdentifier:l};for(var p in f)d[p]=f[p];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=Zw(n,null)}catch{}for(p in v)d[p]=v[p];return d.FMTID=[s,a],d}function rE(t,e,r,n,i,s){var a=ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,ke.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=eE(t,r,n);if(o.push(c),i){var l=eE(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return yr(o)}function Es(t,e){return t.read_shift(e),null}function $P(t,e){e||(e=ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function HP(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Yt(t,e){return t.read_shift(e)===1}function Jr(t,e){return e||(e=ee(2)),e.write_shift(2,+!!t),e}function sr(t){return t.read_shift(2,"u")}function Vn(t,e){return e||(e=ee(2)),e.write_shift(2,t),e}function AT(t,e){return HP(t,e,sr)}function zP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function ST(t,e,r){return r||(r=ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function fu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=xi;if(r&&r.biff>=8&&(xi=1200),!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return xi=s,o}function GP(t){var e=xi;xi=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,c,l={};s&&(o=t.read_shift(2)),i&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",f=r===0?"":t.read_shift(r,h);return s&&(t.l+=4*o),i&&(t.l+=c),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),xi=e,l}function qP(t){var e=t.t||"",r=1,n=ee(3+(r>1?2:0));n.write_shift(2,e.length),n.write_shift(1,(r>1?8:0)|1),r>1&&n.write_shift(2,r);var i=ee(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[n,i];return yr(s)}function Ea(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function du(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ea(t,n,r)}function Da(t,e,r){if(r.biff>5)return du(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function CT(t,e,r){return r||(r=ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function KP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function XP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Br,"");return n&&(t.l+=24),i}function YP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Br,"");return r+a}function QP(t,e){var r=t.read_shift(16);switch(e-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return XP(t,e);case"0303000000000000c000000000000046":return YP(t,e);default:throw new Error("Unsupported Moniker "+r)}}function _f(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Br,""):"";return r}function nE(t,e){e||(e=ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function JP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,c,l="",h,f;i&16&&(s=_f(t,r-t.l)),i&128&&(a=_f(t,r-t.l)),(i&257)===257&&(o=_f(t,r-t.l)),(i&257)===1&&(c=QP(t,r-t.l)),i&8&&(l=_f(t,r-t.l)),i&32&&(h=t.read_shift(16)),i&64&&(f=Jm(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return h&&(p.guid=h),f&&(p.time=f),s&&(p.Tooltip=s),p}function ZP(t){var e=ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),nE(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&nE(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function kT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function DT(t,e){var r=kT(t,e);return r[3]=0,r}function Ei(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ta(t,e,r,n){return n||(n=ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function eF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function tF(t,e,r){return e===0?"":Da(t,e,r)}function rF(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function RT(t){var e=t.read_shift(2),r=Xm(t);return[e,r]}function nF(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=fu(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function $f(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function PT(t,e){return e||(e=ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function FT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var iF=FT;function OT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function sF(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function aF(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Or(t){t.l+=2,t.l+=t.read_shift(2)}var oF={0:Or,4:Or,5:Or,6:Or,7:aF,8:Or,9:Or,10:Or,11:Or,12:Or,13:sF,14:Or,15:Or,16:Or,17:Or,18:Or,19:Or,20:Or,21:OT};function cF(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(oF[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function yf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function Zm(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function lF(t,e){return e===0||t.read_shift(2),1200}function uF(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Da(t,0,r);return t.read_shift(e+n-t.l),i}function hF(t,e){var r=!e||e.biff==8,n=ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function fF(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function dF(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=fu(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function pF(t,e){var r=!e||e.biff>=8?2:1,n=ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function mF(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(GP(t));return s.Count=n,s.Unique=i,s}function gF(t,e){var r=ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=qP(t[i],e);var s=yr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function vF(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function _F(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function yF(t){var e=eF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function xF(t){return t.read_shift(2),t.read_shift(4)}function iE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function wF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function EF(){var t=ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function TF(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function bF(t){var e=ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function IF(){}function AF(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=fu(t,0,r),n}function SF(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ee(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function CF(t){var e=Ei(t);return e.isst=t.read_shift(4),e}function kF(t,e,r,n){var i=ee(10);return Ta(t,e,n,i),i.write_shift(4,r),i}function DF(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ei(t,6);r.biff==2&&t.l++;var s=du(t,n-t.l,r);return i.val=s,i}function RF(t,e,r,n,i){var s=!i||i.biff==8,a=ee(8+ +s+(1+s)*r.length);return Ta(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function PF(t,e,r){var n=t.read_shift(2),i=Da(t,0,r);return[n,i]}function FF(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var OF=Da;function sE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c}}}function NF(t,e){var r=e.biff==8||!e.biff?4:2,n=ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function MF(t){var e=t.read_shift(2),r=t.read_shift(2),n=RT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function LF(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(RT(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function VF(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function BF(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return i.patternType=yP[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function UF(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=BF(t,e,n.fStyle,r),n}function aE(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function jF(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function WF(t){var e=ee(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function oE(t,e,r){var n=Ei(t,6);(r.biff==2||e==9)&&++t.l;var i=zP(t,2);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function $F(t,e,r,n,i,s){var a=ee(8);return Ta(t,e,n,a),ST(r,s,a),a}function HF(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ei(t,6),i=Vr(t,8);return n.val=i,n}function zF(t,e,r,n){var i=ee(14);return Ta(t,e,n,i),wa(r,i),i}var cE=tF;function GF(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ea(t,s),o=[];n>t.l;)o.push(du(t));return[s,i,a,o]}function lE(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=nF(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var qF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function uE(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Ea(t,a,r);i&32&&(l=qF[l.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var f=n==t.l||o===0||!(h>0)?[]:cL(t,h,r,o);return{chKey:s,Name:l,itab:c,rgce:f}}function NT(t,e,r){if(r.biff<8)return KF(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(rF(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function KF(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=fu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function XF(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ea(t,n,r),a=Ea(t,i,r);return[s,a]}function YF(t,e,r){var n=FT(t,6);t.l++;var i=t.read_shift(1);return e-=8,[lL(t,e,r),i,n]}function hE(t,e,r){var n=iF(t,6);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,aL(t,e,r,n)]}function QF(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function JF(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Da(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function ZF(t,e,r){return JF(t,e,r)}function eO(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push($f(t,e));return r}function tO(t){var e=ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)PT(t[r],e);return e}function rO(t,e,r){if(r&&r.biff<8)return iO(t,e,r);var n=OT(t,22),i=cF(t,e-22,n[1]);return{cmo:n,ft:i}}var nO={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function iO(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((nO[n]||jr)(t,e,r)),{cmo:[i,n,s],ft:a}}function sO(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=KP(t,6,r);var o=t.read_shift(2);t.read_shift(2),sr(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var h=t[t.l],f=Ea(t,t.lens[l+1]-t.lens[l]-1);if(i+=f,i.length>=(h?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function aO(t,e){var r=$f(t,8);t.l+=16;var n=JP(t,e-24);return[r,n]}function oO(t){var e=ee(24),r=Ut(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return yr([e,ZP(t[1])])}function cO(t,e){t.read_shift(2);var r=$f(t,8),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Br,""),[r,n]}function lO(t){var e=t[1].Tooltip,r=ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Ut(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function uO(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Xw[r]||r,r=t.read_shift(2),e[1]=Xw[r]||r,e}function hO(t){return t||(t=ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function fO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(DT(t,8));return r}function dO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(DT(t,8));return r}function pO(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function MT(t,e,r){if(!r.cellStyles)return jr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function mO(t,e){var r=ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function gO(t,e){var r={};return e<32||(t.l+=16,r.header=Vr(t,8),r.footer=Vr(t,8),t.l+=2),r}function vO(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function _O(t){for(var e=ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var yO=Ei,xO=AT,wO=du;function EO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function TO(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ei(t,6);++t.l;var i=Da(t,e-7,r);return n.t="str",n.val=i,n}function bO(t){var e=Ei(t,6);++t.l;var r=Vr(t,8);return e.t="n",e.val=r,e}function IO(t,e,r){var n=ee(15);return vu(n,t,e),n.write_shift(8,r,"f"),n}function AO(t){var e=Ei(t,6);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function SO(t,e,r){var n=ee(9);return vu(n,t,e),n.write_shift(2,r),n}function CO(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function kO(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function DO(t,e,r){var n=t.l+e,i=Ei(t,6),s=t.read_shift(2),a=Ea(t,s,r);return t.l=n,i.t="str",i.val=a,i}var RO=[2,3,48,49,131,139,140,245],Em=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=Bf({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],h=Is(1);switch(c.type){case"base64":h=_n(xn(o));break;case"binary":h=_n(o);break;case"buffer":case"array":h=o;break}Dr(h,0);var f=h.read_shift(1),d=!!(f&136),p=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,_=521;f==2&&(m=h.read_shift(2)),h.l+=3,f!=2&&(m=h.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(_=h.read_shift(2));var b=h.read_shift(2),S=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=t[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var T=[],N={},M=Math.min(h.length,f==2?521:_-10-(p?264:0)),B=v?32:11;h.l<M&&h[h.l]!=13;)switch(N={},N.name=pt.utils.decode(S,h.slice(h.l,h.l+B)).replace(/[\u0000\r\n].*$/g,""),h.l+=B,N.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),f==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&T.push(N),f!=2&&(h.l+=v?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var x=0,w=0;for(l[0]=[],w=0;w!=T.length;++w)l[0][w]=T[w].name;for(;m-- >0;){if(h[h.l]===42){h.l+=b;continue}for(++h.l,l[++x]=[],w=0,w=0;w!=T.length;++w){var E=h.slice(h.l,h.l+T[w].len);h.l+=T[w].len,Dr(E,0);var C=pt.utils.decode(S,E);switch(T[w].type){case"C":C.trim().length&&(l[x][w]=C.replace(/\s+$/,""));break;case"D":C.length===8?l[x][w]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):l[x][w]=C;break;case"F":l[x][w]=parseFloat(C.trim());break;case"+":case"I":l[x][w]=v?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":l[x][w]=!0;break;case"N":case"F":l[x][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[x][w]="##MEMO##"+(v?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(l[x][w]=+C||0);break;case"@":l[x][w]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":l[x][w]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":l[x][w]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[x][w]=-E.read_shift(-8,"f");break;case"B":if(p&&T[w].len==8){l[x][w]=E.read_shift(8,"f");break}case"G":case"P":E.l+=T[w].len;break;case"0":if(T[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[w].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=T,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=Xo(r(o,l),l);return h["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,h}function i(o,c){try{return Ds(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&Jn(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=an(),f=Mf(o,{header:1,raw:!0,cellDates:!0}),d=f[0],p=f.slice(1),v=o["!cols"]||[],m=0,_=0,b=0,S=1;for(m=0;m<d.length;++m){if(((v[m]||{}).DBF||{}).name){d[m]=v[m].DBF.name,++b;continue}if(d[m]!=null){if(++b,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var T=at(o["!ref"]),N=[],M=[],B=[];for(m=0;m<=T.e.c-T.s.c;++m){var x="",w="",E=0,C=[];for(_=0;_<p.length;++_)p[_][m]!=null&&C.push(p[_][m]);if(C.length==0||d[m]==null){N[m]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=C[_]instanceof Date?"D":"C";break;default:w="C"}E=Math.max(E,String(C[_]).length),x=x&&x!=w?"C":w}E>250&&(E=250),w=((v[m]||{}).DBF||{}).type,w=="C"&&v[m].DBF.len>E&&(E=v[m].DBF.len),x=="B"&&w=="N"&&(x="N",B[m]=v[m].DBF.dec,E=v[m].DBF.len),M[m]=x=="C"||w=="N"?E:s[x]||0,S+=M[m],N[m]=x}var k=h.next(32);for(k.write_shift(4,318902576),k.write_shift(4,p.length),k.write_shift(2,296+32*b),k.write_shift(2,S),m=0;m<4;++m)k.write_shift(4,0);for(k.write_shift(4,0|(+e[Wo]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var A=h.next(32),R=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,R,"sbcs"),A.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),A.write_shift(4,_),A.write_shift(1,M[m]||s[N[m]]||0),A.write_shift(1,B[m]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),_+=M[m]||s[N[m]]||0}var oe=h.next(264);for(oe.write_shift(4,13),m=0;m<65;++m)oe.write_shift(4,0);for(m=0;m<p.length;++m){var se=h.next(S);for(se.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(N[_]){case"L":se.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":se.write_shift(8,p[m][_]||0,"f");break;case"N":var Se="0";for(typeof p[m][_]=="number"&&(Se=p[m][_].toFixed(B[_]||0)),b=0;b<M[_]-Se.length;++b)se.write_shift(1,32);se.write_shift(1,Se,"sbcs");break;case"D":p[m][_]?(se.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(p[m][_]!=null?p[m][_]:"").slice(0,M[_]);for(se.write_shift(1,_e,"sbcs"),b=0;b<M[_]-_e.length;++b)se.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),LT=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Gt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var v=t[p];return typeof v=="number"?Ew(v):v},n=function(d,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?d:Ew(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(xn(d),p);case"binary":return s(d,p);case"buffer":return s(Ye&&Buffer.isBuffer(d)?d.toString("binary"):ks(d),p);case"array":return s(xa(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var v=d.split(/[\n\r]+/),m=-1,_=-1,b=0,S=0,T=[],N=[],M=null,B={},x=[],w=[],E=[],C=0,k;for(+p.codepage>=0&&Jn(+p.codepage);b!==v.length;++b){C=0;var A=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=A.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),oe=R[0],se;if(A.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&N.push(A.slice(3).replace(/;;/g,";"));break;case"C":var Se=!1,_e=!1,Re=!1,he=!1,Ie=-1,re=-1;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"A":break;case"X":_=parseInt(R[S].slice(1))-1,_e=!0;break;case"Y":for(m=parseInt(R[S].slice(1))-1,_e||(_=0),k=T.length;k<=m;++k)T[k]=[];break;case"K":se=R[S].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(ei(se))?isNaN($o(se).getDate())||(se=Pt(se)):(se=ei(se),M!==null&&Go(M)&&(se=jf(se))),typeof pt<"u"&&typeof se=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(se=pt.utils.decode(p.codepage,se)),Se=!0;break;case"E":he=!0;var j=Uo(R[S].slice(1),{r:m,c:_});T[m][_]=[T[m][_],j];break;case"S":Re=!0,T[m][_]=[T[m][_],"S5S"];break;case"G":break;case"R":Ie=parseInt(R[S].slice(1))-1;break;case"C":re=parseInt(R[S].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}if(Se&&(T[m][_]&&T[m][_].length==2?T[m][_][0]=se:T[m][_]=se,M=null),Re){if(he)throw new Error("SYLK shared formula cannot have own formula");var G=Ie>-1&&T[Ie][re];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");T[m][_][1]=tb(G[1],{r:m-Ie,c:_-re})}break;case"F":var H=0;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"X":_=parseInt(R[S].slice(1))-1,++H;break;case"Y":for(m=parseInt(R[S].slice(1))-1,k=T.length;k<=m;++k)T[k]=[];break;case"M":C=parseInt(R[S].slice(1))/20;break;case"F":break;case"G":break;case"P":M=N[parseInt(R[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=R[S].slice(1).split(" "),k=parseInt(E[0],10);k<=parseInt(E[1],10);++k)C=parseInt(E[2],10),w[k-1]=C===0?{hidden:!0}:{wch:C},As(w[k-1]);break;case"C":_=parseInt(R[S].slice(1))-1,w[_]||(w[_]={});break;case"R":m=parseInt(R[S].slice(1))-1,x[m]||(x[m]={}),C>0?(x[m].hpt=C,x[m].hpx=zo(C)):C===0&&(x[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}H<1&&(M=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+A)}}return x.length>0&&(B["!rows"]=x),w.length>0&&(B["!cols"]=w),p&&p.sheetRows&&(T=T.slice(0,p.sheetRows)),[T,B]}function a(d,p){var v=i(d,p),m=v[0],_=v[1],b=Xo(m,p);return Gt(_).forEach(function(S){b[S]=_[S]}),b}function o(d,p){return Ds(a(d,p),p)}function c(d,p,v,m){var _="C;Y"+(v+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+sg(d.f,{r:v,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function l(d,p){p.forEach(function(v,m){var _="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=su(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=au(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function h(d,p){p.forEach(function(v,m){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*ou(v.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function f(d,p){var v=["ID;PWXL;N;E"],m=[],_=at(d["!ref"]),b,S=Array.isArray(d),T=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&l(v,d["!cols"]),d["!rows"]&&h(v,d["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var N=_.s.r;N<=_.e.r;++N)for(var M=_.s.c;M<=_.e.c;++M){var B=Me({r:N,c:M});b=S?(d[N]||[])[M]:d[B],!(!b||b.v==null&&(!b.f||b.F))&&m.push(c(b,d,N,M,p))}return v.join(T)+T+m.join(T)+T+"E"+T}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),VT=function(){function t(s,a){switch(a.type){case"base64":return e(xn(s),a);case"binary":return e(s,a);case"buffer":return e(Ye&&Buffer.isBuffer(s)?s.toString("binary"):ks(s),a);case"array":return e(xa(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var d=o[h].trim().split(","),p=d[0],v=d[1];++h;for(var m=o[h]||"";(m.match(/["]/g)||[]).length&1&&h<o.length-1;)m+=`
`+o[++h];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],l=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][l]=!0:m==="FALSE"?f[c][l]=!1:isNaN(ei(v))?isNaN($o(v).getDate())?f[c][l]=v:f[c][l]=Pt(v):f[c][l]=ei(v),++l;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),Vl&&m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][l++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return Xo(t(s,a),a)}function n(s,a){return Ds(r(s,a),a)}var i=function(){var s=function(c,l,h,f,d){c.push(l),c.push(h+","+f),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,h,f){c.push(l+","+h),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],h=at(c["!ref"]),f,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,h.e.r-h.s.r+1,""),s(l,"TUPLES",0,h.e.c-h.s.c+1,""),s(l,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){a(l,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var m=Me({r:p,c:v});if(f=d?(c[p]||[])[v]:c[m],!f){a(l,1,0,"");continue}switch(f.t){case"n":var _=Vl?f.w:f.v;!_&&f.v!=null&&(_=f.v),_==null?Vl&&f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,_,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!Vl||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Un(f.z||Pe[14],hr(Pt(f.v)))),Vl?a(l,0,f.w,"V"):a(l,1,0,f.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var b=`\r
`,S=l.join(b);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),BT=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var p=f.split(`
`),v=-1,m=-1,_=0,b=[];_!==p.length;++_){var S=p[_].trim().split(":");if(S[0]==="cell"){var T=Ut(S[1]);if(b.length<=T.r)for(v=b.length;v<=T.r;++v)b[v]||(b[v]=[]);switch(v=T.r,m=T.c,S[2]){case"t":b[v][m]=t(S[3]);break;case"v":b[v][m]=+S[3];break;case"vtf":var N=S[S.length-1];case"vtc":switch(S[3]){case"nl":b[v][m]=!!+S[4];break;default:b[v][m]=+S[4];break}S[2]=="vtf"&&(b[v][m]=[b[v][m],N])}}}return d&&d.sheetRows&&(b=b.slice(0,d.sheetRows)),b}function n(f,d){return Xo(r(f,d),d)}function i(f,d){return Ds(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var d=[],p=[],v,m="",_=on(f["!ref"]),b=Array.isArray(f),S=_.s.r;S<=_.e.r;++S)for(var T=_.s.c;T<=_.e.c;++T)if(m=Me({r:S,c:T}),v=b?(f[S]||[])[T]:f[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=hr(Pt(v.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=v.w||Un(v.z||Pe[14],N);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function h(f){return[s,a,o,a,l(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),Ho=function(){function t(h,f,d,p,v){v.raw?f[d][p]=h:h===""||(h==="TRUE"?f[d][p]=!0:h==="FALSE"?f[d][p]=!1:isNaN(ei(h))?isNaN($o(h).getDate())?f[d][p]=h:f[d][p]=Pt(h):f[d][p]=ei(h))}function e(h,f){var d=f||{},p=[];if(!h||h.length===0)return p;for(var v=h.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var _=10,b=0,S=0;S<=m;++S)b=v[S].indexOf(" "),b==-1?b=v[S].length:b++,_=Math.max(_,b);for(S=0;S<=m;++S){p[S]=[];var T=0;for(t(v[S].slice(0,_).trim(),p,S,T,d),T=1;T<=(v[S].length-_)/10+1;++T)t(v[S].slice(_+(T-1)*10,_+T*10).trim(),p,S,T,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},d=!1,p=0,v=0;p<h.length;++p)(v=h.charCodeAt(p))==34?d=!d:!d&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p]);if(!v.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p])}return v.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(h,f){var d=f||{},p="";zt!=null&&d.dense==null&&(d.dense=zt);var v=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):d&&d.FS?p=d.FS:p=i(h.slice(0,1024));var _=0,b=0,S=0,T=0,N=0,M=p.charCodeAt(0),B=!1,x=0,w=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var E=d.dateNF!=null?vR(d.dateNF):null;function C(){var k=h.slice(T,N),A={};if(k.charAt(0)=='"'&&k.charAt(k.length-1)=='"'&&(k=k.slice(1,-1).replace(/""/g,'"')),k.length===0)A.t="z";else if(d.raw)A.t="s",A.v=k;else if(k.trim().length===0)A.t="s",A.v=k;else if(k.charCodeAt(0)==61)k.charCodeAt(1)==34&&k.charCodeAt(k.length-1)==34?(A.t="s",A.v=k.slice(2,-1).replace(/""/g,'"')):GM(k)?(A.t="n",A.f=k.slice(1)):(A.t="s",A.v=k);else if(k=="TRUE")A.t="b",A.v=!0;else if(k=="FALSE")A.t="b",A.v=!1;else if(!isNaN(S=ei(k)))A.t="n",d.cellText!==!1&&(A.w=k),A.v=S;else if(!isNaN($o(k).getDate())||E&&k.match(E)){A.z=d.dateNF||Pe[14];var R=0;E&&k.match(E)&&(k=_R(k,d.dateNF,k.match(E)||[]),R=1),d.cellDates?(A.t="d",A.v=Pt(k,R)):(A.t="n",A.v=hr(Pt(k,R))),d.cellText!==!1&&(A.w=Un(A.z,A.v instanceof Date?hr(A.v):A.v)),d.cellNF||delete A.z}else A.t="s",A.v=k;if(A.t=="z"||(d.dense?(v[_]||(v[_]=[]),v[_][b]=A):v[Me({c:b,r:_})]=A),T=N+1,w=h.charCodeAt(T),m.e.c<b&&(m.e.c=b),m.e.r<_&&(m.e.r=_),x==M)++b;else if(b=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;N<h.length;++N)switch(x=h.charCodeAt(N)){case 34:w===34&&(B=!B);break;case M:case 10:case 13:if(!B&&C())break e;break;default:break}return N-T>0&&C(),v["!ref"]=$e(m),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):Xo(e(h,f),f)}function o(h,f){var d="",p=f.type=="string"?[0,0,0,0]:dg(h,f);switch(f.type){case"base64":d=xn(h);break;case"binary":d=h;break;case"buffer":f.codepage==65001?d=h.toString("utf8"):f.codepage&&typeof pt<"u"?d=pt.utils.decode(f.codepage,h):d=Ye&&Buffer.isBuffer(h)?h.toString("binary"):ks(h);break;case"array":d=xa(h);break;case"string":d=h;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=wt(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=wt(d):f.type=="binary"&&typeof pt<"u"&&f.codepage&&(d=pt.utils.decode(f.codepage,pt.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?BT.to_sheet(f.type=="string"?d:wt(d),f):a(d,f)}function c(h,f){return Ds(o(h,f),f)}function l(h){for(var f=[],d=at(h["!ref"]),p,v=Array.isArray(h),m=d.s.r;m<=d.e.r;++m){for(var _=[],b=d.s.c;b<=d.e.c;++b){var S=Me({r:m,c:b});if(p=v?(h[m]||[])[b]:h[S],!p||p.v==null){_.push("          ");continue}for(var T=(p.w||(zi(p),p.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(b===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function PO(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=LT.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ho.to_workbook(t,e)}}var va=function(){function t(j,G,H){if(j){Dr(j,j.l||0);for(var W=H.Enum||Ie;j.l<j.length;){var te=j.read_shift(2),de=W[te]||W[65535],ce=j.read_shift(2),ue=j.l+ce,ne=de.f&&de.f(j,ce,H);if(j.l=ue,G(ne,de,te))return}}}function e(j,G){switch(G.type){case"base64":return r(_n(xn(j)),G);case"binary":return r(_n(j),G);case"buffer":case"array":return r(j,G)}throw"Unsupported type "+G.type}function r(j,G){if(!j)return j;var H=G||{};zt!=null&&H.dense==null&&(H.dense=zt);var W=H.dense?[]:{},te="Sheet1",de="",ce=0,ue={},ne=[],Be=[],U={s:{r:0,c:0},e:{r:0,c:0}},nt=H.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)H.Enum=Ie,t(j,function(Ee,Lt,Kr){switch(Kr){case 0:H.vers=Ee,Ee>=4096&&(H.qpro=!0);break;case 6:U=Ee;break;case 204:Ee&&(de=Ee);break;case 222:de=Ee;break;case 15:case 51:H.qpro||(Ee[1].v=Ee[1].v.slice(1));case 13:case 14:case 16:Kr==14&&(Ee[2]&112)==112&&(Ee[2]&15)>1&&(Ee[2]&15)<15&&(Ee[1].z=H.dateNF||Pe[14],H.cellDates&&(Ee[1].t="d",Ee[1].v=jf(Ee[1].v))),H.qpro&&Ee[3]>ce&&(W["!ref"]=$e(U),ue[te]=W,ne.push(te),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ce=Ee[3],te=de||"Sheet"+(ce+1),de="");var cn=H.dense?(W[Ee[0].r]||[])[Ee[0].c]:W[Me(Ee[0])];if(cn){cn.t=Ee[1].t,cn.v=Ee[1].v,Ee[1].z!=null&&(cn.z=Ee[1].z),Ee[1].f!=null&&(cn.f=Ee[1].f);break}H.dense?(W[Ee[0].r]||(W[Ee[0].r]=[]),W[Ee[0].r][Ee[0].c]=Ee[1]):W[Me(Ee[0])]=Ee[1];break;default:}},H);else if(j[2]==26||j[2]==14)H.Enum=re,j[2]==14&&(H.qpro=!0,j.l=0),t(j,function(Ee,Lt,Kr){switch(Kr){case 204:te=Ee;break;case 22:Ee[1].v=Ee[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ee[3]>ce&&(W["!ref"]=$e(U),ue[te]=W,ne.push(te),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ce=Ee[3],te="Sheet"+(ce+1)),nt>0&&Ee[0].r>=nt)break;H.dense?(W[Ee[0].r]||(W[Ee[0].r]=[]),W[Ee[0].r][Ee[0].c]=Ee[1]):W[Me(Ee[0])]=Ee[1],U.e.c<Ee[0].c&&(U.e.c=Ee[0].c),U.e.r<Ee[0].r&&(U.e.r=Ee[0].r);break;case 27:Ee[14e3]&&(Be[Ee[14e3][0]]=Ee[14e3][1]);break;case 1537:Be[Ee[0]]=Ee[1],Ee[0]==ce&&(te=Ee[1]);break;default:break}},H);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(W["!ref"]=$e(U),ue[de||te]=W,ne.push(de||te),!Be.length)return{SheetNames:ne,Sheets:ue};for(var He={},it=[],Xe=0;Xe<Be.length;++Xe)ue[ne[Xe]]?(it.push(Be[Xe]||ne[Xe]),He[Be[Xe]]=ue[Be[Xe]]||ue[ne[Xe]]):(it.push(Be[Xe]),He[Be[Xe]]={"!ref":"A1"});return{SheetNames:it,Sheets:He}}function n(j,G){var H=G||{};if(+H.codepage>=0&&Jn(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var W=an(),te=at(j["!ref"]),de=Array.isArray(j),ce=[];ge(W,0,s(1030)),ge(W,6,c(te));for(var ue=Math.min(te.e.r,8191),ne=te.s.r;ne<=ue;++ne)for(var Be=Qt(ne),U=te.s.c;U<=te.e.c;++U){ne===te.s.r&&(ce[U]=Bt(U));var nt=ce[U]+Be,He=de?(j[ne]||[])[U]:j[nt];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?ge(W,13,p(ne,U,He.v)):ge(W,14,m(ne,U,He.v));else{var it=zi(He);ge(W,15,f(ne,U,it.slice(0,239)))}}return ge(W,1),W.end()}function i(j,G){var H=G||{};if(+H.codepage>=0&&Jn(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var W=an();ge(W,0,a(j));for(var te=0,de=0;te<j.SheetNames.length;++te)(j.Sheets[j.SheetNames[te]]||{})["!ref"]&&ge(W,27,he(j.SheetNames[te],de++));var ce=0;for(te=0;te<j.SheetNames.length;++te){var ue=j.Sheets[j.SheetNames[te]];if(!(!ue||!ue["!ref"])){for(var ne=at(ue["!ref"]),Be=Array.isArray(ue),U=[],nt=Math.min(ne.e.r,8191),He=ne.s.r;He<=nt;++He)for(var it=Qt(He),Xe=ne.s.c;Xe<=ne.e.c;++Xe){He===ne.s.r&&(U[Xe]=Bt(Xe));var Ee=U[Xe]+it,Lt=Be?(ue[He]||[])[Xe]:ue[Ee];if(!(!Lt||Lt.t=="z"))if(Lt.t=="n")ge(W,23,C(He,Xe,ce,Lt.v));else{var Kr=zi(Lt);ge(W,22,x(He,Xe,ce,Kr.slice(0,239)))}}++ce}}return ge(W,1),W.end()}function s(j){var G=ee(2);return G.write_shift(2,j),G}function a(j){var G=ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var H=0,W=0,te=0,de=0;de<j.SheetNames.length;++de){var ce=j.SheetNames[de],ue=j.Sheets[ce];if(!(!ue||!ue["!ref"])){++te;var ne=on(ue["!ref"]);H<ne.e.r&&(H=ne.e.r),W<ne.e.c&&(W=ne.e.c)}}return H>8191&&(H=8191),G.write_shift(2,H),G.write_shift(1,te),G.write_shift(1,W),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(j,G,H){var W={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&H.qpro?(W.s.c=j.read_shift(1),j.l++,W.s.r=j.read_shift(2),W.e.c=j.read_shift(1),j.l++,W.e.r=j.read_shift(2),W):(W.s.c=j.read_shift(2),W.s.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.e.c=j.read_shift(2),W.e.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(j){var G=ee(8);return G.write_shift(2,j.s.c),G.write_shift(2,j.s.r),G.write_shift(2,j.e.c),G.write_shift(2,j.e.r),G}function l(j,G,H){var W=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(W[0].c=j.read_shift(1),W[3]=j.read_shift(1),W[0].r=j.read_shift(2),j.l+=2):(W[2]=j.read_shift(1),W[0].c=j.read_shift(2),W[0].r=j.read_shift(2)),W}function h(j,G,H){var W=j.l+G,te=l(j,G,H);if(te[1].t="s",H.vers==20768){j.l++;var de=j.read_shift(1);return te[1].v=j.read_shift(de,"utf8"),te}return H.qpro&&j.l++,te[1].v=j.read_shift(W-j.l,"cstr"),te}function f(j,G,H){var W=ee(7+H.length);W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(1,39);for(var te=0;te<W.length;++te){var de=H.charCodeAt(te);W.write_shift(1,de>=128?95:de)}return W.write_shift(1,0),W}function d(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(2,"i"),W}function p(j,G,H){var W=ee(7);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(2,H,"i"),W}function v(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(8,"f"),W}function m(j,G,H){var W=ee(13);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(8,H,"f"),W}function _(j,G,H){var W=j.l+G,te=l(j,G,H);if(te[1].v=j.read_shift(8,"f"),H.qpro)j.l=W;else{var de=j.read_shift(2);N(j.slice(j.l,j.l+de),te),j.l+=de}return te}function b(j,G,H){var W=G&32768;return G&=-32769,G=(W?j:0)+(G>=8192?G-16384:G),(W?"":"$")+(H?Bt(G):Qt(G))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(j,G){Dr(j,0);for(var H=[],W=0,te="",de="",ce="",ue="";j.l<j.length;){var ne=j[j.l++];switch(ne){case 0:H.push(j.read_shift(8,"f"));break;case 1:de=b(G[0].c,j.read_shift(2),!0),te=b(G[0].r,j.read_shift(2),!1),H.push(de+te);break;case 2:{var Be=b(G[0].c,j.read_shift(2),!0),U=b(G[0].r,j.read_shift(2),!1);de=b(G[0].c,j.read_shift(2),!0),te=b(G[0].r,j.read_shift(2),!1),H.push(Be+U+":"+de+te)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(j.read_shift(2));break;case 6:{for(var nt="";ne=j[j.l++];)nt+=String.fromCharCode(ne);H.push('"'+nt.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:ue=H.pop(),ce=H.pop(),H.push(["AND","OR"][ne-20]+"("+ce+","+ue+")");break;default:if(ne<32&&T[ne])ue=H.pop(),ce=H.pop(),H.push(ce+T[ne]+ue);else if(S[ne]){if(W=S[ne][1],W==69&&(W=j[j.l++]),W>H.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+H.join("|")+"|");return}var He=H.slice(-W);H.length-=W,H.push(S[ne][0]+"("+He.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}H.length==1?G[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function M(j){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=j.read_shift(2),G[3]=j[j.l++],G[0].c=j[j.l++],G}function B(j,G){var H=M(j,G);return H[1].t="s",H[1].v=j.read_shift(G-4,"cstr"),H}function x(j,G,H,W){var te=ee(6+W.length);te.write_shift(2,j),te.write_shift(1,H),te.write_shift(1,G),te.write_shift(1,39);for(var de=0;de<W.length;++de){var ce=W.charCodeAt(de);te.write_shift(1,ce>=128?95:ce)}return te.write_shift(1,0),te}function w(j,G){var H=M(j,G);H[1].v=j.read_shift(2);var W=H[1].v>>1;if(H[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return H[1].v=W,H}function E(j,G){var H=M(j,G),W=j.read_shift(4),te=j.read_shift(4),de=j.read_shift(2);if(de==65535)return W===0&&te===3221225472?(H[1].t="e",H[1].v=15):W===0&&te===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ce=de&32768;return de=(de&32767)-16446,H[1].v=(1-ce*2)*(te*Math.pow(2,de+32)+W*Math.pow(2,de)),H}function C(j,G,H,W){var te=ee(14);if(te.write_shift(2,j),te.write_shift(1,H),te.write_shift(1,G),W==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var de=0,ce=0,ue=0,ne=0;return W<0&&(de=1,W=-W),ce=Math.log2(W)|0,W/=Math.pow(2,ce-31),ne=W>>>0,ne&2147483648||(W/=2,++ce,ne=W>>>0),W-=ne,ne|=2147483648,ne>>>=0,W*=Math.pow(2,32),ue=W>>>0,te.write_shift(4,ue),te.write_shift(4,ne),ce+=16383+(de?32768:0),te.write_shift(2,ce),te}function k(j,G){var H=E(j,14);return j.l+=G-14,H}function A(j,G){var H=M(j,G),W=j.read_shift(4);return H[1].v=W>>6,H}function R(j,G){var H=M(j,G),W=j.read_shift(8,"f");return H[1].v=W,H}function oe(j,G){var H=R(j,14);return j.l+=G-10,H}function se(j,G){return j[j.l+G-1]==0?j.read_shift(G,"cstr"):""}function Se(j,G){var H=j[j.l++];H>G-1&&(H=G-1);for(var W="";W.length<H;)W+=String.fromCharCode(j[j.l++]);return W}function _e(j,G,H){if(!(!H.qpro||G<21)){var W=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var te=j.read_shift(G-21,"cstr");return[W,te]}}function Re(j,G){for(var H={},W=j.l+G;j.l<W;){var te=j.read_shift(2);if(te==14e3){for(H[te]=[0,""],H[te][0]=j.read_shift(2);j[j.l];)H[te][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return H}function he(j,G){var H=ee(5+j.length);H.write_shift(2,14e3),H.write_shift(2,G);for(var W=0;W<j.length;++W){var te=j.charCodeAt(W);H[H.l++]=te>127?95:te}return H[H.l++]=0,H}var Ie={0:{n:"BOF",f:sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:Se},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:k},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Re},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function FO(t){var e={},r=t.match(Wr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ve(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Am[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var OO=function(){var t=eu("t"),e=eu("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:st(a[1])},c=s.match(e);return c&&(o.s=FO(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),NO=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),MO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,LO=/<(?:\w+:)?r>/,VO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function eg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=st(wt(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=wt(t),r&&(n.h=Mm(n.t))):t.match(LO)&&(n.r=wt(t),n.t=st(wt((t.replace(VO,"").match(MO)||[]).join("").replace(Wr,""))),r&&(n.h=NO(OO(n.r)))),n):{t:""}}var BO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,UO=/<(?:\w+:)?(?:si|sstItem)>/g,jO=/<\/(?:\w+:)?(?:si|sstItem)>/;function WO(t,e){var r=[],n="";if(!t)return r;var i=t.match(BO);if(i){n=i[2].replace(UO,"").split(jO);for(var s=0;s!=n.length;++s){var a=eg(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Ve(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var $O=/^\s|\s$|[\t\n\r]/;function UT(t,e){if(!e.bookSST)return"";var r=[Jt];r[r.length]=me("sst",null,{xmlns:Ia[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match($O)&&(s+=' xml:space="preserve"'),s+=">"+vt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function HO(t){return[t.read_shift(4),t.read_shift(4)]}function zO(t,e){var r=[],n=!1;return qi(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function GO(t,e){return e||(e=ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var qO=nP;function KO(t){var e=an();ie(e,159,GO(t));for(var r=0;r<t.length;++r)ie(e,19,qO(t[r]));return ie(e,160),e.end()}function jT(t){if(typeof pt<"u")return pt.utils.encode(Wo,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Hi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function XO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Hi(t,4),e.U=Hi(t,4),e.W=Hi(t,4),e}function YO(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function QO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(YO(t));return e}function JO(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function ZO(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Hi(t,4),e.U=Hi(t,4),e.W=Hi(t,4),e}function eN(t){var e=ZO(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function WT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function $T(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function tN(t){var e=Hi(t);switch(e.Minor){case 2:return[e.Minor,rN(t,e)];case 3:return[e.Minor,nN(t,e)];case 4:return[e.Minor,iN(t,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function rN(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=WT(t,r),i=$T(t,t.length-t.l);return{t:"Std",h:n,v:i}}function nN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function iN(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Wr,function(s){var a=Ve(s);switch(wi(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function sN(t,e){var r={},n=r.EncryptionVersionInfo=Hi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=WT(t,i),e-=i,r.EncryptionVerifier=$T(t,e),r}function aN(t){var e={},r=e.EncryptionVersionInfo=Hi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function tg(t){var e=0,r,n=jT(t),i=n.length+1,s,a,o,c,l;for(r=Is(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var HT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var h=a[l],f=0;f!=7;++f)h&64&&(o^=r[c]),h*=2,--c;return o};return function(a){for(var o=jT(a),c=s(o),l=o.length,h=Is(16),f=0;f!=16;++f)h[f]=0;var d,p,v;for((l&1)===1&&(d=c>>8,h[l]=i(t[0],d),--l,d=c&255,p=o[o.length-1],h[l]=i(p,d));l>0;)--l,d=c>>8,h[l]=i(o[l],d),--l,d=c&255,h[l]=i(o[l],d);for(l=15,v=15-o.length;v>0;)d=c>>8,h[l]=i(t[v],d),--l,--v,d=c&255,h[l]=i(o[l],d),--l,--v;return h}}(),oN=function(t,e,r,n,i){i||(i=e),n||(n=HT(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},cN=function(t){var e=0,r=HT(t);return function(n){var i=oN("",n,e,r);return e=i[1],i[0]}};function lN(t,e,r,n){var i={key:sr(t),verificationBytes:sr(t)};return r.password&&(i.verifier=tg(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=cN(r.password)),i}function uN(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=aN(t,e):n.Data=sN(t,e),n}function hN(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?uN(t,e-2,n):lN(t,r.biff>=8?e:e-2,r,n),n}var zT=function(){function t(i,s){switch(s.type){case"base64":return e(xn(i),s);case"binary":return e(i,s);case"buffer":return e(Ye&&Buffer.isBuffer(i)?i.toString("binary"):ks(i),s);case"array":return e(xa(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,p=0,v,m=-1;v=d.exec(h);){switch(v[0]){case"\\cell":var _=h.slice(p,d.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var b={v:_,t:"s"};Array.isArray(o)?o[f][m]=b:o[Me({r:f,c:m})]=b}break}p=d.lastIndex}m>l.e.c&&(l.e.c=m)}),o["!ref"]=$e(l),o}function r(i,s){return Ds(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=at(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Me({r:l,c:h});o=c?(i[l]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(zi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function fN(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function iu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function dN(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function pN(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function Ff(t,e){if(e===0)return t;var r=dN(fN(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),iu(pN(r))}var GT=6,mN=15,gN=1,Lr=GT;function su(t){return Math.floor((t+Math.round(128/Lr)/256)*Lr)}function au(t){return Math.floor((t-5)/Lr*100+.5)/100}function Of(t){return Math.round((t*Lr+5)/Lr*256)/256}function sm(t){return Of(au(su(t)))}function rg(t){var e=Math.abs(t-sm(t)),r=Lr;if(e>.005)for(Lr=gN;Lr<mN;++Lr)Math.abs(t-sm(t))<=e&&(e=Math.abs(t-sm(t)),r=Lr);Lr=r}function As(t){t.width?(t.wpx=su(t.width),t.wch=au(t.wpx),t.MDW=Lr):t.wpx?(t.wch=au(t.wpx),t.width=Of(t.wch),t.MDW=Lr):typeof t.wch=="number"&&(t.width=Of(t.wch),t.wpx=su(t.width),t.MDW=Lr),t.customWidth&&delete t.customWidth}var vN=96,qT=vN;function ou(t){return t*96/qT}function zo(t){return t*qT/96}var _N={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yN(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Wr)||[]).forEach(function(a){var o=Ve(a);switch(wi(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Rt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Rt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function xN(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Wr)||[]).forEach(function(a){var o=Ve(a);switch(wi(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function wN(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Wr)||[]).forEach(function(a){var o=Ve(a);switch(wi(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=wt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Rt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Rt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Rt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Rt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Rt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Rt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Rt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Am[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Rt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=ma[i.color.index];i.color.index==81&&(c=ma[1]),c||(c=ma[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Ff(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function EN(t,e,r){e.NumberFmt=[];for(var n=Gt(Pe),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Pe[n[i]];var s=t[0].match(Wr);if(s)for(i=0;i<s.length;++i){var a=Ve(s[i]);switch(wi(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=st(wt(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}$i(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function TN(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=me("numFmt",null,{numFmtId:n,formatCode:vt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=me("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var xf=["numFmtId","fillId","fontId","borderId","xfId"],wf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function bN(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Wr)||[]).forEach(function(s){var a=Ve(s),o=0;switch(wi(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<xf.length;++o)n[xf[o]]&&(n[xf[o]]=parseInt(n[xf[o]],10));for(o=0;o<wf.length;++o)n[wf[o]]&&(n[wf[o]]=Rt(n[wf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Rt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function IN(t){var e=[];return e[e.length]=me("cellXfs",null),t.forEach(function(r){e[e.length]=me("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=me("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var AN=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&EN(f,h,l),(f=o.match(i))&&wN(f,h,c,l),(f=o.match(n))&&xN(f,h,c,l),(f=o.match(s))&&yN(f,h,c,l),(f=o.match(r))&&bN(f,h,l),h}}();function KT(t,e){var r=[Jt,me("styleSheet",null,{xmlns:Ia[0],"xmlns:vt":ur.vt})],n;return t.SSF&&(n=TN(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=IN(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SN(t,e){var r=t.read_shift(2),n=Ur(t,e-2);return[r,n]}function CN(t,e,r){r||(r=ee(6+4*e.length)),r.write_shift(2,t),xr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function kN(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=uP(t,2,r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=lP(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ur(t,e-21),n}function DN(t,e){e||(e=ee(25+4*32)),e.write_shift(2,t.sz*20),hP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Df(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),xr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var RN=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],am,PN=jr;function fE(t,e){e||(e=ee(4*3+8*7+16*1)),am||(am=Bf(RN));var r=am[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Df({auto:1},e),Df({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function FN(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function XT(t,e,r){r||(r=ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Bl(t,e){return e||(e=ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var ON=jr;function NN(t,e){return e||(e=ee(51)),e.write_shift(1,0),Bl(null,e),Bl(null,e),Bl(null,e),Bl(null,e),Bl(null,e),e.length>e.l?e.slice(0,e.l):e}function MN(t,e){return e||(e=ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),kf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function LN(t,e,r){var n=ee(2052);return n.write_shift(4,t),kf(e,n),kf(r,n),n.length>n.l?n.slice(0,n.l):n}function VN(t,e,r){var n={};n.NumberFmt=[];for(var i in Pe)n.NumberFmt[i]=Pe[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return qi(t,function(c,l,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],$i(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Ff(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(h),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(h);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function BN(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ie(t,615,ti(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ie(t,44,CN(i,e[i]))}),ie(t,616))}}function UN(t){var e=1;e!=0&&(ie(t,611,ti(e)),ie(t,43,DN({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ie(t,612))}function jN(t){var e=2;e!=0&&(ie(t,603,ti(e)),ie(t,45,fE({patternType:"none"})),ie(t,45,fE({patternType:"gray125"})),ie(t,604))}function WN(t){var e=1;e!=0&&(ie(t,613,ti(e)),ie(t,46,NN({})),ie(t,614))}function $N(t){var e=1;ie(t,626,ti(e)),ie(t,47,XT({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ie(t,627)}function HN(t,e){ie(t,617,ti(e.length)),e.forEach(function(r){ie(t,47,XT(r,0))}),ie(t,618)}function zN(t){var e=1;ie(t,619,ti(e)),ie(t,48,MN({xfId:0,builtinId:0,name:"Normal"})),ie(t,620)}function GN(t){var e=0;ie(t,505,ti(e)),ie(t,506)}function qN(t){var e=0;ie(t,508,LN(e,"TableStyleMedium9","PivotStyleMedium4")),ie(t,509)}function KN(t,e){var r=an();return ie(r,278),BN(r,t.SSF),UN(r,t),jN(r,t),WN(r,t),$N(r,t),HN(r,e.cellXfs),zN(r,t),GN(r,t),qN(r,t),ie(r,279),r.end()}var XN=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function YN(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Wr)||[]).forEach(function(i){var s=Ve(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[XN.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function QN(){}function JN(){}var ZN=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,eM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,tM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function rM(t,e,r){e.themeElements={};var n;[["clrScheme",ZN,YN],["fontScheme",eM,QN],["fmtScheme",tM,JN]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var nM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function YT(t,e){(!t||t.length===0)&&(t=ng());var r,n={};if(!(r=t.match(nM)))throw new Error("themeElements not found in theme");return rM(r[0],n,e),n.raw=t,n}function ng(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Jt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function iM(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=qE(s,{type:"array"})}catch{return}var o=yn(a,"theme/theme/theme1.xml",!0);if(o)return YT(o,r)}}function sM(t){return t.read_shift(4)}function aM(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=oM(t,4);break;case 2:e.xclrValue=kT(t,4);break;case 3:e.xclrValue=sM(t,4);break;case 4:t.l+=4;break}return t.l+=8,e}function oM(t,e){return jr(t,e)}function cM(t,e){return jr(t,e)}function lM(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=aM(t,r);break;case 6:n[1]=cM(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function uM(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(lM(t,r-t.l));return{ixfe:n,ext:s}}function hM(t,e){e.forEach(function(r){switch(r[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function fM(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:Ur(t,e-8)}}function dM(t){var e=ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),xr(t.name,e),e.slice(0,e.l)}function pM(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function mM(t){var e=ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function gM(t,e){var r=ee(8+2*e.length);return r.write_shift(4,t),xr(e,r),r.slice(0,r.l)}function vM(t){return t.l+=4,t.read_shift(4)!=0}function _M(t,e){var r=ee(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function yM(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return qi(t,function(c,l,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(h),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function xM(){var t=an();return ie(t,332),ie(t,334,ti(1)),ie(t,335,dM({name:"XLDAPR",version:12e4,flags:3496657072})),ie(t,336),ie(t,339,gM(1,"XLDAPR")),ie(t,52),ie(t,35,ti(514)),ie(t,4096,ti(0)),ie(t,4097,Vn(1)),ie(t,36),ie(t,53),ie(t,340),ie(t,337,_M(1,!0)),ie(t,51,mM([[1,0]])),ie(t,338),ie(t,333),t.end()}function wM(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Wr,function(o){var c=Ve(o);switch(wi(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function QT(){var t=[Jt];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function EM(t){var e=[];if(!t)return e;var r=1;return(t.match(Wr)||[]).forEach(function(n){var i=Ve(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function TM(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Me(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function bM(t,e,r){var n=[],i=!1;return qi(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function IM(t,e,r,n){if(!t)return t;var i=n||{},s=!1,a=!1;qi(t,function(c,l,h){if(!a)switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function AM(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Lo=1024;function JT(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[me("xml",null,{"xmlns:v":vn.v,"xmlns:o":vn.o,"xmlns:x":vn.x,"xmlns:mv":vn.mv}).replace(/\/>/,">"),me("o:shapelayout",me("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),me("v:shapetype",[me("v:stroke",null,{joinstyle:"miter"}),me("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Lo<t*1e3;)Lo+=1e3;return e.forEach(function(s){var a=Ut(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?me("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=me("v:fill",c,o),h={on:"t",obscured:"t"};++Lo,i=i.concat(["<v:shape"+tu({id:"_x0000_s"+Lo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,me("v:shadow",null,h),me("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Rr("x:AutoFill","False"),Rr("x:Row",String(a.r)),Rr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function dE(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Ut(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var c=at(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=$e(c);l!==t["!ref"]&&(t["!ref"]=l)}s.c||(s.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function SM(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ve(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ut(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&eg(f[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function ZT(t){var e=[Jt,me("comments",null,{xmlns:Ia[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=vt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(vt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Rr("t",vt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Rr("t",vt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function CM(t,e){var r=[],n=!1,i={},s=0;return t.replace(Wr,function(o,c){var l=Ve(o);switch(wi(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function kM(t,e,r){var n=[Jt,me("ThreadedComments",null,{xmlns:ur.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(me("threadedComment",Rr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function DM(t,e){var r=[],n=!1;return t.replace(Wr,function(s){var a=Ve(s);switch(wi(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function RM(t){var e=[Jt,me("personList",null,{xmlns:ur.TCMNT,"xmlns:x":Ia[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(me("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function PM(t){var e={};e.iauthor=t.read_shift(4);var r=ka(t,16);return e.rfx=r.s,e.ref=Me(r.s),t.l+=16,e}function FM(t,e){return e==null&&(e=ee(36)),e.write_shift(4,t[1].iauthor),Yo(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var OM=Ur;function NM(t){return xr(t.slice(0,54))}function MM(t,e){var r=[],n=[],i={},s=!1;return qi(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function LM(t){var e=an(),r=[];return ie(e,628),ie(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ie(e,632,NM(i.a)))})}),ie(e,631),ie(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Ut(n[0]),e:Ut(n[0])};ie(e,635,FM([s,i])),i.t&&i.t.length>0&&ie(e,637,sP(i)),ie(e,636),delete i.iauthor})}),ie(e,634),ie(e,629),e.end()}var VM="application/vnd.ms-office.vbaProject";function BM(t){var e=ke.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");ke.utils.cfb_add(e,i,t.FileIndex[n].content)}}),ke.write(e)}function UM(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&ke.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var eb=["xlsb","xlsm","xlam","biff8","xla"];function jM(){return{"!type":"dialog"}}function WM(){return{"!type":"dialog"}}function $M(){return{"!type":"macro"}}function HM(){return{"!type":"macro"}}var Uo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,c?l+=e.r:--l,i+(o?"":"$")+Bt(h)+(c?"":"$")+Qt(l)}return function(i,s){return e=s,i.replace(t,r)}}(),ig=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sg=function(){return function(e,r){return e.replace(ig,function(n,i,s,a,o,c){var l=zm(a)-(s?0:r.c),h=Hm(c)-(o?0:r.r),f=h==0?"":o?h+1:"["+h+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+f+"C"+d})}}();function tb(t,e){return t.replace(ig,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Bt(zm(s)+e.c))+(a=="$"?a+o:Qt(Hm(o)+e.r))})}function zM(t,e,r){var n=on(e),i=n.s,s=Ut(r),a={r:s.r-i.r,c:s.c-i.c};return tb(t,a)}function GM(t){return t.length!=1}function pE(t){return t.replace(/_xlfn\./g,"")}function nr(t){t.l+=1}function Ss(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function rb(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return nb(t,e,r);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Ss(t,2),o=Ss(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function nb(t){var e=Ss(t,2),r=Ss(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function qM(t,e,r){if(r.biff<8)return nb(t,e,r);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Ss(t,2),a=Ss(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function ib(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return KM(t,e,r);var n=t.read_shift(r&&r.biff==12?4:2),i=Ss(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function KM(t){var e=Ss(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function XM(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function YM(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return QM(t,e,r);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function QM(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function JM(t,e,r){var n=(t[t.l++]&96)>>5,i=rb(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function ZM(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=rb(t,s,r);return[n,i,a]}function e4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function t4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function r4(t,e,r){var n=(t[t.l++]&96)>>5,i=qM(t,e-1,r);return[n,i]}function n4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function mE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function i4(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function s4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function a4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function o4(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function c4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function sb(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function l4(t){return t.read_shift(2),sb(t,2)}function u4(t){return t.read_shift(2),sb(t,2)}function h4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ib(t,0,r);return[n,i]}function f4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=YM(t,0,r);return[n,i]}function d4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=ib(t,0,r);return[n,i,s]}function p4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[vL[i],cb[i],n]}function m4(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:g4(t);return[i,(s[0]===0?cb:gL)[s[1]]]}function g4(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function v4(t,e,r){t.l+=r&&r.biff==2?3:4}function _4(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function y4(t){return t.l++,Ki[t.read_shift(1)]}function x4(t){return t.l++,t.read_shift(2)}function w4(t){return t.l++,t.read_shift(1)!==0}function E4(t){return t.l++,Vr(t,8)}function T4(t,e,r){return t.l++,fu(t,e-1,r)}function b4(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Yt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Ki[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Vr(t,8);break;case 2:r[1]=Da(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function I4(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?ka:$f)(t,8));return i}function A4(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=b4(t,r.biff);return a}function S4(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function C4(t,e,r){if(r.biff==5)return k4(t,e,r);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function k4(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function D4(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function R4(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function P4(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function F4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var O4=jr,N4=jr,M4=jr;function pu(t,e,r){return t.l+=2,[XM(t,4,r)]}function ag(t){return t.l+=6,[]}var L4=pu,V4=ag,B4=ag,U4=pu;function ab(t){return t.l+=2,[sr(t),t.read_shift(2)&1]}var j4=pu,W4=ab,$4=ag,H4=pu,z4=pu,G4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function q4(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=G4[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function K4(t){return t.l+=2,[t.read_shift(4)]}function X4(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Y4(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Q4(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function J4(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Z4(t){return t.l+=4,[0,0]}var gE={1:{n:"PtgExp",f:_4},2:{n:"PtgTbl",f:M4},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:T4},26:{n:"PtgSheet",f:X4},27:{n:"PtgEndSheet",f:Y4},28:{n:"PtgErr",f:y4},29:{n:"PtgBool",f:w4},30:{n:"PtgInt",f:x4},31:{n:"PtgNum",f:E4},32:{n:"PtgArray",f:n4},33:{n:"PtgFunc",f:p4},34:{n:"PtgFuncVar",f:m4},35:{n:"PtgName",f:S4},36:{n:"PtgRef",f:h4},37:{n:"PtgArea",f:JM},38:{n:"PtgMemArea",f:D4},39:{n:"PtgMemErr",f:O4},40:{n:"PtgMemNoMem",f:N4},41:{n:"PtgMemFunc",f:R4},42:{n:"PtgRefErr",f:P4},43:{n:"PtgAreaErr",f:e4},44:{n:"PtgRefN",f:f4},45:{n:"PtgAreaN",f:r4},46:{n:"PtgMemAreaN",f:Q4},47:{n:"PtgMemNoMemN",f:J4},57:{n:"PtgNameX",f:C4},58:{n:"PtgRef3d",f:d4},59:{n:"PtgArea3d",f:ZM},60:{n:"PtgRefErr3d",f:F4},61:{n:"PtgAreaErr3d",f:t4},255:{}},eL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tL={1:{n:"PtgElfLel",f:ab},2:{n:"PtgElfRw",f:H4},3:{n:"PtgElfCol",f:L4},6:{n:"PtgElfRwV",f:z4},7:{n:"PtgElfColV",f:U4},10:{n:"PtgElfRadical",f:j4},11:{n:"PtgElfRadicalS",f:$4},13:{n:"PtgElfColS",f:V4},15:{n:"PtgElfColSV",f:B4},16:{n:"PtgElfRadicalLel",f:W4},25:{n:"PtgList",f:q4},29:{n:"PtgSxName",f:K4},255:{}},rL={0:{n:"PtgAttrNoop",f:Z4},1:{n:"PtgAttrSemi",f:c4},2:{n:"PtgAttrIf",f:a4},4:{n:"PtgAttrChoose",f:i4},8:{n:"PtgAttrGoto",f:s4},16:{n:"PtgAttrSum",f:v4},32:{n:"PtgAttrBaxcel",f:mE},33:{n:"PtgAttrBaxcel",f:mE},64:{n:"PtgAttrSpace",f:l4},65:{n:"PtgAttrSpaceSemi",f:u4},128:{n:"PtgAttrIfError",f:o4},255:{}};function mu(t,e,r,n){if(n.biff<8)return jr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=A4(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=I4(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0];default:break}return e=i-t.l,e!==0&&s.push(jr(t,e)),s}function gu(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=gE[s]||gE[eL[s]],(s===24||s===25)&&(i=(s===24?tL:rL)[t[t.l+1]]),!i||!i.f?jr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function nL(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var iL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function sL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ob(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function vE(t,e,r){var n=ob(t,e,r);return n=="#REF"?n:sL(n,r)}function Mr(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,h,f=0,d=0,p,v="";if(!t[0]||!t[0][0])return"";for(var m=-1,_="",b=0,S=t[0].length;b<S;++b){var T=t[0][b];switch(T[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:_=$t(" ",t[0][m][1][1]);break;case 1:_=$t("\r",t[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}l=l+_,m=-1}o.push(l+iL[T[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Hl(T[1][1],a,i),o.push(zl(h,s));break;case"PtgRefN":h=r?Hl(T[1][1],r,i):T[1][1],o.push(zl(h,s));break;case"PtgRef3d":f=T[1][1],h=Hl(T[1][2],a,i),v=vE(n,f,i);var N=v;o.push(v+"!"+zl(h,s));break;case"PtgFunc":case"PtgFuncVar":var M=T[1][0],B=T[1][1];M||(M=0),M&=127;var x=M==0?[]:o.slice(-M);o.length-=M,B==="User"&&(B=x.shift()),o.push(B+"("+x.join(",")+")");break;case"PtgBool":o.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(T[1]);break;case"PtgNum":o.push(String(T[1]));break;case"PtgStr":o.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(T[1]);break;case"PtgAreaN":p=Gw(T[1][1],r?{s:r}:a,i),o.push(rm(p,i));break;case"PtgArea":p=Gw(T[1][1],a,i),o.push(rm(p,i));break;case"PtgArea3d":f=T[1][1],p=T[1][2],v=vE(n,f,i),o.push(v+"!"+rm(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=T[1][2];var w=(n.names||[])[d-1]||(n[0]||[])[d],E=w?w.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var C=T[1][1];d=T[1][2];var k;if(i.biff<=5)C<0&&(C=-C),n[C]&&(k=n[C][d]);else{var A="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(A=n.SheetNames[n[C][d].itab-1]+"!"):A=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])A+=n[C][d].Name;else if(n[0]&&n[0][d])A+=n[0][d].Name;else{var R=(ob(n,C,i)||"").split(";;");R[d-1]?A=R[d-1]:A+="SH33TJSERRX"}o.push(A);break}k||(k={Name:"SH33TJSERRY"}),o.push(k.Name);break;case"PtgParen":var oe="(",se=")";if(m>=0){switch(_="",t[0][m][1][0]){case 2:oe=$t(" ",t[0][m][1][1])+oe;break;case 3:oe=$t("\r",t[0][m][1][1])+oe;break;case 4:se=$t(" ",t[0][m][1][1])+se;break;case 5:se=$t("\r",t[0][m][1][1])+se;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(oe+o.pop()+se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:T[1][1],r:T[1][0]};var Se={c:r.c,r:r.r};if(n.sharedf[Me(h)]){var _e=n.sharedf[Me(h)];o.push(Mr(_e,a,Se,n,i))}else{var Re=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push(Mr(l[1],a,Se,n,i)),Re=!0;break}Re||o.push(T[1])}break;case"PtgArray":o.push("{"+nL(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var he=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&he.indexOf(t[0][b][0])==-1){T=t[0][m];var Ie=!0;switch(T[1][0]){case 4:Ie=!1;case 0:_=$t(" ",T[1][1]);break;case 5:Ie=!1;case 1:_=$t("\r",T[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}o.push((Ie?_:"")+o.pop()+(Ie?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function aL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],jr(t,e-2)];var o=gu(t,a,r);return e!==a+i&&(s=mu(t,e-a-i,o,r)),t.l=n,[o,s]}function oL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],jr(t,e-2)];var o=gu(t,a,r);return e!==a+i&&(s=mu(t,e-a-i,o,r)),t.l=n,[o,s]}function cL(t,e,r,n){var i=t.l+e,s=gu(t,n,r),a;return i!==t.l&&(a=mu(t,i-t.l,s,r)),[s,a]}function lL(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=gu(t,s,r);return s==65535?[[],jr(t,e-2)]:(e!==s+2&&(i=mu(t,n-s-2,a,r)),[a,i])}function uL(t){var e;if(ji(t,t.l+6)!==65535)return[Vr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function hL(t){if(t==null){var e=ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return wa(t);return wa(0)}function om(t,e,r){var n=t.l+e,i=Ei(t,6);r.biff==2&&++t.l;var s=uL(t,8),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=oL(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function fL(t,e,r,n,i){var s=Ta(e,r,i),a=hL(t.v),o=ee(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=ee(t.bf.length),h=0;h<t.bf.length;++h)l[h]=t.bf[h];var f=yr([s,a,o,l]);return f}function Hf(t,e,r){var n=t.read_shift(4),i=gu(t,n,r),s=t.read_shift(4),a=s>0?mu(t,s,i,r):null;return[i,a]}var dL=Hf,zf=Hf,pL=Hf,mL=Hf,gL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},cb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _E(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function _L(t){var e="of:="+t.replace(ig,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function cm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function yL(t){return t.replace(/\./,"!")}var ql={},jo={},Kl=typeof Map<"u";function og(t,e,r){var n=0,i=t.length;if(r){if(Kl?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Kl?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Kl?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Gf(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Lr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=au(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Of(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function _a(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Rs(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){$i(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function lb(t,e,r,n,i,s){try{n.cellNF&&(t.z=Pe[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Pt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Pe[e]==null&&$i(gR[e]||"General",e),t.t==="e")t.w=t.w||Ki[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zl(t.v);else if(t.t==="d"){var a=hr(t.v);(a|0)===a?t.w=a.toString(10):t.w=Zl(a)}else{if(t.v===void 0)return"";t.w=ya(t.v,jo)}else t.t==="d"?t.w=Un(e,hr(t.v),jo):t.w=Un(e,t.v,jo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Ff(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Ff(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function xL(t,e,r){if(t&&t["!ref"]){var n=at(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function wL(t,e){var r=at(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=$e(r))}var EL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,TL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,bL=/<(?:\w:)?hyperlink [^>]*>/mg,IL=/"(\w*:\w*)"/,AL=/<(?:\w:)?col\b[^>]*[\/]?>/g,SL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,CL=/<(?:\w:)?pageMargins[^>]*\/>/g,ub=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,DL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function RL(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}}),zt!=null&&e.dense==null&&(e.dense=zt);var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",h="",f=t.match(TL);f?(l=t.slice(0,f.index),h=t.slice(f.index+f[0].length)):l=h=t;var d=l.match(ub);d?cg(d[0],o,i,r):(d=l.match(kL))&&FL(d[0],d[1]||"",o,i,r,a,s);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=l.slice(p,p+50).match(IL);v&&wL(o,v[1])}var m=l.match(DL);m&&m[1]&&GL(m[1],i);var _=[];if(e.cellStyles){var b=l.match(AL);b&&jL(_,b)}f&&XL(f[1],o,e,c,s,a);var S=h.match(SL);S&&(o["!autofilter"]=$L(S[0]));var T=[],N=h.match(EL);if(N)for(p=0;p!=N.length;++p)T[p]=at(N[p].slice(N[p].indexOf('"')+1));var M=h.match(bL);M&&VL(o,M,n);var B=h.match(CL);if(B&&(o["!margins"]=BL(Ve(B[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=$e(c)),e.sheetRows>0&&o["!ref"]){var x=at(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>c.e.r&&(x.e.r=c.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>c.e.c&&(x.e.c=c.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(x))}return _.length>0&&(o["!cols"]=_),T.length>0&&(o["!merges"]=T),o}function PL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+$e(t[r])+'"/>';return e+"</mergeCells>"}function cg(t,e,r,n){var i=Ve(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=st(wt(i.codeName)))}function FL(t,e,r,n,i){cg(t.slice(0,t.indexOf(">")),r,n,i)}function OL(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=yi(vt(c))}if(t&&t["!outline"]){var l={summaryBelow:1,summaryRight:1};t["!outline"].above&&(l.summaryBelow=0),t["!outline"].left&&(l.summaryRight=0),o=(o||"")+me("outlinePr",null,l)}!s&&!o||(i[i.length]=me("sheetPr",o,a))}var NL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],ML=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function LL(t){var e={sheet:1};return NL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),ML.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=tg(t.password).toString(16).toUpperCase()),me("sheetProtection",null,e)}function VL(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Ve(wt(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+st(s.location))):(s.Target="#"+st(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=at(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var h=Me({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=s):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=s)}}}function BL(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function UL(t){return _a(t),me("pageMargins",null,t)}function jL(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ve(e[n],!0);i.hidden&&(i.hidden=Rt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,rg(i.width)),As(i);s<=a;)t[s++]=Ft(i)}}function WL(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=me("col",null,Gf(i,n)));return r[r.length]="</cols>",r.join("")}function $L(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function HL(t,e,r,n){var i=typeof t.ref=="string"?t.ref:$e(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=on(i);a.s.r==a.e.r&&(a.e.r=on(e["!ref"]).e.r,i=$e(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),me("autoFilter",null,{ref:i})}var zL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function GL(t,e){e.Views||(e.Views=[{}]),(t.match(zL)||[]).forEach(function(r,n){var i=Ve(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Rt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function qL(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),me("sheetViews",me("sheetView",null,i),{})}function KL(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Ki[t.v];break;case"d":n&&n.cellDates?i=Pt(t.v,-1).toISOString():(t=Ft(t),t.t="n",i=""+(t.v=hr(Pt(t.v)))),typeof t.z>"u"&&(t.z=Pe[14]);break;default:i=t.v;break}var o=Rr("v",vt(i)),c={r:e},l=Rs(n.cellXfs,t,n);switch(l!==0&&(c.s=l),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Rr("v",""+og(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=me("f",vt(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),me("c",o,c)}var XL=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=eu("v"),a=eu("f");return function(c,l,h,f,d,p){for(var v=0,m="",_=[],b=[],S=0,T=0,N=0,M="",B,x,w=0,E=0,C,k,A=0,R=0,oe=Array.isArray(p.CellXf),se,Se=[],_e=[],Re=Array.isArray(l),he=[],Ie={},re=!1,j=!!h.sheetStubs,G=c.split(e),H=0,W=G.length;H!=W;++H){m=G[H].trim();var te=m.length;if(te!==0){var de=0;e:for(v=0;v<te;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(x=Ve(m.slice(de,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,h.sheetRows&&h.sheetRows<w)continue;Ie={},re=!1,x.ht&&(re=!0,Ie.hpt=parseFloat(x.ht),Ie.hpx=zo(Ie.hpt)),x.hidden=="1"&&(re=!0,Ie.hidden=!0),x.outlineLevel!=null&&(re=!0,Ie.level=+x.outlineLevel),re&&(he[w-1]=Ie)}break;case"<":de=v;break}if(de>=v)break;if(x=Ve(m.slice(de,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,!(h.sheetRows&&h.sheetRows<w)){f.s.r>w-1&&(f.s.r=w-1),f.e.r<w-1&&(f.e.r=w-1),h&&h.cellStyles&&(Ie={},re=!1,x.ht&&(re=!0,Ie.hpt=parseFloat(x.ht),Ie.hpx=zo(Ie.hpt)),x.hidden=="1"&&(re=!0,Ie.hidden=!0),x.outlineLevel!=null&&(re=!0,Ie.level=+x.outlineLevel),re&&(he[w-1]=Ie)),_=m.slice(v).split(t);for(var ce=0;ce!=_.length&&_[ce].trim().charAt(0)=="<";++ce);for(_=_.slice(ce),v=0;v!=_.length;++v)if(m=_[v].trim(),m.length!==0){if(b=m.match(r),S=v,T=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,b!=null&&b.length===2){for(S=0,M=b[1],T=0;T!=M.length&&!((N=M.charCodeAt(T)-64)<1||N>26);++T)S=26*S+N;--S,E=S}else++E;for(T=0;T!=m.length&&m.charCodeAt(T)!==62;++T);if(++T,x=Ve(m.slice(0,T),!0),x.r||(x.r=Me({r:w-1,c:E})),M=m.slice(T),B={t:""},(b=M.match(s))!=null&&b[1]!==""&&(B.v=st(b[1])),h.cellFormula){if((b=M.match(a))!=null&&b[1]!==""){if(B.f=st(wt(b[1])).replace(/\r\n/g,`
`),h.xlfn||(B.f=pE(B.f)),b[0].indexOf('t="array"')>-1)B.F=(M.match(i)||[])[1],B.F.indexOf(":")>-1&&Se.push([at(B.F),B.F]);else if(b[0].indexOf('t="shared"')>-1){k=Ve(b[0]);var ue=st(wt(b[1]));h.xlfn||(ue=pE(ue)),_e[parseInt(k.si,10)]=[k,ue,x.r]}}else(b=M.match(/<f[^>]*\/>/))&&(k=Ve(b[0]),_e[k.si]&&(B.f=zM(_e[k.si][1],_e[k.si][2],x.r)));var ne=Ut(x.r);for(T=0;T<Se.length;++T)ne.r>=Se[T][0].s.r&&ne.r<=Se[T][0].e.r&&ne.c>=Se[T][0].s.c&&ne.c<=Se[T][0].e.c&&(B.F=Se[T][1])}if(x.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=x.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else C=ql[parseInt(B.v,10)],B.v=C.t,B.r=C.r,h.cellHTML&&(B.h=C.h);break;case"str":B.t="s",B.v=B.v!=null?wt(B.v):"",h.cellHTML&&(B.h=Mm(B.v));break;case"inlineStr":b=M.match(n),B.t="s",b!=null&&(C=eg(b[1]))?(B.v=C.t,h.cellHTML&&(B.h=C.h)):B.v="";break;case"b":B.v=Rt(B.v);break;case"d":h.cellDates?B.v=Pt(B.v,1):(B.v=hr(Pt(B.v,1)),B.t="n");break;case"e":(!h||h.cellText!==!1)&&(B.w=B.v),B.v=fT[B.v];break}if(A=R=0,se=null,oe&&x.s!==void 0&&(se=p.CellXf[x.s],se!=null&&(se.numFmtId!=null&&(A=se.numFmtId),h.cellStyles&&se.fillId!=null&&(R=se.fillId))),lb(B,A,R,h,d,p),h.cellDates&&oe&&B.t=="n"&&Go(Pe[A])&&(B.t="d",B.v=jf(B.v)),x.cm&&h.xlmeta){var Be=(h.xlmeta.Cell||[])[+x.cm-1];Be&&Be.type=="XLDAPR"&&(B.D=!0)}if(Re){var U=Ut(x.r);l[U.r]||(l[U.r]=[]),l[U.r][U.c]=B}else l[x.r]=B}}}}he.length>0&&(l["!rows"]=he)}}();function YL(t,e,r,n){var i=[],s=[],a=at(t["!ref"]),o="",c,l="",h=[],f=0,d=0,p=t["!rows"],v=Array.isArray(t),m={r:l},_,b=-1;for(d=a.s.c;d<=a.e.c;++d)h[d]=Bt(d);for(f=a.s.r;f<=a.e.r;++f){for(s=[],l=Qt(f),d=a.s.c;d<=a.e.c;++d){c=h[d]+l;var S=v?(t[f]||[])[d]:t[c];S!==void 0&&(o=KL(S,c,t,e,r,n))!=null&&s.push(o)}(s.length>0||p&&p[f])&&(m={r:l},p&&p[f]&&(_=p[f],_.hidden&&(m.hidden=1),b=-1,_.hpx?b=ou(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(m.ht=b,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),i[i.length]=me("row",s.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},_=p[f],_.hidden&&(m.hidden=1),b=-1,_.hpx?b=ou(_.hpx):_.hpt&&(b=_.hpt),b>-1&&(m.ht=b,m.customHeight=1),_.level&&(m.outlineLevel=_.level),i[i.length]=me("row","",m));return i.join("")}function hb(t,e,r,n){var i=[Jt,me("worksheet",null,{xmlns:Ia[0],"xmlns:r":ur.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",h=at(l);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=$e(h)}n||(n={}),c["!comments"]=[];var f=[];OL(c,r,t,e,i),i[i.length]=me("dimension",null,{ref:l}),i[i.length]=qL(c,e,t,r),e.sheetFormat&&(i[i.length]=me("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=WL(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=YL(c,e,t,r,n),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=LL(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=HL(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=PL(c["!merges"]));var d=-1,p,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=gt(n,-1,vt(m[1].Target).replace(/#.*$/,""),Ke.HLINK),p["r:id"]="rId"+v),(d=m[1].Target.indexOf("#"))>-1&&(p.location=vt(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=vt(m[1].Tooltip)),i[i.length]=me("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=UL(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Rr("ignoredErrors",me("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(v=gt(n,-1,"../drawings/drawing"+(t+1)+".xml",Ke.DRAW),i[i.length]=me("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=gt(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ke.VML),i[i.length]=me("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function QL(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function JL(t,e,r){var n=ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=ou(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,d=-1,p=h<<10;p<h+1<<10;++p){l.c=p;var v=Array.isArray(r)?(r[l.r]||[])[l.c]:r[Me(l)];v&&(f<0&&(f=p),d=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function ZL(t,e,r,n){var i=JL(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ie(t,0,i)}var e3=ka,t3=Yo;function r3(){}function n3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=aP(t,e-19),r}function i3(t,e,r){r==null&&(r=ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Df({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),oT(t,r),r.slice(0,r.l)}function s3(t){var e=jn(t);return[e]}function a3(t,e,r){return r==null&&(r=ee(8)),Aa(e,r)}function o3(t){var e=Sa(t);return[e]}function c3(t,e,r){return r==null&&(r=ee(4)),Ca(e,r)}function l3(t){var e=jn(t),r=t.read_shift(1);return[e,r,"b"]}function u3(t,e,r){return r==null&&(r=ee(9)),Aa(e,r),r.write_shift(1,t.v?1:0),r}function h3(t){var e=Sa(t),r=t.read_shift(1);return[e,r,"b"]}function f3(t,e,r){return r==null&&(r=ee(5)),Ca(e,r),r.write_shift(1,t.v?1:0),r}function d3(t){var e=jn(t),r=t.read_shift(1);return[e,r,"e"]}function p3(t,e,r){return r==null&&(r=ee(9)),Aa(e,r),r.write_shift(1,t.v),r}function m3(t){var e=Sa(t),r=t.read_shift(1);return[e,r,"e"]}function g3(t,e,r){return r==null&&(r=ee(8)),Ca(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function v3(t){var e=jn(t),r=t.read_shift(4);return[e,r,"s"]}function _3(t,e,r){return r==null&&(r=ee(12)),Aa(e,r),r.write_shift(4,e.v),r}function y3(t){var e=Sa(t),r=t.read_shift(4);return[e,r,"s"]}function x3(t,e,r){return r==null&&(r=ee(8)),Ca(e,r),r.write_shift(4,e.v),r}function w3(t){var e=jn(t),r=Vr(t);return[e,r,"n"]}function E3(t,e,r){return r==null&&(r=ee(16)),Aa(e,r),wa(t.v,r),r}function fb(t){var e=Sa(t),r=Vr(t);return[e,r,"n"]}function T3(t,e,r){return r==null&&(r=ee(12)),Ca(e,r),wa(t.v,r),r}function b3(t){var e=jn(t),r=Xm(t);return[e,r,"n"]}function I3(t,e,r){return r==null&&(r=ee(12)),Aa(e,r),cT(t.v,r),r}function A3(t){var e=Sa(t),r=Xm(t);return[e,r,"n"]}function S3(t,e,r){return r==null&&(r=ee(8)),Ca(e,r),cT(t.v,r),r}function C3(t){var e=jn(t),r=Gm(t);return[e,r,"is"]}function k3(t){var e=jn(t),r=Ur(t);return[e,r,"str"]}function D3(t,e,r){return r==null&&(r=ee(12+4*t.v.length)),Aa(e,r),xr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function R3(t){var e=Sa(t),r=Ur(t);return[e,r,"str"]}function P3(t,e,r){return r==null&&(r=ee(8+4*t.v.length)),Ca(e,r),xr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function F3(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=zf(t,n-t.l,r);a[3]=Mr(o,null,i,r.supbooks,r)}else t.l=n;return a}function O3(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=zf(t,n-t.l,r);a[3]=Mr(o,null,i,r.supbooks,r)}else t.l=n;return a}function N3(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=Vr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=zf(t,n-t.l,r);a[3]=Mr(o,null,i,r.supbooks,r)}else t.l=n;return a}function M3(t,e,r){var n=t.l+e,i=jn(t);i.r=r["!row"];var s=Ur(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=zf(t,n-t.l,r);a[3]=Mr(o,null,i,r.supbooks,r)}else t.l=n;return a}var L3=ka,V3=Yo;function B3(t,e){return e==null&&(e=ee(4)),e.write_shift(4,t),e}function U3(t,e){var r=t.l+e,n=ka(t,16),i=qm(t),s=Ur(t),a=Ur(t),o=Ur(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function j3(t,e){var r=ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Yo({s:Ut(t[0]),e:Ut(t[0])},r),Km("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return xr(i||"",r),xr(t[1].Tooltip||"",r),xr("",r),r.slice(0,r.l)}function W3(){}function $3(t,e,r){var n=t.l+e,i=lT(t,16),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=dL(t,n-t.l,r);a[1]=o}else t.l=n;return a}function H3(t,e,r){var n=t.l+e,i=ka(t,16),s=[i];if(r.cellFormula){var a=mL(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function z3(t,e,r){r==null&&(r=ee(18));var n=Gf(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var db=["left","right","top","bottom","header","footer"];function G3(t){var e={};return db.forEach(function(r){e[r]=Vr(t,8)}),e}function q3(t,e){return e==null&&(e=ee(6*8)),_a(t),db.forEach(function(r){wa(t[r],e)}),e}function K3(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function X3(t,e,r){r==null&&(r=ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Y3(t){var e=ee(24);return e.write_shift(4,4),e.write_shift(4,1),Yo(t,e),e}function Q3(t,e){return e==null&&(e=ee(16*4+2)),e.write_shift(2,t.password?tg(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function J3(){}function Z3(){}function eV(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}}),zt!=null&&o.dense==null&&(o.dense=zt);var c=o.dense?[]:{},l,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],d=!1,p=!1,v,m,_,b,S,T,N,M,B,x=[];o.biff=12,o["!row"]=0;var w=0,E=!1,C=[],k={},A=o.supbooks||i.supbooks||[[]];if(A.sharedf=k,A.arrayf=C,A.SheetNames=i.SheetNames||i.Sheets.map(function(Ie){return Ie.name}),!o.supbooks&&(o.supbooks=A,i.Names))for(var R=0;R<i.Names.length;++R)A[0][R+1]=i.Names[R];var oe=[],se=[],Se=!1;cu[16]={n:"BrtShortReal",f:fb};var _e,Re;if(qi(t,function(re,j,G){if(!p)switch(G){case 148:l=re;break;case 0:v=re,o.sheetRows&&o.sheetRows<=v.r&&(p=!0),M=Qt(b=v.r),o["!row"]=v.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=zo(re.hpt)),se[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:re[2]},re[2]){case"n":m.v=re[1];break;case"s":N=ql[re[1]],m.v=N.t,m.r=N.r;break;case"b":m.v=!!re[1];break;case"e":m.v=re[1],o.cellText!==!1&&(m.w=Ki[m.v]);break;case"str":m.t="s",m.v=re[1];break;case"is":m.t="s",m.v=re[1].t;break}if((_=a.CellXf[re[0].iStyleRef])&&lb(m,_.numFmtId,null,o,s,a),S=re[0].c==-1?S+1:re[0].c,o.dense?(c[b]||(c[b]=[]),c[b][S]=m):c[Bt(S)+M]=m,o.cellFormula){for(E=!1,w=0;w<C.length;++w){var H=C[w];v.r>=H[0].s.r&&v.r<=H[0].e.r&&S>=H[0].s.c&&S<=H[0].e.c&&(m.F=$e(H[0]),E=!0)}!E&&re.length>3&&(m.f=re[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>S&&(h.s.c=S),h.e.r<v.r&&(h.e.r=v.r),h.e.c<S&&(h.e.c=S),o.cellDates&&_&&m.t=="n"&&Go(Pe[_.numFmtId])){var W=pa(m.v);W&&(m.t="d",m.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}_e&&(_e.type=="XLDAPR"&&(m.D=!0),_e=void 0),Re&&(Re=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;m={t:"z",v:void 0},S=re[0].c==-1?S+1:re[0].c,o.dense?(c[b]||(c[b]=[]),c[b][S]=m):c[Bt(S)+M]=m,h.s.r>v.r&&(h.s.r=v.r),h.s.c>S&&(h.s.c=S),h.e.r<v.r&&(h.e.r=v.r),h.e.c<S&&(h.e.c=S),_e&&(_e.type=="XLDAPR"&&(m.D=!0),_e=void 0),Re&&(Re=void 0);break;case 176:x.push(re);break;case 49:_e=((o.xlmeta||{}).Cell||[])[re-1];break;case 494:var te=n["!id"][re.relId];for(te?(re.Target=te.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=te):re.relId==""&&(re.Target="#"+re.loc),b=re.rfx.s.r;b<=re.rfx.e.r;++b)for(S=re.rfx.s.c;S<=re.rfx.e.c;++S)o.dense?(c[b]||(c[b]=[]),c[b][S]||(c[b][S]={t:"z",v:void 0}),c[b][S].l=re):(T=Me({c:S,r:b}),c[T]||(c[T]={t:"z",v:void 0}),c[T].l=re);break;case 426:if(!o.cellFormula)break;C.push(re),B=o.dense?c[b][S]:c[Bt(S)+M],B.f=Mr(re[1],h,{r:v.r,c:S},A,o),B.F=$e(re[0]);break;case 427:if(!o.cellFormula)break;k[Me(re[0].s)]=re[1],B=o.dense?c[b][S]:c[Bt(S)+M],B.f=Mr(re[1],h,{r:v.r,c:S},A,o);break;case 60:if(!o.cellStyles)break;for(;re.e>=re.s;)oe[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},Se||(Se=!0,rg(re.w/256)),As(oe[re.e+1]);break;case 161:c["!autofilter"]={ref:$e(re)};break;case 476:c["!margins"]=re;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),re.name&&(i.Sheets[r].CodeName=re.name),(re.above||re.left)&&(c["!outline"]={above:re.above,left:re.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),re.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:f.push(G),d=!0;break;case 38:f.pop(),d=!1;break;default:if(!j.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=$e(l||h)),o.sheetRows&&c["!ref"]){var he=at(c["!ref"]);o.sheetRows<=+he.e.r&&(he.e.r=o.sheetRows-1,he.e.r>h.e.r&&(he.e.r=h.e.r),he.e.r<he.s.r&&(he.s.r=he.e.r),he.e.c>h.e.c&&(he.e.c=h.e.c),he.e.c<he.s.c&&(he.s.c=he.e.c),c["!fullref"]=c["!ref"],c["!ref"]=$e(he))}return x.length>0&&(c["!merges"]=x),oe.length>0&&(c["!cols"]=oe),se.length>0&&(c["!rows"]=se),c}function tV(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ft(e),e.z=e.z||Pe[14],e.v=hr(Pt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Rs(i.cellXfs,e,i),e.l&&s["!links"].push([Me(c),e.l]),e.c&&s["!comments"].push([Me(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=og(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?ie(t,18,x3(e,c)):ie(t,7,_3(e,c))):(c.t="str",a?ie(t,17,P3(e,c)):ie(t,6,D3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ie(t,13,S3(e,c)):ie(t,2,I3(e,c)):a?ie(t,16,T3(e,c)):ie(t,5,E3(e,c)),!0;case"b":return c.t="b",a?ie(t,15,f3(e,c)):ie(t,4,u3(e,c)),!0;case"e":return c.t="e",a?ie(t,14,g3(e,c)):ie(t,3,p3(e,c)),!0}return a?ie(t,12,c3(e,c)):ie(t,1,a3(e,c)),!0}function rV(t,e,r,n){var i=at(e["!ref"]||"A1"),s,a="",o=[];ie(t,145);var c=Array.isArray(e),l=i.e.r;e["!rows"]&&(l=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=l;++h){a=Qt(h),ZL(t,e,i,h);var f=!1;if(h<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(o[d]=Bt(d)),s=o[d]+a;var p=c?(e[h]||[])[d]:e[s];if(!p){f=!1;continue}f=tV(t,p,h,d,n,e,f)}}ie(t,146)}function nV(t,e){!e||!e["!merges"]||(ie(t,177,B3(e["!merges"].length)),e["!merges"].forEach(function(r){ie(t,176,V3(r))}),ie(t,178))}function iV(t,e){!e||!e["!cols"]||(ie(t,390),e["!cols"].forEach(function(r,n){r&&ie(t,60,z3(n,r))}),ie(t,391))}function sV(t,e){!e||!e["!ref"]||(ie(t,648),ie(t,649,Y3(at(e["!ref"]))),ie(t,650))}function aV(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=gt(r,-1,n[1].Target.replace(/#.*$/,""),Ke.HLINK);ie(t,494,j3(n,i))}}),delete e["!links"]}function oV(t,e,r,n){if(e["!comments"].length>0){var i=gt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ke.VML);ie(t,551,Km("rId"+i)),e["!legacy"]=i}}function cV(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:$e(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=on(s);o.s.r==o.e.r&&(o.e.r=on(e["!ref"]).e.r,s=$e(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ie(t,161,Yo(at(s))),ie(t,162)}}function lV(t,e,r){ie(t,133),ie(t,137,X3(e,r)),ie(t,138),ie(t,134)}function uV(t,e){e["!protect"]&&ie(t,535,Q3(e["!protect"]))}function hV(t,e,r,n){var i=an(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=at(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ie(i,129),(r.vbaraw||a["!outline"])&&ie(i,147,i3(o,a["!outline"])),ie(i,148,t3(c)),lV(i,a,r.Workbook),iV(i,a,t,e,r),rV(i,a,t,e,r),uV(i,a),cV(i,a,r,t),nV(i,a),aV(i,a,n),a["!margins"]&&ie(i,476,q3(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sV(i,a),oV(i,a,t,n),ie(i,130),i.end()}function fV(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=st((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function dV(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,c=0,l="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=fV(f);h.s.r=h.s.c=0,h.e.c=o,l=Bt(o),d[0].forEach(function(p,v){a[l+Qt(v)]={t:"n",v:p,z:d[1]},c=v}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(a["!ref"]=$e(h)),a}function pV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(ub);return o&&cg(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function mV(t,e){t.l+=10;var r=Ur(t,e-10);return{name:r}}function gV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=[],o=!1;return qi(t,function(l,h,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f);break;case 38:a.pop();break;default:if(h.T>0)a.push(f);else if(h.T<0)a.pop();else if(!o||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var lg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],_V=[],yV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function yE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Rt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function xE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Rt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function pb(t){xE(t.WBProps,lg),xE(t.CalcPr,yV),yE(t.WBView,vV),yE(t.Sheets,_V),jo.date1904=Rt(t.WBProps.date1904)}function xV(t){return!t.Workbook||!t.Workbook.WBProps?"false":Rt(t.Workbook.WBProps.date1904)?"true":"false"}var wV="][*?/\\".split("");function mb(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return wV.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function EV(t,e,r){t.forEach(function(n,i){mb(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function TV(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];EV(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)xL(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var bV=/<\w+:workbook/;function IV(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Wr,function(c,l){var h=Ve(c);switch(wi(h[0])){case"<?xml":break;case"<workbook":c.match(bV)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":lg.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Rt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=wt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=st(wt(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=wt(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Rt(h.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=st(wt(t.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),Ia.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return pb(r),r}function gb(t){var e=[Jt];e[e.length]=me("workbook",null,{xmlns:Ia[0],"xmlns:r":ur.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(lg.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=me("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:vt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=me("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=me("definedName",vt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function AV(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=gm(t,e-8),r.name=Ur(t),r}function SV(t,e){return e||(e=ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Km(t.strRelID,e),xr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function CV(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?Ur(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function kV(t,e){e||(e=ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),oT(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function DV(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function RV(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=oP(t),a=pL(t,0,r),o=qm(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function PV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],cu[16]={n:"BrtFRTArchID$",f:DV},qi(t,function(c,l,h){switch(h){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Mr(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,c]):a[0]=[h,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),pb(r),r.Names=s,r.supbooks=a,r}function FV(t,e){ie(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ie(t,156,SV(i))}ie(t,144)}function OV(t,e){e||(e=ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return xr("SheetJS",e),xr(Ql.version,e),xr(Ql.version,e),xr("7262",e),e.length>e.l?e.slice(0,e.l):e}function NV(t,e){e||(e=ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function MV(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ie(t,135),ie(t,158,NV(i)),ie(t,136))}}function LV(t,e){var r=an();return ie(r,131),ie(r,128,OV()),ie(r,153,kV(t.Workbook&&t.Workbook.WBProps||null)),MV(r,t,e),FV(r,t,e),ie(r,132),r.end()}function VV(t,e,r){return e.slice(-4)===".bin"?PV(t,r):IV(t,r)}function BV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?eV(t,n,r,i,s,a,o):RL(t,n,r,i,s,a,o)}function UV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?gV(t,n,r,i,s,a,o):pV(t,n,r,i,s,a,o)}function jV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?$M(t,n,r,i,s,a,o):HM(t,n,r,i,s,a,o)}function WV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?jM(t,n,r,i,s,a,o):WM(t,n,r,i,s,a,o)}function $V(t,e,r,n){return e.slice(-4)===".bin"?VN(t,r,n):AN(t,r,n)}function HV(t,e,r){return YT(t,r)}function zV(t,e,r){return e.slice(-4)===".bin"?zO(t,r):WO(t,r)}function GV(t,e,r){return e.slice(-4)===".bin"?MM(t,r):SM(t,r)}function qV(t,e,r){return e.slice(-4)===".bin"?bM(t,e,r):EM(t,e,r)}function KV(t,e,r,n){return r.slice(-4)===".bin"?IM(t,e,r,n):void 0}function XV(t,e,r){return e.slice(-4)===".bin"?yM(t,e,r):wM(t,e,r)}function YV(t,e,r){return(e.slice(-4)===".bin"?LV:gb)(t,r)}function QV(t,e,r,n,i){return(e.slice(-4)===".bin"?hV:hb)(t,r,n,i)}function JV(t,e,r){return(e.slice(-4)===".bin"?KN:KT)(t,r)}function ZV(t,e,r){return(e.slice(-4)===".bin"?KO:UT)(t,r)}function e6(t,e,r){return(e.slice(-4)===".bin"?LM:ZT)(t,r)}function t6(t){return(t.slice(-4)===".bin"?xM:QT)()}var vb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,_b=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Qn(t,e){var r=t.split(/\s+/),n=[];if(e||(n[0]=r[0]),r.length===1)return n;var i=t.match(vb),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(_b),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function r6(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(vb),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(_b),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Xl;function n6(t,e){var r=Xl[t]||st(t);return r==="General"?ya(e):Un(r,e)}function i6(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Rt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Pt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[st(e)]=i}function s6(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Ki[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zl(t.v):t.w=ya(t.v):t.w=n6(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Xl[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Go(n)){var i=pa(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function a6(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=_N[n.Pattern]||n.Pattern)}t[e.ID]=e}function o6(t,e,r,n,i,s,a,o,c,l){var h="General",f=n.StyleID,d={};l=l||{};var p=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Rt(t);break;case"String":n.t="s",n.r=Lw(st(t)),n.v=t.indexOf("<")>-1?st(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Pt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=st(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=fT[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Lw(e||t));break}if(s6(n,h,l),l.cellFormula!==!1)if(n.Formula){var m=st(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Uo(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Uo("RC:RC",i):n.ArrayRange&&(n.F=Uo(n.ArrayRange,i),c.push([at(n.F),n.F]))}else for(v=0;v<c.length;++v)i.r>=c[v][0].s.r&&i.r<=c[v][0].e.r&&i.c>=c[v][0].s.c&&i.c<=c[v][0].e.c&&(n.F=c[v][1]);l.cellStyles&&(p.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function c6(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function lm(t,e){var r=e||{};qo();var n=Ul(Lm(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof pt<"u"?n=pt.utils.decode(65001,pm(n)):n=wt(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Ft(r);return a.type="string",Ho.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Lt){i.indexOf("<"+Lt)>=0&&(s=!0)}),s)return q6(n,r);Xl={"General Number":"General","General Date":Pe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Pe[15],"Short Date":Pe[14],"Long Time":Pe[19],"Medium Time":Pe[18],"Short Time":Pe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Pe[2],Standard:Pe[4],Percent:Pe[10],Scientific:Pe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;zt!=null&&r.dense==null&&(r.dense=zt);var h={},f=[],d=r.dense?[]:{},p="",v={},m={},_=Qn('<Data ss:Type="String">'),b=0,S=0,T=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},M={},B={},x="",w=0,E=[],C={},k={},A=0,R=[],oe=[],se={},Se=[],_e,Re=!1,he=[],Ie=[],re={},j=0,G=0,H={Sheets:[],WBProps:{date1904:!1}},W={};ru.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=ru.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?o6(n.slice(b,o.index),x,_,c[c.length-1][0]=="comment"?se:v,{c:S,r:T},M,Se[S],m,he,r):(x="",_=Qn(o[0]),b=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(v.c=oe),(!r.sheetRows||r.sheetRows>T)&&v.v!==void 0&&(r.dense?(d[T]||(d[T]=[]),d[T][S]=v):d[Bt(S)+Qt(T)]=v),v.HRef&&(v.l={Target:st(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(j=S+(parseInt(v.MergeAcross,10)|0),G=T+(parseInt(v.MergeDown,10)|0),E.push({s:{c:S,r:T},e:{c:j,r:G}})),!r.sheetStubs)v.MergeAcross?S=j+1:++S;else if(v.MergeAcross||v.MergeDown){for(var de=S;de<=j;++de)for(var ce=T;ce<=G;++ce)(de>S||ce>T)&&(r.dense?(d[ce]||(d[ce]=[]),d[ce][de]={t:"z"}):d[Bt(de)+Qt(ce)]={t:"z"});S=j+1}else++S;else v=r6(o[0]),v.Index&&(S=+v.Index-1),S<N.s.c&&(N.s.c=S),S>N.e.c&&(N.e.c=S),o[0].slice(-2)==="/>"&&++S,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(T<N.s.r&&(N.s.r=T),T>N.e.r&&(N.e.r=T),o[0].slice(-2)==="/>"&&(m=Qn(o[0]),m.Index&&(T=+m.Index-1)),S=0,++T):(m=Qn(o[0]),m.Index&&(T=+m.Index-1),re={},(m.AutoFitHeight=="0"||m.Height)&&(re.hpx=parseInt(m.Height,10),re.hpt=ou(re.hpx),Ie[T]=re),m.Hidden=="1"&&(re.hidden=!0,Ie[T]=re));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=$e(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=$e(N))),E.length&&(d["!merges"]=E),Se.length>0&&(d["!cols"]=Se),Ie.length>0&&(d["!rows"]=Ie),h[p]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=S=0,c.push([o[3],!1]),l=Qn(o[0]),p=st(l.Name),d=r.dense?[]:{},E=[],he=[],Ie=[],W={name:p,Hidden:0},H.Sheets.push(W);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Se=[],Re=!1}break;case"style":o[1]==="/"?a6(M,B,r):B=Qn(o[0]);break;case"numberformat":B.nf=st(Qn(o[0]).Format||"General"),Xl[B.nf]&&(B.nf=Xl[B.nf]);for(var ue=0;ue!=392&&Pe[ue]!=B.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(Pe[ue]==null){$i(B.nf,ue);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(_e=Qn(o[0]),_e.Hidden&&(_e.hidden=!0,delete _e.Hidden),_e.Width&&(_e.wpx=parseInt(_e.Width,10)),!Re&&_e.wpx>10){Re=!0,Lr=GT;for(var ne=0;ne<Se.length;++ne)Se[ne]&&As(Se[ne])}Re&&As(_e),Se[_e.Index-1||Se.length]=_e;for(var Be=0;Be<+_e.Span;++Be)Se[Se.length]=Ft(_e);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var U=Ve(o[0]),nt={Name:U.Name,Ref:Uo(U.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(nt.Sheet=H.Sheets.length-1),H.Names.push(nt);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(w,o.index):w=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=Qn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?PP(C,te,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));c6(se),oe.push(se)}else c.push([o[3],!1]),l=Qn(o[0]),se={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=Qn(o[0]);d["!autofilter"]={ref:Uo(He.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return IE(n,r);var it=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:it=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:it=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:it=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:it=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else A=o.index+o[0].length;break;case"header":d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].header=+Ve(o[0]).Margin);break;case"footer":d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].footer=+Ve(o[0]).Margin);break;case"pagemargins":var Xe=Ve(o[0]);d["!margins"]||_a(d["!margins"]={},"xlml"),isNaN(+Xe.Top)||(d["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(d["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(d["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(d["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:it=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:it=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:it=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:it=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:it=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:it=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:it=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:it=!1}break;case"smarttags":break;default:it=!1;break}if(it||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?i6(k,te,R,n.slice(A,o.index)):(R=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Ee={};return!r.bookSheets&&!r.bookProps&&(Ee.Sheets=h),Ee.SheetNames=f,Ee.Workbook=H,Ee.SSF=Ft(Pe),Ee.Props=C,Ee.Custprops=k,Ee}function Tm(t,e){switch(hg(e=e||{}),e.type||"base64"){case"base64":return lm(xn(t),e);case"binary":case"buffer":case"file":return lm(t,e);case"array":return lm(ks(t),e)}}function l6(t,e){var r=[];return t.Props&&r.push(FP(t.Props,e)),t.Custprops&&r.push(OP(t.Props,t.Custprops,e)),r.join("")}function u6(){return""}function h6(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(me("NumberFormat",null,{"ss:Format":vt(Pe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(me("Style",s.join(""),a))}),me("Styles",r.join(""))}function yb(t){return me("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+sg(t.Ref,{r:0,c:0})})}function f6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(yb(i)))}return me("Names",r.join(""))}function d6(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(yb(o)))}return s.join("")}function p6(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(me("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(me("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(me("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(me("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Rr("ProtectContents","True")),t["!protect"].objects&&i.push(Rr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Rr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Rr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Rr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":me("WorksheetOptions",i.join(""),{xmlns:vn.x})}function m6(t){return t.map(function(e){var r=NR(e.t||""),n=me("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return me("Comment",n,{"ss:Author":e.a})}).join("")}function g6(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+vt(sg(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=Ut(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=vt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=vt(t.l.Tooltip))),r["!merges"])for(var l=r["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var f="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(t.v);break;case"b":f="Boolean",d=t.v?"1":"0";break;case"e":f="Error",d=Ki[t.v];break;case"d":f="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Pe[14]);break;case"s":f="String",d=OR(t.v||"");break}var p=Rs(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var v=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(t.c||[]).length>0&&(m+=m6(t.c)),me("Cell",m,o)}function v6(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=zo(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function _6(t,e,r,n){if(!t["!ref"])return"";var i=at(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,b){As(_);var S=!!_.width,T=Gf(b,_),N={"ss:Index":b+1};S&&(N["ss:Width"]=su(T.width)),_.hidden&&(N["ss:Hidden"]="1"),o.push(me("Column",null,N))});for(var c=Array.isArray(t),l=i.s.r;l<=i.e.r;++l){for(var h=[v6(l,(t["!rows"]||[])[l])],f=i.s.c;f<=i.e.c;++f){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>l)&&!(s[a].e.c<f)&&!(s[a].e.r<l)){(s[a].s.c!=f||s[a].s.r!=l)&&(d=!0);break}if(!d){var p={r:l,c:f},v=Me(p),m=c?(t[l]||[])[f]:t[v];h.push(g6(m,v,t,e,r,n,p))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function y6(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?d6(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?_6(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(p6(s,e,t,r)),n.join("")}function x6(t,e){e||(e={}),t.SSF||(t.SSF=Ft(Pe)),t.SSF&&(qo(),Vf(t.SSF),e.revssf=Uf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Rs(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(l6(t,e)),r.push(u6(t,e)),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(me("Worksheet",y6(n,e,t),{"ss:Name":vt(t.SheetNames[n])}));return r[2]=h6(t,e),r[3]=f6(t,e),Jt+me("Workbook",r.join(""),{xmlns:vn.ss,"xmlns:o":vn.o,"xmlns:x":vn.x,"xmlns:ss":vn.ss,"xmlns:dt":vn.dt,"xmlns:html":vn.html})}function w6(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=fP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=dP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var E6=[60,1084,2066,2165,2175];function T6(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=ji(r,r.l),l=bm[c],h=0;l!=null&&E6.indexOf(c)>-1;)s=ji(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+s),a.push(o),r.l+=4+s,l=bm[c=ji(r,r.l)];var f=yr(a);Dr(f,0);var d=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(d),d+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,i)}function gi(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Pe[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Ki[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=Zl(t.v):t.w=ya(t.v):t.w=Un(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Go(Pe[n]||String(n))){var i=pa(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Ef(t,e,r){return{v:t,ixfe:e,t:r}}function b6(t,e){var r={opts:{}},n={};zt!=null&&e.dense==null&&(e.dense=zt);var i=e.dense?[]:{},s={},a={},o=null,c=[],l="",h={},f,d="",p,v,m,_,b={},S=[],T,N,M=[],B=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},E=function(ze){return ze<8?ma[ze]:ze<64&&B[ze-8]||ma[ze]},C=function(ze,Ot,en){var Ct=Ot.XF.data;if(!(!Ct||!Ct.patternType||!en||!en.cellStyles)){Ot.s={},Ot.s.patternType=Ct.patternType;var oi;(oi=iu(E(Ct.icvFore)))&&(Ot.s.fgColor={rgb:oi}),(oi=iu(E(Ct.icvBack)))&&(Ot.s.bgColor={rgb:oi})}},k=function(ze,Ot,en){if(!(re>1)&&!(en.sheetRows&&ze.r>=en.sheetRows)){if(en.cellStyles&&Ot.XF&&Ot.XF.data&&C(ze,Ot,en),delete Ot.ixfe,delete Ot.XF,f=ze,d=Me(ze),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<a.s.r&&(a.s.r=ze.r),ze.c<a.s.c&&(a.s.c=ze.c),ze.r+1>a.e.r&&(a.e.r=ze.r+1),ze.c+1>a.e.c&&(a.e.c=ze.c+1),en.cellFormula&&Ot.f){for(var Ct=0;Ct<S.length;++Ct)if(!(S[Ct][0].s.c>ze.c||S[Ct][0].s.r>ze.r)&&!(S[Ct][0].e.c<ze.c||S[Ct][0].e.r<ze.r)){Ot.F=$e(S[Ct][0]),(S[Ct][0].s.c!=ze.c||S[Ct][0].s.r!=ze.r)&&delete Ot.f,Ot.f&&(Ot.f=""+Mr(S[Ct][1],a,ze,he,A));break}}en.dense?(i[ze.r]||(i[ze.r]=[]),i[ze.r][ze.c]=Ot):i[d]=Ot}},A={enc:!1,sbcch:0,snames:[],sharedf:b,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var R,oe=[],se=[],Se=[],_e=[],Re=!1,he=[];he.SheetNames=A.snames,he.sharedf=A.sharedf,he.arrayf=A.arrayf,he.names=[],he.XTI=[];var Ie=0,re=0,j=0,G=[],H=[],W;A.codepage=1200,Jn(1200);for(var te=!1;t.l<t.length-1;){var de=t.l,ce=t.read_shift(2);if(ce===0&&Ie===10)break;var ue=t.l===t.length?0:t.read_shift(2),ne=bm[ce];if(ne&&ne.f){if(e.bookSheets&&Ie===133&&ce!==133)break;if(Ie=ce,ne.r===2||ne.r==12){var Be=t.read_shift(2);if(ue-=2,!A.enc&&Be!==ce&&((Be&255)<<8|Be>>8)!==ce)throw new Error("rt mismatch: "+Be+"!="+ce);ne.r==12&&(t.l+=10,ue-=10)}var U={};if(ce===10?U=ne.f(t,ue,A):U=T6(ce,ne,t,ue,A),re==0&&[9,521,1033,2057].indexOf(Ie)===-1)continue;switch(ce){case 34:r.opts.Date1904=x.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=U;break;case 66:var nt=Number(U);switch(nt){case 21010:nt=1200;break;case 32768:nt=1e4;break;case 32769:nt=1252;break}Jn(A.codepage=nt),te=!0;break;case 317:A.rrtabid=U;break;case 25:A.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:A.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:M.push(U);break;case 430:he.push([U]),he[he.length-1].XTI=[];break;case 35:case 547:he[he.length-1].push(U);break;case 24:case 536:W={Name:U.Name,Ref:Mr(U.rgce,a,null,he,A)},U.itab>0&&(W.Sheet=U.itab-1),he.names.push(W),he[0]||(he[0]=[],he[0].XTI=[]),he[he.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(H[U.itab-1]={ref:$e(U.rgce[0][0][1][2])});break;case 22:A.ExternCount=U;break;case 23:he.length==0&&(he[0]=[],he[0].XTI=[]),he[he.length-1].XTI=he[he.length-1].XTI.concat(U),he.XTI=he.XTI.concat(U);break;case 2196:if(A.biff<8)break;W!=null&&(W.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&A.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,A.snames.push(U.name);break;case 10:{if(--re)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=$e(a),e.sheetRows&&e.sheetRows<=a.e.r){var He=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=$e(a),a.e.r=He}a.e.r++,a.e.c++}oe.length>0&&(i["!merges"]=oe),se.length>0&&(i["!objects"]=se),Se.length>0&&(i["!cols"]=Se),_e.length>0&&(i["!rows"]=_e),x.Sheets.push(w)}l===""?h=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),A.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(A.biff=5,te=!0,Jn(A.codepage=28591)),A.biff==8&&U.BIFFVer==0&&U.dt==16&&(A.biff=2),re++)break;if(i=e.dense?[]:{},A.biff<8&&!te&&(te=!0,Jn(A.codepage=e.codepage||1252)),A.biff<5||U.BIFFVer==0&&U.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var it={pos:t.l-ue,name:l};s[it.pos]=it,A.snames.push(l)}else l=(s[de]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),oe=[],se=[],A.arrayf=S=[],Se=[],_e=[],Re=!1,w={Hidden:(s[de]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[U.r]||[])[U.c]:i[Me({c:U.c,r:U.r})])&&++U.c,T={ixfe:U.ixfe,XF:M[U.ixfe]||{},v:U.val,t:"n"},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e);break;case 5:case 517:T={ixfe:U.ixfe,XF:M[U.ixfe],v:U.val,t:U.t},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e);break;case 638:T={ixfe:U.ixfe,XF:M[U.ixfe],v:U.rknum,t:"n"},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e);break;case 189:for(var Xe=U.c;Xe<=U.C;++Xe){var Ee=U.rkrec[Xe-U.c][0];T={ixfe:Ee,XF:M[Ee],v:U.rkrec[Xe-U.c][1],t:"n"},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:Xe,r:U.r},T,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(T=Ef(U.val,U.cell.ixfe,U.tt),T.XF=M[T.ixfe],e.cellFormula){var Lt=U.formula;if(Lt&&Lt[0]&&Lt[0][0]&&Lt[0][0][0]=="PtgExp"){var Kr=Lt[0][0][1][0],cn=Lt[0][0][1][1],ln=Me({r:Kr,c:cn});b[ln]?T.f=""+Mr(U.formula,a,U.cell,he,A):T.F=((e.dense?(i[Kr]||[])[cn]:i[ln])||{}).F}else T.f=""+Mr(U.formula,a,U.cell,he,A)}j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k(U.cell,T,e),o=U}break;case 7:case 519:if(o)o.val=U,T=Ef(U,o.cell.ixfe,"s"),T.XF=M[T.ixfe],e.cellFormula&&(T.f=""+Mr(o.formula,a,o.cell,he,A)),j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k(o.cell,T,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(U);var ss=Me(U[0].s);if(p=e.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[ss],e.cellFormula&&p){if(!o||!ss||!p)break;p.f=""+Mr(U[1],a,U[0],he,A),p.F=$e(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;b[Me(o.cell)]=U[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Me(o.cell)],(p||{}).f=""+Mr(U[0],a,f,he,A)}}break;case 253:T=Ef(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(T.h=c[U.isst].h),T.XF=M[T.ixfe],j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e);break;case 513:e.sheetStubs&&(T={ixfe:U.ixfe,XF:M[U.ixfe],t:"z"},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e));break;case 190:if(e.sheetStubs)for(var ai=U.c;ai<=U.C;++ai){var br=U.ixfe[ai-U.c];T={ixfe:br,XF:M[br],t:"z"},j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:ai,r:U.r},T,e)}break;case 214:case 516:case 4:T=Ef(U.val,U.ixfe,"s"),T.XF=M[T.ixfe],j>0&&(T.z=G[T.ixfe>>8&63]),gi(T,e,r.opts.Date1904),k({c:U.c,r:U.r},T,e);break;case 0:case 512:re===1&&(a=U);break;case 252:c=U;break;case 1054:if(A.biff==4){G[j++]=U[1];for(var un=0;un<j+163&&Pe[un]!=U[1];++un);un>=163&&$i(U[1],j+163)}else $i(U[1],U[0]);break;case 30:{G[j++]=U;for(var An=0;An<j+163&&Pe[An]!=U;++An);An>=163&&$i(U,j+163)}break;case 229:oe=oe.concat(U);break;case 93:se[U.cmo[0]]=A.lastobj=U;break;case 438:A.lastobj.TxO=U;break;case 127:A.lastobj.ImData=U;break;case 440:for(_=U[0].s.r;_<=U[0].e.r;++_)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Me({c:m,r:_})],p&&(p.l=U[1]);break;case 2048:for(_=U[0].s.r;_<=U[0].e.r;++_)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Me({c:m,r:_})],p&&p.l&&(p.l.Tooltip=U[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;p=e.dense?(i[U[0].r]||[])[U[0].c]:i[Me(U[0])];var jt=se[U[2]];p||(e.dense?(i[U[0].r]||(i[U[0].r]=[]),p=i[U[0].r][U[0].c]={t:"z"}):p=i[Me(U[0])]={t:"z"},a.e.r=Math.max(a.e.r,U[0].r),a.s.r=Math.min(a.s.r,U[0].r),a.e.c=Math.max(a.e.c,U[0].c),a.s.c=Math.min(a.s.c,U[0].c)),p.c||(p.c=[]),v={a:U[1],t:jt.TxO.t},p.c.push(v)}break;case 2173:hM(M[U.ixfe],U.ext);break;case 125:{if(!A.cellStyles)break;for(;U.e>=U.s;)Se[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Re||(Re=!0,rg(U.w/256)),As(Se[U.e+1])}break;case 520:{var lt={};U.level!=null&&(_e[U.r]=lt,lt.level=U.level),U.hidden&&(_e[U.r]=lt,lt.hidden=!0),U.hpt&&(_e[U.r]=lt,lt.hpt=U.hpt,lt.hpx=zo(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||_a(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ce]]=U;break;case 161:i["!margins"]||_a(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(x.Views[0].RTL=!0);break;case 146:B=U;break;case 2198:R=U;break;case 140:N=U;break;case 442:l?w.CodeName=U||w.name:x.WBProps.CodeName=U||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+ce.toString(16)),t.l+=ue}return r.SheetNames=Gt(s).sort(function(Xr,ze){return Number(Xr)-Number(ze)}).map(function(Xr){return s[Xr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(Xr,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=Xr}),r.Strings=c,r.SSF=Ft(Pe),A.enc&&(r.Encryption=A.enc),R&&(r.Themes=R),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),he.names.length>0&&(x.Names=he.names),r.Workbook=x,r}var Yl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function I6(t,e,r){var n=ke.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=tE(n,vm,Yl.DSI);for(var s in i)e[s]=i[s]}catch(l){if(r.WTF)throw l}var a=ke.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=tE(a,_m,Yl.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(_T(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function A6(t,e){var r=[],n=[],i=[],s=0,a,o=Rw(vm,"n"),c=Rw(_m,"n");if(t.Props)for(a=Gt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Gt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)IT.indexOf(i[s][0])>-1||vT.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&ke.utils.cfb_add(e,"/SummaryInformation",rE(n,Yl.SI,c,_m)),(r.length||l.length)&&ke.utils.cfb_add(e,"/DocumentSummaryInformation",rE(r,Yl.DSI,o,vm,l.length?l:null,Yl.UDI))}function xb(t,e){e||(e={}),hg(e),Cm(),e.codepage&&Sm(e.codepage);var r,n;if(t.FullPaths){if(ke.find(t,"/encryption"))throw new Error("File is password-protected");r=ke.find(t,"!CompObj"),n=ke.find(t,"/Workbook")||ke.find(t,"/Book")}else{switch(e.type){case"base64":t=_n(xn(t));break;case"binary":t=_n(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Dr(t,0),n={content:t}}var i,s;if(r&&w6(r),e.bookProps&&!e.bookSheets)i={};else{var a=Ye?"buffer":"array";if(n&&n.content)i=b6(n.content,e);else if((s=ke.find(t,"PerfectOffice_MAIN"))&&s.content)i=va.to_workbook(s.content,(e.type=a,e));else if((s=ke.find(t,"NativeContent_MAIN"))&&s.content)i=va.to_workbook(s.content,(e.type=a,e));else throw(s=ke.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&ke.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=BM(t))}var o={};return t.FullPaths&&I6(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function S6(t,e){var r=e||{},n=ke.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return ke.utils.cfb_add(n,i,wb(t,r)),r.biff==8&&(t.Props||t.Custprops)&&A6(t,n),r.biff==8&&t.vbaraw&&UM(n,ke.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var cu={0:{f:QL},1:{f:s3},2:{f:b3},3:{f:d3},4:{f:l3},5:{f:w3},6:{f:k3},7:{f:v3},8:{f:M3},9:{f:N3},10:{f:F3},11:{f:O3},12:{f:o3},13:{f:A3},14:{f:m3},15:{f:h3},16:{f:fb},17:{f:R3},18:{f:y3},19:{f:Gm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:RV},40:{},42:{},43:{f:kN},44:{f:SN},45:{f:PN},46:{f:ON},47:{f:FN},48:{},49:{f:eP},50:{},51:{f:pM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:MT},62:{f:C3},63:{f:TM},64:{f:J3},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:jr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:n3},148:{f:e3,p:16},151:{f:W3},152:{},153:{f:CV},154:{},155:{},156:{f:AV},157:{},158:{},159:{T:1,f:HO},160:{T:-1},161:{T:1,f:ka},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:L3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:fM},336:{T:-1},337:{f:vM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:gm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:NT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:$3},427:{f:H3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:G3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:r3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:U3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:gm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:OM},633:{T:1},634:{T:-1},635:{T:1,f:PM},636:{T:-1},637:{f:iP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:mV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Z3},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},bm={6:{f:om},10:{f:Es},12:{f:sr},13:{f:sr},14:{f:Yt},15:{f:Yt},16:{f:Vr},17:{f:Yt},18:{f:Yt},19:{f:sr},20:{f:cE},21:{f:cE},23:{f:NT},24:{f:uE},25:{f:Yt},26:{},27:{},28:{f:ZF},29:{},34:{f:Yt},35:{f:lE},38:{f:Vr},39:{f:Vr},40:{f:Vr},41:{f:Vr},42:{f:Yt},43:{f:Yt},47:{f:hN},49:{f:AF},51:{f:sr},60:{},61:{f:wF},64:{f:Yt},65:{f:IF},66:{f:sr},77:{},80:{},81:{},82:{},85:{f:sr},89:{},90:{},91:{},92:{f:uF},93:{f:rO},94:{},95:{f:Yt},96:{},97:{},99:{f:Yt},125:{f:MT},128:{f:jF},129:{f:fF},130:{f:sr},131:{f:Yt},132:{f:Yt},133:{f:dF},134:{},140:{f:uO},141:{f:sr},144:{},146:{f:dO},151:{},152:{},153:{},154:{},155:{},156:{f:sr},157:{},158:{},160:{f:xO},161:{f:gO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:LF},190:{f:VF},193:{f:Es},197:{},198:{},199:{},200:{},201:{},202:{f:Yt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sr},220:{},221:{f:Yt},222:{},224:{f:UF},225:{f:lF},226:{f:Es},227:{},229:{f:eO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:mF},253:{f:CF},255:{f:vF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:AT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Yt},353:{f:Es},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:GF},431:{f:Yt},432:{},433:{},434:{},437:{},438:{f:sO},439:{f:Yt},440:{f:aO},441:{},442:{f:du},443:{},444:{f:sr},445:{},446:{},448:{f:Es},449:{f:xF,r:2},450:{f:Es},512:{f:sE},513:{f:yO},515:{f:HF},516:{f:DF},517:{f:oE},519:{f:wO},520:{f:_F},523:{},545:{f:hE},549:{f:iE},566:{},574:{f:TF},638:{f:MF},659:{},1048:{},1054:{f:PF},1084:{},1212:{f:YF},2048:{f:cO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Es},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:pO,r:12},2173:{f:uM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Yt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:XF,r:12},2197:{},2198:{f:iM,r:12},2199:{},2200:{},2201:{},2202:{f:QF,r:12},2203:{f:Es},2204:{},2205:{},2206:{},2207:{},2211:{f:yF},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:fO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:sE},1:{},2:{f:AO},3:{f:bO},4:{f:TO},5:{f:oE},7:{f:CO},8:{},9:{f:yf},11:{},22:{f:sr},30:{f:OF},31:{},32:{},33:{f:hE},36:{},37:{f:iE},50:{f:kO},62:{},52:{},67:{},68:{f:sr},69:{},86:{},126:{},127:{f:EO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:DO},223:{},234:{},354:{},421:{},518:{f:om},521:{f:yf},536:{f:uE},547:{f:lE},561:{},579:{},1030:{f:om},1033:{f:yf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ge(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&$m(r)&&t.push(r)}}function C6(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return ge(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,s),h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l;c<i;){for(h=t.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l}}}function vu(t,e,r){return t||(t=ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function k6(t,e,r,n){var i=ee(9);return vu(i,t,e),ST(r,n||"b",i),i}function D6(t,e,r){var n=ee(8+2*r.length);return vu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function R6(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?hr(Pt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ge(t,2,SO(r,n,i)):ge(t,3,IO(r,n,i));return;case"b":case"e":ge(t,5,k6(r,n,e.v,e.t));return;case"s":case"str":ge(t,4,D6(r,n,(e.v||"").slice(0,255)));return}ge(t,1,vu(null,r,n))}function P6(t,e,r,n){var i=Array.isArray(e),s=at(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=$e(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Qt(l);for(var h=s.s.c;h<=s.e.c;++h){l===s.s.r&&(c[h]=Bt(h)),a=c[h]+o;var f=i?(e[l]||[])[h]:e[a];f&&R6(t,f,l,h,n)}}}function F6(t,e){var r=e||{};zt!=null&&r.dense==null&&(r.dense=zt);for(var n=an(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ge(n,r.biff==4?1033:r.biff==3?521:9,Zm(t,16,r)),P6(n,t.Sheets[t.SheetNames[i]],i,r,t),ge(n,10),n.end()}function O6(t,e,r){ge(t,49,SF({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function N6(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ge(t,1054,FF(i,e[i],r))})}function M6(t,e){var r=ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ge(t,2151,r),r=ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),PT(at(e["!ref"]||"A1"),r),r.write_shift(4,4),ge(t,2152,r)}function L6(t,e){for(var r=0;r<16;++r)ge(t,224,aE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ge(t,224,aE(n,0,e))})}function V6(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ge(t,440,oO(n)),n[1].Tooltip&&ge(t,2048,lO(n))}delete e["!links"]}function B6(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ge(t,125,mO(Gf(i,n),i))})}}function U6(t,e,r,n,i){var s=16+Rs(i.cellXfs,e,i);if(e.v==null&&!e.bf){ge(t,513,Ta(r,n,s));return}if(e.bf)ge(t,6,fL(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?hr(Pt(e.v)):e.v;ge(t,515,zF(r,n,a,s,i));break;case"b":case"e":ge(t,517,$F(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=og(i.Strings,e.v,i.revStrings);ge(t,253,kF(r,n,o,s,i))}else ge(t,516,RF(r,n,(e.v||"").slice(0,255),s,i));break;default:ge(t,513,Ta(r,n,s))}}function j6(t,e,r){var n=an(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),l=e.biff==8,h,f="",d=[],p=at(s["!ref"]||"A1"),v=l?65536:16384;if(p.e.c>255||p.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}ge(n,2057,Zm(r,16,e)),ge(n,13,Vn(1)),ge(n,12,Vn(100)),ge(n,15,Jr(!0)),ge(n,17,Jr(!1)),ge(n,16,wa(.001)),ge(n,95,Jr(!0)),ge(n,42,Jr(!1)),ge(n,43,Jr(!1)),ge(n,130,Vn(1)),ge(n,128,WF([0,0])),ge(n,131,Jr(!1)),ge(n,132,Jr(!1)),l&&B6(n,s["!cols"]),ge(n,512,NF(p,e)),l&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){f=Qt(m);for(var _=p.s.c;_<=p.e.c;++_){m===p.s.r&&(d[_]=Bt(_)),h=d[_]+f;var b=c?(s[m]||[])[_]:s[h];b&&(U6(n,b,m,_,e),l&&b.l&&s["!links"].push([h,b.l]))}}var S=o.CodeName||o.name||i;return l&&ge(n,574,bF((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&ge(n,229,tO(s["!merges"])),l&&V6(n,s),ge(n,442,CT(S,e)),l&&M6(n,s),ge(n,10),n.end()}function W6(t,e,r){var n=an(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(ge(n,2057,Zm(t,5,r)),r.bookType=="xla"&&ge(n,135),ge(n,225,o?Vn(1200):null),ge(n,193,$P(2)),c&&ge(n,191),c&&ge(n,192),ge(n,226),ge(n,92,hF("SheetJS",r)),ge(n,66,Vn(o?1200:1252)),o&&ge(n,353,Vn(0)),o&&ge(n,448),ge(n,317,_O(t.SheetNames.length)),o&&t.vbaraw&&ge(n,211),o&&t.vbaraw){var l=a.CodeName||"ThisWorkbook";ge(n,442,CT(l,r))}ge(n,156,Vn(17)),ge(n,25,Jr(!1)),ge(n,18,Jr(!1)),ge(n,19,Vn(0)),o&&ge(n,431,Jr(!1)),o&&ge(n,444,Vn(0)),ge(n,61,EF(r)),ge(n,64,Jr(!1)),ge(n,141,Vn(0)),ge(n,34,Jr(xV(t)=="true")),ge(n,14,Jr(!0)),o&&ge(n,439,Jr(!1)),ge(n,218,Vn(0)),O6(n,t,r),N6(n,t.SSF,r),L6(n,r),o&&ge(n,352,Jr(!1));var h=n.end(),f=an();o&&ge(f,140,hO()),o&&r.Strings&&C6(f,252,gF(r.Strings,r)),ge(f,10);var d=f.end(),p=an(),v=0,m=0;for(m=0;m<t.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var _=h.length+v+d.length;for(m=0;m<t.SheetNames.length;++m){var b=s[m]||{};ge(p,133,pF({pos:_,hs:b.Hidden||0,dt:0,name:t.SheetNames[m]},r)),_+=e[m].length}var S=p.end();if(v!=S.length)throw new Error("BS8 "+v+" != "+S.length);var T=[];return h.length&&T.push(h),S.length&&T.push(S),d.length&&T.push(d),yr(T)}function $6(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Ft(Pe)),t&&t.SSF&&(qo(),Vf(t.SSF),r.revssf=Uf(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fg(r),r.cellXfs=[],Rs(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=j6(i,r,t);return n.unshift(W6(t,n,r)),yr(n)}function wb(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=on(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return $6(t,e);case 4:case 3:case 2:return F6(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function wE(t,e){var r=e||{};zt!=null&&r.dense==null&&(r.dense=zt);var n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,c=SR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,h=0,f=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<c.length;++a){var m=c[a].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var b=m.split(/<\/t[dh]>/i);for(o=0;o<b.length;++o){var S=b[o].trim();if(S.match(/<t[dh]/i)){for(var T=S,N=0;T.charAt(0)=="<"&&(N=T.indexOf(">"))>-1;)T=T.slice(N+1);for(var M=0;M<v.length;++M){var B=v[M];B.s.c==h&&B.s.r<l&&l<=B.e.r&&(h=B.e.c+1,M=-1)}var x=Ve(S.slice(0,S.indexOf(">")));d=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||d>1)&&v.push({s:{r:l,c:h},e:{r:l+(f||1)-1,c:h+d-1}});var w=x.t||x["data-t"]||"";if(!T.length){h+=d;continue}if(T=YE(T),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>h&&(p.s.c=h),p.e.c<h&&(p.e.c=h),!T.length){h+=d;continue}var E={t:"s",v:T};r.raw||!T.trim().length||w=="s"||(T==="TRUE"?E={t:"b",v:!0}:T==="FALSE"?E={t:"b",v:!1}:isNaN(ei(T))?isNaN($o(T).getDate())||(E={t:"d",v:Pt(T)},r.cellDates||(E={t:"n",v:hr(E.v)}),E.z=r.dateNF||Pe[14]):E={t:"n",v:ei(T)}),r.dense?(n[l]||(n[l]=[]),n[l][h]=E):n[Me({r:l,c:h})]=E,h+=d}}}}return n["!ref"]=$e(p),v.length&&(n["!merges"]=v),n}function H6(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var h=Me({r,c:a}),f=n.dense?(t[r]||[])[a]:t[h],d=f&&f.v!=null&&(f.h||Mm(f.w||(zi(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+h,s.push(me("td",d,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var z6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',G6="</body></html>";function q6(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ds(wE(r[0],e),e);var n=mg();return r.forEach(function(i,s){gg(n,wE(i,e),"Sheet"+(s+1))}),n}function K6(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Eb(t,e){var r=e||{},n=r.header!=null?r.header:z6,i=r.footer!=null?r.footer:G6,s=[n],a=on(t["!ref"]);r.dense=Array.isArray(t),s.push(K6(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(H6(t,a,o,r));return s.push("</table>"+i),s.join("")}function Tb(t,e,r){var n=r||{};zt!=null&&(n.dense=zt);var i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Ut(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=on(t["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),i==-1&&(l.e.r=i=h.e.r+1)}var f=[],d=0,p=t["!rows"]||(t["!rows"]=[]),v=0,m=0,_=0,b=0,S=0,T=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&m<c;++v){var N=o[v];if(EE(N)){if(n.display)continue;p[m]={hidden:!0}}var M=N.children;for(_=b=0;_<M.length;++_){var B=M[_];if(!(n.display&&EE(B))){var x=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):YE(B.innerHTML),w=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<f.length;++d){var E=f[d];E.s.c==b+s&&E.s.r<m+i&&m+i<=E.e.r&&(b=E.e.c+1-s,d=-1)}T=+B.getAttribute("colspan")||1,((S=+B.getAttribute("rowspan")||1)>1||T>1)&&f.push({s:{r:m+i,c:b+s},e:{r:m+i+(S||1)-1,c:b+s+(T||1)-1}});var C={t:"s",v:x},k=B.getAttribute("data-t")||B.getAttribute("t")||"";x!=null&&(x.length==0?C.t=k||"z":n.raw||x.trim().length==0||k=="s"||(x==="TRUE"?C={t:"b",v:!0}:x==="FALSE"?C={t:"b",v:!1}:isNaN(ei(x))?isNaN($o(x).getDate())||(C={t:"d",v:Pt(x)},n.cellDates||(C={t:"n",v:hr(C.v)}),C.z=n.dateNF||Pe[14]):C={t:"n",v:ei(x)})),C.z===void 0&&w!=null&&(C.z=w);var A="",R=B.getElementsByTagName("A");if(R&&R.length)for(var oe=0;oe<R.length&&!(R[oe].hasAttribute("href")&&(A=R[oe].getAttribute("href"),A.charAt(0)!="#"));++oe);A&&A.charAt(0)!="#"&&(C.l={Target:A}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][b+s]=C):t[Me({c:b+s,r:m+i})]=C,l.e.c<b+s&&(l.e.c=b+s),b+=T}}++m}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,m-1+i),t["!ref"]=$e(l),m>=c&&(t["!fullref"]=$e((l.e.r=o.length-v+m-1+i,l))),t}function bb(t,e){var r=e||{},n=r.dense?[]:{};return Tb(n,t,e)}function X6(t,e){return Ds(bb(t,e),e)}function EE(t){var e="",r=Y6(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Y6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Q6(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=st(e.replace(/<[^>]*>/g,""));return[r]}var TE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Ib(t,e){var r=e||{};zt!=null&&r.dense==null&&(r.dense=zt);var n=Lm(t),i=[],s,a,o={name:""},c="",l=0,h,f,d={},p=[],v=r.dense?[]:{},m,_,b={value:""},S="",T=0,N,M=[],B=-1,x=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,C={},k=[],A={},R=0,oe=0,se=[],Se=1,_e=1,Re=[],he={Names:[]},Ie={},re=["",""],j=[],G={},H="",W=0,te=!1,de=!1,ce=0;for(ru.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=ru.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":m[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=$e(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=$e(w)),k.length&&(v["!merges"]=k),se.length&&(v["!rows"]=se),h.name=h.\u540D\u79F0||h.name,typeof JSON<"u"&&JSON.stringify(h),p.push(h.name),d[h.name]=v,de=!1):m[0].charAt(m[0].length-2)!=="/"&&(h=Ve(m[0],!1),B=x=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},k=[],se=[],de=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"\u884C":if(m[1]==="/"){B+=Se,Se=1;break}if(f=Ve(m[0],!1),f.\u884C\u53F7?B=f.\u884C\u53F7-1:B==-1&&(B=0),Se=+f["number-rows-repeated"]||1,Se<10)for(ce=0;ce<Se;++ce)E>0&&(se[B+ce]={level:E});x=-1;break;case"covered-table-cell":m[1]!=="/"&&++x,r.sheetStubs&&(r.dense?(v[B]||(v[B]=[]),v[B][x]={t:"z"}):v[Me({r:B,c:x})]={t:"z"}),S="",M=[];break;case"table-cell":case"\u6570\u636E":if(m[0].charAt(m[0].length-2)==="/")++x,b=Ve(m[0],!1),_e=parseInt(b["number-columns-repeated"]||"1",10),_={t:"z",v:null},b.formula&&r.cellFormula!=!1&&(_.f=_E(st(b.formula))),(b.\u6570\u636E\u7C7B\u578B||b["value-type"])=="string"&&(_.t="s",_.v=st(b["string-value"]||""),r.dense?(v[B]||(v[B]=[]),v[B][x]=_):v[Me({r:B,c:x})]=_),x+=_e-1;else if(m[1]!=="/"){++x,S="",T=0,M=[],_e=1;var ue=Se?B+Se-1:B;if(x>w.e.c&&(w.e.c=x),x<w.s.c&&(w.s.c=x),B<w.s.r&&(w.s.r=B),ue>w.e.r&&(w.e.r=ue),b=Ve(m[0],!1),j=[],G={},_={t:b.\u6570\u636E\u7C7B\u578B||b["value-type"],v:null},r.cellFormula)if(b.formula&&(b.formula=st(b.formula)),b["number-matrix-columns-spanned"]&&b["number-matrix-rows-spanned"]&&(R=parseInt(b["number-matrix-rows-spanned"],10)||0,oe=parseInt(b["number-matrix-columns-spanned"],10)||0,A={s:{r:B,c:x},e:{r:B+R-1,c:x+oe-1}},_.F=$e(A),Re.push([A,_.F])),b.formula)_.f=_E(b.formula);else for(ce=0;ce<Re.length;++ce)B>=Re[ce][0].s.r&&B<=Re[ce][0].e.r&&x>=Re[ce][0].s.c&&x<=Re[ce][0].e.c&&(_.F=Re[ce][1]);switch((b["number-columns-spanned"]||b["number-rows-spanned"])&&(R=parseInt(b["number-rows-spanned"],10)||0,oe=parseInt(b["number-columns-spanned"],10)||0,A={s:{r:B,c:x},e:{r:B+R-1,c:x+oe-1}},k.push(A)),b["number-columns-repeated"]&&(_e=parseInt(b["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Rt(b["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(b.value);break;case"percentage":_.t="n",_.v=parseFloat(b.value);break;case"currency":_.t="n",_.v=parseFloat(b.value);break;case"date":_.t="d",_.v=Pt(b["date-value"]),r.cellDates||(_.t="n",_.v=hr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=bR(b["time-value"])/86400,r.cellDates&&(_.t="d",_.v=jf(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(b.\u6570\u636E\u6570\u503C);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",b["string-value"]!=null&&(S=st(b["string-value"]),M=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(te=!1,_.t==="s"&&(_.v=S||"",M.length&&(_.R=M),te=T==0),Ie.Target&&(_.l=Ie),j.length>0&&(_.c=j,j=[]),S&&r.cellText!==!1&&(_.w=S),te&&(_.t="z",delete _.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var ne=0;ne<Se;++ne){if(_e=parseInt(b["number-columns-repeated"]||"1",10),r.dense)for(v[B+ne]||(v[B+ne]=[]),v[B+ne][x]=ne==0?_:Ft(_);--_e>0;)v[B+ne][x+_e]=Ft(_);else for(v[Me({r:B+ne,c:x})]=_;--_e>0;)v[Me({r:B+ne,c:x+_e})]=Ft(_);w.e.c<=x&&(w.e.c=x)}_e=parseInt(b["number-columns-repeated"]||"1",10),x+=_e-1,_e=0,_={},S="",M=[]}Ie={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;G.t=S,M.length&&(G.R=M),G.a=H,j.push(G)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);H="",W=0,S="",T=0,M=[];break;case"creator":m[1]==="/"?H=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);S="",T=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(C[o.name]=c,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=Ve(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ve(m[0],!1),c+=TE[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ve(m[0],!1),c+=TE[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,m.index);break}else l=m.index+m[0].length;break;case"named-range":a=Ve(m[0],!1),re=cm(a["cell-range-address"]);var Be={Name:a.name,Ref:re[0]+"!"+re[1]};de&&(Be.Sheet=p.length),he.Names.push(Be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!b||!b["string-value"])){var U=Q6(n.slice(T,m.index),N);S=(S.length>0?S+`
`:"")+U[0]}else N=Ve(m[0],!1),T=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{re=cm(Ve(m[0])["target-range-address"]),d[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Ie=Ve(m[0],!1),!Ie.href)break;Ie.Target=st(Ie.href),delete Ie.href,Ie.Target.charAt(0)=="#"&&Ie.Target.indexOf(".")>-1?(re=cm(Ie.Target.slice(1)),Ie.Target="#"+re[0]+"!"+re[1]):Ie.Target.match(/^\.\.[\\\/]/)&&(Ie.Target=Ie.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(m)}}var nt={Sheets:d,SheetNames:p,Workbook:he};return r.bookSheets&&delete nt.Sheets,nt}function bE(t,e){e=e||{},Ln(t,"META-INF/manifest.xml")&&bP(ir(t,"META-INF/manifest.xml"),e);var r=yn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Ib(wt(r),e);return Ln(t,"meta.xml")&&(n.Props=mT(ir(t,"meta.xml"))),n}function IE(t,e){return Ib(t,e)}var J6=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+tu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Jt+e}}(),AE=function(){var t=function(s){return vt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+vt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,f=on(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var m="",_=s["!rows"]||[];for(l=0;l<f.s.r;++l)m=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;l<=f.e.r;++l){for(m=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+m+`>
`),h=0;h<f.s.c;++h)c.push(e);for(;h<=f.e.c;++h){var b=!1,S={},T="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>h)&&!(d[p].s.r>l)&&!(d[p].e.c<h)&&!(d[p].e.r<l)){(d[p].s.c!=h||d[p].s.r!=l)&&(b=!0),S["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,S["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(b){c.push(r);continue}var N=Me({r:l,c:h}),M=v?(s[l]||[])[h]:s[N];if(M&&M.f&&(S["table:formula"]=vt(_L(M.f)),M.F&&M.F.slice(0,N.length)==N)){var B=on(M.F);S["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,S["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!M){c.push(e);continue}switch(M.t){case"b":T=M.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=M.v?"true":"false";break;case"n":T=M.w||String(M.v||0),S["office:value-type"]="float",S["office:value"]=M.v||0;break;case"s":case"str":T=M.v==null?"":M.v,S["office:value-type"]="string";break;case"d":T=M.w||Pt(M.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Pt(M.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(e);continue}var x=t(T);if(M.l&&M.l.Target){var w=M.l.Target;w=w.charAt(0)=="#"?"#"+yL(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),x=me("text:a",x,{"xlink:href":w.replace(/&/g,"&amp;")})}c.push("          "+me("table:table-cell",me("text:p",x,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var f=l["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;As(f),f.ods=o;var d=l["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var f=l["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[Jt],l=tu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=tu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(pT().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Ab(t,e){if(e.bookType=="fods")return AE(t,e);var r=Fm(),n="",i=[],s=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,AE(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",qe(r,n,J6(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",qe(r,n,Jt+pT()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,SP(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,IP(i)),r}function ba(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Im(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):wt(ks(t))}function Z6(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):_n(yi(t))}function e8(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Cs(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function SE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function t8(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function r8(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function lu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function mt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Ht(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ct(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=lu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=lu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function kr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(mt(n*8+i.type)),i.type==2&&e.push(mt(i.data.length)),e.push(i.data))})}),Cs(e)}function ug(t,e){return t?.map(function(r){return e(r.data)})||[]}function Nn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=lu(t,n),s=ct(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Ht(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=ct(o.data),l=Ht(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Ht(s[3][0].data)>>>0>0),r.push(a)}return r}function Fo(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:mt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:mt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:mt(a.data.length)}],n[2].push({data:kr(a.meta),type:2})});var s=kr(n);e.push(mt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Cs(e)}function n8(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=lu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Cs(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var h=Cs(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Mn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(n8(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Cs(e)}function Oo(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=mt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Cs(e)}function i8(t,e,r,n){var i=ba(t),s=i.getUint32(4,!0),a=(n>1?12:8)+SE(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,h=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=SE(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function s8(t,e,r){var n=ba(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,h=new Date(2001,0,1);i&1&&(c=t8(t,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return f}function um(t,e){var r=new Uint8Array(32),n=ba(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,r8(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function hm(t,e){var r=new Uint8Array(32),n=ba(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function a8(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return i8(t,e,r,t[0]);case 5:return s8(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Nr(t){var e=ct(t);return lu(e[1][0].data)}function CE(t,e){var r=ct(e.data),n=Ht(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=ct(a.data),c=Ht(o[1][0].data)>>>0;switch(n){case 1:s[c]=Im(o[3][0].data);break;case 8:{var l=t[Nr(o[9][0].data)][0],h=ct(l.data),f=t[Nr(h[1][0].data)][0],d=Ht(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=ct(f.data);s[c]=p[3].map(function(v){return Im(v.data)}).join("")}break}}),s}function o8(t,e){var r,n,i,s,a,o,c,l,h,f,d,p,v,m,_=ct(t),b=Ht(_[1][0].data)>>>0,S=Ht(_[2][0].data)>>>0,T=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Ht(_[8][0].data)>0||!1,N,M;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)N=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,M=(l=(c=_[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(h=_[4])==null?void 0:h[0])!=null&&f.data&&e!=1)N=(p=(d=_[4])==null?void 0:d[0])==null?void 0:p.data,M=(m=(v=_[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=T?4:1,x=ba(N),w=[],E=0;E<N.length/2;++E){var C=x.getUint16(E*2,!0);C<65535&&w.push([E,C])}if(w.length!=S)throw"Expected ".concat(S," cells, found ").concat(w.length);var k=[];for(E=0;E<w.length-1;++E)k[w[E][0]]=M.subarray(w[E][1]*B,w[E+1][1]*B);return w.length>=1&&(k[w[w.length-1][0]]=M.subarray(w[w.length-1][1]*B)),{R:b,cells:k}}function c8(t,e){var r,n=ct(e.data),i=(r=n?.[7])!=null&&r[0]?Ht(n[7][0].data)>>>0>0?1:0:-1,s=ug(n[5],function(a){return o8(a,i)});return{nrows:Ht(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function l8(t,e,r){var n,i=ct(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Ht(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Ht(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=$e(s);var a=ct(i[4][0].data),o=CE(t,t[Nr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?CE(t,t[Nr(a[17][0].data)][0]):[],l=ct(a[3][0].data),h=0;l[1].forEach(function(f){var d=ct(f.data),p=t[Nr(d[2][0].data)][0],v=Ht(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=c8(t,p);m.data.forEach(function(_,b){_.forEach(function(S,T){var N=Me({r:h+b,c:T}),M=a8(S,o,c);M&&(r[N]=M)})}),h+=m.nrows})}function u8(t,e){var r=ct(e.data),n={"!ref":"A1"},i=t[Nr(r[2][0].data)],s=Ht(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return l8(t,i[0],n),n}function h8(t,e){var r,n=ct(e.data),i={name:(r=n[1])!=null&&r[0]?Im(n[1][0].data):"",sheets:[]},s=ug(n[2],Nr);return s.forEach(function(a){t[a].forEach(function(o){var c=Ht(o.meta[1][0].data);c==6e3&&i.sheets.push(u8(t,o))})}),i}function f8(t,e){var r=mg(),n=ct(e.data),i=ug(n[1],Nr);if(i.forEach(function(s){t[s].forEach(function(a){var o=Ht(a.meta[1][0].data);if(o==2){var c=h8(t,a);c.sheets.forEach(function(l,h){gg(r,l,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function fm(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=Mn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=Nn(l)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Ht(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var h=Ht(l.meta[1][0].data)>>>0;if(h==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return f8(s,o)}function d8(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Ht(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ba(t[7][0].data),h=0,f=[],d=ba(t[4][0].data),p=0,v=[],m=0;m<e.length;++m){if(e[m]==null){l.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}l.setUint16(m*2,h,!0),d.setUint16(m*2,p,!0);var _,b;switch(typeof e[m]){case"string":_=um({t:"s",v:e[m]},r),b=hm({t:"s",v:e[m]},r);break;case"number":_=um({t:"n",v:e[m]},r),b=hm({t:"n",v:e[m]},r);break;case"boolean":_=um({t:"b",v:e[m]},r),b=hm({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}f.push(_),h+=_.length,v.push(b),p+=b.length,++c}for(t[2][0].data=mt(c);m<t[7][0].data.length/2;++m)l.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=Cs(f),t[3][0].data=Cs(v),c}function p8(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=on(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($e(n)));var s=Mf(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],l=ke.read(e.numbers,{type:"base64"});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],te=H[1];if(W.type==2&&W.name.match(/\.iwa/)){var de=W.content,ce=Mn(de),ue=Nn(ce);ue.forEach(function(ne){c.push(ne.id),o[ne.id]={deps:[],location:te,type:Ht(ne.messages[0].meta[1][0].data)}})}}),c.sort(function(H,W){return H-W});var h=c.filter(function(H){return H>1}).map(function(H){return[H,mt(H)]});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],te=H[1];if(W.name.match(/\.iwa/)){var de=Nn(Mn(W.content));de.forEach(function(ce){ce.messages.forEach(function(ue){h.forEach(function(ne){ce.messages.some(function(Be){return Ht(Be.meta[1][0].data)!=11006&&e8(Be.data,ne[1])})&&o[ne[0]].deps.push(ce.id)})})})}});function f(){for(var H=927262;H<2e6;++H)if(!o[H])return H;throw new Error("Too many messages")}for(var d=ke.find(l,o[1].location),p=Nn(Mn(d.content)),v,m=0;m<p.length;++m){var _=p[m];_.id==1&&(v=_)}var b=Nr(ct(v.messages[0].data)[1][0].data);for(d=ke.find(l,o[b].location),p=Nn(Mn(d.content)),m=0;m<p.length;++m)_=p[m],_.id==b&&(v=_);for(b=Nr(ct(v.messages[0].data)[2][0].data),d=ke.find(l,o[b].location),p=Nn(Mn(d.content)),m=0;m<p.length;++m)_=p[m],_.id==b&&(v=_);for(b=Nr(ct(v.messages[0].data)[2][0].data),d=ke.find(l,o[b].location),p=Nn(Mn(d.content)),m=0;m<p.length;++m)_=p[m],_.id==b&&(v=_);var S=ct(v.messages[0].data);{S[6][0].data=mt(n.e.r+1),S[7][0].data=mt(n.e.c+1);var T=Nr(S[46][0].data),N=ke.find(l,o[T].location),M=Nn(Mn(N.content));{for(var B=0;B<M.length&&M[B].id!=T;++B);if(M[B].id!=T)throw"Bad ColumnRowUIDMapArchive";var x=ct(M[B].messages[0].data);x[1]=[],x[2]=[],x[3]=[];for(var w=0;w<=n.e.c;++w){var E=[];E[1]=E[2]=[{type:0,data:mt(w+420690)}],x[1].push({type:2,data:kr(E)}),x[2].push({type:0,data:mt(w)}),x[3].push({type:0,data:mt(w)})}x[4]=[],x[5]=[],x[6]=[];for(var C=0;C<=n.e.r;++C)E=[],E[1]=E[2]=[{type:0,data:mt(C+726270)}],x[4].push({type:2,data:kr(E)}),x[5].push({type:0,data:mt(C)}),x[6].push({type:0,data:mt(C)});M[B].messages[0].data=kr(x)}N.content=Oo(Fo(M)),N.size=N.content.length,delete S[46];var k=ct(S[4][0].data);{k[7][0].data=mt(n.e.r+1);var A=ct(k[1][0].data),R=Nr(A[2][0].data);N=ke.find(l,o[R].location),M=Nn(Mn(N.content));{if(M[0].id!=R)throw"Bad HeaderStorageBucket";var oe=ct(M[0].messages[0].data);for(C=0;C<s.length;++C){var se=ct(oe[2][0].data);se[1][0].data=mt(C),se[4][0].data=mt(s[C].length),oe[2][C]={type:oe[2][0].type,data:kr(se)}}M[0].messages[0].data=kr(oe)}N.content=Oo(Fo(M)),N.size=N.content.length;var Se=Nr(k[2][0].data);N=ke.find(l,o[Se].location),M=Nn(Mn(N.content));{if(M[0].id!=Se)throw"Bad HeaderStorageBucket";for(oe=ct(M[0].messages[0].data),w=0;w<=n.e.c;++w)se=ct(oe[2][0].data),se[1][0].data=mt(w),se[4][0].data=mt(n.e.r+1),oe[2][w]={type:oe[2][0].type,data:kr(se)};M[0].messages[0].data=kr(oe)}N.content=Oo(Fo(M)),N.size=N.content.length;var _e=Nr(k[4][0].data);(function(){for(var H=ke.find(l,o[_e].location),W=Nn(Mn(H.content)),te,de=0;de<W.length;++de){var ce=W[de];ce.id==_e&&(te=ce)}var ue=ct(te.messages[0].data);{ue[3]=[];var ne=[];a.forEach(function(nt,He){ne[1]=[{type:0,data:mt(He)}],ne[2]=[{type:0,data:mt(1)}],ne[3]=[{type:2,data:Z6(nt)}],ue[3].push({type:2,data:kr(ne)})})}te.messages[0].data=kr(ue);var Be=Fo(W),U=Oo(Be);H.content=U,H.size=H.content.length})();var Re=ct(k[3][0].data);{var he=Re[1][0];delete Re[2];var Ie=ct(he.data);{var re=Nr(Ie[2][0].data);(function(){for(var H=ke.find(l,o[re].location),W=Nn(Mn(H.content)),te,de=0;de<W.length;++de){var ce=W[de];ce.id==re&&(te=ce)}var ue=ct(te.messages[0].data);{delete ue[6],delete Re[7];var ne=new Uint8Array(ue[5][0].data);ue[5]=[];for(var Be=0,U=0;U<=n.e.r;++U){var nt=ct(ne);Be+=d8(nt,s[U],a),nt[1][0].data=mt(U),ue[5].push({data:kr(nt),type:2})}ue[1]=[{type:0,data:mt(n.e.c+1)}],ue[2]=[{type:0,data:mt(n.e.r+1)}],ue[3]=[{type:0,data:mt(Be)}],ue[4]=[{type:0,data:mt(n.e.r+1)}]}te.messages[0].data=kr(ue);var He=Fo(W),it=Oo(He);H.content=it,H.size=H.content.length})()}he.data=kr(Ie)}k[3][0].data=kr(Re)}S[4][0].data=kr(k)}v.messages[0].data=kr(S);var j=Fo(p),G=Oo(j);return d.content=G,d.size=d.content.length,l}function Sb(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function hg(t){Sb([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function fg(t){Sb([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function m8(t){return Ke.WS.indexOf(t)>-1?"sheet":Ke.CS&&t==Ke.CS?"chart":Ke.DS&&t==Ke.DS?"dialog":Ke.MS&&t==Ke.MS?"macro":t&&t.length?t:"sheet"}function g8(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,m8(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function v8(t,e,r,n,i,s,a,o,c,l,h,f){try{s[n]=Gl(yn(t,r,!0),e);var d=ir(t,e),p;switch(o){case"sheet":p=BV(d,e,i,c,s[n],l,h,f);break;case"chart":if(p=UV(d,e,i,c,s[n],l,h,f),!p||!p["!drawel"])break;var v=Wl(p["!drawel"].Target,e),m=nu(v),_=AM(yn(t,v,!0),Gl(yn(t,m,!0),v)),b=Wl(_,v),S=nu(b);p=dV(yn(t,b,!0),b,c,Gl(yn(t,S,!0),b),l,p);break;case"macro":p=jV(d,e,i,c,s[n],l,h,f);break;case"dialog":p=WV(d,e,i,c,s[n],l,h,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var T=[];s&&s[n]&&Gt(s[n]).forEach(function(N){var M="";if(s[n][N].Type==Ke.CMNT){M=Wl(s[n][N].Target,e);var B=GV(ir(t,M,!0),M,c);if(!B||!B.length)return;dE(p,B,!1)}s[n][N].Type==Ke.TCMNT&&(M=Wl(s[n][N].Target,e),T=T.concat(CM(ir(t,M,!0),c)))}),T&&T.length&&dE(p,T,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Fn(t){return t.charAt(0)=="/"?t.slice(1):t}function _8(t,e){if(qo(),e=e||{},hg(e),Ln(t,"META-INF/manifest.xml")||Ln(t,"objectdata.xml"))return bE(t,e);if(Ln(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof fm<"u"){if(t.FileIndex)return fm(t);var r=ke.utils.cfb_new();return Ow(t).forEach(function(oe){qe(r,oe,GE(t,oe))}),fm(r)}throw new Error("Unsupported NUMBERS file")}if(!Ln(t,"[Content_Types].xml"))throw Ln(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Ln(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Ow(t),i=EP(yn(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",ir(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!ir(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(ql=[],i.sst)try{ql=zV(ir(t,Fn(i.sst)),i.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&i.themes.length&&(c=HV(yn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=$V(ir(t,Fn(i.style)),i.style,c,e))}i.links.map(function(oe){try{var se=Gl(yn(t,nu(Fn(oe))),oe);return KV(ir(t,Fn(oe)),se,oe,e)}catch{}});var h=VV(ir(t,Fn(i.workbooks[0])),i.workbooks[0],e),f={},d="";i.coreprops.length&&(d=ir(t,Fn(i.coreprops[0]),!0),d&&(f=mT(d)),i.extprops.length!==0&&(d=ir(t,Fn(i.extprops[0]),!0),d&&kP(d,f,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=yn(t,Fn(i.custprops[0]),!0),d&&(p=RP(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(se){return se.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(v.Props=f,v.Custprops=p),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var m={};e.bookDeps&&i.calcchain&&(m=qV(ir(t,Fn(i.calcchain)),i.calcchain,e));var _=0,b={},S,T;{var N=h.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var M=0;M!=N.length;++M)f.SheetNames[M]=N[M].name}var B=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),w=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");Ln(t,w)||(w="xl/_rels/workbook."+B+".rels");var E=Gl(yn(t,w,!0),w.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=XV(ir(t,Fn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=DM(ir(t,Fn(i.people[0])),e)),E&&(E=g8(E,h.Sheets));var C=ir(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var k="sheet";if(E&&E[_]?(S="xl/"+E[_][1].replace(/[\/]?xl\//,""),Ln(t,S)||(S=E[_][1]),Ln(t,S)||(S=w.replace(/_rels\/.*$/,"")+E[_][1]),k=E[_][2]):(S="xl/worksheets/sheet"+(_+1-C)+"."+B,S=S.replace(/sheet0\./,"sheet.")),T=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==_&&(A=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==f.SheetNames[_].toLowerCase()&&(A=1);if(!A)continue e}}v8(t,S,T,f.SheetNames[_],_,b,a,k,e,h,c,l)}return v={Directory:i,Workbook:h,Props:f,Custprops:p,Deps:m,Sheets:a,SheetNames:f.SheetNames,Strings:ql,Styles:l,Themes:c,SSF:Ft(Pe)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(oe,se){oe=oe.replace(/^Root Entry[\/]/,""),v.keys.push(oe),v.files[oe]=t.FileIndex[se]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=ir(t,Fn(i.vba[0]),!0):i.defaults&&i.defaults.bin===VM&&(v.vbaraw=ir(t,"xl/vbaProject.bin",!0))),v}function y8(t,e){var r=e||{},n="Workbook",i=ke.find(t,n);try{if(n="/!DataSpaces/Version",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(XO(i.content),n="/!DataSpaces/DataSpaceMap",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=QO(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=JO(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);eN(i.content)}catch{}if(n="/EncryptionInfo",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=tN(i.content);if(n="/EncryptedPackage",i=ke.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function x8(t,e){return e.bookType=="ods"?Ab(t,e):e.bookType=="numbers"?p8(t,e):e.bookType=="xlsb"?w8(t,e):E8(t,e)}function w8(t,e){Lo=1024,t&&!t.SSF&&(t.SSF=Ft(Pe)),t&&t.SSF&&(qo(),Vf(t.SSF),e.revssf=Uf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Kl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=eb.indexOf(e.bookType)>-1,i=Qm();fg(e=e||{});var s=Fm(),a="",o=0;if(e.cellXfs=[],Rs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",qe(s,a,gT(t.Props,e)),i.coreprops.push(a),gt(e.rels,2,a,Ke.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,qe(s,a,yT(t.Props,e)),i.extprops.push(a),gt(e.rels,3,a,Ke.EXT_PROPS),t.Custprops!==t.Props&&Gt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",qe(s,a,xT(t.Custprops,e)),i.custprops.push(a),gt(e.rels,4,a,Ke.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,qe(s,a,QV(o-1,a,e,t,h)),i.sheets.push(a),gt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ke.WS[0])}if(f){var p=f["!comments"],v=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,qe(s,m,e6(p,m,e)),i.comments.push(m),gt(h,-1,"../comments"+o+"."+r,Ke.CMNT),v=!0),f["!legacy"]&&v&&qe(s,"xl/drawings/vmlDrawing"+o+".vml",JT(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qe(s,nu(a),Bo(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,qe(s,a,ZV(e.Strings,a,e)),i.strs.push(a),gt(e.wbrels,-1,"sharedStrings."+r,Ke.SST)),a="xl/workbook."+r,qe(s,a,YV(t,a,e)),i.workbooks.push(a),gt(e.rels,1,a,Ke.WB),a="xl/theme/theme1.xml",qe(s,a,ng(t.Themes,e)),i.themes.push(a),gt(e.wbrels,-1,"theme/theme1.xml",Ke.THEME),a="xl/styles."+r,qe(s,a,JV(t,a,e)),i.styles.push(a),gt(e.wbrels,-1,"styles."+r,Ke.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",qe(s,a,t.vbaraw),i.vba.push(a),gt(e.wbrels,-1,"vbaProject.bin",Ke.VBA)),a="xl/metadata."+r,qe(s,a,t6(a)),i.metadata.push(a),gt(e.wbrels,-1,"metadata."+r,Ke.XLMETA),qe(s,"[Content_Types].xml",dT(i,e)),qe(s,"_rels/.rels",Bo(e.rels)),qe(s,"xl/_rels/workbook."+r+".rels",Bo(e.wbrels)),delete e.revssf,delete e.ssf,s}function E8(t,e){Lo=1024,t&&!t.SSF&&(t.SSF=Ft(Pe)),t&&t.SSF&&(qo(),Vf(t.SSF),e.revssf=Uf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Kl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=eb.indexOf(e.bookType)>-1,i=Qm();fg(e=e||{});var s=Fm(),a="",o=0;if(e.cellXfs=[],Rs(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",qe(s,a,gT(t.Props,e)),i.coreprops.push(a),gt(e.rels,2,a,Ke.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,qe(s,a,yT(t.Props,e)),i.extprops.push(a),gt(e.rels,3,a,Ke.EXT_PROPS),t.Custprops!==t.Props&&Gt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",qe(s,a,xT(t.Custprops,e)),i.custprops.push(a),gt(e.rels,4,a,Ke.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,qe(s,a,hb(o-1,e,t,f)),i.sheets.push(a),gt(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ke.WS[0])}if(d){var v=d["!comments"],m=!1,_="";if(v&&v.length>0){var b=!1;v.forEach(function(S){S[1].forEach(function(T){T.T==!0&&(b=!0)})}),b&&(_="xl/threadedComments/threadedComment"+o+"."+r,qe(s,_,kM(v,h,e)),i.threadedcomments.push(_),gt(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ke.TCMNT)),_="xl/comments"+o+"."+r,qe(s,_,ZT(v,e)),i.comments.push(_),gt(f,-1,"../comments"+o+"."+r,Ke.CMNT),m=!0}d["!legacy"]&&m&&qe(s,"xl/drawings/vmlDrawing"+o+".vml",JT(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&qe(s,nu(a),Bo(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,qe(s,a,UT(e.Strings,e)),i.strs.push(a),gt(e.wbrels,-1,"sharedStrings."+r,Ke.SST)),a="xl/workbook."+r,qe(s,a,gb(t,e)),i.workbooks.push(a),gt(e.rels,1,a,Ke.WB),a="xl/theme/theme1.xml",qe(s,a,ng(t.Themes,e)),i.themes.push(a),gt(e.wbrels,-1,"theme/theme1.xml",Ke.THEME),a="xl/styles."+r,qe(s,a,KT(t,e)),i.styles.push(a),gt(e.wbrels,-1,"styles."+r,Ke.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",qe(s,a,t.vbaraw),i.vba.push(a),gt(e.wbrels,-1,"vbaProject.bin",Ke.VBA)),a="xl/metadata."+r,qe(s,a,QT()),i.metadata.push(a),gt(e.wbrels,-1,"metadata."+r,Ke.XLMETA),h.length>1&&(a="xl/persons/person.xml",qe(s,a,RM(h,e)),i.people.push(a),gt(e.wbrels,-1,"persons/person.xml",Ke.PEOPLE)),qe(s,"[Content_Types].xml",dT(i,e)),qe(s,"_rels/.rels",Bo(e.rels)),qe(s,"xl/_rels/workbook."+r+".rels",Bo(e.wbrels)),delete e.revssf,delete e.ssf,s}function dg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=xn(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function T8(t,e){return ke.find(t,"EncryptedPackage")?y8(t,e):xb(t,e)}function b8(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r=qE(n,i),_8(r,i)}function Cb(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Tm(t.slice(r),e);default:break e}return Ho.to_workbook(t,e)}function I8(t,e){var r="",n=dg(t,e);switch(e.type){case"base64":r=xn(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=xa(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=wt(r)),e.type="binary",Cb(r,e)}function A8(t,e){var r=t;return e.type=="base64"&&(r=xn(r)),r=pt.utils.decode(1200,r.slice(2),"str"),e.type="binary",Cb(r,e)}function S8(t){return t.match(/[^\x00-\x7F]/)?yi(t):t}function dm(t,e,r,n){return n?(r.type="string",Ho.to_workbook(t,r)):Ho.to_workbook(e,r)}function Nf(t,e){Cm();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Nf(new Uint8Array(t),(r=Ft(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),jo={},r.dateNF&&(jo.dateNF=r.dateNF),r.type||(r.type=Ye&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ye?"buffer":"binary",n=wR(t),typeof Uint8Array<"u"&&!Ye&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=S8(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Ft(r),r.type="array",Nf(km(n),r)}switch((i=dg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return T8(ke.read(n,r),r);break;case 9:if(i[1]<=8)return xb(n,r);break;case 60:return Tm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return PO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return VT.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?b8(n,r):dm(t,n,r,s);case 239:return i[3]===60?Tm(n,r):dm(t,n,r,s);case 255:if(i[1]===254)return A8(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return va.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return va.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Em.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return zT.to_workbook(n,r);break;case 10:case 13:case 32:return I8(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return RO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Em.to_workbook(n,r):dm(t,n,r,s)}function kb(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return hu(e.file,ke.write(t,{type:Ye?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return ke.write(t,e)}function C8(t,e){var r=Ft(e||{}),n=x8(t,r);return k8(n,r)}function k8(t,e){var r={},n=Ye?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?ke.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Lf(i))}return e.password&&typeof encrypt_agile<"u"?kb(encrypt_agile(i,e.password),e):e.type==="file"?hu(e.file,i):e.type=="string"?wt(i):i}function D8(t,e){var r=e||{},n=S6(t,r);return kb(n,r)}function _i(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Jl(yi(n));case"binary":return yi(n);case"string":return t;case"file":return hu(e.file,n,"utf8");case"buffer":return Ye?Gi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):_i(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function R8(t,e){switch(e.type){case"base64":return Jl(t);case"binary":return t;case"string":return t;case"file":return hu(e.file,t,"binary");case"buffer":return Ye?Gi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Tf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Jl(r):e.type=="string"?wt(r):r;case"file":return hu(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Db(t,e){Cm(),TV(t);var r=Ft(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Db(t,r);return r.type="array",Lf(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return _i(x6(t,r),r);case"slk":case"sylk":return _i(LT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return _i(Eb(t.Sheets[t.SheetNames[i]],r),r);case"txt":return R8(Pb(t.Sheets[t.SheetNames[i]],r),r);case"csv":return _i(pg(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return _i(VT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Tf(Em.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return _i(Ho.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return _i(zT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return _i(BT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return _i(Ab(t,r),r);case"wk1":return Tf(va.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Tf(va.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Tf(wb(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),D8(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return C8(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function P8(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Rb(t,e,r){var n=r||{};return n.type="file",n.file=e,P8(n),Db(t,n)}function F8(t,e,r,n,i,s,a,o){var c=Qt(r),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=a?t[r][p]:t[n[p]+c];if(v===void 0||v.t===void 0){if(l===void 0)continue;s[p]!=null&&(d[s[p]]=l);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)d[s[p]]=null;else if(l!==void 0)d[s[p]]=l;else if(h&&m===null)d[s[p]]=null;else continue;else d[s[p]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:zi(v,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function Mf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},h=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof h){case"string":c=at(h);break;case"number":c=at(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=Qt(c.s.r),d=[],p=[],v=0,m=0,_=Array.isArray(t),b=c.s.r,S=0,T={};_&&!t[b]&&(t[b]=[]);var N=l.skipHidden&&t["!cols"]||[],M=l.skipHidden&&t["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(N[S]||{}).hidden)switch(d[S]=Bt(S),r=_?t[b][S]:t[d[S]+f],n){case 1:s[S]=S-c.s.c;break;case 2:s[S]=d[S];break;case 3:s[S]=l.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=zi(r,null,l),m=T[a]||0,!m)T[a]=1;else{do o=a+"_"+m++;while(T[o]);T[a]=m,T[o]=1}s[S]=o}for(b=c.s.r+i;b<=c.e.r;++b)if(!(M[b]||{}).hidden){var B=F8(t,c,b,d,n,s,_,l);(B.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(p[v++]=B.row)}return p.length=v,p}var kE=/"/g;function O8(t,e,r,n,i,s,a,o){for(var c=!0,l=[],h="",f=Qt(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+f];if(p==null)h="";else if(p.v!=null){c=!1,h=""+(o.rawNumbers&&p.t=="n"?p.v:zi(p,null,o));for(var v=0,m=0;v!==h.length;++v)if((m=h.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){h='"'+h.replace(kE,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(c=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(kE,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function pg(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=at(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(f[v]=Bt(v));for(var m=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(h=O8(t,i,_,f,a,c,s,n),h!=null&&(n.strip&&(h=h.replace(l,"")),(h||n.blankrows!==!1)&&r.push((m++?o:"")+h)));return delete n.dense,r.join("")}function Pb(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=pg(t,e);if(typeof pt>"u"||e.type=="string")return r;var n=pt.utils.encode(1200,r,"str");return"\xFF\xFE"+n}function N8(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=at(t["!ref"]),s="",a=[],o,c=[],l=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Bt(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Qt(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=l?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function Fb(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=at(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,_){Gt(m).forEach(function(b){(p=d.indexOf(b))==-1&&(d[p=d.length]=b);var S=m[b],T="z",N="",M=Me({c:o+p,r:a+_+i});l=uu(s,M),S&&typeof S=="object"&&!(S instanceof Date)?s[M]=S:(typeof S=="number"?T="n":typeof S=="boolean"?T="b":typeof S=="string"?T="s":S instanceof Date?(T="d",n.cellDates||(T="n",S=hr(S)),N=n.dateNF||Pe[14]):S===null&&n.nullError&&(T="e",S=0),l?(l.t=T,l.v=S,delete l.w,delete l.R,N&&(l.z=N)):s[M]=l={t:T,v:S},N&&(l.z=N))})}),h.e.c=Math.max(h.e.c,o+d.length-1);var v=Qt(a);if(i)for(p=0;p<d.length;++p)s[Bt(p+o)+v]={t:"s",v:d[p]};return s["!ref"]=$e(h),s}function M8(t,e){return Fb(null,t,e)}function uu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ut(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?uu(t,Me(e)):uu(t,Me({r:e,c:r||0}))}function L8(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function mg(){return{SheetNames:[],Sheets:{}}}function gg(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(mb(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function V8(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=L8(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function B8(t,e){return t.z=e,t}function Ob(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function U8(t,e,r){return Ob(t,"#"+e,r)}function j8(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function W8(t,e,r,n){for(var i=typeof e!="string"?e:at(e),s=typeof e=="string"?e:$e(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=uu(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var _u={encode_col:Bt,encode_row:Qt,encode_cell:Me,encode_range:$e,decode_col:zm,decode_row:Hm,split_cell:ZR,decode_cell:Ut,decode_range:on,format_cell:zi,sheet_add_aoa:aT,sheet_add_json:Fb,sheet_add_dom:Tb,aoa_to_sheet:Xo,json_to_sheet:M8,table_to_sheet:bb,table_to_book:X6,sheet_to_csv:pg,sheet_to_txt:Pb,sheet_to_json:Mf,sheet_to_html:Eb,sheet_to_formulae:N8,sheet_to_row_object_array:Mf,sheet_get_cell:uu,book_new:mg,book_append_sheet:gg,book_set_sheet_visibility:V8,cell_set_number_format:B8,cell_set_hyperlink:Ob,cell_set_internal_link:U8,cell_add_comment:j8,sheet_set_array_formula:W8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var uz=Ql.version;var qf=(()=>{let e=class e{constructor(){this.data={}}setHeaderData(n){this.data=n}getHeaderData(){return this.data}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Mb=(()=>{let e=class e{constructor(n){this.headerDataService=n,this.guardarHeader=new Sr,this.cerrarModal=new Sr,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[];let i=this.headerDataService.getHeaderData();i&&(this.institucion=i.institucion,this.examen=i.examen,this.fecha=i.fecha==null||i.fecha==""?this.getFechaActual():i.fecha,this.duracion=i.duracion,this.profesor=i.profesor,this.catedra=i.catedra,this.dniChecked=i.dniChecked,this.puntosChecked=i.puntosChecked,this.logoFiles=i.logoFile)}guardarDatosHeader(){let n={institucion:this.institucion,examen:this.examen,fecha:this.fecha,duracion:this.duracion,profesor:this.profesor,catedra:this.catedra,logoFile:this.logoFiles,dniChecked:this.dniChecked,puntosChecked:this.puntosChecked};this.headerDataService.setHeaderData(n),this.guardarHeader.emit(n),this.cerrarModal.emit()}onClose(){this.cerrarModal.emit()}onLogoChange(n){let i=n.target,s=i.files&&i.files[0];s&&this.logoFiles.push(s)}getFechaActual(){let n=new Date,i=new Date(n.toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"})),s=i.getFullYear(),a=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return`${s}-${a}-${o}`}};e.\u0275fac=function(i){return new(i||e)(Ue(qf))},e.\u0275cmp=tr({type:e,selectors:[["app-header"]],outputs:{guardarHeader:"guardarHeader",cerrarModal:"cerrarModal"},standalone:!0,features:[rr],decls:48,vars:8,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-gray-900","bg-opacity-50"],["id","modal",1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-lg","w-full","mx-4","max-h-[85vh]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit"],["for","institucion",1,"block","font-semibold","mb-2"],["type","text","id","institucion","name","institucion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","logo",1,"block","font-semibold","mb-2"],["type","file","id","logoInput","accept","image/*",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"change"],["for","examen",1,"block","font-semibold","mb-2"],["type","text","id","examen","name","examen","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","flex-col","sm:flex-row","gap-2"],[1,"flex-1"],["for","fecha",1,"block","font-semibold","mb-2"],["type","date","id","fecha","name","fecha","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","duracion",1,"block","font-semibold","mb-2"],["type","text","id","duracion","name","duracion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","profesor",1,"block","font-semibold","mb-2"],["type","text","id","profesor","name","profesor","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","catedra",1,"block","font-semibold","mb-2"],["type","text","id","catedra","name","catedra","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","mb-4"],["type","checkbox","id","dniCheckbox","name","dniCheckbox",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","dniCheckbox",1,"ms-2","font-semibold"],["type","checkbox","id","puntosCheckbox","name","puntos",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","puntos",1,"ms-2","font-semibold"],[1,"flex","justify-end","space-x-4"],["type","button",1,"bg-gray-300","text-gray-800","py-2","px-4","rounded","hover:bg-gray-400",3,"click"],["type","submit",1,"bg-blue-500","text-white","py-2","px-4","rounded","hover:bg-blue-600"]],template:function(i,s){i&1&&(Te(0,"div",0)(1,"div",1)(2,"h2",2),Ne(3,"Ingresar datos del membrete"),we(),Te(4,"form",3),Dt("ngSubmit",function(){return s.guardarDatosHeader()}),Te(5,"div")(6,"label",4),Ne(7,"Instituci\xF3n:"),we(),Te(8,"input",5),pn("ngModelChange",function(o){return dn(s.institucion,o)||(s.institucion=o),o}),we()(),Te(9,"div")(10,"label",6),Ne(11,"Logo de la instituci\xF3n:"),we(),Te(12,"input",7),Dt("change",function(o){return s.onLogoChange(o)}),we()(),Te(13,"div")(14,"label",8),Ne(15,"Examen:"),we(),Te(16,"input",9),pn("ngModelChange",function(o){return dn(s.examen,o)||(s.examen=o),o}),we()(),Te(17,"div",10)(18,"div",11)(19,"label",12),Ne(20,"Fecha:"),we(),Te(21,"input",13),pn("ngModelChange",function(o){return dn(s.fecha,o)||(s.fecha=o),o}),we()(),Te(22,"div",11)(23,"label",14),Ne(24,"Duraci\xF3n:"),we(),Te(25,"input",15),pn("ngModelChange",function(o){return dn(s.duracion,o)||(s.duracion=o),o}),we()()(),Te(26,"div",10)(27,"div",11)(28,"label",16),Ne(29,"Profesor:"),we(),Te(30,"input",17),pn("ngModelChange",function(o){return dn(s.profesor,o)||(s.profesor=o),o}),we()(),Te(31,"div",11)(32,"label",18),Ne(33,"C\xE1tedra:"),we(),Te(34,"input",19),pn("ngModelChange",function(o){return dn(s.catedra,o)||(s.catedra=o),o}),we()()(),Te(35,"div",20)(36,"input",21),pn("ngModelChange",function(o){return dn(s.dniChecked,o)||(s.dniChecked=o),o}),we(),Te(37,"label",22),Ne(38,"DNI Alumno"),we()(),Te(39,"div",20)(40,"input",23),pn("ngModelChange",function(o){return dn(s.puntosChecked,o)||(s.puntosChecked=o),o}),we(),Te(41,"label",24),Ne(42,"Puntos"),we()(),Te(43,"div",25)(44,"button",26),Dt("click",function(){return s.onClose()}),Ne(45," Cancelar "),we(),Te(46,"button",27),Ne(47," Guardar "),we()()()()()),i&2&&(ft(8),fn("ngModel",s.institucion),ft(8),fn("ngModel",s.examen),ft(5),fn("ngModel",s.fecha),ft(4),fn("ngModel",s.duracion),ft(5),fn("ngModel",s.profesor),ft(4),fn("ngModel",s.catedra),ft(2),fn("ngModel",s.dniChecked),ft(4),fn("ngModel",s.puntosChecked))},dependencies:[Ro,Do,ws,Lp,Co,ko,ua,Pl,$p],encapsulation:2});let t=e;return t})();function Lb(t,e){return typeof t=="function"?t(e):t}function vg(t){return t.split("-")[0]}function Vb(t){return t.split("-")[1]}function Bb(t){return["top","bottom"].includes(vg(t))?"y":"x"}function z8(t,e){return Z(this,null,function*(){let{placement:r,platform:n,elements:i}=t,s=yield n.isRTL==null?void 0:n.isRTL(i.floating),a=vg(r),o=Vb(r),c=Bb(r)==="y",l=["left","top"].includes(a)?-1:1,h=s&&c?-1:1,f=Lb(e,t),{mainAxis:d,crossAxis:p,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:be({mainAxis:0,crossAxis:0,alignmentAxis:null},f);return o&&typeof v=="number"&&(p=o==="end"?v*-1:v),c?{x:p*h,y:d*l}:{x:d*l,y:p*h}})}var Ub=function(t){return t===void 0&&(t=0),{name:"offset",options:t,fn(r){return Z(this,null,function*(){var n,i;let{x:s,y:a,placement:o,middlewareData:c}=r,l=yield z8(r,t);return o===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:a+l.y,data:ht(be({},l),{placement:o})}})}}};var ri=Ub;var jb=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["app-loading-print"]],standalone:!0,features:[rr],decls:7,vars:0,consts:[["id","printOverlay",1,"fixed","inset-0","bg-white","flex","flex-col","items-center","justify-center","z-50","print:flex"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"animate-spin","h-16","w-16","mb-4"],["cx","16","cy","16","r","14","fill","#3498db",1,"shadow-md"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"text-lg","font-semibold","text-gray-700"]],template:function(i,s){i&1&&(Te(0,"div",0),ta(),Te(1,"svg",1),xt(2,"circle",2)(3,"circle",3)(4,"circle",4),we(),fo(),Te(5,"p",5),Ne(6,"Cargando, por favor espere..."),we()())},encapsulation:2});let t=e;return t})();var Wb=(()=>{let e=class e{generateExams(n,i,s,a){let o=[];if(s!=0)for(let c=0;c<n;c++){let l=[],h=0;for(;h<s;){if(a.length===0){console.warn("No hay suficientes preguntas disponibles para generar un examen completo.");break}let d=Math.floor(Math.random()*a.length),p=a[d];!l.some(m=>m.pregunta===p.pregunta)&&Number(p.puntaje)<=s&&(l.push(p),h-=Number(p.puntaje))}let f=l.map(d=>be({},d));o.push(f)}else for(let c=0;c<n;c++){let l=[];for(;l.length<i;){let d=this.getRandomQuestion(a),p=this.mezclarArray(d.respuesta);d.respuesta=p,l.some(m=>m.pregunta===d.pregunta)||l.push(d)}let h=100/i,f=l.map(d=>ht(be({},d),{puntaje:h}));o.push(f)}return o}getRandomQuestion(n){let i=Math.floor(Math.random()*n.length);return n[i]}mezclarArray(n){let i=[...n];for(let s=i.length-1;s>0;s--){let a=Math.floor(Math.random()*(s+1)),o=i[s];i[s]=i[a],i[a]=o}return i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var q8=function(e){return K8(e)&&!X8(e)};function K8(t){return!!t&&typeof t=="object"}function X8(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||J8(t)}var Y8=typeof Symbol=="function"&&Symbol.for,Q8=Y8?Symbol.for("react.element"):60103;function J8(t){return t.$$typeof===Q8}function Z8(t){return Array.isArray(t)?[]:{}}function xu(t,e){return e.clone!==!1&&e.isMergeableObject(t)?rc(Z8(t),t,e):t}function eB(t,e,r){return t.concat(e).map(function(n){return xu(n,r)})}function tB(t,e){if(!e.customMerge)return rc;var r=e.customMerge(t);return typeof r=="function"?r:rc}function rB(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function $b(t){return Object.keys(t).concat(rB(t))}function cI(t,e){try{return e in t}catch{return!1}}function nB(t,e){return cI(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function iB(t,e,r){var n={};return r.isMergeableObject(t)&&$b(t).forEach(function(i){n[i]=xu(t[i],r)}),$b(e).forEach(function(i){nB(t,i)||(cI(t,i)&&r.isMergeableObject(e[i])?n[i]=tB(i,r)(t[i],e[i],r):n[i]=xu(e[i],r))}),n}function rc(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||eB,r.isMergeableObject=r.isMergeableObject||q8,r.cloneUnlessOtherwiseSpecified=xu;var n=Array.isArray(e),i=Array.isArray(t),s=n===i;return s?n?r.arrayMerge(t,e,r):iB(t,e,r):xu(e,r)}rc.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,i){return rc(n,i,r)},{})};var sB=rc,Fg=sB;function aB(t){return t instanceof Element}function Og(t){return t instanceof HTMLElement}function Na(t){return typeof t=="function"}function wu(t){return typeof t=="string"}function $r(t){return t===void 0}var Eu=class{on(e,r,n,i=!1){return $r(this.bindings)&&(this.bindings={}),$r(this.bindings[e])&&(this.bindings[e]=[]),this.bindings[e].push({handler:r,ctx:n,once:i}),this}once(e,r,n){return this.on(e,r,n,!0)}off(e,r){return $r(this.bindings)||$r(this.bindings[e])?this:($r(r)?delete this.bindings[e]:this.bindings[e].forEach((n,i)=>{n.handler===r&&this.bindings[e].splice(i,1)}),this)}trigger(e,...r){return!$r(this.bindings)&&this.bindings[e]&&this.bindings[e].forEach((n,i)=>{let{ctx:s,handler:a,once:o}=n,c=s||this;a.apply(c,r),o&&this.bindings[e].splice(i,1)}),this}};function lI(t){let e=Object.getOwnPropertyNames(t.constructor.prototype);for(let r=0;r<e.length;r++){let n=e[r],i=t[n];n!=="constructor"&&typeof i=="function"&&(t[n]=i.bind(t))}return t}function oB(t,e){return r=>{if(e.isOpen()){let n=e.el&&r.currentTarget===e.el;(!$r(t)&&r.currentTarget.matches(t)||n)&&e.tour.next()}}}function cB(t){let{event:e,selector:r}=t.options.advanceOn||{};if(e){let n=oB(r,t),i;try{i=document.querySelector(r)}catch{}if(!$r(r)&&!i)return console.error(`No element was found for the selector supplied to advanceOn: ${r}`);i?(i.addEventListener(e,n),t.on("destroy",()=>i.removeEventListener(e,n))):(document.body.addEventListener(e,n,!0),t.on("destroy",()=>document.body.removeEventListener(e,n,!0)))}else return console.error("advanceOn was defined, but no event name was passed.")}function uI(t){return!wu(t)||t===""?"":t.charAt(t.length-1)!=="-"?`${t}-`:t}function lB(t){let e=t.options.attachTo||{},r=Object.assign({},e);if(Na(r.element)&&(r.element=r.element.call(t)),wu(r.element)){try{r.element=document.querySelector(r.element)}catch{}r.element||console.error(`The element for this Shepherd step was not found ${e.element}`)}return r}function hI(t){return t==null?!0:!t.element||!t.on}function Ng(){let t=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e=="x"?r:r&3|8).toString(16)})}function Hr(){return Hr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Hr.apply(this,arguments)}function fI(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var nc=Math.min,Pa=Math.max,Yf=Math.round,Kf=Math.floor,Fs=t=>({x:t,y:t}),uB={left:"right",right:"left",bottom:"top",top:"bottom"},hB={start:"end",end:"start"};function yg(t,e,r){return Pa(t,nc(e,r))}function ic(t,e){return typeof t=="function"?t(e):t}function Ma(t){return t.split("-")[0]}function rd(t){return t.split("-")[1]}function Mg(t){return t==="x"?"y":"x"}function Lg(t){return t==="y"?"height":"width"}function nd(t){return["top","bottom"].includes(Ma(t))?"y":"x"}function Vg(t){return Mg(nd(t))}function fB(t,e,r){r===void 0&&(r=!1);let n=rd(t),i=Vg(t),s=Lg(i),a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=Qf(a)),[a,Qf(a)]}function dB(t){let e=Qf(t);return[xg(t),e,xg(e)]}function xg(t){return t.replace(/start|end/g,e=>hB[e])}function pB(t,e,r){let n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return r?e?i:n:e?n:i;case"left":case"right":return e?s:a;default:return[]}}function mB(t,e,r,n){let i=rd(t),s=pB(Ma(t),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(xg)))),s}function Qf(t){return t.replace(/left|right|bottom|top/g,e=>uB[e])}function gB(t){return Hr({top:0,right:0,bottom:0,left:0},t)}function dI(t){return typeof t!="number"?gB(t):{top:t,right:t,bottom:t,left:t}}function Jf(t){return Hr({},t,{top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height})}var vB=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],_B=["mainAxis","crossAxis","limiter"];function Hb(t,e,r){let{reference:n,floating:i}=t,s=nd(e),a=Vg(e),o=Lg(a),c=Ma(e),l=s==="y",h=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,d=n[o]/2-i[o]/2,p;switch(c){case"top":p={x:h,y:n.y-i.height};break;case"bottom":p={x:h,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:f};break;case"left":p={x:n.x-i.width,y:f};break;default:p={x:n.x,y:n.y}}switch(rd(e)){case"start":p[a]-=d*(r&&l?-1:1);break;case"end":p[a]+=d*(r&&l?-1:1);break}return p}var yB=(t,e,r)=>Z(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),c=yield a.isRTL==null?void 0:a.isRTL(e),l=yield a.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:f}=Hb(l,n,c),d=n,p={},v=0;for(let m=0;m<o.length;m++){let{name:_,fn:b}=o[m],{x:S,y:T,data:N,reset:M}=yield b({x:h,y:f,initialPlacement:n,placement:d,strategy:i,middlewareData:p,rects:l,platform:a,elements:{reference:t,floating:e}});if(h=S??h,f=T??f,p=Hr({},p,{[_]:Hr({},p[_],N)}),M&&v<=50){v++,typeof M=="object"&&(M.placement&&(d=M.placement),M.rects&&(l=M.rects===!0?yield a.getElementRects({reference:t,floating:e,strategy:i}):M.rects),{x:h,y:f}=Hb(l,d,c)),m=-1;continue}}return{x:h,y:f,placement:d,strategy:i,middlewareData:p}});function pI(t,e){return Z(this,null,function*(){var r;e===void 0&&(e={});let{x:n,y:i,platform:s,rects:a,elements:o,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:d=!1,padding:p=0}=ic(e,t),v=dI(p),_=o[d?f==="floating"?"reference":"floating":f],b=Jf(yield s.getClippingRect({element:(r=yield s.isElement==null?void 0:s.isElement(_))==null||r?_:_.contextElement||(yield s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:l,rootBoundary:h,strategy:c})),S=f==="floating"?Hr({},a.floating,{x:n,y:i}):a.reference,T=yield s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating),N=(yield s.isElement==null?void 0:s.isElement(T))?(yield s.getScale==null?void 0:s.getScale(T))||{x:1,y:1}:{x:1,y:1},M=Jf(s.convertOffsetParentRelativeRectToViewportRelativeRect?yield s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:T,strategy:c}):S);return{top:(b.top-M.top+v.top)/N.y,bottom:(M.bottom-b.bottom+v.bottom)/N.y,left:(b.left-M.left+v.left)/N.x,right:(M.right-b.right+v.right)/N.x}})}var xB=t=>({name:"arrow",options:t,fn(r){return Z(this,null,function*(){let{x:n,y:i,placement:s,rects:a,platform:o,elements:c}=r,{element:l,padding:h=0}=ic(t,r)||{};if(l==null)return{};let f=dI(h),d={x:n,y:i},p=Vg(s),v=Lg(p),m=yield o.getDimensions(l),_=p==="y",b=_?"top":"left",S=_?"bottom":"right",T=_?"clientHeight":"clientWidth",N=a.reference[v]+a.reference[p]-d[p]-a.floating[v],M=d[p]-a.reference[p],B=yield o.getOffsetParent==null?void 0:o.getOffsetParent(l),x=B?B[T]:0;(!x||!(yield o.isElement==null?void 0:o.isElement(B)))&&(x=c.floating[T]||a.floating[v]);let w=N/2-M/2,E=x/2-m[v]/2-1,C=nc(f[b],E),k=nc(f[S],E),A=C,R=x-m[v]-k,oe=x/2-m[v]/2+w,se=yg(A,oe,R),_e=rd(s)!=null&&oe!=se&&a.reference[v]/2-(oe<A?C:k)-m[v]/2<0?oe<A?A-oe:R-oe:0;return{[p]:d[p]-_e,data:{[p]:se,centerOffset:oe-se+_e}}})}}),wB=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(n){return Z(this,null,function*(){var i;let{placement:s,middlewareData:a,rects:o,initialPlacement:c,platform:l,elements:h}=n,f=ic(e,n),{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:v,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:b=!0}=f,S=fI(f,vB),T=Ma(s),N=Ma(c)===c,M=yield l.isRTL==null?void 0:l.isRTL(h.floating),B=v||(N||!b?[Qf(c)]:dB(c));!v&&_!=="none"&&B.push(...mB(c,b,_,M));let x=[c,...B],w=yield pI(n,S),E=[],C=((i=a.flip)==null?void 0:i.overflows)||[];if(d&&E.push(w[T]),p){let oe=fB(s,o,M);E.push(w[oe[0]],w[oe[1]])}if(C=[...C,{placement:s,overflows:E}],!E.every(oe=>oe<=0)){var k,A;let oe=(((k=a.flip)==null?void 0:k.index)||0)+1,se=x[oe];if(se)return{data:{index:oe,overflows:C},reset:{placement:se}};let Se=(A=C.filter(_e=>_e.overflows[0]<=0).sort((_e,Re)=>_e.overflows[1]-Re.overflows[1])[0])==null?void 0:A.placement;if(!Se)switch(m){case"bestFit":{var R;let _e=(R=C.map(Re=>[Re.placement,Re.overflows.filter(he=>he>0).reduce((he,Ie)=>he+Ie,0)]).sort((Re,he)=>Re[1]-he[1])[0])==null?void 0:R[0];_e&&(Se=_e);break}case"initialPlacement":Se=c;break}if(s!==Se)return{reset:{placement:Se}}}return{}})}}},EB=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(n){return Z(this,null,function*(){let{x:i,y:s,placement:a}=n,o=ic(e,n),{mainAxis:c=!0,crossAxis:l=!1,limiter:h={fn:T=>{let{x:N,y:M}=T;return{x:N,y:M}}}}=o,f=fI(o,_B),d={x:i,y:s},p=yield pI(n,f),v=nd(Ma(a)),m=Mg(v),_=d[m],b=d[v];if(c){let T=m==="y"?"top":"left",N=m==="y"?"bottom":"right",M=_+p[T],B=_-p[N];_=yg(M,_,B)}if(l){let T=v==="y"?"top":"left",N=v==="y"?"bottom":"right",M=b+p[T],B=b-p[N];b=yg(M,b,B)}let S=h.fn(Hr({},n,{[m]:_,[v]:b}));return Hr({},S,{data:{x:S.x-i,y:S.y-s}})})}}},TB=function(e){return e===void 0&&(e={}),{options:e,fn(r){let{x:n,y:i,placement:s,rects:a,middlewareData:o}=r,{offset:c=0,mainAxis:l=!0,crossAxis:h=!0}=ic(e,r),f={x:n,y:i},d=nd(s),p=Mg(d),v=f[p],m=f[d],_=ic(c,r),b=typeof _=="number"?{mainAxis:_,crossAxis:0}:Hr({mainAxis:0,crossAxis:0},_);if(l){let N=p==="y"?"height":"width",M=a.reference[p]-a.floating[N]+b.mainAxis,B=a.reference[p]+a.reference[N]-b.mainAxis;v<M?v=M:v>B&&(v=B)}if(h){var S,T;let N=p==="y"?"width":"height",M=["top","left"].includes(Ma(s)),B=a.reference[d]-a.floating[N]+(M&&((S=o.offset)==null?void 0:S[d])||0)+(M?0:b.crossAxis),x=a.reference[d]+a.reference[N]+(M?0:((T=o.offset)==null?void 0:T[d])||0)-(M?b.crossAxis:0);m<B?m=B:m>x&&(m=x)}return{[p]:v,[d]:m}}}};function Os(t){return mI(t)?(t.nodeName||"").toLowerCase():"#document"}function wn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Yi(t){var e;return(e=(mI(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function mI(t){return t instanceof Node||t instanceof wn(t).Node}function Xi(t){return t instanceof Element||t instanceof wn(t).Element}function Ti(t){return t instanceof HTMLElement||t instanceof wn(t).HTMLElement}function zb(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof wn(t).ShadowRoot}function Iu(t){let{overflow:e,overflowX:r,overflowY:n,display:i}=Wn(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function bB(t){return["table","td","th"].includes(Os(t))}function Bg(t){let e=Ug(),r=Wn(t);return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function IB(t){let e=sc(t);for(;Ti(e)&&!id(e);){if(Bg(e))return e;e=sc(e)}return null}function Ug(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function id(t){return["html","body","#document"].includes(Os(t))}function Wn(t){return wn(t).getComputedStyle(t)}function sd(t){return Xi(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function sc(t){if(Os(t)==="html")return t;let e=t.assignedSlot||t.parentNode||zb(t)&&t.host||Yi(t);return zb(e)?e.host:e}function gI(t){let e=sc(t);return id(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ti(e)&&Iu(e)?e:gI(e)}function Zf(t,e){var r;e===void 0&&(e=[]);let n=gI(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),s=wn(n);return i?e.concat(s,s.visualViewport||[],Iu(n)?n:[]):e.concat(n,Zf(n))}function vI(t){let e=Wn(t),r=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=Ti(t),s=i?t.offsetWidth:r,a=i?t.offsetHeight:n,o=Yf(r)!==s||Yf(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function jg(t){return Xi(t)?t:t.contextElement}function ec(t){let e=jg(t);if(!Ti(e))return Fs(1);let r=e.getBoundingClientRect(),{width:n,height:i,$:s}=vI(e),a=(s?Yf(r.width):r.width)/n,o=(s?Yf(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}var AB=Fs(0);function _I(t){let e=wn(t);return!Ug()||!e.visualViewport?AB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function SB(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==wn(t)?!1:e}function La(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);let i=t.getBoundingClientRect(),s=jg(t),a=Fs(1);e&&(n?Xi(n)&&(a=ec(n)):a=ec(t));let o=SB(s,r,n)?_I(s):Fs(0),c=(i.left+o.x)/a.x,l=(i.top+o.y)/a.y,h=i.width/a.x,f=i.height/a.y;if(s){let d=wn(s),p=n&&Xi(n)?wn(n):n,v=d.frameElement;for(;v&&n&&p!==d;){let m=ec(v),_=v.getBoundingClientRect(),b=Wn(v),S=_.left+(v.clientLeft+parseFloat(b.paddingLeft))*m.x,T=_.top+(v.clientTop+parseFloat(b.paddingTop))*m.y;c*=m.x,l*=m.y,h*=m.x,f*=m.y,c+=S,l+=T,v=wn(v).frameElement}}return Jf({width:h,height:f,x:c,y:l})}function CB(t){let{rect:e,offsetParent:r,strategy:n}=t,i=Ti(r),s=Yi(r);if(r===s)return e;let a={scrollLeft:0,scrollTop:0},o=Fs(1),c=Fs(0);if((i||!i&&n!=="fixed")&&((Os(r)!=="body"||Iu(s))&&(a=sd(r)),Ti(r))){let l=La(r);o=ec(r),c.x=l.x+r.clientLeft,c.y=l.y+r.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+c.x,y:e.y*o.y-a.scrollTop*o.y+c.y}}function kB(t){return Array.from(t.getClientRects())}function yI(t){return La(Yi(t)).left+sd(t).scrollLeft}function DB(t){let e=Yi(t),r=sd(t),n=t.ownerDocument.body,i=Pa(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=Pa(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),a=-r.scrollLeft+yI(t),o=-r.scrollTop;return Wn(n).direction==="rtl"&&(a+=Pa(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function RB(t,e){let r=wn(t),n=Yi(t),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,c=0;if(i){s=i.width,a=i.height;let l=Ug();(!l||l&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:s,height:a,x:o,y:c}}function PB(t,e){let r=La(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=Ti(t)?ec(t):Fs(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,c=i*s.x,l=n*s.y;return{width:a,height:o,x:c,y:l}}function Gb(t,e,r){let n;if(e==="viewport")n=RB(t,r);else if(e==="document")n=DB(Yi(t));else if(Xi(e))n=PB(e,r);else{let i=_I(t);n=Hr({},e,{x:e.x-i.x,y:e.y-i.y})}return Jf(n)}function xI(t,e){let r=sc(t);return r===e||!Xi(r)||id(r)?!1:Wn(r).position==="fixed"||xI(r,e)}function FB(t,e){let r=e.get(t);if(r)return r;let n=Zf(t).filter(o=>Xi(o)&&Os(o)!=="body"),i=null,s=Wn(t).position==="fixed",a=s?sc(t):t;for(;Xi(a)&&!id(a);){let o=Wn(a),c=Bg(a);!c&&o.position==="fixed"&&(i=null),(s?!c&&!i:!c&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Iu(a)&&!c&&xI(t,a))?n=n.filter(h=>h!==a):i=o,a=sc(a)}return e.set(t,n),n}function OB(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t,a=[...r==="clippingAncestors"?FB(e,this._c):[].concat(r),n],o=a[0],c=a.reduce((l,h)=>{let f=Gb(e,h,i);return l.top=Pa(f.top,l.top),l.right=nc(f.right,l.right),l.bottom=nc(f.bottom,l.bottom),l.left=Pa(f.left,l.left),l},Gb(e,o,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function NB(t){return vI(t)}function MB(t,e,r){let n=Ti(e),i=Yi(e),s=r==="fixed",a=La(t,!0,s,e),o={scrollLeft:0,scrollTop:0},c=Fs(0);if(n||!n&&!s)if((Os(e)!=="body"||Iu(i))&&(o=sd(e)),n){let l=La(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=yI(i));return{x:a.left+o.scrollLeft-c.x,y:a.top+o.scrollTop-c.y,width:a.width,height:a.height}}function qb(t,e){return!Ti(t)||Wn(t).position==="fixed"?null:e?e(t):t.offsetParent}function wI(t,e){let r=wn(t);if(!Ti(t))return r;let n=qb(t,e);for(;n&&bB(n)&&Wn(n).position==="static";)n=qb(n,e);return n&&(Os(n)==="html"||Os(n)==="body"&&Wn(n).position==="static"&&!Bg(n))?r:n||IB(t)||r}var LB=function(e){return Z(this,null,function*(){let{reference:r,floating:n,strategy:i}=e,s=this.getOffsetParent||wI,a=this.getDimensions;return{reference:MB(r,yield s(n),i),floating:Hr({x:0,y:0},yield a(n))}})};function VB(t){return Wn(t).direction==="rtl"}var BB={convertOffsetParentRelativeRectToViewportRelativeRect:CB,getDocumentElement:Yi,getClippingRect:OB,getOffsetParent:wI,getElementRects:LB,getClientRects:kB,getDimensions:NB,getScale:ec,isElement:Xi,isRTL:VB};function UB(t,e){let r=null,n,i=Yi(t);function s(){clearTimeout(n),r&&r.disconnect(),r=null}function a(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),s();let{left:l,top:h,width:f,height:d}=t.getBoundingClientRect();if(o||e(),!f||!d)return;let p=Kf(h),v=Kf(i.clientWidth-(l+f)),m=Kf(i.clientHeight-(h+d)),_=Kf(l),S={rootMargin:-p+"px "+-v+"px "+-m+"px "+-_+"px",threshold:Pa(0,nc(1,c))||1},T=!0;function N(M){let B=M[0].intersectionRatio;if(B!==c){if(!T)return a();B?a(!1,B):n=setTimeout(()=>{a(!1,1e-7)},100)}T=!1}try{r=new IntersectionObserver(N,Hr({},S,{root:i.ownerDocument}))}catch{r=new IntersectionObserver(N,S)}r.observe(t)}return a(!0),s}function jB(t,e,r,n){n===void 0&&(n={});let{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,l=jg(t),h=i||s?[...l?Zf(l):[],...Zf(e)]:[];h.forEach(b=>{i&&b.addEventListener("scroll",r,{passive:!0}),s&&b.addEventListener("resize",r)});let f=l&&o?UB(l,r):null,d=-1,p=null;a&&(p=new ResizeObserver(b=>{let[S]=b;S&&S.target===l&&p&&(p.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{p&&p.observe(e)})),r()}),l&&!c&&p.observe(l),p.observe(e));let v,m=c?La(t):null;c&&_();function _(){let b=La(t);m&&(b.x!==m.x||b.y!==m.y||b.width!==m.width||b.height!==m.height)&&r(),m=b,v=requestAnimationFrame(_)}return r(),()=>{h.forEach(b=>{i&&b.removeEventListener("scroll",r),s&&b.removeEventListener("resize",r)}),f&&f(),p&&p.disconnect(),p=null,c&&cancelAnimationFrame(v)}}var WB=(t,e,r)=>{let n=new Map,i=Hr({platform:BB},r),s=Hr({},i.platform,{_c:n});return yB(t,e,Hr({},i,{platform:s}))};function $B(t){t.cleanup&&t.cleanup();let e=t._getResolvedAttachToOptions(),r=e.element,n=XB(e,t),i=hI(e);return i&&(r=document.body,t.shepherdElementComponent.getElement().classList.add("shepherd-centered")),t.cleanup=jB(r,t.el,()=>{if(!t.el){t.cleanup();return}GB(r,t,n,i)}),t.target=e.element,n}function HB(t,e){return{floatingUIOptions:Fg(t.floatingUIOptions||{},e.floatingUIOptions||{})}}function zB(t){t.cleanup&&t.cleanup(),t.cleanup=null}function GB(t,e,r,n){return WB(t,e.el,r).then(qB(e,n)).then(i=>new Promise(s=>{setTimeout(()=>s(i),300)})).then(i=>{i&&i.el&&i.el.focus({preventScroll:!0})})}function qB(t,e){return({x:r,y:n,placement:i,middlewareData:s})=>(t.el&&(e?Object.assign(t.el.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}):Object.assign(t.el.style,{position:"absolute",left:`${r}px`,top:`${n}px`}),t.el.dataset.popperPlacement=i,KB(t.el,s)),t)}function KB(t,e){let r=t.querySelector(".shepherd-arrow");if(r&&e.arrow){let{x:n,y:i}=e.arrow;Object.assign(r.style,{left:n!=null?`${n}px`:"",top:i!=null?`${i}px`:""})}}function XB(t,e){let r={strategy:"absolute",middleware:[]},n=YB(e);return hI(t)||(r.middleware.push(wB(),EB({limiter:TB(),crossAxis:!0})),n&&r.middleware.push(xB({element:n})),r.placement=t.on),Fg(e.options.floatingUIOptions||{},r)}function YB(t){return t.options.arrow&&t.el?t.el.querySelector(".shepherd-arrow"):!1}function En(){}function QB(t,e){for(let r in e)t[r]=e[r];return t}function EI(t){return t()}function Kb(){return Object.create(null)}function Au(t){t.forEach(EI)}function Wg(t){return typeof t=="function"}function Qi(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function JB(t){return Object.keys(t).length===0}function ac(t,e){t.appendChild(e)}function ii(t,e,r){t.insertBefore(e,r||null)}function $n(t){t.parentNode&&t.parentNode.removeChild(t)}function ZB(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function bi(t){return document.createElement(t)}function Xb(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function TI(t){return document.createTextNode(t)}function ed(){return TI(" ")}function eU(){return TI("")}function ad(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function It(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}var tU=["width","height"];function Yb(t,e){let r=Object.getOwnPropertyDescriptors(t.__proto__);for(let n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:r[n]&&r[n].set&&tU.indexOf(n)===-1?t[n]=e[n]:It(t,n,e[n])}function rU(t){return Array.from(t.childNodes)}function Qo(t,e,r){t.classList[r?"add":"remove"](e)}var Tu;function yu(t){Tu=t}function bI(){if(!Tu)throw new Error("Function called outside component initialization");return Tu}function nU(t){bI().$$.on_mount.push(t)}function $g(t){bI().$$.after_update.push(t)}var Zo=[],oc=[],tc=[],Qb=[],iU=Promise.resolve(),wg=!1;function sU(){wg||(wg=!0,iU.then(II))}function Eg(t){tc.push(t)}var _g=new Set,Jo=0;function II(){if(Jo!==0)return;let t=Tu;do{try{for(;Jo<Zo.length;){let e=Zo[Jo];Jo++,yu(e),aU(e.$$)}}catch(e){throw Zo.length=0,Jo=0,e}for(yu(null),Zo.length=0,Jo=0;oc.length;)oc.pop()();for(let e=0;e<tc.length;e+=1){let r=tc[e];_g.has(r)||(_g.add(r),r())}tc.length=0}while(Zo.length);for(;Qb.length;)Qb.pop()();wg=!1,_g.clear(),yu(t)}function aU(t){if(t.fragment!==null){t.update(),Au(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Eg)}}function oU(t){let e=[],r=[];tc.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),tc=e}var Xf=new Set,Ra;function Fa(){Ra={r:0,c:[],p:Ra}}function Oa(){Ra.r||Au(Ra.c),Ra=Ra.p}function _t(t,e){t&&t.i&&(Xf.delete(t),t.i(e))}function Zt(t,e,r,n){if(t&&t.o){if(Xf.has(t))return;Xf.add(t),Ra.c.push(()=>{Xf.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function cU(t,e){let r={},n={},i={$$scope:1},s=t.length;for(;s--;){let a=t[s],o=e[s];if(o){for(let c in a)c in o||(n[c]=1);for(let c in o)i[c]||(r[c]=o[c],i[c]=1);t[s]=o}else for(let c in a)i[c]=1}for(let a in n)a in r||(r[a]=void 0);return r}function Va(t){t&&t.c()}function Ns(t,e,r,n){let{fragment:i,after_update:s}=t.$$;i&&i.m(e,r),n||Eg(()=>{let a=t.$$.on_mount.map(EI).filter(Wg);t.$$.on_destroy?t.$$.on_destroy.push(...a):Au(a),t.$$.on_mount=[]}),s.forEach(Eg)}function Ms(t,e){let r=t.$$;r.fragment!==null&&(oU(r.after_update),Au(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function lU(t,e){t.$$.dirty[0]===-1&&(Zo.push(t),sU(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Ji(t,e,r,n,i,s,a,o=[-1]){let c=Tu;yu(t);let l=t.$$={fragment:null,ctx:[],props:s,update:En,not_equal:i,bound:Kb(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Kb(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};a&&a(l.root);let h=!1;if(l.ctx=r?r(t,e.props||{},(f,d,...p)=>{let v=p.length?p[0]:d;return l.ctx&&i(l.ctx[f],l.ctx[f]=v)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](v),h&&lU(t,f)),d}):[],l.update(),h=!0,Au(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){let f=rU(e.target);l.fragment&&l.fragment.l(f),f.forEach($n)}else l.fragment&&l.fragment.c();e.intro&&_t(t.$$.fragment),Ns(t,e.target,e.anchor,e.customElement),II()}yu(c)}var ni=class{$destroy(){Ms(this,1),this.$destroy=En}$on(e,r){if(!Wg(r))return En;let n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{let i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!JB(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};function uU(t){let e,r,n,i,s;return{c(){e=bi("button"),It(e,"aria-label",r=t[3]?t[3]:null),It(e,"class",n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`),e.disabled=t[2],It(e,"tabindex","0")},m(a,o){ii(a,e,o),e.innerHTML=t[5],i||(s=ad(e,"click",function(){Wg(t[0])&&t[0].apply(this,arguments)}),i=!0)},p(a,[o]){t=a,o&32&&(e.innerHTML=t[5]),o&8&&r!==(r=t[3]?t[3]:null)&&It(e,"aria-label",r),o&18&&n!==(n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`)&&It(e,"class",n),o&4&&(e.disabled=t[2])},i:En,o:En,d(a){a&&$n(e),i=!1,s()}}}function hU(t,e,r){let{config:n,step:i}=e,s,a,o,c,l,h;function f(d){return Na(d)?d=d.call(i):d}return t.$$set=d=>{"config"in d&&r(6,n=d.config),"step"in d&&r(7,i=d.step)},t.$$.update=()=>{t.$$.dirty&192&&(r(0,s=n.action?n.action.bind(i.tour):null),r(1,a=n.classes),r(2,o=n.disabled?f(n.disabled):!1),r(3,c=n.label?f(n.label):null),r(4,l=n.secondary),r(5,h=n.text?f(n.text):null))},[s,a,o,c,l,h,n,i]}var Tg=class extends ni{constructor(e){super(),Ji(this,e,hU,uU,Qi,{config:6,step:7})}};function Jb(t,e,r){let n=t.slice();return n[2]=e[r],n}function Zb(t){let e,r,n=t[1],i=[];for(let a=0;a<n.length;a+=1)i[a]=eI(Jb(t,n,a));let s=a=>Zt(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=eU()},m(a,o){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,o);ii(a,e,o),r=!0},p(a,o){if(o&3){n=a[1];let c;for(c=0;c<n.length;c+=1){let l=Jb(a,n,c);i[c]?(i[c].p(l,o),_t(i[c],1)):(i[c]=eI(l),i[c].c(),_t(i[c],1),i[c].m(e.parentNode,e))}for(Fa(),c=n.length;c<i.length;c+=1)s(c);Oa()}},i(a){if(!r){for(let o=0;o<n.length;o+=1)_t(i[o]);r=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)Zt(i[o]);r=!1},d(a){ZB(i,a),a&&$n(e)}}}function eI(t){let e,r;return e=new Tg({props:{config:t[2],step:t[0]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.config=n[2]),i&1&&(s.step=n[0]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function fU(t){let e,r,n=t[1]&&Zb(t);return{c(){e=bi("footer"),n&&n.c(),It(e,"class","shepherd-footer")},m(i,s){ii(i,e,s),n&&n.m(e,null),r=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&_t(n,1)):(n=Zb(i),n.c(),_t(n,1),n.m(e,null)):n&&(Fa(),Zt(n,1,1,()=>{n=null}),Oa())},i(i){r||(_t(n),r=!0)},o(i){Zt(n),r=!1},d(i){i&&$n(e),n&&n.d()}}}function dU(t,e,r){let n,{step:i}=e;return t.$$set=s=>{"step"in s&&r(0,i=s.step)},t.$$.update=()=>{t.$$.dirty&1&&r(1,n=i.options.buttons)},[i,n]}var bg=class extends ni{constructor(e){super(),Ji(this,e,dU,fU,Qi,{step:0})}};function pU(t){let e,r,n,i,s;return{c(){e=bi("button"),r=bi("span"),r.textContent="\xD7",It(r,"aria-hidden","true"),It(e,"aria-label",n=t[0].label?t[0].label:"Close Tour"),It(e,"class","shepherd-cancel-icon"),It(e,"type","button")},m(a,o){ii(a,e,o),ac(e,r),i||(s=ad(e,"click",t[1]),i=!0)},p(a,[o]){o&1&&n!==(n=a[0].label?a[0].label:"Close Tour")&&It(e,"aria-label",n)},i:En,o:En,d(a){a&&$n(e),i=!1,s()}}}function mU(t,e,r){let{cancelIcon:n,step:i}=e,s=a=>{a.preventDefault(),i.cancel()};return t.$$set=a=>{"cancelIcon"in a&&r(0,n=a.cancelIcon),"step"in a&&r(2,i=a.step)},[n,s,i]}var Ig=class extends ni{constructor(e){super(),Ji(this,e,mU,pU,Qi,{cancelIcon:0,step:2})}};function gU(t){let e;return{c(){e=bi("h3"),It(e,"id",t[1]),It(e,"class","shepherd-title")},m(r,n){ii(r,e,n),t[3](e)},p(r,[n]){n&2&&It(e,"id",r[1])},i:En,o:En,d(r){r&&$n(e),t[3](null)}}}function vU(t,e,r){let{labelId:n,element:i,title:s}=e;$g(()=>{Na(s)&&r(2,s=s()),r(0,i.innerHTML=s,i)});function a(o){oc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"labelId"in o&&r(1,n=o.labelId),"element"in o&&r(0,i=o.element),"title"in o&&r(2,s=o.title)},[i,n,s,a]}var Ag=class extends ni{constructor(e){super(),Ji(this,e,vU,gU,Qi,{labelId:1,element:0,title:2})}};function tI(t){let e,r;return e=new Ag({props:{labelId:t[0],title:t[2]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.labelId=n[0]),i&4&&(s.title=n[2]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function rI(t){let e,r;return e=new Ig({props:{cancelIcon:t[3],step:t[1]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&8&&(s.cancelIcon=n[3]),i&2&&(s.step=n[1]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function _U(t){let e,r,n,i=t[2]&&tI(t),s=t[3]&&t[3].enabled&&rI(t);return{c(){e=bi("header"),i&&i.c(),r=ed(),s&&s.c(),It(e,"class","shepherd-header")},m(a,o){ii(a,e,o),i&&i.m(e,null),ac(e,r),s&&s.m(e,null),n=!0},p(a,[o]){a[2]?i?(i.p(a,o),o&4&&_t(i,1)):(i=tI(a),i.c(),_t(i,1),i.m(e,r)):i&&(Fa(),Zt(i,1,1,()=>{i=null}),Oa()),a[3]&&a[3].enabled?s?(s.p(a,o),o&8&&_t(s,1)):(s=rI(a),s.c(),_t(s,1),s.m(e,null)):s&&(Fa(),Zt(s,1,1,()=>{s=null}),Oa())},i(a){n||(_t(i),_t(s),n=!0)},o(a){Zt(i),Zt(s),n=!1},d(a){a&&$n(e),i&&i.d(),s&&s.d()}}}function yU(t,e,r){let{labelId:n,step:i}=e,s,a;return t.$$set=o=>{"labelId"in o&&r(0,n=o.labelId),"step"in o&&r(1,i=o.step)},t.$$.update=()=>{t.$$.dirty&2&&(r(2,s=i.options.title),r(3,a=i.options.cancelIcon))},[n,i,s,a]}var Sg=class extends ni{constructor(e){super(),Ji(this,e,yU,_U,Qi,{labelId:0,step:1})}};function xU(t){let e;return{c(){e=bi("div"),It(e,"class","shepherd-text"),It(e,"id",t[1])},m(r,n){ii(r,e,n),t[3](e)},p(r,[n]){n&2&&It(e,"id",r[1])},i:En,o:En,d(r){r&&$n(e),t[3](null)}}}function wU(t,e,r){let{descriptionId:n,element:i,step:s}=e;$g(()=>{let{text:o}=s.options;Na(o)&&(o=o.call(s)),Og(o)?i.appendChild(o):r(0,i.innerHTML=o,i)});function a(o){oc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"descriptionId"in o&&r(1,n=o.descriptionId),"element"in o&&r(0,i=o.element),"step"in o&&r(2,s=o.step)},[i,n,s,a]}var Cg=class extends ni{constructor(e){super(),Ji(this,e,wU,xU,Qi,{descriptionId:1,element:0,step:2})}};function nI(t){let e,r;return e=new Sg({props:{labelId:t[1],step:t[2]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.labelId=n[1]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function iI(t){let e,r;return e=new Cg({props:{descriptionId:t[0],step:t[2]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.descriptionId=n[0]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function sI(t){let e,r;return e=new bg({props:{step:t[2]}}),{c(){Va(e.$$.fragment)},m(n,i){Ns(e,n,i),r=!0},p(n,i){let s={};i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(_t(e.$$.fragment,n),r=!0)},o(n){Zt(e.$$.fragment,n),r=!1},d(n){Ms(e,n)}}}function EU(t){let e,r=!$r(t[2].options.title)||t[2].options.cancelIcon&&t[2].options.cancelIcon.enabled,n,i=!$r(t[2].options.text),s,a=Array.isArray(t[2].options.buttons)&&t[2].options.buttons.length,o,c=r&&nI(t),l=i&&iI(t),h=a&&sI(t);return{c(){e=bi("div"),c&&c.c(),n=ed(),l&&l.c(),s=ed(),h&&h.c(),It(e,"class","shepherd-content")},m(f,d){ii(f,e,d),c&&c.m(e,null),ac(e,n),l&&l.m(e,null),ac(e,s),h&&h.m(e,null),o=!0},p(f,[d]){d&4&&(r=!$r(f[2].options.title)||f[2].options.cancelIcon&&f[2].options.cancelIcon.enabled),r?c?(c.p(f,d),d&4&&_t(c,1)):(c=nI(f),c.c(),_t(c,1),c.m(e,n)):c&&(Fa(),Zt(c,1,1,()=>{c=null}),Oa()),d&4&&(i=!$r(f[2].options.text)),i?l?(l.p(f,d),d&4&&_t(l,1)):(l=iI(f),l.c(),_t(l,1),l.m(e,s)):l&&(Fa(),Zt(l,1,1,()=>{l=null}),Oa()),d&4&&(a=Array.isArray(f[2].options.buttons)&&f[2].options.buttons.length),a?h?(h.p(f,d),d&4&&_t(h,1)):(h=sI(f),h.c(),_t(h,1),h.m(e,null)):h&&(Fa(),Zt(h,1,1,()=>{h=null}),Oa())},i(f){o||(_t(c),_t(l),_t(h),o=!0)},o(f){Zt(c),Zt(l),Zt(h),o=!1},d(f){f&&$n(e),c&&c.d(),l&&l.d(),h&&h.d()}}}function TU(t,e,r){let{descriptionId:n,labelId:i,step:s}=e;return t.$$set=a=>{"descriptionId"in a&&r(0,n=a.descriptionId),"labelId"in a&&r(1,i=a.labelId),"step"in a&&r(2,s=a.step)},[n,i,s]}var kg=class extends ni{constructor(e){super(),Ji(this,e,TU,EU,Qi,{descriptionId:0,labelId:1,step:2})}};function aI(t){let e;return{c(){e=bi("div"),It(e,"class","shepherd-arrow"),It(e,"data-popper-arrow","")},m(r,n){ii(r,e,n)},d(r){r&&$n(e)}}}function bU(t){let e,r,n,i,s,a,o,c,l=t[4].options.arrow&&t[4].options.attachTo&&t[4].options.attachTo.element&&t[4].options.attachTo.on&&aI();n=new kg({props:{descriptionId:t[2],labelId:t[3],step:t[4]}});let h=[{"aria-describedby":i=$r(t[4].options.text)?null:t[2]},{"aria-labelledby":s=t[4].options.title?t[3]:null},t[1],{role:"dialog"},{tabindex:"0"}],f={};for(let d=0;d<h.length;d+=1)f=QB(f,h[d]);return{c(){e=bi("div"),l&&l.c(),r=ed(),Va(n.$$.fragment),Yb(e,f),Qo(e,"shepherd-has-cancel-icon",t[5]),Qo(e,"shepherd-has-title",t[6]),Qo(e,"shepherd-element",!0)},m(d,p){ii(d,e,p),l&&l.m(e,null),ac(e,r),Ns(n,e,null),t[13](e),a=!0,o||(c=ad(e,"keydown",t[7]),o=!0)},p(d,[p]){d[4].options.arrow&&d[4].options.attachTo&&d[4].options.attachTo.element&&d[4].options.attachTo.on?l||(l=aI(),l.c(),l.m(e,r)):l&&(l.d(1),l=null);let v={};p&4&&(v.descriptionId=d[2]),p&8&&(v.labelId=d[3]),p&16&&(v.step=d[4]),n.$set(v),Yb(e,f=cU(h,[(!a||p&20&&i!==(i=$r(d[4].options.text)?null:d[2]))&&{"aria-describedby":i},(!a||p&24&&s!==(s=d[4].options.title?d[3]:null))&&{"aria-labelledby":s},p&2&&d[1],{role:"dialog"},{tabindex:"0"}])),Qo(e,"shepherd-has-cancel-icon",d[5]),Qo(e,"shepherd-has-title",d[6]),Qo(e,"shepherd-element",!0)},i(d){a||(_t(n.$$.fragment,d),a=!0)},o(d){Zt(n.$$.fragment,d),a=!1},d(d){d&&$n(e),l&&l.d(),Ms(n),t[13](null),o=!1,c()}}}var IU=9,AU=27,SU=37,CU=39;function oI(t){return t.split(" ").filter(e=>!!e.length)}function kU(t,e,r){let{classPrefix:n,element:i,descriptionId:s,firstFocusableElement:a,focusableElements:o,labelId:c,lastFocusableElement:l,step:h,dataStepId:f}=e,d,p,v,m=()=>i;nU(()=>{r(1,f={[`data-${n}shepherd-step-id`]:h.id}),r(9,o=i.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),r(8,a=o[0]),r(10,l=o[o.length-1])}),$g(()=>{v!==h.options.classes&&_()});function _(){b(v),v=h.options.classes,S(v)}function b(M){if(wu(M)){let B=oI(M);B.length&&i.classList.remove(...B)}}function S(M){if(wu(M)){let B=oI(M);B.length&&i.classList.add(...B)}}let T=M=>{let{tour:B}=h;switch(M.keyCode){case IU:if(o.length===0){M.preventDefault();break}M.shiftKey?(document.activeElement===a||document.activeElement.classList.contains("shepherd-element"))&&(M.preventDefault(),l.focus()):document.activeElement===l&&(M.preventDefault(),a.focus());break;case AU:B.options.exitOnEsc&&(M.stopPropagation(),h.cancel());break;case SU:B.options.keyboardNavigation&&(M.stopPropagation(),B.back());break;case CU:B.options.keyboardNavigation&&(M.stopPropagation(),B.next());break}};function N(M){oc[M?"unshift":"push"](()=>{i=M,r(0,i)})}return t.$$set=M=>{"classPrefix"in M&&r(11,n=M.classPrefix),"element"in M&&r(0,i=M.element),"descriptionId"in M&&r(2,s=M.descriptionId),"firstFocusableElement"in M&&r(8,a=M.firstFocusableElement),"focusableElements"in M&&r(9,o=M.focusableElements),"labelId"in M&&r(3,c=M.labelId),"lastFocusableElement"in M&&r(10,l=M.lastFocusableElement),"step"in M&&r(4,h=M.step),"dataStepId"in M&&r(1,f=M.dataStepId)},t.$$.update=()=>{t.$$.dirty&16&&(r(5,d=h.options&&h.options.cancelIcon&&h.options.cancelIcon.enabled),r(6,p=h.options&&h.options.title))},[i,f,s,c,h,d,p,T,a,o,l,n,m,N]}var Dg=class extends ni{constructor(e){super(),Ji(this,e,kU,bU,Qi,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}},bu=class extends Eu{constructor(e,r={}){return super(e,r),this.tour=e,this.classPrefix=this.tour.options?uI(this.tour.options.classPrefix):"",this.styles=e.styles,this._resolvedAttachTo=null,lI(this),this._setOptions(r),this}cancel(){this.tour.cancel(),this.trigger("cancel")}complete(){this.tour.complete(),this.trigger("complete")}destroy(){zB(this),Og(this.el)&&(this.el.remove(),this.el=null),this._updateStepTargetOnHide(),this.trigger("destroy")}getTour(){return this.tour}hide(){this.tour.modal.hide(),this.trigger("before-hide"),this.el&&(this.el.hidden=!0),this._updateStepTargetOnHide(),this.trigger("hide")}_resolveAttachToOptions(){return this._resolvedAttachTo=lB(this),this._resolvedAttachTo}_getResolvedAttachToOptions(){return this._resolvedAttachTo===null?this._resolveAttachToOptions():this._resolvedAttachTo}isOpen(){return!!(this.el&&!this.el.hidden)}show(){return Na(this.options.beforeShowPromise)?Promise.resolve(this.options.beforeShowPromise()).then(()=>this._show()):Promise.resolve(this._show())}updateStepOptions(e){Object.assign(this.options,e),this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){let e=`${this.id}-description`,r=`${this.id}-label`;return this.shepherdElementComponent=new Dg({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:e,labelId:r,step:this,styles:this.styles}}),this.shepherdElementComponent.getElement()}_scrollTo(e){let{element:r}=this._getResolvedAttachToOptions();Na(this.options.scrollToHandler)?this.options.scrollToHandler(r):aB(r)&&typeof r.scrollIntoView=="function"&&r.scrollIntoView(e)}_getClassOptions(e){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions,n=e.classes?e.classes:"",i=r&&r.classes?r.classes:"",s=[...n.split(" "),...i.split(" ")],a=new Set(s);return Array.from(a).join(" ").trim()}_setOptions(e={}){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;r=Fg({},r||{}),this.options=Object.assign({arrow:!0},r,e,HB(r,e));let{when:n}=this.options;this.options.classes=this._getClassOptions(e),this.destroy(),this.id=this.options.id||`step-${Ng()}`,n&&Object.keys(n).forEach(i=>{this.on(i,n[i],this)})}_setupElements(){$r(this.el)||this.destroy(),this.el=this._createTooltipContent(),this.options.advanceOn&&cB(this),$B(this)}_show(){this.trigger("before-show"),this._resolveAttachToOptions(),this._setupElements(),this.tour.modal||this.tour._setupModal(),this.tour.modal.setupForStep(this),this._styleTargetElementForStep(this),this.el.hidden=!1,this.options.scrollTo&&setTimeout(()=>{this._scrollTo(this.options.scrollTo)}),this.el.hidden=!1;let e=this.shepherdElementComponent.getElement(),r=this.target||document.body;r.classList.add(`${this.classPrefix}shepherd-enabled`),r.classList.add(`${this.classPrefix}shepherd-target`),e.classList.add("shepherd-enabled"),this.trigger("show")}_styleTargetElementForStep(e){let r=e.target;r&&(e.options.highlightClass&&r.classList.add(e.options.highlightClass),r.classList.remove("shepherd-target-click-disabled"),e.options.canClickTarget===!1&&r.classList.add("shepherd-target-click-disabled"))}_updateStepTargetOnHide(){let e=this.target||document.body;this.options.highlightClass&&e.classList.remove(this.options.highlightClass),e.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}};function DU(t){if(t){let{steps:e}=t;e.forEach(r=>{r.options&&r.options.canClickTarget===!1&&r.options.attachTo&&r.target instanceof HTMLElement&&r.target.classList.remove("shepherd-target-click-disabled")})}}function RU({width:t,height:e,x:r=0,y:n=0,r:i=0}){let{innerWidth:s,innerHeight:a}=window,{topLeft:o=0,topRight:c=0,bottomRight:l=0,bottomLeft:h=0}=typeof i=="number"?{topLeft:i,topRight:i,bottomRight:i,bottomLeft:i}:i;return`M${s},${a}H0V0H${s}V${a}ZM${r+o},${n}a${o},${o},0,0,0-${o},${o}V${e+n-h}a${h},${h},0,0,0,${h},${h}H${t+r-l}a${l},${l},0,0,0,${l}-${l}V${n+c}a${c},${c},0,0,0-${c}-${c}Z`}function PU(t){let e,r,n,i,s;return{c(){e=Xb("svg"),r=Xb("path"),It(r,"d",t[2]),It(e,"class",n=`${t[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)},m(a,o){ii(a,e,o),ac(e,r),t[11](e),i||(s=ad(e,"touchmove",t[3]),i=!0)},p(a,[o]){o&4&&It(r,"d",a[2]),o&2&&n!==(n=`${a[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)&&It(e,"class",n)},i:En,o:En,d(a){a&&$n(e),t[11](null),i=!1,s()}}}function AI(t){if(!t)return null;let r=t instanceof HTMLElement&&window.getComputedStyle(t).overflowY;return r!=="hidden"&&r!=="visible"&&t.scrollHeight>=t.clientHeight?t:AI(t.parentElement)}function FU(t,e){let r=t.getBoundingClientRect(),n=r.y||r.top,i=r.bottom||n+r.height;if(e){let a=e.getBoundingClientRect(),o=a.y||a.top,c=a.bottom||o+a.height;n=Math.max(n,o),i=Math.min(i,c)}let s=Math.max(i-n,0);return{y:n,height:s}}function OU(t,e,r){let{element:n,openingProperties:i}=e;Ng();let s=!1,a,o;l();let c=()=>n;function l(){r(4,i={width:0,height:0,x:0,y:0,r:0})}function h(){r(1,s=!1),b()}function f(N=0,M=0,B,x){if(x){let{y:w,height:E}=FU(x,B),{x:C,width:k,left:A}=x.getBoundingClientRect();r(4,i={width:k+N*2,height:E+N*2,x:(C||A)-N,y:w-N,r:M})}else l()}function d(N){b(),N.tour.options.useModalOverlay?(S(N),p()):h()}function p(){r(1,s=!0)}let v=N=>{N.preventDefault()},m=N=>{N.stopPropagation()};function _(){window.addEventListener("touchmove",v,{passive:!1})}function b(){a&&(cancelAnimationFrame(a),a=void 0),window.removeEventListener("touchmove",v,{passive:!1})}function S(N){let{modalOverlayOpeningPadding:M,modalOverlayOpeningRadius:B}=N.options,x=AI(N.target),w=()=>{a=void 0,f(M,B,x,N.target),a=requestAnimationFrame(w)};w(),_()}function T(N){oc[N?"unshift":"push"](()=>{n=N,r(0,n)})}return t.$$set=N=>{"element"in N&&r(0,n=N.element),"openingProperties"in N&&r(4,i=N.openingProperties)},t.$$.update=()=>{t.$$.dirty&16&&r(2,o=RU(i))},[n,s,o,m,i,c,l,h,f,d,p,T]}var Rg=class extends ni{constructor(e){super(),Ji(this,e,OU,PU,Qi,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModal:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModal(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}},Ps=new Eu,Pg=class extends Eu{constructor(e={}){super(e),lI(this);let r={exitOnEsc:!0,keyboardNavigation:!0};return this.options=Object.assign({},r,e),this.classPrefix=uI(this.options.classPrefix),this.steps=[],this.addSteps(this.options.steps),["active","cancel","complete","inactive","show","start"].map(i=>{(s=>{this.on(s,a=>{a=a||{},a.tour=this,Ps.trigger(s,a)})})(i)}),this._setTourID(),this}addStep(e,r){let n=e;return n instanceof bu?n.tour=this:n=new bu(this,n),$r(r)?this.steps.push(n):this.steps.splice(r,0,n),n}addSteps(e){return Array.isArray(e)&&e.forEach(r=>{this.addStep(r)}),this}back(){let e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}cancel(){return Z(this,null,function*(){if(this.options.confirmCancel){let e=typeof this.options.confirmCancel=="function",r=this.options.confirmCancelMessage||"Are you sure you want to stop the tour?";(e?yield this.options.confirmCancel():window.confirm(r))&&this._done("cancel")}else this._done("cancel")})}complete(){this._done("complete")}getById(e){return this.steps.find(r=>r.id===e)}getCurrentStep(){return this.currentStep}hide(){let e=this.getCurrentStep();if(e)return e.hide()}isActive(){return Ps.activeTour===this}next(){let e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?this.complete():this.show(e+1,!0)}removeStep(e){let r=this.getCurrentStep();this.steps.some((n,i)=>{if(n.id===e)return n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1),!0}),r&&r.id===e&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(e=0,r=!0){let n=wu(e)?this.getById(e):this.steps[e];n&&(this._updateStateBeforeShow(),Na(n.options.showOn)&&!n.options.showOn()?this._skipStep(n,r):(this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show()))}start(){this.trigger("start"),this.focusedElBeforeOpen=document.activeElement,this.currentStep=null,this._setupModal(),this._setupActiveTour(),this.next()}_done(e){let r=this.steps.indexOf(this.currentStep);if(Array.isArray(this.steps)&&this.steps.forEach(n=>n.destroy()),DU(this),this.trigger(e,{index:r}),Ps.activeTour=null,this.trigger("inactive",{tour:this}),this.modal&&this.modal.hide(),(e==="cancel"||e==="complete")&&this.modal){let n=document.querySelector(".shepherd-modal-overlay-container");n&&n.remove()}Og(this.focusedElBeforeOpen)&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this}),Ps.activeTour=this}_setupModal(){this.modal=new Rg({target:this.options.modalContainer||document.body,props:{classPrefix:this.classPrefix,styles:this.styles}})}_skipStep(e,r){let n=this.steps.indexOf(e);if(n===this.steps.length-1)this.complete();else{let i=r?n+1:n-1;this.show(i,r)}}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide(),this.isActive()||this._setupActiveTour()}_setTourID(){let e=this.options.tourName||"tour";this.id=`${e}--${Ng()}`}},NU=typeof window>"u",td=class{constructor(){}};NU?Object.assign(Ps,{Tour:td,Step:td}):Object.assign(Ps,{Tour:Pg,Step:bu});function MU(t){return t.offsetWidth===0&&t.offsetHeight===0}function LU(t){let{classes:e,disabled:r,label:n,secondary:i,type:s,text:a}=t,o=["back","cancel","next"];if(!s)return t;if(o.indexOf(s)===-1)throw new Error("'type' property must be one of 'back', 'cancel', or 'next'");return{action:this[s].bind(this),classes:e,disabled:r,label:n,secondary:i,text:a}}var SI=(()=>{let e=class e{constructor(){this.confirmCancel=!1,this.confirmCancelMessage=null,this.defaultStepOptions={},this.errorTitle=null,this.isActive=!1,this.keyboardNavigation=!0,this.messageForUser=null,this.modal=!1,this.requiredElements=[],this.tourName=void 0,this.tourObject=null,this.exitOnEsc=!0}back(){this.tourObject.back()}cancel(){this.tourObject.cancel()}complete(){this.tourObject.complete()}hide(){this.tourObject.hide()}next(){this.tourObject.next()}show(n){this.tourObject.show(n)}start(){this.isActive=!0,this.tourObject.start()}onTourFinish(n){this.isActive=!1}addSteps(n){this._initialize();let i=this.tourObject;if(!(!n||!Array.isArray(n)||n.length===0)){if(!this.requiredElementsPresent()){i.addStep({buttons:[{text:"Exit",action:i.cancel}],id:"error",title:this.errorTitle,text:[this.messageForUser]});return}n.forEach(s=>{s.buttons&&(s.buttons=s.buttons.map(LU.bind(this),this)),i.addStep(s)})}}requiredElementsPresent(){let n=!0;return this.requiredElements.forEach(i=>{let s=document.querySelector(i.selector);n&&(!s||MU(s))&&(n=!1,this.errorTitle=i.title,this.messageForUser=i.message)}),n}_initialize(){let n=new Ps.Tour({confirmCancel:this.confirmCancel,confirmCancelMessage:this.confirmCancelMessage,defaultStepOptions:this.defaultStepOptions,keyboardNavigation:this.keyboardNavigation,tourName:this.tourName,useModalOverlay:this.modal,exitOnEsc:this.exitOnEsc});n.on("complete",this.onTourFinish.bind(this,"complete")),n.on("cancel",this.onTourFinish.bind(this,"cancel")),this.tourObject=n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Le({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function BU(t,e){if(t&1&&(Te(0,"li",36),Ne(1),we()),t&2){let r=e.$implicit;ft(),Zc(" ",r," ")}}function UU(t,e){if(t&1&&(Te(0,"div",31)(1,"div",32)(2,"div",33),Ne(3),we()(),Te(4,"ul",34),fi(5,BU,2,1,"li",35),we()()),t&2){let r=e.$implicit,n=e.index;ft(3),d1("",n+1,". ",r.pregunta,""),ft(2),rn("ngForOf",r.respuesta)}}function jU(t,e){if(t&1){let r=Jc();Te(0,"app-header",37),Dt("guardarHeader",function(i){uo(r);let s=Vi();return ho(s.actualizarHeader(i))})("cerrarModal",function(){uo(r);let i=Vi();return ho(i.mostrarModal=!1)}),we()}}function WU(t,e){if(t&1){let r=Jc();Te(0,"div",38)(1,"label",39),Ne(2,"Cantidad de preguntas por evaluaci\xF3n:"),we(),Te(3,"input",18),pn("ngModelChange",function(i){uo(r);let s=Vi();return dn(s.preguntasPorExamen,i)||(s.preguntasPorExamen=i),ho(i)}),we()()}if(t&2){let r=Vi();ft(3),fn("ngModel",r.preguntasPorExamen)}}function $U(t,e){if(t&1){let r=Jc();Te(0,"div")(1,"label",40),Ne(2,"Puntaje total por examen:"),we(),Te(3,"input",41),pn("ngModelChange",function(i){uo(r);let s=Vi();return dn(s.puntajeTotal,i)||(s.puntajeTotal=i),ho(i)}),we()()}if(t&2){let r=Vi();ft(3),fn("ngModel",r.puntajeTotal)}}function HU(t,e){t&1&&xt(0,"i",42)}function zU(t,e){t&1&&xt(0,"div",43)}function GU(t,e){t&1&&xt(0,"app-loading-print",44)}var CI=(()=>{let e=class e{constructor(n,i,s,a,o){this.fb=n,this.http=i,this.examService=s,this.headerDataService=a,this.shepherdService=o,this.mapeoDificultad={facil:"F\xE1cil",f\u00E1cil:"F\xE1cil",media:"Media",dificil:"Dif\xEDcil",dif\u00EDcil:"Dif\xEDcil"},this.tutorialSeen=localStorage.getItem("tutorialSeen"),this.information=localStorage.getItem("information"),this.preguntasList=[],this.dificultad=1,this.preguntasPorExamen=1,this.cantidadExamenes=1,this.puntajeTotal=0,this.criterioSeleccionado="questionsPerExam",this.cargandoPDF=!1,this.mostrarModal=!1,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[],this.loading=!1;let c=`
    Qu\xE9 gusto tiene la sal?
    Salada
    Amarga
    Dulce
    
    Cu\xE1ntos a\xF1os tiene Mirtha Legrand?
    98
    95
    97
`;this.questionForm=this.fb.group({preguntasTextarea:[c,[Cl.required]]})}ngAfterViewInit(){this.shepherdService.defaultStepOptions={cancelIcon:{enabled:!0},scrollTo:{behavior:"smooth",block:"center"},when:{show:function(){if(this.id!="firstStep"){let a=this.getElement()?.querySelector(".shepherd-footer");a?.classList.remove("single-button","multiple-buttons"),a?.classList.add("multiple-buttons")}}}},this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps([{id:"firstStep",text:"Gracias por elegir nuestra aplicaci\xF3n. Te voy a guiar en un recorrido breve para que puedas aprovechar todas sus funcionalidades.",modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Siguiente",action(){return this.next()}}]},{text:"Ac\xE1 pod\xE9s modificar el membrete de la evaluaci\xF3n. Hac\xE9 clic para abrir el popup.",attachTo:{element:"#buttonModal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.next()},1))}]},{text:`
        Estos son los campos que pod\xE9s modificar en el membrete. Todos son opcionales, y si no se completan, se mostrar\xE1n autom\xE1ticamente la fecha, el puntaje total y el nombre del examen.
        <br><br>
        <strong>Instituci\xF3n:</strong> Ingres\xE1 el nombre de la instituci\xF3n.
        <br><br>
        <strong>Logos de la instituci\xF3n:</strong> Pod\xE9s agregar uno o varios logos de la instituci\xF3n.
        <br><br>
        <strong>Examen:</strong> Indic\xE1 el nombre del examen.
        <br><br>
        <strong>Fecha:</strong> Seleccion\xE1 la fecha del examen.
        <br><br>
        <strong>Duraci\xF3n:</strong> Indic\xE1 la duraci\xF3n del examen.
        <br><br>
        <strong>Profesor:</strong> Ingres\xE1 el nombre del profesor.
        <br><br>
        <strong>C\xE1tedra:</strong> Indic\xE1 el nombre de la c\xE1tedra o materia.
        <br><br>
        <strong>DNI Alumno:</strong> Si seleccionas esta opci\xF3n, se incluir\xE1 el campo DNI en el membrete.
        <br><br>
        <strong>Puntos:</strong> Si seleccionas esta opci\xF3n, se mostrar\xE1n los puntos asignados a cada pregunta, calculados autom\xE1ticamente como 100 dividido por la cantidad de preguntas.
        `,attachTo:{element:"#modal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!1,this.shepherdService.back())},{text:"Siguiente",action:()=>(this.mostrarModal=!1,this.shepherdService.next())}]},{text:`
        Ac\xE1 se ingresan las preguntas.
        <br><br>
        El formato a seguir es:
        <br><br>
        <strong>Pregunta:</strong>
        <br>
        <strong>Opciones de respuesta</strong> <span class="text-sm text-gray-500">(opcional)</span>
        <br>
        <strong>Presionar la tecla Enter</strong> para agregar la siguiente pregunta.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        - Si no se agregan opciones de respuesta, solo se mostrar\xE1 la pregunta.
        <br>
        - Record\xE1 presionar Enter despu\xE9s de ingresar cada pregunta para a\xF1adir la siguiente.
        `,attachTo:{element:"#preguntasTextarea",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.back()},1))},{text:"Siguiente",action(){return this.next()}}]},{text:"Una vez que hayas ingresado todas las preguntas, hac\xE9 clic en este bot\xF3n para guardarlas.",attachTo:{element:"#guardarPreguntas",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Aqu\xED es donde ingres\xE1s las cantidades deseadas. 
        Si no se completan estos campos, no se podr\xE1 generar el PDF.
        <br><br>
        <strong>Cantidad de evaluaciones:</strong> Indica cu\xE1ntas evaluaciones quer\xE9s generar.
        <br><br>
        <strong>Cantidad de preguntas por evaluaci\xF3n:</strong> Define cu\xE1ntas preguntas tendr\xE1 cada evaluaci\xF3n.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        La cantidad de preguntas no puede superar el total de preguntas ingresadas.
        `,attachTo:{element:"#cantidades",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Estos son los tres botones m\xE1s importantes de la aplicaci\xF3n:
        <br><br>
        <strong class="text-green-600">Verde:</strong> Descarga un Excel con las preguntas de la evaluaci\xF3n.
        <br><br>
        <strong class="text-yellow-600">Amarillo:</strong> Permite cargar el Excel que descargaste, evitando que tengas que volver a escribir las preguntas.
        <br><br>
        <strong class="text-red-600">Rojo:</strong> Genera el PDF con los ex\xE1menes.
        `,attachTo:{element:"#botones",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:"En esta secci\xF3n se mostrar\xE1n todas las preguntas que hayas agregado.",attachTo:{element:"#listadoPreguntas",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        \xA1Mucho \xE9xito! Si ten\xE9s alguna duda o sugerencia, no dudes en <a href="#contacto" class="text-blue-600 hover:text-blue-800 underline">contactarnos</a>. 
        Estamos para ayudarte en lo que necesites.
      `,modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Finalizar",action(){return this.next()}}]}]);let n=navigator.userAgent,i=/Mobi|Android|iPhone|iPad|iPod/.test(n);!this.tutorialSeen&&!i&&(this.shepherdService.start(),localStorage.setItem("tutorialSeen","true")),!i&&!this.information&&this.tutorialSeen&&(this.shepherdService.addSteps([{id:"firstStep",text:`
      <p>
        Queremos informarles que hemos decidido <strong>eliminar tanto el puntaje como la dificultad</strong> de las preguntas, ya que por el momento no planeamos utilizarlos. 
      </p>
      <br>
      <p>
        Sin embargo, <em>no se preocupen</em>, los archivos Excel que contengan esta informaci\xF3n <strong>pueden seguir utiliz\xE1ndose sin ning\xFAn problema</strong>, aunque ya no es necesario incluir esos datos.
      </p>
      <br>
      <p>
        \xA1<strong>Muchas gracias</strong> por su comprensi\xF3n y colaboraci\xF3n!
      </p>
`,modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[ri({mainAxis:30,crossAxis:40})]},attachTo:{element:"#preguntasTextarea",on:"right"},buttons:[{text:"Finalizar",action(){return this.next()}}]}]),this.shepherdService.start(),localStorage.setItem("information","true"))}actualizarHeader(n){this.institucion=n.institucion,this.examen=n.examen,this.fecha=n.fecha,this.duracion=n.duracion,this.profesor=n.profesor,this.catedra=n.catedra,this.logoFiles=n.logoFile,this.dniChecked=n.dniChecked,this.puntosChecked=n.puntosChecked,this.mostrarModal=!1}formatDate(n){return new Intl.DateTimeFormat("es-ES",{day:"numeric",month:"long",year:"numeric"}).format(n)}updateDificultad(n){return this.dificultad=n.target.value,this.dificultad.toString()}createRespuesta(){return this.fb.group({respuesta:["",Cl.required]})}addRespuesta(){this.questionForm.get("respuestas").push(this.createRespuesta())}deleteRespuesta(n){this.questionForm.get("respuestas").removeAt(n)}normalizarDificultad(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}verificarDificultad(n,i){return this.normalizarDificultad(n.dificultad)===i}convertToExcelData(){let n=[];return this.preguntasList.forEach(i=>{let s={Pregunta:i.pregunta,Respuestas:i.respuesta.join(", ")};n.push(s)}),n}downloadExcel(){let n=this.convertToExcelData(),i=_u.json_to_sheet(n),s=_u.book_new();_u.book_append_sheet(s,i,"Preguntas"),Rb(s,"preguntasList.xlsx")}onFileChange(n){let i=n.target.files[0];i&&this.loadExcelFile(i)}loadExcelFile(n){let i=new FileReader;i.onload=s=>{this.preguntasList=[];let a=s.target?.result;if(a){let o=Nf(a,{type:"binary"}),c=o.SheetNames[0],l=o.Sheets[c],h=_u.sheet_to_json(l);this.preguntasList=h.map(f=>({pregunta:f.Pregunta,respuesta:f.Respuestas.split(", ").map(d=>d.trim())}))}},i.readAsBinaryString(n)}generarPDF(){return Z(this,null,function*(){this.loading=!0,this.cargandoPDF=!0;let n=this.cantidadExamenes,i=this.preguntasPorExamen,s=this.puntajeTotal,a=this.preguntasList,o=this.examService.generateExams(n,i,s,a),c=document.createElement("div");for(let l=0;l<o.length;l++){let h=o[l],f=document.createElement("div"),d=yield this.http.get("assets/reporteExamen.html",{responseType:"text"}).toPromise();f.innerHTML=d;let p=document.createElement("div"),v=document.createElement("div");if(v.classList.add("header-info","text-right"),this.logoFiles?.length>0&&(v.style.borderTop="2px solid #ccc",v.style.marginTop="20px",p.classList.add("header-img"),Array.from(this.logoFiles).forEach(T=>{this.convertFileToBase64(T).subscribe(N=>{let M=document.createElement("img");M.src=N,M.width=100,M.height=100,p.appendChild(M)})})),this.institucion){let T=document.createElement("h1");T.textContent=`${this.institucion}`,T.classList.add("text-xl","font-bold"),v.appendChild(T)}if(this.examen){let T=document.createElement("h2");T.textContent=`${this.examen??""}`,v.appendChild(T)}let m=document.createElement("p"),_=this.fecha!==""?new Date(this.fecha):new Date;if(console.log(_),this.duracion?m.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(_)} | <strong>Duraci\xF3n:</strong> ${this.duracion??""} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`:m.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(_)} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`,v.appendChild(m),this.profesor){let T=document.createElement("p");T.innerHTML=`<strong>Profesor:</strong> ${this.profesor??""} | <strong>C\xE1tedra:</strong> ${this.catedra??""}`,v.appendChild(T)}let b=document.createElement("p");this.dniChecked?b.innerHTML='<strong>Nombre:</strong> <span style="margin-left: 240px;"></span>| <strong>DNI:</strong>':b.innerHTML="<strong>Nombre:</strong>",v.appendChild(b),f.insertBefore(v,f.firstChild),f.insertBefore(p,f.firstChild);let S=f.querySelector("#preguntasContainer");if(!S){console.error("No se encontr\xF3 el contenedor de preguntas en el HTML cargado.");continue}S.innerHTML="",l>0&&(f.style.pageBreakBefore="always"),h.forEach((T,N)=>{let M=document.createElement("div");M.classList.add("mb-6");let B=document.createElement("div");B.classList.add("text-lg","font-semibold","mb-2"),B.textContent=`${N+1}. ${T.pregunta}`;let x=document.createElement("span");x.classList.add("text-sm","font-bold","text-gray-600","ml-2"),this.puntosChecked&&(x.textContent=` (${T.puntaje} pts)`),B.appendChild(x),M.appendChild(B);let w=document.createElement("ul");w.classList.add("space-y-2"),T.respuesta.forEach((E,C)=>{let k=document.createElement("li");k.classList.add("flex","items-center");let A=document.createElement("input");A.type="checkbox",A.value=E,A.classList.add("mr-2");let R=document.createElement("label");R.htmlFor=A.id,R.textContent=E,k.appendChild(A),k.appendChild(R),w.appendChild(k)}),M.appendChild(w),S.appendChild(M)}),c.appendChild(f)}document.body.appendChild(c),this.cargandoPDF=!1,yield new Promise(l=>setTimeout(l,1e3)),document.title=this.institucion!=""?`${this.examen}-${this.institucion}`:`${this.profesor}-${this.examen}`,window.print(),c.remove(),document.title="EvaluAr",this.loading=!1})}convertFileToBase64(n){return new Ni(i=>{let s=new FileReader;s.onload=()=>{let a=s.result;i.next(a),i.complete()},s.onerror=a=>{i.error(a)},s.readAsDataURL(n)})}onSubmit(){this.questionForm.value.preguntasTextarea.trim().split(/\n\s*\n/).forEach(s=>{let a=s.split(`
`),[o,...c]=a,[l,h,f]=o.split(" - "),d=f?.toLowerCase(),p=this.mapeoDificultad[d]||f,v={pregunta:l.trim(),respuesta:c.map(m=>m.trim()).filter(m=>m!=="")};this.preguntasList.push(v)}),this.questionForm.reset()}};e.\u0275fac=function(i){return new(i||e)(Ue(ew),Ue(L0),Ue(Wb),Ue(qf),Ue(SI))},e.\u0275cmp=tr({type:e,selectors:[["app-preguntas"]],standalone:!0,features:[rr],decls:38,vars:9,consts:[[1,"no-print","container","mx-auto","px-4","py-6",2,"margin-bottom","200px"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["id","listadoPreguntas",1,"bg-white","p-6","rounded-lg","shadow-lg","max-h-[400px]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],["id","listadoPreguntas",1,"space-y-4"],["class","border rounded-lg p-4 shadow-sm",4,"ngFor","ngForOf"],[1,"bg-white","p-6","rounded-lg","shadow-lg"],[1,"flex","flex-row","justify-between","mb-4"],[1,"text-2xl","font-semibold"],["id","buttonModal",1,"w-20","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"fas","fa-file-alt"],[3,"guardarHeader","cerrarModal",4,"ngIf"],[1,"space-y-6","mb-4",3,"ngSubmit","formGroup"],["for","preguntasTextarea",1,"block","font-semibold","mb-2"],["id","preguntasTextarea","formControlName","preguntasTextarea","rows","10","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500"],["id","guardarPreguntas","type","submit",1,"w-full","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600"],["id","cantidades"],["for","cantidadExamenes",1,"block","font-semibold","mb-2"],["type","number",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["class","mt-2",4,"ngIf"],[4,"ngIf"],["id","botones",1,"flex","flex-row","mt-6"],["id","descargarExcel",1,"w-full","bg-green-500","text-white","font-bold","py-2","rounded","hover:bg-green-600",3,"click"],[1,"fas","fa-file-excel"],["id","importarExcel","onclick","document.getElementById('importExcelInput').click()",1,"w-full","bg-yellow-500","hover:bg-yellow-600","border","p-2","rounded","text-white","font-bold","text-center"],[1,"fas","fa-upload"],["id","importExcelInput","type","file","accept",".xls, .xlsx",2,"display","none",3,"change"],["id","descargarPDF",1,"w-full","bg-red-500","text-white","font-bold","py-2","rounded","hover:bg-red-600",3,"click"],["class","fas fa-file-pdf",4,"ngIf"],["class","inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",4,"ngIf"],["class","no-print",4,"ngIf"],[1,"border","rounded-lg","p-4","shadow-sm"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-semibold","text-lg"],[1,"list-[lower-alpha]","pl-6"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"guardarHeader","cerrarModal"],[1,"mt-2"],["for","preguntasPorExamen",1,"block","font-semibold","mb-2"],["for","puntajeTotal"],["type","puntajeTotal",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"fas","fa-file-pdf"],[1,"inline-block","h-4","w-4","animate-spin","rounded-full","border-2","border-solid","border-current","border-e-transparent","align-[-0.125em]","text-surface","motion-reduce:animate-[spin_1.5s_linear_infinite]","dark:text-white"],[1,"no-print"]],template:function(i,s){i&1&&(Te(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),Ne(4,"Listado de Preguntas"),we(),Te(5,"div",4),fi(6,UU,6,3,"div",5),we()(),Te(7,"div",6)(8,"div",7)(9,"h2",8),Ne(10,"Agregar Configuraci\xF3n"),we(),Te(11,"button",9),Dt("click",function(){return s.mostrarModal=!0}),xt(12,"i",10),we()(),fi(13,jU,1,0,"app-header",11),Te(14,"form",12),Dt("ngSubmit",function(){return s.onSubmit()}),Te(15,"div")(16,"label",13),Ne(17,"Preguntas:"),we(),xt(18,"textarea",14),we(),Te(19,"button",15),Ne(20," Guardar Preguntas "),we()(),Te(21,"div",16)(22,"div")(23,"label",17),Ne(24,"Cantidad de evaluaciones a crear:"),we(),Te(25,"input",18),pn("ngModelChange",function(o){return dn(s.cantidadExamenes,o)||(s.cantidadExamenes=o),o}),we()(),fi(26,WU,4,1,"div",19),we(),fi(27,$U,4,1,"div",20),Te(28,"div",21)(29,"button",22),Dt("click",function(){return s.downloadExcel()}),xt(30,"i",23),we(),Te(31,"button",24),xt(32,"i",25),we(),Te(33,"input",26),Dt("change",function(o){return s.onFileChange(o)}),we(),Te(34,"button",27),Dt("click",function(){return s.generarPDF()}),fi(35,HU,1,0,"i",28)(36,zU,1,0,"div",29),we()()()()(),fi(37,GU,1,0,"app-loading-print",30)),i&2&&(ft(6),rn("ngForOf",s.preguntasList),ft(7),rn("ngIf",s.mostrarModal),ft(),rn("formGroup",s.questionForm),ft(11),fn("ngModel",s.cantidadExamenes),ft(),rn("ngIf",s.criterioSeleccionado==="questionsPerExam"),ft(),rn("ngIf",s.criterioSeleccionado==="puntajeTotal"),ft(8),rn("ngIf",!s.cargandoPDF),ft(),rn("ngIf",s.cargandoPDF),ft(),rn("ngIf",s.loading))},dependencies:[el,_1,y1,ff,Do,ws,Hp,Co,ko,ua,Fl,Ol,ww,P1,Ro,Pl,Mb,jb],encapsulation:2});let t=e;return t})();var DI=function(t){let e=[],r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},qU=function(t){let e=[],r=0,n=0;for(;r<t.length;){let i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{let s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},RI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){let s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4,d=(o&15)<<2|l>>6,p=l&63;c||(p=64,a||(d=64)),n.push(r[h],r[f],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(DI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):qU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){let s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;let l=i<t.length?r[t.charAt(i)]:64;++i;let f=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||l==null||f==null)throw new zg;let d=s<<2|o>>4;if(n.push(d),l!==64){let p=o<<4&240|l>>2;if(n.push(p),f!==64){let v=l<<6&192|f;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},zg=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},KU=function(t){let e=DI(t);return RI.encodeByteArray(e,!0)},Su=function(t){return KU(t).replace(/\./g,"")},qg=function(t){try{return RI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function XU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var YU=()=>XU().__FIREBASE_DEFAULTS__,QU=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},JU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&qg(t[1]);return e&&JSON.parse(e)},cd=()=>{try{return YU()||QU()||JU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},PI=t=>{var e,r;return(r=(e=cd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},FI=t=>{let e=PI(t);if(!e)return;let r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Kg=()=>{var t;return(t=cd())===null||t===void 0?void 0:t.config},OI=t=>{var e;return(e=cd())===null||e===void 0?void 0:e[`_${t}`]};var od=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}};function NI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Su(JSON.stringify(r)),Su(JSON.stringify(a)),""].join(".")}function Tn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function MI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Tn())}function ZU(){var t;let e=(t=cd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function LI(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function VI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function BI(){return!ZU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Xg(){try{return typeof indexedDB=="object"}catch{return!1}}function UI(){return new Promise((t,e)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}var e5="FirebaseError",Hn=class t extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=e5,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Zi.prototype.create)}},Zi=class{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){let n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?t5(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Hn(i,o,n)}};function t5(t,e){return t.replace(r5,(r,n)=>{let i=e[n];return i!=null?String(i):`<${n}?>`})}var r5=/\{\$([^}]+)}/g;function cc(t,e){if(t===e)return!0;let r=Object.keys(t),n=Object.keys(e);for(let i of r){if(!n.includes(i))return!1;let s=t[i],a=e[i];if(kI(s)&&kI(a)){if(!cc(s,a))return!1}else if(s!==a)return!1}for(let i of n)if(!r.includes(i))return!1;return!0}function kI(t){return t!==null&&typeof t=="object"}function Yg(t){let e=[];for(let[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function jI(t,e){let r=new Gg(t,e);return r.subscribe.bind(r)}var Gg=class{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");n5(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Hg),i.error===void 0&&(i.error=Hg),i.complete===void 0&&(i.complete=Hg);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function n5(t,e){if(typeof t!="object"||t===null)return!1;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Hg(){}var lG=4*60*60*1e3;function si(t){return t&&t._delegate?t._delegate:t}var zn=class{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ba="[DEFAULT]";var Qg=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let n=new od;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;let n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(s5(e))try{this.getOrInitializeService({instanceIdentifier:Ba})}catch{}for(let[r,n]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(r);try{let s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Ba){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return Z(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ba){return this.instances.has(e)}getOptions(e=Ba){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(let[s,a]of this.instancesDeferred.entries()){let o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;let i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){let n=this.onInitCallbacks.get(r);if(n)for(let i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:i5(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ba){return this.component?this.component.multipleInstances?e:Ba:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function i5(t){return t===Ba?void 0:t}function s5(t){return t.instantiationMode==="EAGER"}var ld=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new Qg(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}};var a5=[],Je=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(Je||{}),o5={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},c5=Je.INFO,l5={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},u5=(t,e,...r)=>{if(e<t.logLevel)return;let n=new Date().toISOString(),i=l5[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ls=class{constructor(e){this.name=e,this._logLevel=c5,this._logHandler=u5,this._userLogHandler=null,a5.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?o5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}};var h5=(t,e)=>e.some(r=>t instanceof r),WI,$I;function f5(){return WI||(WI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function d5(){return $I||($I=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var HI=new WeakMap,Zg=new WeakMap,zI=new WeakMap,Jg=new WeakMap,tv=new WeakMap;function p5(t){let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Ii(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&HI.set(r,t)}).catch(()=>{}),tv.set(e,t),e}function m5(t){if(Zg.has(t))return;let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});Zg.set(t,e)}var ev={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Zg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||zI.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ii(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function GI(t){ev=t(ev)}function g5(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){let n=t.call(ud(this),e,...r);return zI.set(n,e.sort?e.sort():[e]),Ii(n)}:d5().includes(t)?function(...e){return t.apply(ud(this),e),Ii(HI.get(this))}:function(...e){return Ii(t.apply(ud(this),e))}}function v5(t){return typeof t=="function"?g5(t):(t instanceof IDBTransaction&&m5(t),h5(t,f5())?new Proxy(t,ev):t)}function Ii(t){if(t instanceof IDBRequest)return p5(t);if(Jg.has(t))return Jg.get(t);let e=v5(t);return e!==t&&(Jg.set(t,e),tv.set(e,t)),e}var ud=t=>tv.get(t);function KI(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(t,e),o=Ii(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Ii(a.result),c.oldVersion,c.newVersion,Ii(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}var _5=["get","getKey","getAll","getAllKeys","count"],y5=["put","add","delete","clear"],rv=new Map;function qI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(rv.get(e))return rv.get(e);let r=e.replace(/FromIndex$/,""),n=e!==r,i=y5.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||_5.includes(r)))return;let s=function(a,...o){return Z(this,null,function*(){let c=this.transaction(a,i?"readwrite":"readonly"),l=c.store;return n&&(l=l.index(o.shift())),(yield Promise.all([l[r](...o),i&&c.done]))[0]})};return rv.set(e,s),s}GI(t=>ht(be({},t),{get:(e,r,n)=>qI(e,r)||t.get(e,r,n),has:(e,r)=>!!qI(e,r)||t.has(e,r)}));var iv=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(x5(r)){let n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}};function x5(t){let e=t.getComponent();return e?.type==="VERSION"}var sv="@firebase/app",XI="0.10.8";var Ua=new Ls("@firebase/app"),w5="@firebase/app-compat",E5="@firebase/analytics-compat",T5="@firebase/analytics",b5="@firebase/app-check-compat",I5="@firebase/app-check",A5="@firebase/auth",S5="@firebase/auth-compat",C5="@firebase/database",k5="@firebase/database-compat",D5="@firebase/functions",R5="@firebase/functions-compat",P5="@firebase/installations",F5="@firebase/installations-compat",O5="@firebase/messaging",N5="@firebase/messaging-compat",M5="@firebase/performance",L5="@firebase/performance-compat",V5="@firebase/remote-config",B5="@firebase/remote-config-compat",U5="@firebase/storage",j5="@firebase/storage-compat",W5="@firebase/firestore",$5="@firebase/vertexai-preview",H5="@firebase/firestore-compat",z5="firebase",G5="10.12.5";var av="[DEFAULT]",q5={[sv]:"fire-core",[w5]:"fire-core-compat",[T5]:"fire-analytics",[E5]:"fire-analytics-compat",[I5]:"fire-app-check",[b5]:"fire-app-check-compat",[A5]:"fire-auth",[S5]:"fire-auth-compat",[C5]:"fire-rtdb",[k5]:"fire-rtdb-compat",[D5]:"fire-fn",[R5]:"fire-fn-compat",[P5]:"fire-iid",[F5]:"fire-iid-compat",[O5]:"fire-fcm",[N5]:"fire-fcm-compat",[M5]:"fire-perf",[L5]:"fire-perf-compat",[V5]:"fire-rc",[B5]:"fire-rc-compat",[U5]:"fire-gcs",[j5]:"fire-gcs-compat",[W5]:"fire-fst",[H5]:"fire-fst-compat",[$5]:"fire-vertex","fire-js":"fire-js",[z5]:"fire-js-all"};var Cu=new Map,K5=new Map,ov=new Map;function YI(t,e){try{t.container.addComponent(e)}catch(r){Ua.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Bs(t){let e=t.name;if(ov.has(e))return Ua.debug(`There were multiple attempts to register component ${e}.`),!1;ov.set(e,t);for(let r of Cu.values())YI(r,t);for(let r of K5.values())YI(r,t);return!0}function hv(t,e){let r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function lc(t){return t.settings!==void 0}var X5={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Vs=new Zi("app","Firebase",X5);var cv=class{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new zn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Vs.create("app-deleted",{appName:this._name})}};var uc=G5;function fv(t,e={}){let r=t;typeof e!="object"&&(e={name:e});let n=Object.assign({name:av,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw Vs.create("bad-app-name",{appName:String(i)});if(r||(r=Kg()),!r)throw Vs.create("no-options");let s=Cu.get(i);if(s){if(cc(r,s.options)&&cc(n,s.config))return s;throw Vs.create("duplicate-app",{appName:i})}let a=new ld(i);for(let c of ov.values())a.addComponent(c);let o=new cv(r,n,a);return Cu.set(i,o),o}function Du(t=av){let e=Cu.get(t);if(!e&&t===av&&Kg())return fv();if(!e)throw Vs.create("no-app",{appName:t});return e}function hd(){return Array.from(Cu.values())}function wr(t,e,r){var n;let i=(n=q5[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ua.warn(o.join(" "));return}Bs(new zn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Y5="firebase-heartbeat-database",Q5=1,ku="firebase-heartbeat-store",nv=null;function eA(){return nv||(nv=KI(Y5,Q5,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(ku)}catch(r){console.warn(r)}}}}).catch(t=>{throw Vs.create("idb-open",{originalErrorMessage:t.message})})),nv}function J5(t){return Z(this,null,function*(){try{let r=(yield eA()).transaction(ku),n=yield r.objectStore(ku).get(tA(t));return yield r.done,n}catch(e){if(e instanceof Hn)Ua.warn(e.message);else{let r=Vs.create("idb-get",{originalErrorMessage:e?.message});Ua.warn(r.message)}}})}function QI(t,e){return Z(this,null,function*(){try{let n=(yield eA()).transaction(ku,"readwrite");yield n.objectStore(ku).put(e,tA(t)),yield n.done}catch(r){if(r instanceof Hn)Ua.warn(r.message);else{let n=Vs.create("idb-set",{originalErrorMessage:r?.message});Ua.warn(n.message)}}})}function tA(t){return`${t.name}!${t.options.appId}`}var Z5=1024,e9=30*24*60*60*1e3,lv=class{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new uv(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){return Z(this,null,function*(){var e,r;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=JI();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let o=new Date(a.date).valueOf();return Date.now()-o<=e9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return Z(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let r=JI(),{heartbeatsToSend:n,unsentEntries:i}=t9(this._heartbeatsCache.heartbeats),s=Su(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function JI(){return new Date().toISOString().substring(0,10)}function t9(t,e=Z5){let r=[],n=t.slice();for(let i of t){let s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),ZI(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),ZI(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}var uv=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Z(this,null,function*(){return Xg()?UI().then(()=>!0).catch(()=>!1):!1})}read(){return Z(this,null,function*(){if(yield this._canUseIndexedDBPromise){let r=yield J5(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return Z(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return QI(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return Z(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return QI(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function ZI(t){return Su(JSON.stringify({version:2,heartbeats:t})).length}function r9(t){Bs(new zn("platform-logger",e=>new iv(e),"PRIVATE")),Bs(new zn("heartbeat",e=>new lv(e),"PRIVATE")),wr(sv,XI,t),wr(sv,XI,"esm2017"),wr("fire-js","")}r9("");var n9="firebase",i9="10.12.5";wr(n9,i9,"app");var fc=new mo("ANGULARFIRE2_VERSION");function pv(t,e,r){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===r);if(s.length===1)return s[0]}return r.container.getProvider(t).getImmediate({optional:!0})}var Pu=(t,e)=>{let r=e?[e]:hd(),n=[];return r.forEach(i=>{i.container.getProvider(t).instances.forEach(a=>{n.includes(a)||n.push(a)})}),n},Ru=class{constructor(){return Pu(s9)}},s9="app-check";function hc(){}var fd=class{zone;delegate;constructor(e,r=Yy){this.zone=e,this.delegate=r}now(){return this.delegate.now()}schedule(e,r,n){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,r,n)}},dv=class{zone;task=null;constructor(e){this.zone=e}call(e,r){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",hc,{},hc,hc)),r.pipe(lr({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Fu=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(r){this.ngZone=r,this.outsideAngular=r.runOutsideAngular(()=>new fd(Zone.current)),this.insideAngular=r.run(()=>new fd(Zone.current,Xy)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||t)(je(Vt))};static \u0275prov=Le({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function dd(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function a9(t){return dd().ngZone.runOutsideAngular(()=>t())}function ja(t){return dd().ngZone.run(()=>t())}function o9(t){return c9(dd())(t)}function c9(t){return function(r){return r=r.lift(new dv(t.ngZone)),r.pipe(_0(t.outsideAngular),v0(t.insideAngular))}}var l9=(t,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),ja(()=>t.apply(void 0,n))},Ou=(t,e)=>function(){let r,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(r||=ja(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",hc,{},hc,hc))),n[s]=l9(n[s],r));let i=a9(()=>t.apply(this,n));if(!e)if(i instanceof Ni){let s=dd();return i.pipe(_0(s.outsideAngular),v0(s.insideAngular))}else return ja(()=>i);return i instanceof Ni?i.pipe(o9):i instanceof Promise?ja(()=>new Promise((s,a)=>i.then(o=>ja(()=>s(o)),o=>ja(()=>a(o))))):typeof i=="function"&&r?function(){return setTimeout(()=>{r&&r.state==="scheduled"&&r.invoke()},10),i.apply(this,arguments)}:ja(()=>i)};var Wa=class{constructor(e){return e}},Nu=class{constructor(){return hd()}};function u9(t){return t&&t.length===1?t[0]:new Wa(Du())}var mv=new tt("angularfire2._apps"),h9={provide:Wa,useFactory:u9,deps:[[new ui,mv]]},f9={provide:Nu,deps:[[new ui,mv]]};function d9(t){return(e,r)=>{let n=r.get(Yn);wr("angularfire",fc.full,"core"),wr("angularfire",fc.full,"app"),wr("angular",p1.full,n.toString());let i=e.runOutsideAngular(()=>t(r));return new Wa(i)}}function rA(t,...e){return qn([h9,f9,{provide:mv,useFactory:d9(t),multi:!0,deps:[Vt,ra,Fu,...e]}])}var nA=Ou(fv,!0);function hA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var fA=hA,dA=new Zi("auth","Firebase",hA());var vd=new Ls("@firebase/auth");function m9(t,...e){vd.logLevel<=Je.WARN&&vd.warn(`Auth (${uc}): ${t}`,...e)}function md(t,...e){vd.logLevel<=Je.ERROR&&vd.error(`Auth (${uc}): ${t}`,...e)}function iA(t,...e){throw Sv(t,...e)}function Av(t,...e){return Sv(t,...e)}function pA(t,e,r){let n=Object.assign(Object.assign({},fA()),{[e]:r});return new Zi("auth","Firebase",n).create(e,{appName:t.name})}function gd(t){return pA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Sv(t,...e){if(typeof t!="string"){let r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return dA.create(t,...e)}function ut(t,e,...r){if(!t)throw Sv(e,...r)}function Mu(t){let e="INTERNAL ASSERTION FAILED: "+t;throw md(e),new Error(e)}function _d(t,e){t||Mu(e)}function g9(){return sA()==="http:"||sA()==="https:"}function sA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function v9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(g9()||LI()||"connection"in navigator)?navigator.onLine:!0}function _9(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var Ha=class{constructor(e,r){this.shortDelay=e,this.longDelay=r,_d(r>e,"Short delay should be less than long delay!"),this.isMobile=MI()||VI()}get(){return v9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function y9(t,e){_d(t.emulator,"Emulator should always be set here");let{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}var yd=class{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Mu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Mu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Mu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var x9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var w9=new Ha(3e4,6e4);function mA(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Td(s,a,o,c){return Z(this,arguments,function*(t,e,r,n,i={}){return gA(t,i,()=>Z(this,null,function*(){let l={},h={};n&&(e==="GET"?h=n:l={body:JSON.stringify(n)});let f=Yg(Object.assign({key:t.config.apiKey},h)).slice(1),d=yield t._getAdditionalHeaders();return d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode),yd.fetch()(vA(t,t.config.apiHost,r,f),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},l))}))})}function gA(t,e,r){return Z(this,null,function*(){t._canInitEmulator=!1;let n=Object.assign(Object.assign({},x9),e);try{let i=new _v(t),s=yield Promise.race([r(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw pd(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let o=s.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw pd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw pd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw pd(t,"user-disabled",a);let h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw pA(t,h,l);iA(t,h)}}catch(i){if(i instanceof Hn)throw i;iA(t,"network-request-failed",{message:String(i)})}})}function vA(t,e,r,n){let i=`${e}${r}?${n}`;return t.config.emulator?y9(t.config,i):`${t.config.apiScheme}://${i}`}var _v=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Av(this.auth,"network-request-failed")),w9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function pd(t,e,r){let n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=Av(t,e,n);return i.customData._tokenResponse=r,i}function E9(t,e){return Z(this,null,function*(){return Td(t,"POST","/v1/accounts:delete",e)})}function _A(t,e){return Z(this,null,function*(){return Td(t,"POST","/v1/accounts:lookup",e)})}function Lu(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Cv(t,e=!1){return Z(this,null,function*(){let r=si(t),n=yield r.getIdToken(e),i=yA(n);ut(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:n,authTime:Lu(gv(i.auth_time)),issuedAtTime:Lu(gv(i.iat)),expirationTime:Lu(gv(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function gv(t){return Number(t)*1e3}function yA(t){let[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return md("JWT malformed, contained fewer than 3 sections"),null;try{let i=qg(r);return i?JSON.parse(i):(md("Failed to decode base64 JWT payload"),null)}catch(i){return md("Caught error parsing JWT payload as JSON",i?.toString()),null}}function aA(t){let e=yA(t);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function yv(t,e,r=!1){return Z(this,null,function*(){if(r)return e;try{return yield e}catch(n){throw n instanceof Hn&&T9(n)&&t.auth.currentUser===t&&(yield t.auth.signOut()),n}})}function T9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var xv=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){let n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;let i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(()=>Z(this,null,function*(){yield this.iteration()}),r)}iteration(){return Z(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Bu=class{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Lu(this.lastLoginAt),this.creationTime=Lu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function xd(t){return Z(this,null,function*(){var e;let r=t.auth,n=yield t.getIdToken(),i=yield yv(t,_A(r,{idToken:n}));ut(i?.users.length,r,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?xA(s.providerUserInfo):[],o=b9(t.providerData,a),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!o?.length,h=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Bu(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)})}function kv(t){return Z(this,null,function*(){let e=si(t);yield xd(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function b9(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function xA(t){return t.map(e=>{var{providerId:r}=e,n=g0(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function I9(t,e){return Z(this,null,function*(){let r=yield gA(t,{},()=>Z(this,null,function*(){let n=Yg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=vA(t,i,"/v1/token",`key=${s}`),o=yield t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",yd.fetch()(a,{method:"POST",headers:o,body:n})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}})}function A9(t,e){return Z(this,null,function*(){return Td(t,"POST","/v2/accounts:revokeToken",mA(t,e))})}var Vu=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");let r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):aA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){ut(e.length!==0,"internal-error");let r=aA(e);this.updateTokensAndExpiration(e,null,r)}getToken(e,r=!1){return Z(this,null,function*(){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,r){return Z(this,null,function*(){let{accessToken:n,refreshToken:i,expiresIn:s}=yield I9(e,r);this.updateTokensAndExpiration(n,i,Number(s))})}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){let{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new t;return n&&(ut(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(ut(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(ut(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Mu("not implemented")}};function Us(t,e){ut(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Uu=class t{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=g0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new xv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Bu(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return Z(this,null,function*(){let r=yield yv(this,this.stsTokenManager.getToken(this.auth,e));return ut(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r})}getIdTokenResult(e){return Cv(this,e)}reload(){return kv(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,r=!1){return Z(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&(yield xd(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return Z(this,null,function*(){if(lc(this.auth.app))return Promise.reject(gd(this.auth));let e=yield this.getIdToken();return yield yv(this,E9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,c,l,h;let f=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,b=(l=r.createdAt)!==null&&l!==void 0?l:void 0,S=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:T,emailVerified:N,isAnonymous:M,providerData:B,stsTokenManager:x}=r;ut(T&&x,e,"internal-error");let w=Vu.fromJSON(this.name,x);ut(typeof T=="string",e,"internal-error"),Us(f,e.name),Us(d,e.name),ut(typeof N=="boolean",e,"internal-error"),ut(typeof M=="boolean",e,"internal-error"),Us(p,e.name),Us(v,e.name),Us(m,e.name),Us(_,e.name),Us(b,e.name),Us(S,e.name);let E=new t({uid:T,auth:e,email:d,emailVerified:N,displayName:f,isAnonymous:M,photoURL:v,phoneNumber:p,tenantId:m,stsTokenManager:w,createdAt:b,lastLoginAt:S});return B&&Array.isArray(B)&&(E.providerData=B.map(C=>Object.assign({},C))),_&&(E._redirectEventId=_),E}static _fromIdTokenResponse(e,r,n=!1){return Z(this,null,function*(){let i=new Vu;i.updateFromServerResponse(r);let s=new t({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield xd(s),s})}static _fromGetAccountInfoResponse(e,r,n){return Z(this,null,function*(){let i=r.users[0];ut(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?xA(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Vu;o.updateFromIdToken(n);let c=new t({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Bu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var oA=new Map;function $a(t){_d(t instanceof Function,"Expected a class definition");let e=oA.get(t);return e?(_d(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,oA.set(t,e),e)}var S9=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Z(this,null,function*(){return!0})}_set(r,n){return Z(this,null,function*(){this.storage[r]=n})}_get(r){return Z(this,null,function*(){let n=this.storage[r];return n===void 0?null:n})}_remove(r){return Z(this,null,function*(){delete this.storage[r]})}_addListener(r,n){}_removeListener(r,n){}}return t.type="NONE",t})(),wv=S9;function vv(t,e,r){return`firebase:${t}:${e}:${r}`}var wd=class t{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;let{config:i,name:s}=this.auth;this.fullUserKey=vv(this.userKey,i.apiKey,s),this.fullPersistenceKey=vv("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return Z(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Uu._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return Z(this,null,function*(){if(this.persistence===e)return;let r=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,r,n="authUser"){return Z(this,null,function*(){if(!r.length)return new t($a(wv),e,n);let i=(yield Promise.all(r.map(l=>Z(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||$a(wv),a=vv(n,e.config.apiKey,e.name),o=null;for(let l of r)try{let h=yield l._get(a);if(h){let f=Uu._fromJSON(e,h);l!==s&&(o=f),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,n):(s=c[0],o&&(yield s._set(a,o.toJSON())),yield Promise.all(r.map(l=>Z(this,null,function*(){if(l!==s)try{yield l._remove(a)}catch{}}))),new t(s,e,n))})}};function cA(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(R9(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(C9(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(F9(e))return"Blackberry";if(O9(e))return"Webos";if(k9(e))return"Safari";if((e.includes("chrome/")||D9(e))&&!e.includes("edge/"))return"Chrome";if(P9(e))return"Android";{let r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function C9(t=Tn()){return/firefox\//i.test(t)}function k9(t=Tn()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function D9(t=Tn()){return/crios\//i.test(t)}function R9(t=Tn()){return/iemobile/i.test(t)}function P9(t=Tn()){return/android/i.test(t)}function F9(t=Tn()){return/blackberry/i.test(t)}function O9(t=Tn()){return/webos/i.test(t)}function wA(t,e=[]){let r;switch(t){case"Browser":r=cA(Tn());break;case"Worker":r=`${cA(Tn())}-${t}`;break;default:r=t}let n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${uc}/${n}`}var Ev=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let n=s=>new Promise((a,o)=>{try{let c=e(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return Z(this,null,function*(){if(this.auth.currentUser===e)return;let r=[];try{for(let n of this.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(let i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}})}};function N9(r){return Z(this,arguments,function*(t,e={}){return Td(t,"GET","/v2/passwordPolicy",mA(t,e))})}var M9=6,Tv=class{constructor(e){var r,n,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:M9,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,r){let n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var bv=class{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ed(this),this.idTokenSubscription=new Ed(this),this.beforeStateQueue=new Ev(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=dA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=$a(r)),this._initializationPromise=this.queue(()=>Z(this,null,function*(){var n,i;if(!this._deleted&&(this.persistenceManager=yield wd.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return Z(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return Z(this,null,function*(){try{let r=yield _A(this,{idToken:e}),n=yield Uu._fromGetAccountInfoResponse(this,r,e);yield this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return Z(this,null,function*(){var r;if(lc(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}let n=yield this.assertedPersistence.getCurrentUser(),i=n,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return Z(this,null,function*(){let r=null;try{r=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return r})}reloadAndSetCurrentUserOrClear(e){return Z(this,null,function*(){try{yield xd(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=_9()}_delete(){return Z(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return Z(this,null,function*(){if(lc(this.app))return Promise.reject(gd(this));let r=e?si(e):null;return r&&ut(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))})}_updateCurrentUser(e,r=!1){return Z(this,null,function*(){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>Z(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return Z(this,null,function*(){return lc(this.app)?Promise.reject(gd(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return lc(this.app)?Promise.reject(gd(this)):this.queue(()=>Z(this,null,function*(){yield this.assertedPersistence.setPersistence($a(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return Z(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return Z(this,null,function*(){let e=yield N9(this),r=new Tv(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Zi("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},r)}})}revokeAccessToken(e){return Z(this,null,function*(){if(this.currentUser){let r=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),yield A9(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,r){return Z(this,null,function*(){let n=yield this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return Z(this,null,function*(){if(!this.redirectPersistenceManager){let r=e&&$a(e)||this._popupRedirectResolver;ut(r,this,"argument-error"),this.redirectPersistenceManager=yield wd.create(this,[$a(r._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return Z(this,null,function*(){var r,n;return this._isInitialized&&(yield this.queue(()=>Z(this,null,function*(){}))),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return Z(this,null,function*(){if(e===this.currentUser)return this.queue(()=>Z(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};let s=typeof r=="function"?r:r.next.bind(r),a=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){let c=e.addObserver(r,n,i);return()=>{a=!0,c()}}else{let c=e.addObserver(r);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return Z(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=wA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return Z(this,null,function*(){var e;let r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);let n=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();n&&(r["X-Firebase-Client"]=n);let i=yield this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r})}_getAppCheckToken(){return Z(this,null,function*(){var e;let r=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return r?.error&&m9(`Error while retrieving App Check token: ${r.error}`),r?.token})}};function L9(t){return si(t)}var Ed=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=jI(r=>this.observer=r)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var V9={loadJS(){return Z(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function B9(t){V9=t}function U9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function j9(t,e){let r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map($a);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}var aq=U9("rcb"),oq=new Ha(3e4,6e4);var cq=new Ha(2e3,1e4);var lq=10*60*1e3;var uq=new Ha(3e4,6e4);var hq=new Ha(5e3,15e3);var fq=encodeURIComponent("fac");var lA="@firebase/auth",uA="1.7.6";var Iv=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return Z(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function W9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $9(t){Bs(new zn("auth",(e,{options:r})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;ut(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});let c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wA(t)},l=new bv(n,i,s,c);return j9(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Bs(new zn("auth-internal",e=>{let r=L9(e.getProvider("auth").getImmediate());return(n=>new Iv(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),wr(lA,uA,W9(t)),wr(lA,uA,"esm2017")}var H9=5*60,dq=OI("authIdTokenMaxAge")||H9;function z9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}B9({loadJS(t){return new Promise((e,r)=>{let n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{let s=Av("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",z9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$9("Browser");var Hj="auth";var bd=class{constructor(){return Pu(Hj)}};var EA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},TA={};var Dv,bA;(function(){var t;function e(x,w){function E(){}E.prototype=w.prototype,x.D=w.prototype,x.prototype=new E,x.prototype.constructor=x,x.C=function(C,k,A){for(var R=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)R[oe-2]=arguments[oe];return w.prototype[k].apply(C,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,w,E){E||(E=0);var C=Array(16);if(typeof w=="string")for(var k=0;16>k;++k)C[k]=w.charCodeAt(E++)|w.charCodeAt(E++)<<8|w.charCodeAt(E++)<<16|w.charCodeAt(E++)<<24;else for(k=0;16>k;++k)C[k]=w[E++]|w[E++]<<8|w[E++]<<16|w[E++]<<24;w=x.g[0],E=x.g[1],k=x.g[2];var A=x.g[3],R=w+(A^E&(k^A))+C[0]+3614090360&4294967295;w=E+(R<<7&4294967295|R>>>25),R=A+(k^w&(E^k))+C[1]+3905402710&4294967295,A=w+(R<<12&4294967295|R>>>20),R=k+(E^A&(w^E))+C[2]+606105819&4294967295,k=A+(R<<17&4294967295|R>>>15),R=E+(w^k&(A^w))+C[3]+3250441966&4294967295,E=k+(R<<22&4294967295|R>>>10),R=w+(A^E&(k^A))+C[4]+4118548399&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(k^w&(E^k))+C[5]+1200080426&4294967295,A=w+(R<<12&4294967295|R>>>20),R=k+(E^A&(w^E))+C[6]+2821735955&4294967295,k=A+(R<<17&4294967295|R>>>15),R=E+(w^k&(A^w))+C[7]+4249261313&4294967295,E=k+(R<<22&4294967295|R>>>10),R=w+(A^E&(k^A))+C[8]+1770035416&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(k^w&(E^k))+C[9]+2336552879&4294967295,A=w+(R<<12&4294967295|R>>>20),R=k+(E^A&(w^E))+C[10]+4294925233&4294967295,k=A+(R<<17&4294967295|R>>>15),R=E+(w^k&(A^w))+C[11]+2304563134&4294967295,E=k+(R<<22&4294967295|R>>>10),R=w+(A^E&(k^A))+C[12]+1804603682&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(k^w&(E^k))+C[13]+4254626195&4294967295,A=w+(R<<12&4294967295|R>>>20),R=k+(E^A&(w^E))+C[14]+2792965006&4294967295,k=A+(R<<17&4294967295|R>>>15),R=E+(w^k&(A^w))+C[15]+1236535329&4294967295,E=k+(R<<22&4294967295|R>>>10),R=w+(k^A&(E^k))+C[1]+4129170786&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^k&(w^E))+C[6]+3225465664&4294967295,A=w+(R<<9&4294967295|R>>>23),R=k+(w^E&(A^w))+C[11]+643717713&4294967295,k=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(k^A))+C[0]+3921069994&4294967295,E=k+(R<<20&4294967295|R>>>12),R=w+(k^A&(E^k))+C[5]+3593408605&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^k&(w^E))+C[10]+38016083&4294967295,A=w+(R<<9&4294967295|R>>>23),R=k+(w^E&(A^w))+C[15]+3634488961&4294967295,k=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(k^A))+C[4]+3889429448&4294967295,E=k+(R<<20&4294967295|R>>>12),R=w+(k^A&(E^k))+C[9]+568446438&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^k&(w^E))+C[14]+3275163606&4294967295,A=w+(R<<9&4294967295|R>>>23),R=k+(w^E&(A^w))+C[3]+4107603335&4294967295,k=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(k^A))+C[8]+1163531501&4294967295,E=k+(R<<20&4294967295|R>>>12),R=w+(k^A&(E^k))+C[13]+2850285829&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^k&(w^E))+C[2]+4243563512&4294967295,A=w+(R<<9&4294967295|R>>>23),R=k+(w^E&(A^w))+C[7]+1735328473&4294967295,k=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(k^A))+C[12]+2368359562&4294967295,E=k+(R<<20&4294967295|R>>>12),R=w+(E^k^A)+C[5]+4294588738&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^k)+C[8]+2272392833&4294967295,A=w+(R<<11&4294967295|R>>>21),R=k+(A^w^E)+C[11]+1839030562&4294967295,k=A+(R<<16&4294967295|R>>>16),R=E+(k^A^w)+C[14]+4259657740&4294967295,E=k+(R<<23&4294967295|R>>>9),R=w+(E^k^A)+C[1]+2763975236&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^k)+C[4]+1272893353&4294967295,A=w+(R<<11&4294967295|R>>>21),R=k+(A^w^E)+C[7]+4139469664&4294967295,k=A+(R<<16&4294967295|R>>>16),R=E+(k^A^w)+C[10]+3200236656&4294967295,E=k+(R<<23&4294967295|R>>>9),R=w+(E^k^A)+C[13]+681279174&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^k)+C[0]+3936430074&4294967295,A=w+(R<<11&4294967295|R>>>21),R=k+(A^w^E)+C[3]+3572445317&4294967295,k=A+(R<<16&4294967295|R>>>16),R=E+(k^A^w)+C[6]+76029189&4294967295,E=k+(R<<23&4294967295|R>>>9),R=w+(E^k^A)+C[9]+3654602809&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^k)+C[12]+3873151461&4294967295,A=w+(R<<11&4294967295|R>>>21),R=k+(A^w^E)+C[15]+530742520&4294967295,k=A+(R<<16&4294967295|R>>>16),R=E+(k^A^w)+C[2]+3299628645&4294967295,E=k+(R<<23&4294967295|R>>>9),R=w+(k^(E|~A))+C[0]+4096336452&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~k))+C[7]+1126891415&4294967295,A=w+(R<<10&4294967295|R>>>22),R=k+(w^(A|~E))+C[14]+2878612391&4294967295,k=A+(R<<15&4294967295|R>>>17),R=E+(A^(k|~w))+C[5]+4237533241&4294967295,E=k+(R<<21&4294967295|R>>>11),R=w+(k^(E|~A))+C[12]+1700485571&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~k))+C[3]+2399980690&4294967295,A=w+(R<<10&4294967295|R>>>22),R=k+(w^(A|~E))+C[10]+4293915773&4294967295,k=A+(R<<15&4294967295|R>>>17),R=E+(A^(k|~w))+C[1]+2240044497&4294967295,E=k+(R<<21&4294967295|R>>>11),R=w+(k^(E|~A))+C[8]+1873313359&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~k))+C[15]+4264355552&4294967295,A=w+(R<<10&4294967295|R>>>22),R=k+(w^(A|~E))+C[6]+2734768916&4294967295,k=A+(R<<15&4294967295|R>>>17),R=E+(A^(k|~w))+C[13]+1309151649&4294967295,E=k+(R<<21&4294967295|R>>>11),R=w+(k^(E|~A))+C[4]+4149444226&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~k))+C[11]+3174756917&4294967295,A=w+(R<<10&4294967295|R>>>22),R=k+(w^(A|~E))+C[2]+718787259&4294967295,k=A+(R<<15&4294967295|R>>>17),R=E+(A^(k|~w))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+w&4294967295,x.g[1]=x.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+k&4294967295,x.g[3]=x.g[3]+A&4294967295}n.prototype.u=function(x,w){w===void 0&&(w=x.length);for(var E=w-this.blockSize,C=this.B,k=this.h,A=0;A<w;){if(k==0)for(;A<=E;)i(this,x,A),A+=this.blockSize;if(typeof x=="string"){for(;A<w;)if(C[k++]=x.charCodeAt(A++),k==this.blockSize){i(this,C),k=0;break}}else for(;A<w;)if(C[k++]=x[A++],k==this.blockSize){i(this,C),k=0;break}}this.h=k,this.o+=w},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var w=1;w<x.length-8;++w)x[w]=0;var E=8*this.o;for(w=x.length-8;w<x.length;++w)x[w]=E&255,E/=256;for(this.u(x),x=Array(16),w=E=0;4>w;++w)for(var C=0;32>C;C+=8)x[E++]=this.g[w]>>>C&255;return x};function s(x,w){var E=o;return Object.prototype.hasOwnProperty.call(E,x)?E[x]:E[x]=w(x)}function a(x,w){this.h=w;for(var E=[],C=!0,k=x.length-1;0<=k;k--){var A=x[k]|0;C&&A==w||(E[k]=A,C=!1)}this.g=E}var o={};function c(x){return-128<=x&&128>x?s(x,function(w){return new a([w|0],0>w?-1:0)}):new a([x|0],0>x?-1:0)}function l(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return _(l(-x));for(var w=[],E=1,C=0;x>=E;C++)w[C]=x/E|0,E*=4294967296;return new a(w,0)}function h(x,w){if(x.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(x.charAt(0)=="-")return _(h(x.substring(1),w));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(w,8)),C=f,k=0;k<x.length;k+=8){var A=Math.min(8,x.length-k),R=parseInt(x.substring(k,k+A),w);8>A?(A=l(Math.pow(w,A)),C=C.j(A).add(l(R))):(C=C.j(E),C=C.add(l(R)))}return C}var f=c(0),d=c(1),p=c(16777216);t=a.prototype,t.m=function(){if(m(this))return-_(this).m();for(var x=0,w=1,E=0;E<this.g.length;E++){var C=this.i(E);x+=(0<=C?C:4294967296+C)*w,w*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(v(this))return"0";if(m(this))return"-"+_(this).toString(x);for(var w=l(Math.pow(x,6)),E=this,C="";;){var k=N(E,w).g;E=b(E,k.j(w));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(x);if(E=k,v(E))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function v(x){if(x.h!=0)return!1;for(var w=0;w<x.g.length;w++)if(x.g[w]!=0)return!1;return!0}function m(x){return x.h==-1}t.l=function(x){return x=b(this,x),m(x)?-1:v(x)?0:1};function _(x){for(var w=x.g.length,E=[],C=0;C<w;C++)E[C]=~x.g[C];return new a(E,~x.h).add(d)}t.abs=function(){return m(this)?_(this):this},t.add=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0,k=0;k<=w;k++){var A=C+(this.i(k)&65535)+(x.i(k)&65535),R=(A>>>16)+(this.i(k)>>>16)+(x.i(k)>>>16);C=R>>>16,A&=65535,R&=65535,E[k]=R<<16|A}return new a(E,E[E.length-1]&-2147483648?-1:0)};function b(x,w){return x.add(_(w))}t.j=function(x){if(v(this)||v(x))return f;if(m(this))return m(x)?_(this).j(_(x)):_(_(this).j(x));if(m(x))return _(this.j(_(x)));if(0>this.l(p)&&0>x.l(p))return l(this.m()*x.m());for(var w=this.g.length+x.g.length,E=[],C=0;C<2*w;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var k=0;k<x.g.length;k++){var A=this.i(C)>>>16,R=this.i(C)&65535,oe=x.i(k)>>>16,se=x.i(k)&65535;E[2*C+2*k]+=R*se,S(E,2*C+2*k),E[2*C+2*k+1]+=A*se,S(E,2*C+2*k+1),E[2*C+2*k+1]+=R*oe,S(E,2*C+2*k+1),E[2*C+2*k+2]+=A*oe,S(E,2*C+2*k+2)}for(C=0;C<w;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=w;C<2*w;C++)E[C]=0;return new a(E,0)};function S(x,w){for(;(x[w]&65535)!=x[w];)x[w+1]+=x[w]>>>16,x[w]&=65535,w++}function T(x,w){this.g=x,this.h=w}function N(x,w){if(v(w))throw Error("division by zero");if(v(x))return new T(f,f);if(m(x))return w=N(_(x),w),new T(_(w.g),_(w.h));if(m(w))return w=N(x,_(w)),new T(_(w.g),w.h);if(30<x.g.length){if(m(x)||m(w))throw Error("slowDivide_ only works with positive integers.");for(var E=d,C=w;0>=C.l(x);)E=M(E),C=M(C);var k=B(E,1),A=B(C,1);for(C=B(C,2),E=B(E,2);!v(C);){var R=A.add(C);0>=R.l(x)&&(k=k.add(E),A=R),C=B(C,1),E=B(E,1)}return w=b(x,k.j(w)),new T(k,w)}for(k=f;0<=x.l(w);){for(E=Math.max(1,Math.floor(x.m()/w.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=l(E),R=A.j(w);m(R)||0<R.l(x);)E-=C,A=l(E),R=A.j(w);v(A)&&(A=d),k=k.add(A),x=b(x,R)}return new T(k,x)}t.A=function(x){return N(this,x).h},t.and=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)&x.i(C);return new a(E,this.h&x.h)},t.or=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)|x.i(C);return new a(E,this.h|x.h)},t.xor=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)^x.i(C);return new a(E,this.h^x.h)};function M(x){for(var w=x.g.length+1,E=[],C=0;C<w;C++)E[C]=x.i(C)<<1|x.i(C-1)>>>31;return new a(E,x.h)}function B(x,w){var E=w>>5;w%=32;for(var C=x.g.length-E,k=[],A=0;A<C;A++)k[A]=0<w?x.i(A+E)>>>w|x.i(A+E+1)<<32-w:x.i(A+E);return new a(k,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,bA=TA.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=h,Dv=TA.Integer=a}).apply(typeof EA<"u"?EA:typeof self<"u"?self:typeof window<"u"?window:{});var Id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},es={};var Rv,Pv,dc,Fv,ju,Ad,Ov,Nv,Mv;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,y){return u==Array.prototype||u==Object.prototype||(u[g]=y.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Id=="object"&&Id];for(var g=0;g<u.length;++g){var y=u[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=r(this);function i(u,g){if(g)e:{var y=n;u=u.split(".");for(var D=0;D<u.length-1;D++){var z=u[D];if(!(z in y))break e;y=y[z]}u=u[u.length-1],D=y[u],g=g(D),g!=D&&g!=null&&e(y,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var y=0,D=!1,z={next:function(){if(!D&&y<u.length){var Q=y++;return{value:g(Q,u[Q]),done:!1}}return D=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,y){return y})}});var a=a||{},o=this||self;function c(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function l(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function h(u,g,y){return u.call.apply(u.bind,arguments)}function f(u,g,y){if(!u)throw Error();if(2<arguments.length){var D=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,D),u.apply(g,z)}}return function(){return u.apply(g,arguments)}}function d(u,g,y){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,d.apply(null,arguments)}function p(u,g){var y=Array.prototype.slice.call(arguments,1);return function(){var D=y.slice();return D.push.apply(D,arguments),u.apply(this,D)}}function v(u,g){function y(){}y.prototype=g.prototype,u.aa=g.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(D,z,Q){for(var ye=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)ye[Et-2]=arguments[Et];return g.prototype[z].apply(D,ye)}}function m(u){let g=u.length;if(0<g){let y=Array(g);for(let D=0;D<g;D++)y[D]=u[D];return y}return[]}function _(u,g){for(let y=1;y<arguments.length;y++){let D=arguments[y];if(c(D)){let z=u.length||0,Q=D.length||0;u.length=z+Q;for(let ye=0;ye<Q;ye++)u[z+ye]=D[ye]}else u.push(D)}}class b{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function S(u){return/^[\s\xa0]*$/.test(u)}function T(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function N(u){return N[" "](u),u}N[" "]=function(){};var M=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function B(u,g,y){for(let D in u)g.call(y,u[D],D,u)}function x(u,g){for(let y in u)g.call(void 0,u[y],y,u)}function w(u){let g={};for(let y in u)g[y]=u[y];return g}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,g){let y,D;for(let z=1;z<arguments.length;z++){D=arguments[z];for(y in D)u[y]=D[y];for(let Q=0;Q<E.length;Q++)y=E[Q],Object.prototype.hasOwnProperty.call(D,y)&&(u[y]=D[y])}}function k(u){var g=1;u=u.split(":");let y=[];for(;0<g&&u.length;)y.push(u.shift()),g--;return u.length&&y.push(u.join(":")),y}function A(u){o.setTimeout(()=>{throw u},0)}function R(){var u=he;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class oe{constructor(){this.h=this.g=null}add(g,y){let D=se.get();D.set(g,y),this.h?this.h.next=D:this.g=D,this.h=D}}var se=new b(()=>new Se,u=>u.reset());class Se{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let _e,Re=!1,he=new oe,Ie=()=>{let u=o.Promise.resolve(void 0);_e=()=>{u.then(re)}};var re=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(y){A(y)}var g=se;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}Re=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return u}();function W(u,g){if(G.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,D=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(M){e:{try{N(g.nodeName);var z=!0;break e}catch{}z=!1}z||(g=null)}}else y=="mouseover"?g=u.fromElement:y=="mouseout"&&(g=u.toElement);this.relatedTarget=g,D?(this.clientX=D.clientX!==void 0?D.clientX:D.pageX,this.clientY=D.clientY!==void 0?D.clientY:D.pageY,this.screenX=D.screenX||0,this.screenY=D.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:te[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&W.aa.h.call(this)}}v(W,G);var te={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var de="closure_listenable_"+(1e6*Math.random()|0),ce=0;function ue(u,g,y,D,z){this.listener=u,this.proxy=null,this.src=g,this.type=y,this.capture=!!D,this.ha=z,this.key=++ce,this.da=this.fa=!1}function ne(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Be(u){this.src=u,this.g={},this.h=0}Be.prototype.add=function(u,g,y,D,z){var Q=u.toString();u=this.g[Q],u||(u=this.g[Q]=[],this.h++);var ye=nt(u,g,D,z);return-1<ye?(g=u[ye],y||(g.fa=!1)):(g=new ue(g,this.src,Q,!!D,z),g.fa=y,u.push(g)),g};function U(u,g){var y=g.type;if(y in u.g){var D=u.g[y],z=Array.prototype.indexOf.call(D,g,void 0),Q;(Q=0<=z)&&Array.prototype.splice.call(D,z,1),Q&&(ne(g),u.g[y].length==0&&(delete u.g[y],u.h--))}}function nt(u,g,y,D){for(var z=0;z<u.length;++z){var Q=u[z];if(!Q.da&&Q.listener==g&&Q.capture==!!y&&Q.ha==D)return z}return-1}var He="closure_lm_"+(1e6*Math.random()|0),it={};function Xe(u,g,y,D,z){if(D&&D.once)return Kr(u,g,y,D,z);if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Xe(u,g[Q],y,D,z);return null}return y=An(y),u&&u[de]?u.K(g,y,l(D)?!!D.capture:!!D,z):Ee(u,g,y,!1,D,z)}function Ee(u,g,y,D,z,Q){if(!g)throw Error("Invalid event type");var ye=l(z)?!!z.capture:!!z,Et=br(u);if(Et||(u[He]=Et=new Be(u)),y=Et.add(g,y,D,ye,Q),y.proxy)return y;if(D=Lt(),y.proxy=D,D.src=u,D.listener=y,u.addEventListener)H||(z=ye),z===void 0&&(z=!1),u.addEventListener(g.toString(),D,z);else if(u.attachEvent)u.attachEvent(ss(g.toString()),D);else if(u.addListener&&u.removeListener)u.addListener(D);else throw Error("addEventListener and attachEvent are unavailable.");return y}function Lt(){function u(y){return g.call(u.src,u.listener,y)}let g=ai;return u}function Kr(u,g,y,D,z){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Kr(u,g[Q],y,D,z);return null}return y=An(y),u&&u[de]?u.L(g,y,l(D)?!!D.capture:!!D,z):Ee(u,g,y,!0,D,z)}function cn(u,g,y,D,z){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)cn(u,g[Q],y,D,z);else D=l(D)?!!D.capture:!!D,y=An(y),u&&u[de]?(u=u.i,g=String(g).toString(),g in u.g&&(Q=u.g[g],y=nt(Q,y,D,z),-1<y&&(ne(Q[y]),Array.prototype.splice.call(Q,y,1),Q.length==0&&(delete u.g[g],u.h--)))):u&&(u=br(u))&&(g=u.g[g.toString()],u=-1,g&&(u=nt(g,y,D,z)),(y=-1<u?g[u]:null)&&ln(y))}function ln(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[de])U(g.i,u);else{var y=u.type,D=u.proxy;g.removeEventListener?g.removeEventListener(y,D,u.capture):g.detachEvent?g.detachEvent(ss(y),D):g.addListener&&g.removeListener&&g.removeListener(D),(y=br(g))?(U(y,u),y.h==0&&(y.src=null,g[He]=null)):ne(u)}}}function ss(u){return u in it?it[u]:it[u]="on"+u}function ai(u,g){if(u.da)u=!0;else{g=new W(g,this);var y=u.listener,D=u.ha||u.src;u.fa&&ln(u),u=y.call(D,g)}return u}function br(u){return u=u[He],u instanceof Be?u:null}var un="__closure_events_fn_"+(1e9*Math.random()>>>0);function An(u){return typeof u=="function"?u:(u[un]||(u[un]=function(g){return u.handleEvent(g)}),u[un])}function jt(){j.call(this),this.i=new Be(this),this.M=this,this.F=null}v(jt,j),jt.prototype[de]=!0,jt.prototype.removeEventListener=function(u,g,y,D){cn(this,u,g,y,D)};function lt(u,g){var y,D=u.F;if(D)for(y=[];D;D=D.F)y.push(D);if(u=u.M,D=g.type||g,typeof g=="string")g=new G(g,u);else if(g instanceof G)g.target=g.target||u;else{var z=g;g=new G(D,u),C(g,z)}if(z=!0,y)for(var Q=y.length-1;0<=Q;Q--){var ye=g.g=y[Q];z=Xr(ye,D,!0,g)&&z}if(ye=g.g=u,z=Xr(ye,D,!0,g)&&z,z=Xr(ye,D,!1,g)&&z,y)for(Q=0;Q<y.length;Q++)ye=g.g=y[Q],z=Xr(ye,D,!1,g)&&z}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var y=u.g[g],D=0;D<y.length;D++)ne(y[D]);delete u.g[g],u.h--}}this.F=null},jt.prototype.K=function(u,g,y,D){return this.i.add(String(u),g,!1,y,D)},jt.prototype.L=function(u,g,y,D){return this.i.add(String(u),g,!0,y,D)};function Xr(u,g,y,D){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var z=!0,Q=0;Q<g.length;++Q){var ye=g[Q];if(ye&&!ye.da&&ye.capture==y){var Et=ye.listener,Ar=ye.ha||ye.src;ye.fa&&U(u.i,ye),z=Et.call(Ar,D)!==!1&&z}}return z&&!D.defaultPrevented}function ze(u,g,y){if(typeof u=="function")y&&(u=d(u,y));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:o.setTimeout(u,g||0)}function Ot(u){u.g=ze(()=>{u.g=null,u.i&&(u.i=!1,Ot(u))},u.l);let g=u.h;u.h=null,u.m.apply(null,g)}class en extends j{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ot(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ct(u){j.call(this),this.h=u,this.g={}}v(Ct,j);var oi=[];function Pc(u){B(u.g,function(g,y){this.g.hasOwnProperty(y)&&ln(g)},u),u.g={}}Ct.prototype.N=function(){Ct.aa.N.call(this),Pc(this)},Ct.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Fc=o.JSON.stringify,s0=o.JSON.parse,th=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function to(){}to.prototype.h=null;function Oc(u){return u.h||(u.h=u.i())}function rh(){}var Gs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function as(){G.call(this,"d")}v(as,G);function Nc(){G.call(this,"c")}v(Nc,G);var Ri={},nh=null;function ro(){return nh=nh||new jt}Ri.La="serverreachability";function ih(u){G.call(this,Ri.La,u)}v(ih,G);function qs(u){let g=ro();lt(g,new ih(g))}Ri.STAT_EVENT="statevent";function sh(u,g){G.call(this,Ri.STAT_EVENT,u),this.stat=g}v(sh,G);function Ir(u){let g=ro();lt(g,new sh(g,u))}Ri.Ma="timingevent";function no(u,g){G.call(this,Ri.Ma,u),this.size=g}v(no,G);function Ks(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function Xs(){this.g=!0}Xs.prototype.xa=function(){this.g=!1};function a0(u,g,y,D,z,Q){u.info(function(){if(u.g)if(Q)for(var ye="",Et=Q.split("&"),Ar=0;Ar<Et.length;Ar++){var ot=Et[Ar].split("=");if(1<ot.length){var Pr=ot[0];ot=ot[1];var Fr=Pr.split("_");ye=2<=Fr.length&&Fr[1]=="type"?ye+(Pr+"="+ot+"&"):ye+(Pr+"=redacted&")}}else ye=null;else ye=Q;return"XMLHTTP REQ ("+D+") [attempt "+z+"]: "+g+`
`+y+`
`+ye})}function I(u,g,y,D,z,Q,ye){u.info(function(){return"XMLHTTP RESP ("+D+") [ attempt "+z+"]: "+g+`
`+y+`
`+Q+" "+ye})}function O(u,g,y,D){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+F(u,y)+(D?" "+D:"")})}function P(u,g){u.info(function(){return"TIMEOUT: "+g})}Xs.prototype.info=function(){};function F(u,g){if(!u.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var D=y[u];if(!(2>D.length)){var z=D[1];if(Array.isArray(z)&&!(1>z.length)){var Q=z[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var ye=1;ye<z.length;ye++)z[ye]=""}}}}return Fc(y)}catch{return g}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function J(){}v(J,to),J.prototype.g=function(){return new XMLHttpRequest},J.prototype.i=function(){return{}},K=new J;function q(u,g,y,D){this.j=u,this.i=g,this.l=y,this.R=D||1,this.U=new Ct(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},ae={};function fe(u,g,y){u.L=1,u.v=ch(Fi(g)),u.m=y,u.P=!0,Ae(u,null)}function Ae(u,g){u.F=Date.now(),Oe(u),u.A=Fi(u.v);var y=u.A,D=u.R;Array.isArray(D)||(D=[String(D)]),Iy(y.i,"t",D),u.C=0,y=u.j.J,u.h=new X,u.g=$y(u.j,y?g:null,!u.m),0<u.O&&(u.M=new en(d(u.Y,u,u.g),u.O)),g=u.U,y=u.g,D=u.ca;var z="readystatechange";Array.isArray(z)||(z&&(oi[0]=z.toString()),z=oi);for(var Q=0;Q<z.length;Q++){var ye=Xe(y,z[Q],D||g.handleEvent,!1,g.h||g);if(!ye)break;g.g[ye.key]=ye}g=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),qs(),a0(u.i,u.u,u.A,u.l,u.R,u.m)}q.prototype.ca=function(u){u=u.target;let g=this.M;g&&Oi(u)==3?g.j():this.Y(u)},q.prototype.Y=function(u){try{if(u==this.g)e:{let Fr=Oi(this.g);var g=this.g.Ba();let oo=this.g.Z();if(!(3>Fr)&&(Fr!=3||this.g&&(this.h.h||this.g.oa()||Py(this.g)))){this.J||Fr!=4||g==7||(g==8||0>=oo?qs(3):qs(2)),pr(this);var y=this.g.Z();this.X=y;t:if(pe(this)){var D=Py(this.g);u="";var z=D.length,Q=Oi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){qt(this),Tt(this);var ye="";break t}this.h.i=new o.TextDecoder}for(g=0;g<z;g++)this.h.h=!0,u+=this.h.i.decode(D[g],{stream:!(Q&&g==z-1)});D.length=0,this.h.g+=u,this.C=0,ye=this.h.g}else ye=this.g.oa();if(this.o=y==200,I(this.i,this.u,this.A,this.l,this.R,Fr,y),this.o){if(this.T&&!this.K){t:{if(this.g){var Et,Ar=this.g;if((Et=Ar.g?Ar.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(Et)){var ot=Et;break t}}ot=null}if(y=ot)O(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Pi(this,y);else{this.o=!1,this.s=3,Ir(12),qt(this),Tt(this);break e}}if(this.P){y=!0;let Gn;for(;!this.J&&this.C<ye.length;)if(Gn=xe(this,ye),Gn==ae){Fr==4&&(this.s=4,Ir(14),y=!1),O(this.i,this.l,null,"[Incomplete Response]");break}else if(Gn==Y){this.s=4,Ir(15),O(this.i,this.l,ye,"[Invalid Chunk]"),y=!1;break}else O(this.i,this.l,Gn,null),Pi(this,Gn);if(pe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Fr!=4||ye.length!=0||this.h.h||(this.s=1,Ir(16),y=!1),this.o=this.o&&y,!y)O(this.i,this.l,ye,"[Invalid Chunked Response]"),qt(this),Tt(this);else if(0<ye.length&&!this.W){this.W=!0;var Pr=this.j;Pr.g==this&&Pr.ba&&!Pr.M&&(Pr.j.info("Great, no buffering proxy detected. Bytes received: "+ye.length),f0(Pr),Pr.M=!0,Ir(11))}}else O(this.i,this.l,ye,null),Pi(this,ye);Fr==4&&qt(this),this.o&&!this.J&&(Fr==4?By(this.j,this):(this.o=!1,Oe(this)))}else lC(this.g),y==400&&0<ye.indexOf("Unknown SID")?(this.s=3,Ir(12)):(this.s=0,Ir(13)),qt(this),Tt(this)}}}catch{}finally{}};function pe(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function xe(u,g){var y=u.C,D=g.indexOf(`
`,y);return D==-1?ae:(y=Number(g.substring(y,D)),isNaN(y)?Y:(D+=1,D+y>g.length?ae:(g=g.slice(D,D+y),u.C=D+y,g)))}q.prototype.cancel=function(){this.J=!0,qt(this)};function Oe(u){u.S=Date.now()+u.I,yt(u,u.I)}function yt(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Ks(d(u.ba,u),g)}function pr(u){u.B&&(o.clearTimeout(u.B),u.B=null)}q.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(P(this.i,this.A),this.L!=2&&(qs(),Ir(17)),qt(this),this.s=2,Tt(this)):yt(this,this.S-u)};function Tt(u){u.j.G==0||u.J||By(u.j,u)}function qt(u){pr(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Pc(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Pi(u,g){try{var y=u.j;if(y.G!=0&&(y.g==u||o0(y.h,u))){if(!u.K&&o0(y.h,u)&&y.G==3){try{var D=y.Da.g.parse(g)}catch{D=null}if(Array.isArray(D)&&D.length==3){var z=D;if(z[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)dh(y),hh(y);else break e;h0(y),Ir(18)}}else y.za=z[1],0<y.za-y.T&&37500>z[2]&&y.F&&y.v==0&&!y.C&&(y.C=Ks(d(y.Za,y),6e3));if(1>=Sn(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else Js(y,11)}else if((u.K||y.g==u)&&dh(y),!S(g))for(z=y.Da.g.parse(g),g=0;g<z.length;g++){let ot=z[g];if(y.T=ot[0],ot=ot[1],y.G==2)if(ot[0]=="c"){y.K=ot[1],y.ia=ot[2];let Pr=ot[3];Pr!=null&&(y.la=Pr,y.j.info("VER="+y.la));let Fr=ot[4];Fr!=null&&(y.Aa=Fr,y.j.info("SVER="+y.Aa));let oo=ot[5];oo!=null&&typeof oo=="number"&&0<oo&&(D=1.5*oo,y.L=D,y.j.info("backChannelRequestTimeoutMs_="+D)),D=y;let Gn=u.g;if(Gn){let mh=Gn.g?Gn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(mh){var Q=D.h;Q.g||mh.indexOf("spdy")==-1&&mh.indexOf("quic")==-1&&mh.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(c0(Q,Q.h),Q.h=null))}if(D.D){let d0=Gn.g?Gn.g.getResponseHeader("X-HTTP-Session-Id"):null;d0&&(D.ya=d0,kt(D.I,D.D,d0))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),D=y;var ye=u;if(D.qa=Wy(D,D.J?D.ia:null,D.W),ye.K){vy(D.h,ye);var Et=ye,Ar=D.L;Ar&&(Et.I=Ar),Et.B&&(pr(Et),Oe(Et)),D.g=ye}else Ly(D);0<y.i.length&&fh(y)}else ot[0]!="stop"&&ot[0]!="close"||Js(y,7);else y.G==3&&(ot[0]=="stop"||ot[0]=="close"?ot[0]=="stop"?Js(y,7):u0(y):ot[0]!="noop"&&y.l&&y.l.ta(ot),y.v=0)}}qs(4)}catch{}}var Ys=class{constructor(u,g){this.g=u,this.map=g}};function ci(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function io(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Sn(u){return u.h?1:u.g?u.g.size:0}function o0(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function c0(u,g){u.g?u.g.add(g):u.h=g}function vy(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ci.prototype.cancel=function(){if(this.i=_y(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function _y(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(let y of u.g.values())g=g.concat(y.D);return g}return m(u.i)}function KS(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var g=[],y=u.length,D=0;D<y;D++)g.push(u[D]);return g}g=[],y=0;for(D in u)g[y++]=u[D];return g}function XS(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var g=[];u=u.length;for(var y=0;y<u;y++)g.push(y);return g}g=[],y=0;for(let D in u)g[y++]=D;return g}}}function yy(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var y=XS(u),D=KS(u),z=D.length,Q=0;Q<z;Q++)g.call(void 0,D[Q],y&&y[Q],u)}var xy=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function YS(u,g){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var D=u[y].indexOf("="),z=null;if(0<=D){var Q=u[y].substring(0,D);z=u[y].substring(D+1)}else Q=u[y];g(Q,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function Qs(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Qs){this.h=u.h,ah(this,u.j),this.o=u.o,this.g=u.g,oh(this,u.s),this.l=u.l;var g=u.i,y=new Vc;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),wy(this,y),this.m=u.m}else u&&(g=String(u).match(xy))?(this.h=!1,ah(this,g[1]||"",!0),this.o=Mc(g[2]||""),this.g=Mc(g[3]||"",!0),oh(this,g[4]),this.l=Mc(g[5]||"",!0),wy(this,g[6]||"",!0),this.m=Mc(g[7]||"")):(this.h=!1,this.i=new Vc(null,this.h))}Qs.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Lc(g,Ey,!0),":");var y=this.g;return(y||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Lc(g,Ey,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(Lc(y,y.charAt(0)=="/"?ZS:JS,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",Lc(y,tC)),u.join("")};function Fi(u){return new Qs(u)}function ah(u,g,y){u.j=y?Mc(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function oh(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function wy(u,g,y){g instanceof Vc?(u.i=g,rC(u.i,u.h)):(y||(g=Lc(g,eC)),u.i=new Vc(g,u.h))}function kt(u,g,y){u.i.set(g,y)}function ch(u){return kt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Mc(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Lc(u,g,y){return typeof u=="string"?(u=encodeURI(u).replace(g,QS),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function QS(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Ey=/[#\/\?@]/g,JS=/[#\?:]/g,ZS=/[#\?]/g,eC=/[#\?@]/g,tC=/#/g;function Vc(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function os(u){u.g||(u.g=new Map,u.h=0,u.i&&YS(u.i,function(g,y){u.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=Vc.prototype,t.add=function(u,g){os(this),this.i=null,u=so(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(g),this.h+=1,this};function Ty(u,g){os(u),g=so(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function by(u,g){return os(u),g=so(u,g),u.g.has(g)}t.forEach=function(u,g){os(this),this.g.forEach(function(y,D){y.forEach(function(z){u.call(g,z,D,this)},this)},this)},t.na=function(){os(this);let u=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let D=0;D<g.length;D++){let z=u[D];for(let Q=0;Q<z.length;Q++)y.push(g[D])}return y},t.V=function(u){os(this);let g=[];if(typeof u=="string")by(this,u)&&(g=g.concat(this.g.get(so(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)g=g.concat(u[y])}return g},t.set=function(u,g){return os(this),this.i=null,u=so(this,u),by(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Iy(u,g,y){Ty(u,g),0<y.length&&(u.i=null,u.g.set(so(u,g),m(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var D=g[y];let Q=encodeURIComponent(String(D)),ye=this.V(D);for(D=0;D<ye.length;D++){var z=Q;ye[D]!==""&&(z+="="+encodeURIComponent(String(ye[D]))),u.push(z)}}return this.i=u.join("&")};function so(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function rC(u,g){g&&!u.j&&(os(u),u.i=null,u.g.forEach(function(y,D){var z=D.toLowerCase();D!=z&&(Ty(this,D),Iy(this,z,y))},u)),u.j=g}function nC(u,g){let y=new Xs;if(o.Image){let D=new Image;D.onload=p(cs,y,"TestLoadImage: loaded",!0,g,D),D.onerror=p(cs,y,"TestLoadImage: error",!1,g,D),D.onabort=p(cs,y,"TestLoadImage: abort",!1,g,D),D.ontimeout=p(cs,y,"TestLoadImage: timeout",!1,g,D),o.setTimeout(function(){D.ontimeout&&D.ontimeout()},1e4),D.src=u}else g(!1)}function iC(u,g){let y=new Xs,D=new AbortController,z=setTimeout(()=>{D.abort(),cs(y,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:D.signal}).then(Q=>{clearTimeout(z),Q.ok?cs(y,"TestPingServer: ok",!0,g):cs(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(z),cs(y,"TestPingServer: error",!1,g)})}function cs(u,g,y,D,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),D(y)}catch{}}function sC(){this.g=new th}function aC(u,g,y){let D=y||"";try{yy(u,function(z,Q){let ye=z;l(z)&&(ye=Fc(z)),g.push(D+Q+"="+encodeURIComponent(ye))})}catch(z){throw g.push(D+"type="+encodeURIComponent("_badmap")),z}}function Bc(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Bc,to),Bc.prototype.g=function(){return new lh(this.l,this.j)},Bc.prototype.i=function(u){return function(){return u}}({});function lh(u,g){jt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(lh,jt),t=lh.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,jc(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||o).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Uc(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,jc(this)),this.g&&(this.readyState=3,jc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ay(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ay(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Uc(this):jc(this),this.readyState==3&&Ay(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Uc(this))},t.Qa=function(u){this.g&&(this.response=u,Uc(this))},t.ga=function(){this.g&&Uc(this)};function Uc(u){u.readyState=4,u.l=null,u.j=null,u.v=null,jc(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=g.next();return u.join(`\r
`)};function jc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(lh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Sy(u){let g="";return B(u,function(y,D){g+=D,g+=":",g+=y,g+=`\r
`}),g}function l0(u,g,y){e:{for(D in y){var D=!1;break e}D=!0}D||(y=Sy(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):kt(u,g,y))}function Wt(u){jt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Wt,jt);var oC=/^https?$/i,cC=["POST","PUT"];t=Wt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,y,D){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?Oc(this.o):Oc(K),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(Q){Cy(this,Q);return}if(u=y||"",y=new Map(this.headers),D)if(Object.getPrototypeOf(D)===Object.prototype)for(var z in D)y.set(z,D[z]);else if(typeof D.keys=="function"&&typeof D.get=="function")for(let Q of D.keys())y.set(Q,D.get(Q));else throw Error("Unknown input type for opt_headers: "+String(D));D=Array.from(y.keys()).find(Q=>Q.toLowerCase()=="content-type"),z=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(cC,g,void 0))||D||z||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[Q,ye]of y)this.g.setRequestHeader(Q,ye);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ry(this),this.u=!0,this.g.send(u),this.u=!1}catch(Q){Cy(this,Q)}};function Cy(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,ky(u),uh(u)}function ky(u){u.A||(u.A=!0,lt(u,"complete"),lt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,lt(this,"complete"),lt(this,"abort"),uh(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),uh(this,!0)),Wt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Dy(this):this.bb())},t.bb=function(){Dy(this)};function Dy(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Oi(u)!=4||u.Z()!=2)){if(u.u&&Oi(u)==4)ze(u.Ea,0,u);else if(lt(u,"readystatechange"),Oi(u)==4){u.h=!1;try{let ye=u.Z();e:switch(ye){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var D;if(D=ye===0){var z=String(u.D).match(xy)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),D=!oC.test(z?z.toLowerCase():"")}y=D}if(y)lt(u,"complete"),lt(u,"success");else{u.m=6;try{var Q=2<Oi(u)?u.g.statusText:""}catch{Q=""}u.l=Q+" ["+u.Z()+"]",ky(u)}}finally{uh(u)}}}}function uh(u,g){if(u.g){Ry(u);let y=u.g,D=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||lt(u,"ready");try{y.onreadystatechange=D}catch{}}}function Ry(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Oi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Oi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),s0(g)}};function Py(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function lC(u){let g={};u=(u.g&&2<=Oi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let D=0;D<u.length;D++){if(S(u[D]))continue;var y=k(u[D]);let z=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();let Q=g[z]||[];g[z]=Q,Q.push(y)}x(g,function(D){return D.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Wc(u,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||g}function Fy(u){this.Aa=0,this.i=[],this.j=new Xs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wc("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wc("baseRetryDelayMs",5e3,u),this.cb=Wc("retryDelaySeedMs",1e4,u),this.Wa=Wc("forwardChannelMaxRetries",2,u),this.wa=Wc("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ci(u&&u.concurrentRequestLimit),this.Da=new sC,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Fy.prototype,t.la=8,t.G=1,t.connect=function(u,g,y,D){Ir(0),this.W=u,this.H=g||{},y&&D!==void 0&&(this.H.OSID=y,this.H.OAID=D),this.F=this.X,this.I=Wy(this,null,this.W),fh(this)};function u0(u){if(Oy(u),u.G==3){var g=u.U++,y=Fi(u.I);if(kt(y,"SID",u.K),kt(y,"RID",g),kt(y,"TYPE","terminate"),$c(u,y),g=new q(u,u.j,g),g.L=2,g.v=ch(Fi(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.v,y=!0),y||(g.g=$y(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Oe(g)}jy(u)}function hh(u){u.g&&(f0(u),u.g.cancel(),u.g=null)}function Oy(u){hh(u),u.u&&(o.clearTimeout(u.u),u.u=null),dh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function fh(u){if(!io(u.h)&&!u.s){u.s=!0;var g=u.Ga;_e||Ie(),Re||(_e(),Re=!0),he.add(g,u),u.B=0}}function uC(u,g){return Sn(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Ks(d(u.Ga,u,g),Uy(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let z=new q(this,this.j,u),Q=this.o;if(this.S&&(Q?(Q=w(Q),C(Q,this.S)):Q=this.S),this.m!==null||this.O||(z.H=Q,Q=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var D=this.i[y];if("__data__"in D.map&&(D=D.map.__data__,typeof D=="string")){D=D.length;break t}D=void 0}if(D===void 0)break;if(g+=D,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=My(this,z,g),y=Fi(this.I),kt(y,"RID",u),kt(y,"CVER",22),this.D&&kt(y,"X-HTTP-Session-Id",this.D),$c(this,y),Q&&(this.O?g="headers="+encodeURIComponent(String(Sy(Q)))+"&"+g:this.m&&l0(y,this.m,Q)),c0(this.h,z),this.Ua&&kt(y,"TYPE","init"),this.P?(kt(y,"$req",g),kt(y,"SID","null"),z.T=!0,fe(z,y,null)):fe(z,y,g),this.G=2}}else this.G==3&&(u?Ny(this,u):this.i.length==0||io(this.h)||Ny(this))};function Ny(u,g){var y;g?y=g.l:y=u.U++;let D=Fi(u.I);kt(D,"SID",u.K),kt(D,"RID",y),kt(D,"AID",u.T),$c(u,D),u.m&&u.o&&l0(D,u.m,u.o),y=new q(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),g&&(u.i=g.D.concat(u.i)),g=My(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),c0(u.h,y),fe(y,D,g)}function $c(u,g){u.H&&B(u.H,function(y,D){kt(g,D,y)}),u.l&&yy({},function(y,D){kt(g,D,y)})}function My(u,g,y){y=Math.min(u.i.length,y);var D=u.l?d(u.l.Na,u.l,u):null;e:{var z=u.i;let Q=-1;for(;;){let ye=["count="+y];Q==-1?0<y?(Q=z[0].g,ye.push("ofs="+Q)):Q=0:ye.push("ofs="+Q);let Et=!0;for(let Ar=0;Ar<y;Ar++){let ot=z[Ar].g,Pr=z[Ar].map;if(ot-=Q,0>ot)Q=Math.max(0,z[Ar].g-100),Et=!1;else try{aC(Pr,ye,"req"+ot+"_")}catch{D&&D(Pr)}}if(Et){D=ye.join("&");break e}}}return u=u.i.splice(0,y),g.D=u,D}function Ly(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;_e||Ie(),Re||(_e(),Re=!0),he.add(g,u),u.v=0}}function h0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Ks(d(u.Fa,u),Uy(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Vy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Ks(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ir(10),hh(this),Vy(this))};function f0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function Vy(u){u.g=new q(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Fi(u.qa);kt(g,"RID","rpc"),kt(g,"SID",u.K),kt(g,"AID",u.T),kt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&kt(g,"TO",u.ja),kt(g,"TYPE","xmlhttp"),$c(u,g),u.m&&u.o&&l0(g,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=ch(Fi(g)),y.m=null,y.P=!0,Ae(y,u)}t.Za=function(){this.C!=null&&(this.C=null,hh(this),h0(this),Ir(19))};function dh(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function By(u,g){var y=null;if(u.g==g){dh(u),f0(u),u.g=null;var D=2}else if(o0(u.h,g))y=g.D,vy(u.h,g),D=1;else return;if(u.G!=0){if(g.o)if(D==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var z=u.B;D=ro(),lt(D,new no(D,y)),fh(u)}else Ly(u);else if(z=g.s,z==3||z==0&&0<g.X||!(D==1&&uC(u,g)||D==2&&h0(u)))switch(y&&0<y.length&&(g=u.h,g.i=g.i.concat(y)),z){case 1:Js(u,5);break;case 4:Js(u,10);break;case 3:Js(u,6);break;default:Js(u,2)}}}function Uy(u,g){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*g}function Js(u,g){if(u.j.info("Error code "+g),g==2){var y=d(u.fb,u),D=u.Xa;let z=!D;D=new Qs(D||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ah(D,"https"),ch(D),z?nC(D.toString(),y):iC(D.toString(),y)}else Ir(2);u.G=0,u.l&&u.l.sa(g),jy(u),Oy(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Ir(2)):(this.j.info("Failed to ping google.com"),Ir(1))};function jy(u){if(u.G=0,u.ka=[],u.l){let g=_y(u.h);(g.length!=0||u.i.length!=0)&&(_(u.ka,g),_(u.ka,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.ra()}}function Wy(u,g,y){var D=y instanceof Qs?Fi(y):new Qs(y);if(D.g!="")g&&(D.g=g+"."+D.g),oh(D,D.s);else{var z=o.location;D=z.protocol,g=g?g+"."+z.hostname:z.hostname,z=+z.port;var Q=new Qs(null);D&&ah(Q,D),g&&(Q.g=g),z&&oh(Q,z),y&&(Q.l=y),D=Q}return y=u.D,g=u.ya,y&&g&&kt(D,y,g),kt(D,"VER",u.la),$c(u,D),D}function $y(u,g,y){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Bc({eb:y})):new Wt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Hy(){}t=Hy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ph(){}ph.prototype.g=function(u,g){return new hn(u,g)};function hn(u,g){jt.call(this),this.g=new Fy(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!S(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!S(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ao(this)}v(hn,jt),hn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},hn.prototype.close=function(){u0(this.g)},hn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=Fc(u),u=y);g.i.push(new Ys(g.Ya++,u)),g.G==3&&fh(g)},hn.prototype.N=function(){this.g.l=null,delete this.j,u0(this.g),delete this.g,hn.aa.N.call(this)};function zy(u){as.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(let y in g){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(zy,as);function Gy(){Nc.call(this),this.status=1}v(Gy,Nc);function ao(u){this.g=u}v(ao,Hy),ao.prototype.ua=function(){lt(this.g,"a")},ao.prototype.ta=function(u){lt(this.g,new zy(u))},ao.prototype.sa=function(u){lt(this.g,new Gy)},ao.prototype.ra=function(){lt(this.g,"b")},ph.prototype.createWebChannel=ph.prototype.g,hn.prototype.send=hn.prototype.o,hn.prototype.open=hn.prototype.m,hn.prototype.close=hn.prototype.close,Mv=es.createWebChannelTransport=function(){return new ph},Nv=es.getStatEventTarget=function(){return ro()},Ov=es.Event=Ri,Ad=es.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,ju=es.ErrorCode=L,V.COMPLETE="complete",Fv=es.EventType=V,rh.EventType=Gs,Gs.OPEN="a",Gs.CLOSE="b",Gs.ERROR="c",Gs.MESSAGE="d",jt.prototype.listen=jt.prototype.K,dc=es.WebChannel=rh,Pv=es.FetchXmlHttpFactory=Bc,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,Rv=es.XhrIo=Wt}).apply(typeof Id<"u"?Id:typeof self<"u"?self:typeof window<"u"?window:{});var IA="@firebase/firestore";var Er=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Er.UNAUTHENTICATED=new Er(null),Er.GOOGLE_CREDENTIALS=new Er("google-credentials-uid"),Er.FIRST_PARTY=new Er("first-party-uid"),Er.MOCK_USER=new Er("mock-user");var Rc="10.12.5";var Ka=new Ls("@firebase/firestore");function Wu(){return Ka.logLevel}function De(t,...e){if(Ka.logLevel<=Je.DEBUG){let r=e.map(iy);Ka.debug(`Firestore (${Rc}): ${t}`,...r)}}function Xa(t,...e){if(Ka.logLevel<=Je.ERROR){let r=e.map(iy);Ka.error(`Firestore (${Rc}): ${t}`,...r)}}function Pd(t,...e){if(Ka.logLevel<=Je.WARN){let r=e.map(iy);Ka.warn(`Firestore (${Rc}): ${t}`,...r)}}function iy(t){if(typeof t=="string")return t;try{return function(r){return JSON.stringify(r)}(t)}catch{return t}}function Ze(t="Unexpected state"){let e=`FIRESTORE (${Rc}) INTERNAL ASSERTION FAILED: `+t;throw Xa(e),new Error(e)}function dr(t,e){t||Ze()}function St(t,e){return t}var le={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Fe=class extends Hn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ts=class{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}};var Fd=class{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Uv=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Er.UNAUTHENTICATED))}shutdown(){}},jv=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}},Wv=class{constructor(e){this.t=e,this.currentUser=Er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){let n=this.i,i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve(),s=new ts;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ts,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let c=s;e.enqueueRetryable(()=>Z(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},o=c=>{De("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?o(c):(De("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ts)}},0),a()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(De("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(dr(typeof n.accessToken=="string"),new Fd(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return dr(e===null||typeof e=="string"),new Er(e)}},$v=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Er.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Hv=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new $v(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Er.FIRST_PARTY))}shutdown(){}invalidateToken(){}},zv=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Gv=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){let n=s=>{s.error!=null&&De("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,De("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{De("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):De("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(dr(typeof r.token=="string"),this.R=r.token,new zv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function zj(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}var Od=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=zj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}};function At(t,e){return t<e?-1:t>e?1:0}function vc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}var qr=class t{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Fe(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Fe(le.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Fe(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Fe(le.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new t(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?At(this.nanoseconds,e.nanoseconds):At(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var er=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new qr(0,0))}static max(){return new t(new qr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Nd=class t{constructor(e,r,n){r===void 0?r=0:r>e.length&&Ze(),n===void 0?n=e.length-r:n>e.length-r&&Ze(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let n=Math.min(e.length,r.length);for(let i=0;i<n;i++){let s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}},cr=class t extends Nd{construct(e,r,n){return new t(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let n of e){if(n.indexOf("//")>=0)throw new Fe(le.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new t(r)}static emptyPath(){return new t([])}},Gj=/^[_a-zA-Z][_a-zA-Z0-9]*$/,bn=class t extends Nd{construct(e,r,n){return new t(e,r,n)}static isValidIdentifier(e){return Gj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let r=[],n="",i=0,s=()=>{if(n.length===0)throw new Fe(le.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""},a=!1;for(;i<e.length;){let o=e[i];if(o==="\\"){if(i+1===e.length)throw new Fe(le.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Fe(le.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Fe(le.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(r)}static emptyPath(){return new t([])}};var Qe=class t{constructor(e){this.path=e}static fromPath(e){return new t(cr.fromString(e))}static fromName(e){return new t(cr.fromString(e).popFirst(5))}static empty(){return new t(cr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return cr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new cr(e.slice()))}};var qv=class{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}};qv.UNKNOWN_ID=-1;function qj(t,e){let r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=er.fromTimestamp(n===1e9?new qr(r+1,0):new qr(r,n));return new Ya(i,Qe.empty(),e)}function Kj(t){return new Ya(t.readTime,t.key,-1)}var Ya=class t{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new t(er.min(),Qe.empty(),-1)}static max(){return new t(er.max(),Qe.empty(),-1)}};function Xj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Qe.comparator(t.documentKey,e.documentKey),r!==0?r:At(t.largestBatchId,e.largestBatchId))}var Yj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Kv=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function GA(t){return Z(this,null,function*(){if(t.code!==le.FAILED_PRECONDITION||t.message!==Yj)throw t;De("LocalStore","Unexpectedly lost primary lease")})}var ve=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&Ze(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new t((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof t?r:t.resolve(r)}catch(r){return t.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):t.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):t.reject(r)}static resolve(e){return new t((r,n)=>{r(e)})}static reject(e){return new t((r,n)=>{n(e)})}static waitFor(e){return new t((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=t.resolve(!1);for(let n of e)r=r.next(i=>i?t.resolve(i):n());return r}static forEach(e,r){let n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new t((n,i)=>{let s=e.length,a=new Array(s),o=0;for(let c=0;c<s;c++){let l=c;r(e[l]).next(h=>{a[l]=h,++o,o===s&&n(a)},h=>i(h))}})}static doWhile(e,r){return new t((n,i)=>{let s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}};function Qj(t){let e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function Zd(t){return t.name==="IndexedDbTransactionError"}var Jj=(()=>{class t{constructor(r,n){this.previousValue=r,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(r){return this.previousValue=Math.max(r,this.previousValue),this.previousValue}next(){let r=++this.previousValue;return this.se&&this.se(r),r}}return t.oe=-1,t})();function sy(t){return t==null}function Ku(t){return t===0&&1/t==-1/0}function Zj(t){return typeof t=="number"&&Number.isInteger(t)&&!Ku(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var e7=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],pK=[...e7,"documentOverlays"],t7=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],r7=t7,n7=[...r7,"indexConfiguration","indexState","indexEntries"];var mK=[...n7,"globals"];function AA(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function Ju(t,e){for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function qA(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var In=class t{constructor(e,r){this.comparator=e,this.root=r||ki.EMPTY}insert(e,r){return new t(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,ki.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ki.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){let e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new mc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new mc(this.root,e,this.comparator,!1)}getReverseIterator(){return new mc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new mc(this.root,e,this.comparator,!0)}},mc=class{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ki=class t{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new t(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ze();let e=this.left.check();if(e!==this.right.check())throw Ze();return e+(this.isRed()?0:1)}};ki.EMPTY=null,ki.RED=!0,ki.BLACK=!1;ki.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze()}get value(){throw Ze()}get color(){throw Ze()}get left(){throw Ze()}get right(){throw Ze()}copy(e,r,n,i,s){return this}insert(e,r,n){return new ki(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Zr=class t{constructor(e){this.comparator=e,this.data=new In(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Md(this.data.getIterator())}getIteratorFrom(e){return new Md(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){let i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new t(this.comparator);return r.data=e,r}},Md=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ci=class t{constructor(e){this.fields=e,e.sort(bn.comparator)}static empty(){return new t([])}unionWith(e){let r=new Zr(bn.comparator);for(let n of this.fields)r=r.add(n);for(let n of e)r=r.add(n);return new t(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return vc(this.fields,e.fields,(r,n)=>r.isEqual(n))}};var Xv=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ns=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Xv("Invalid base64 string: "+s):s}}(e);return new t(r)}static fromUint8Array(e){let r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new t(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){let n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return At(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ns.EMPTY_BYTE_STRING=new ns("");var i7=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ws(t){if(dr(!!t),typeof t=="string"){let e=0,r=i7.exec(t);if(dr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:fr(t.seconds),nanos:fr(t.nanos)}}function fr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function _c(t){return typeof t=="string"?ns.fromBase64String(t):ns.fromUint8Array(t)}function ay(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function KA(t){let e=t.mapValue.fields.__previous_value__;return ay(e)?KA(e):e}function Ld(t){let e=Ws(t.mapValue.fields.__local_write_time__.timestampValue);return new qr(e.seconds,e.nanos)}var Yv=class{constructor(e,r,n,i,s,a,o,c,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}},Qv=class t{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Sd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function yc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ay(t)?4:XA(t)?9007199254740991:10:Ze()}function Di(t,e){if(t===e)return!0;let r=yc(t);if(r!==yc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ld(t).isEqual(Ld(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Ws(i.timestampValue),o=Ws(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return _c(i.bytesValue).isEqual(_c(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return fr(i.geoPointValue.latitude)===fr(s.geoPointValue.latitude)&&fr(i.geoPointValue.longitude)===fr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return fr(i.integerValue)===fr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=fr(i.doubleValue),o=fr(s.doubleValue);return a===o?Ku(a)===Ku(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return vc(t.arrayValue.values||[],e.arrayValue.values||[],Di);case 10:return function(i,s){let a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(AA(a)!==AA(o))return!1;for(let c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Di(a[c],o[c])))return!1;return!0}(t,e);default:return Ze()}}function Xu(t,e){return(t.values||[]).find(r=>Di(r,e))!==void 0}function xc(t,e){if(t===e)return 0;let r=yc(t),n=yc(e);if(r!==n)return At(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return At(t.booleanValue,e.booleanValue);case 2:return function(s,a){let o=fr(s.integerValue||s.doubleValue),c=fr(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return SA(t.timestampValue,e.timestampValue);case 4:return SA(Ld(t),Ld(e));case 5:return At(t.stringValue,e.stringValue);case 6:return function(s,a){let o=_c(s),c=_c(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){let o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){let h=At(o[l],c[l]);if(h!==0)return h}return At(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){let o=At(fr(s.latitude),fr(a.latitude));return o!==0?o:At(fr(s.longitude),fr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){let o=s.values||[],c=a.values||[];for(let l=0;l<o.length&&l<c.length;++l){let h=xc(o[l],c[l]);if(h)return h}return At(o.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Sd.mapValue&&a===Sd.mapValue)return 0;if(s===Sd.mapValue)return 1;if(a===Sd.mapValue)return-1;let o=s.fields||{},c=Object.keys(o),l=a.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){let d=At(c[f],h[f]);if(d!==0)return d;let p=xc(o[c[f]],l[h[f]]);if(p!==0)return p}return At(c.length,h.length)}(t.mapValue,e.mapValue);default:throw Ze()}}function SA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return At(t,e);let r=Ws(t),n=Ws(e),i=At(r.seconds,n.seconds);return i!==0?i:At(r.nanos,n.nanos)}function wc(t){return Jv(t)}function Jv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){let n=Ws(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return _c(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Qe.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(let s of r.values||[])i?i=!1:n+=",",n+=Jv(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){let n=Object.keys(r.fields||{}).sort(),i="{",s=!0;for(let a of n)s?s=!1:i+=",",i+=`${a}:${Jv(r.fields[a])}`;return i+"}"}(t.mapValue):Ze()}function Zv(t){return!!t&&"integerValue"in t}function oy(t){return!!t&&"arrayValue"in t}function Dd(t){return!!t&&"mapValue"in t}function Hu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return Ju(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Hu(n)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Hu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function XA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Si=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Dd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hu(r)}setAll(e){let r=bn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){let c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Hu(a):i.push(o.lastSegment())});let s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){let r=this.field(e.popLast());Dd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Di(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Dd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){Ju(r,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new t(Hu(this.value))}};function YA(t){let e=[];return Ju(t.fields,(r,n)=>{let i=new bn([r]);if(Dd(n)){let s=YA(n.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Ci(e)}var Ec=class t{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new t(e,0,er.min(),er.min(),er.min(),Si.empty(),0)}static newFoundDocument(e,r,n,i){return new t(e,1,r,er.min(),n,i,0)}static newNoDocument(e,r){return new t(e,2,r,er.min(),er.min(),Si.empty(),0)}static newUnknownDocument(e,r){return new t(e,3,r,er.min(),er.min(),Si.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(er.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=er.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Tc=class{constructor(e,r){this.position=e,this.inclusive=r}};function CA(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){let s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Qe.comparator(Qe.fromName(a.referenceValue),r.key):n=xc(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function kA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Di(t.position[r],e.position[r]))return!1;return!0}var bc=class{constructor(e,r="asc"){this.field=e,this.dir=r}};function s7(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var Vd=class{},Tr=class t extends Vd{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new t_(e,r,n):r==="array-contains"?new i_(e,n):r==="in"?new s_(e,n):r==="not-in"?new a_(e,n):r==="array-contains-any"?new o_(e,n):new t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new r_(e,n):new n_(e,n)}matches(e){let r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(xc(r,this.value)):r!==null&&yc(this.value)===yc(r)&&this.matchesComparison(xc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},$s=class t extends Vd{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new t(e,r)}matches(e){return QA(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function QA(t){return t.op==="and"}function JA(t){return a7(t)&&QA(t)}function a7(t){for(let e of t.filters)if(e instanceof $s)return!1;return!0}function e_(t){if(t instanceof Tr)return t.field.canonicalString()+t.op.toString()+wc(t.value);if(JA(t))return t.filters.map(e=>e_(e)).join(",");{let e=t.filters.map(r=>e_(r)).join(",");return`${t.op}(${e})`}}function ZA(t,e){return t instanceof Tr?function(n,i){return i instanceof Tr&&n.op===i.op&&n.field.isEqual(i.field)&&Di(n.value,i.value)}(t,e):t instanceof $s?function(n,i){return i instanceof $s&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&ZA(a,i.filters[o]),!0):!1}(t,e):void Ze()}function eS(t){return t instanceof Tr?function(r){return`${r.field.canonicalString()} ${r.op} ${wc(r.value)}`}(t):t instanceof $s?function(r){return r.op.toString()+" {"+r.getFilters().map(eS).join(" ,")+"}"}(t):"Filter"}var t_=class extends Tr{constructor(e,r,n){super(e,r,n),this.key=Qe.fromName(n.referenceValue)}matches(e){let r=Qe.comparator(e.key,this.key);return this.matchesComparison(r)}},r_=class extends Tr{constructor(e,r){super(e,"in",r),this.keys=tS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}},n_=class extends Tr{constructor(e,r){super(e,"not-in",r),this.keys=tS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}};function tS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Qe.fromName(n.referenceValue))}var i_=class extends Tr{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return oy(r)&&Xu(r.arrayValue,this.value)}},s_=class extends Tr{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return r!==null&&Xu(this.value.arrayValue,r)}},a_=class extends Tr{constructor(e,r){super(e,"not-in",r)}matches(e){if(Xu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return r!==null&&!Xu(this.value.arrayValue,r)}},o_=class extends Tr{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!oy(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Xu(this.value.arrayValue,n))}};var c_=class{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}};function DA(t,e=null,r=[],n=[],i=null,s=null,a=null){return new c_(t,e,r,n,i,s,a)}function cy(t){let e=St(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>e_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),sy(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>wc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>wc(n)).join(",")),e.ue=r}return e.ue}function ly(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!s7(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!ZA(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!kA(t.startAt,e.startAt)&&kA(t.endAt,e.endAt)}var Ic=class{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function o7(t,e,r,n,i,s,a,o){return new Ic(t,e,r,n,i,s,a,o)}function c7(t){return new Ic(t)}function RA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function l7(t){return t.collectionGroup!==null}function zu(t){let e=St(t);if(e.ce===null){e.ce=[];let r=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new Zr(bn.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new bc(s,n))}),r.has(bn.keyField().canonicalString())||e.ce.push(new bc(bn.keyField(),n))}return e.ce}function Ga(t){let e=St(t);return e.le||(e.le=u7(e,zu(t))),e.le}function u7(t,e){if(t.limitType==="F")return DA(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new bc(i.field,s)});let r=t.endAt?new Tc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Tc(t.startAt.position,t.startAt.inclusive):null;return DA(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function l_(t,e,r){return new Ic(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function rS(t,e){return ly(Ga(t),Ga(e))&&t.limitType===e.limitType}function nS(t){return`${cy(Ga(t))}|lt:${t.limitType}`}function $u(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>eS(i)).join(", ")}]`),sy(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>wc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>wc(i)).join(",")),`Target(${n})`}(Ga(t))}; limitType=${t.limitType})`}function uy(t,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Qe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(let s of zu(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){let l=CA(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,zu(n),i)||n.endAt&&!function(a,o,c){let l=CA(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,zu(n),i))}(t,e)}function h7(t){return(e,r)=>{let n=!1;for(let i of zu(t)){let s=f7(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function f7(t,e,r){let n=t.field.isKeyField()?Qe.comparator(e.key,r.key):function(s,a,o){let c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?xc(c,l):Ze()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return Ze()}}var Hs=class{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ju(this.inner,(r,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return qA(this.inner)}size(){return this.innerSize}};var d7=new In(Qe.comparator);function Bd(){return d7}var iS=new In(Qe.comparator);function Cd(...t){let e=iS;for(let r of t)e=e.insert(r.key,r);return e}function sS(t){let e=iS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function za(){return Gu()}function aS(){return Gu()}function Gu(){return new Hs(t=>t.toString(),(t,e)=>t.isEqual(e))}var p7=new In(Qe.comparator),m7=new Zr(Qe.comparator);function Gr(...t){let e=m7;for(let r of t)e=e.add(r);return e}var g7=new Zr(At);function v7(){return g7}function oS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ku(e)?"-0":e}}function cS(t){return{integerValue:""+t}}function _7(t,e){return Zj(e)?cS(e):oS(t,e)}var Ac=class{constructor(){this._=void 0}};function y7(t,e,r){return t instanceof Sc?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ay(s)&&(s=KA(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof Qa?uS(t,e):t instanceof Ja?hS(t,e):function(i,s){let a=lS(i,s),o=PA(a)+PA(i.Pe);return Zv(a)&&Zv(i.Pe)?cS(o):oS(i.serializer,o)}(t,e)}function x7(t,e,r){return t instanceof Qa?uS(t,e):t instanceof Ja?hS(t,e):r}function lS(t,e){return t instanceof Cc?function(n){return Zv(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var Sc=class extends Ac{},Qa=class extends Ac{constructor(e){super(),this.elements=e}};function uS(t,e){let r=fS(e);for(let n of t.elements)r.some(i=>Di(i,n))||r.push(n);return{arrayValue:{values:r}}}var Ja=class extends Ac{constructor(e){super(),this.elements=e}};function hS(t,e){let r=fS(e);for(let n of t.elements)r=r.filter(i=>!Di(i,n));return{arrayValue:{values:r}}}var Cc=class extends Ac{constructor(e,r){super(),this.serializer=e,this.Pe=r}};function PA(t){return fr(t.integerValue||t.doubleValue)}function fS(t){return oy(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function w7(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof Qa&&i instanceof Qa||n instanceof Ja&&i instanceof Ja?vc(n.elements,i.elements,Di):n instanceof Cc&&i instanceof Cc?Di(n.Pe,i.Pe):n instanceof Sc&&i instanceof Sc}(t.transform,e.transform)}var u_=class{constructor(e,r){this.version=e,this.transformResults=r}},qa=class t{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Rd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var kc=class{};function dS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ud(t.key,qa.none()):new Za(t.key,t.data,qa.none());{let r=t.data,n=Si.empty(),i=new Zr(bn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new is(t.key,n,new Ci(i.toArray()),qa.none())}}function E7(t,e,r){t instanceof Za?function(i,s,a){let o=i.value.clone(),c=OA(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof is?function(i,s,a){if(!Rd(i.precondition,s))return void s.convertToUnknownDocument(a.version);let o=OA(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(pS(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function qu(t,e,r,n){return t instanceof Za?function(s,a,o,c){if(!Rd(s.precondition,a))return o;let l=s.value.clone(),h=NA(s.fieldTransforms,c,a);return l.setAll(h),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof is?function(s,a,o,c){if(!Rd(s.precondition,a))return o;let l=NA(s.fieldTransforms,c,a),h=a.data;return h.setAll(pS(s)),h.setAll(l),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,a,o){return Rd(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function T7(t,e){let r=null;for(let n of t.fieldTransforms){let i=e.data.field(n.field),s=lS(n.transform,i||null);s!=null&&(r===null&&(r=Si.empty()),r.set(n.field,s))}return r||null}function FA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&vc(n,i,(s,a)=>w7(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Za=class extends kc{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},is=class extends kc{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function pS(t){let e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=t.data.field(r);e.set(r,n)}}),e}function OA(t,e,r){let n=new Map;dr(t.length===r.length);for(let i=0;i<r.length;i++){let s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,x7(a,o,r[i]))}return n}function NA(t,e,r){let n=new Map;for(let i of t){let s=i.transform,a=r.data.field(i.field);n.set(i.field,y7(s,a,e))}return n}var Ud=class extends kc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},h_=class extends kc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var f_=class{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){let n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&E7(s,e,n[i])}}applyToLocalView(e,r){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(r=qu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let n=aS();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;let c=dS(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(er.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Gr())}isEqual(e){return this.batchId===e.batchId&&vc(this.mutations,e.mutations,(r,n)=>FA(r,n))&&vc(this.baseMutations,e.baseMutations,(r,n)=>FA(r,n))}},d_=class t{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){dr(e.mutations.length===n.length);let i=function(){return p7}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new t(e,r,n,i)}};var p_=class{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ar,rt;function b7(t){switch(t){default:return Ze();case le.CANCELLED:case le.UNKNOWN:case le.DEADLINE_EXCEEDED:case le.RESOURCE_EXHAUSTED:case le.INTERNAL:case le.UNAVAILABLE:case le.UNAUTHENTICATED:return!1;case le.INVALID_ARGUMENT:case le.NOT_FOUND:case le.ALREADY_EXISTS:case le.PERMISSION_DENIED:case le.FAILED_PRECONDITION:case le.ABORTED:case le.OUT_OF_RANGE:case le.UNIMPLEMENTED:case le.DATA_LOSS:return!0}}function I7(t){if(t===void 0)return Xa("GRPC error has no .code"),le.UNKNOWN;switch(t){case ar.OK:return le.OK;case ar.CANCELLED:return le.CANCELLED;case ar.UNKNOWN:return le.UNKNOWN;case ar.DEADLINE_EXCEEDED:return le.DEADLINE_EXCEEDED;case ar.RESOURCE_EXHAUSTED:return le.RESOURCE_EXHAUSTED;case ar.INTERNAL:return le.INTERNAL;case ar.UNAVAILABLE:return le.UNAVAILABLE;case ar.UNAUTHENTICATED:return le.UNAUTHENTICATED;case ar.INVALID_ARGUMENT:return le.INVALID_ARGUMENT;case ar.NOT_FOUND:return le.NOT_FOUND;case ar.ALREADY_EXISTS:return le.ALREADY_EXISTS;case ar.PERMISSION_DENIED:return le.PERMISSION_DENIED;case ar.FAILED_PRECONDITION:return le.FAILED_PRECONDITION;case ar.ABORTED:return le.ABORTED;case ar.OUT_OF_RANGE:return le.OUT_OF_RANGE;case ar.UNIMPLEMENTED:return le.UNIMPLEMENTED;case ar.DATA_LOSS:return le.DATA_LOSS;default:return Ze()}}(rt=ar||(ar={}))[rt.OK=0]="OK",rt[rt.CANCELLED=1]="CANCELLED",rt[rt.UNKNOWN=2]="UNKNOWN",rt[rt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",rt[rt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",rt[rt.NOT_FOUND=5]="NOT_FOUND",rt[rt.ALREADY_EXISTS=6]="ALREADY_EXISTS",rt[rt.PERMISSION_DENIED=7]="PERMISSION_DENIED",rt[rt.UNAUTHENTICATED=16]="UNAUTHENTICATED",rt[rt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",rt[rt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",rt[rt.ABORTED=10]="ABORTED",rt[rt.OUT_OF_RANGE=11]="OUT_OF_RANGE",rt[rt.UNIMPLEMENTED=12]="UNIMPLEMENTED",rt[rt.INTERNAL=13]="INTERNAL",rt[rt.UNAVAILABLE=14]="UNAVAILABLE",rt[rt.DATA_LOSS=15]="DATA_LOSS";var vK=new Dv([4294967295,4294967295],0);var m_=class{constructor(e,r){this.databaseId=e,this.useProto3Json=r}};function g_(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A7(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function S7(t,e){return g_(t,e.toTimestamp())}function gc(t){return dr(!!t),er.fromTimestamp(function(r){let n=Ws(r);return new qr(n.seconds,n.nanos)}(t))}function mS(t,e){return v_(t,e).canonicalString()}function v_(t,e){let r=function(i){return new cr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function C7(t){let e=cr.fromString(t);return dr(M7(e)),e}function __(t,e){return mS(t.databaseId,e.path)}function k7(t){let e=C7(t);return e.length===4?cr.emptyPath():R7(e)}function D7(t){return new cr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function R7(t){return dr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function MA(t,e,r){return{name:__(t,e),fields:r.value.mapValue.fields}}function P7(t,e){let r;if(e instanceof Za)r={update:MA(t,e.key,e.value)};else if(e instanceof Ud)r={delete:__(t,e.key)};else if(e instanceof is)r={update:MA(t,e.key,e.data),updateMask:N7(e.fieldMask)};else{if(!(e instanceof h_))return Ze();r={verify:__(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){let o=a.transform;if(o instanceof Sc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof Qa)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Ja)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Cc)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw Ze()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:S7(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ze()}(t,e.precondition)),r}function F7(t,e){return t&&t.length>0?(dr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?gc(i.updateTime):gc(s);return a.isEqual(er.min())&&(a=gc(s)),new u_(a,i.transformResults||[])}(r,e))):[]}function O7(t){let e=k7(t.parent),r=t.structuredQuery,n=r.from?r.from.length:0,i=null;if(n>0){dr(n===1);let h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];r.where&&(s=function(f){let d=gS(f);return d instanceof $s&&JA(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(d=>function(v){return new bc(pc(v.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(f){let d;return d=typeof f=="object"?f.value:f,sy(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(f){let d=!!f.before,p=f.values||[];return new Tc(p,d)}(r.startAt));let l=null;return r.endAt&&(l=function(f){let d=!f.before,p=f.values||[];return new Tc(p,d)}(r.endAt)),o7(e,i,a,s,o,"F",c,l)}function gS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":let n=pc(r.unaryFilter.field);return Tr.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=pc(r.unaryFilter.field);return Tr.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=pc(r.unaryFilter.field);return Tr.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=pc(r.unaryFilter.field);return Tr.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Ze()}}(t):t.fieldFilter!==void 0?function(r){return Tr.create(pc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ze()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return $s.create(r.compositeFilter.filters.map(n=>gS(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ze()}}(r.compositeFilter.op))}(t):Ze()}function pc(t){return bn.fromServerFormat(t.fieldPath)}function N7(t){let e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function M7(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var y_=class{constructor(e){this.ct=e}};function L7(t){let e=O7({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?l_(e,e.limit,"L"):e}var jd=class{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(fr(e.integerValue));else if("doubleValue"in e){let n=fr(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),Ku(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=Ws(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(_c(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){let n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?XA(e)?this.dt(r,Number.MAX_SAFE_INTEGER):(this.wt(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.St(e.arrayValue,r),this.ft(r)):Ze()}Vt(e,r){this.dt(r,25),this.bt(e,r)}bt(e,r){r.Rt(e)}wt(e,r){let n=e.fields||{};this.dt(r,55);for(let i of Object.keys(n))this.Vt(i,r),this.Tt(n[i],r)}St(e,r){let n=e.values||[];this.dt(r,50);for(let i of n)this.Tt(i,r)}yt(e,r){this.dt(r,37),Qe.fromName(e).path.forEach(n=>{this.dt(r,60),this.bt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}};jd.Dt=new jd;var x_=class{constructor(){this.an=new w_}addToCollectionParentIndex(e,r){return this.an.add(r),ve.resolve()}getCollectionParents(e,r){return ve.resolve(this.an.getEntries(r))}addFieldIndex(e,r){return ve.resolve()}deleteFieldIndex(e,r){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,r){return ve.resolve()}getDocumentsMatchingTarget(e,r){return ve.resolve(null)}getIndexType(e,r){return ve.resolve(0)}getFieldIndexes(e,r){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,r){return ve.resolve(Ya.min())}getMinOffsetFromCollectionGroup(e,r){return ve.resolve(Ya.min())}updateCollectionGroup(e,r,n){return ve.resolve()}updateIndexEntries(e,r){return ve.resolve()}},w_=class{constructor(){this.index={}}add(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new Zr(cr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new Zr(cr.comparator)).toArray()}};var _K=new Uint8Array(0);var Ai=class t{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Ai.DEFAULT_COLLECTION_PERCENTILE=10,Ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ai.DEFAULT=new Ai(41943040,Ai.DEFAULT_COLLECTION_PERCENTILE,Ai.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ai.DISABLED=new Ai(-1,0,0);var Yu=class t{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new t(0)}static Bn(){return new t(-1)}};var E_=class{constructor(){this.changes=new Hs(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ec.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let n=this.changes.get(r);return n!==void 0?ve.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var T_=class{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}};var b_=class{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&qu(n.mutation,i,Ci.empty(),qr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Gr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Gr()){let i=za();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Cd();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){let n=za();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Gr()))}populateOverlays(e,r,n){let i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Bd(),a=Gu(),o=function(){return Gu()}();return r.forEach((c,l)=>{let h=n.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof is)?s=s.insert(l.key,l):h!==void 0?(a.set(l.key,h.mutation.getFieldMask()),qu(h.mutation,l,h.mutation.getFieldMask(),qr.now())):a.set(l.key,Ci.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,h)=>a.set(l,h)),r.forEach((l,h)=>{var f;return o.set(l,new T_(h,(f=a.get(l))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){let n=Gu(),i=new In((a,o)=>a-o),s=Gr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(let o of a)o.keys().forEach(c=>{let l=r.get(c);if(l===null)return;let h=n.get(c)||Ci.empty();h=o.applyToLocalView(l,h),n.set(c,h);let f=(i.get(o.batchId)||Gr()).add(c);i=i.insert(o.batchId,f)})}).next(()=>{let a=[],o=i.getReverseIterator();for(;o.hasNext();){let c=o.getNext(),l=c.key,h=c.value,f=aS();h.forEach(d=>{if(!s.has(d)){let p=dS(r.get(d),n.get(d));p!==null&&f.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,f))}return ve.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Qe.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):l7(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ve.resolve(za()),o=-1,c=s;return a.next(l=>ve.forEach(l,(h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?ve.resolve():this.remoteDocumentCache.getEntry(e,h).next(d=>{c=c.insert(h,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Gr())).next(h=>({batchId:o,changes:sS(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Qe(r)).next(n=>{let i=Cd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){let s=r.collectionGroup,a=Cd();return this.indexManager.getCollectionParents(e,s).next(o=>ve.forEach(o,c=>{let l=function(f,d){return new Ic(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(h=>{h.forEach((f,d)=>{a=a.insert(f,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,l)=>{let h=l.getKey();a.get(h)===null&&(a=a.insert(h,Ec.newInvalidDocument(h)))});let o=Cd();return a.forEach((c,l)=>{let h=s.get(c);h!==void 0&&qu(h.mutation,l,Ci.empty(),qr.now()),uy(r,l)&&(o=o.insert(c,l))}),o})}};var I_=class{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,r){return ve.resolve(this.lr.get(r))}saveBundleMetadata(e,r){return this.lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:gc(i.createTime)}}(r)),ve.resolve()}getNamedQuery(e,r){return ve.resolve(this.hr.get(r))}saveNamedQuery(e,r){return this.hr.set(r.name,function(i){return{name:i.name,query:L7(i.bundledQuery),readTime:gc(i.readTime)}}(r)),ve.resolve()}};var A_=class{constructor(){this.overlays=new In(Qe.comparator),this.Pr=new Map}getOverlay(e,r){return ve.resolve(this.overlays.get(r))}getOverlays(e,r){let n=za();return ve.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),ve.resolve()}removeOverlaysForBatchId(e,r,n){let i=this.Pr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Pr.delete(n)),ve.resolve()}getOverlaysForCollection(e,r,n){let i=za(),s=r.length+1,a=new Qe(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ve.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new In((l,h)=>l-h),a=this.overlays.getIterator();for(;a.hasNext();){let l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let h=s.get(l.largestBatchId);h===null&&(h=za(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let o=za(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>o.set(l,h)),!(o.size()>=i)););return ve.resolve(o)}ht(e,r,n){let i=this.overlays.get(n.key);if(i!==null){let a=this.Pr.get(i.largestBatchId).delete(n.key);this.Pr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new p_(r,n));let s=this.Pr.get(r);s===void 0&&(s=Gr(),this.Pr.set(r,s)),this.Pr.set(r,s.add(n.key))}};var S_=class{constructor(){this.sessionToken=ns.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ve.resolve()}};var Qu=class{constructor(){this.Ir=new Zr(or.Tr),this.Er=new Zr(or.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,r){let n=new or(e,r);this.Ir=this.Ir.add(n),this.Er=this.Er.add(n)}Ar(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Rr(new or(e,r))}Vr(e,r){e.forEach(n=>this.removeReference(n,r))}mr(e){let r=new Qe(new cr([])),n=new or(r,e),i=new or(r,e+1),s=[];return this.Er.forEachInRange([n,i],a=>{this.Rr(a),s.push(a.key)}),s}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){let r=new Qe(new cr([])),n=new or(r,e),i=new or(r,e+1),s=Gr();return this.Er.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){let r=new or(e,0),n=this.Ir.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}},or=class{constructor(e,r){this.key=e,this.yr=r}static Tr(e,r){return Qe.comparator(e.key,r.key)||At(e.yr,r.yr)}static dr(e,r){return At(e.yr,r.yr)||Qe.comparator(e.key,r.key)}};var C_=class{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.wr=1,this.Sr=new Zr(or.Tr)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){let s=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new f_(s,r,n,i);this.mutationQueue.push(a);for(let o of i)this.Sr=this.Sr.add(new or(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ve.resolve(a)}lookupMutationBatch(e,r){return ve.resolve(this.br(r))}getNextMutationBatchAfterBatchId(e,r){let n=r+1,i=this.Dr(n),s=i<0?0:i;return ve.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?-1:this.wr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let n=new or(r,0),i=new or(r,Number.POSITIVE_INFINITY),s=[];return this.Sr.forEachInRange([n,i],a=>{let o=this.br(a.yr);s.push(o)}),ve.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new Zr(At);return r.forEach(i=>{let s=new or(i,0),a=new or(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([s,a],o=>{n=n.add(o.yr)})}),ve.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){let n=r.path,i=n.length+1,s=n;Qe.isDocumentKey(s)||(s=s.child(""));let a=new or(new Qe(s),0),o=new Zr(At);return this.Sr.forEachWhile(c=>{let l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.yr)),!0)},a),ve.resolve(this.Cr(o))}Cr(e){let r=[];return e.forEach(n=>{let i=this.br(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){dr(this.vr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Sr;return ve.forEach(r.mutations,i=>{let s=new or(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=n})}xn(e){}containsKey(e,r){let n=new or(r,0),i=this.Sr.firstAfterOrEqual(n);return ve.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}vr(e,r){return this.Dr(e)}Dr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}br(e){let r=this.Dr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}};var k_=class{constructor(e){this.Fr=e,this.docs=function(){return new In(Qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Fr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let n=this.docs.get(r);return ve.resolve(n?n.document.mutableCopy():Ec.newInvalidDocument(r))}getEntries(e,r){let n=Bd();return r.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Ec.newInvalidDocument(i))}),ve.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Bd(),a=r.path,o=new Qe(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||Xj(Kj(h),n)<=0||(i.has(h.key)||uy(r,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ve.resolve(s)}getAllFromCollectionGroup(e,r,n,i){Ze()}Mr(e,r){return ve.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new D_(this)}getSize(e){return ve.resolve(this.size)}},D_=class extends E_{constructor(e){super(),this.ur=e}applyChanges(e){let r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.ur.addEntry(e,i)):this.ur.removeEntry(n)}),ve.waitFor(r)}getFromCache(e,r){return this.ur.getEntry(e,r)}getAllFromCache(e,r){return this.ur.getEntries(e,r)}};var R_=class{constructor(e){this.persistence=e,this.Or=new Hs(r=>cy(r),ly),this.lastRemoteSnapshotVersion=er.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new Qu,this.targetCount=0,this.Br=Yu.Ln()}forEachTarget(e,r){return this.Or.forEach((n,i)=>r(i)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Nr&&(this.Nr=r),ve.resolve()}Qn(e){this.Or.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this.Br=new Yu(r),this.highestTargetId=r),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,r){return this.Qn(r),this.targetCount+=1,ve.resolve()}updateTargetData(e,r){return this.Qn(r),ve.resolve()}removeTargetData(e,r){return this.Or.delete(r.target),this.Lr.mr(r.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,r,n){let i=0,s=[];return this.Or.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Or.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ve.waitFor(s).next(()=>i)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,r){let n=this.Or.get(r)||null;return ve.resolve(n)}addMatchingKeys(e,r,n){return this.Lr.Ar(r,n),ve.resolve()}removeMatchingKeys(e,r,n){this.Lr.Vr(r,n);let i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ve.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Lr.mr(r),ve.resolve()}getMatchingKeysForTargetId(e,r){let n=this.Lr.pr(r);return ve.resolve(n)}containsKey(e,r){return ve.resolve(this.Lr.containsKey(r))}};var P_=class{constructor(e,r){this.kr={},this.overlays={},this.qr=new Jj(0),this.Qr=!1,this.Qr=!0,this.Kr=new S_,this.referenceDelegate=e(this),this.$r=new R_(this),this.indexManager=new x_,this.remoteDocumentCache=function(i){return new k_(i)}(n=>this.referenceDelegate.Ur(n)),this.serializer=new y_(r),this.Wr=new I_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new A_,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.kr[e.toKey()];return n||(n=new C_(r,this.referenceDelegate),this.kr[e.toKey()]=n),n}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,r,n){De("MemoryPersistence","Starting transaction:",e);let i=new F_(this.qr.next());return this.referenceDelegate.Gr(),n(i).next(s=>this.referenceDelegate.zr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}jr(e,r){return ve.or(Object.values(this.kr).map(n=>()=>n.containsKey(e,r)))}},F_=class extends Kv{constructor(e){super(),this.currentSequenceNumber=e}},O_=class t{constructor(e){this.persistence=e,this.Hr=new Qu,this.Jr=null}static Yr(e){return new t(e)}get Zr(){if(this.Jr)return this.Jr;throw Ze()}addReference(e,r,n){return this.Hr.addReference(n,r),this.Zr.delete(n.toString()),ve.resolve()}removeReference(e,r,n){return this.Hr.removeReference(n,r),this.Zr.add(n.toString()),ve.resolve()}markPotentiallyOrphaned(e,r){return this.Zr.add(r.toString()),ve.resolve()}removeTarget(e,r){this.Hr.mr(r.targetId).forEach(i=>this.Zr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Zr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Gr(){this.Jr=new Set}zr(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.Zr,n=>{let i=Qe.fromPath(n);return this.Xr(e,i).next(s=>{s||r.removeEntry(i,er.min())})}).next(()=>(this.Jr=null,r.apply(e)))}updateLimboDocument(e,r){return this.Xr(e,r).next(n=>{n?this.Zr.delete(r.toString()):this.Zr.add(r.toString())})}Ur(e){return 0}Xr(e,r){return ve.or([()=>ve.resolve(this.Hr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.jr(e,r)])}};var N_=class t{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Ki=n,this.$i=i}static Ui(e,r){let n=Gr(),i=Gr();for(let s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,r.fromCache,n,i)}};var M_=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var L_=class{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=function(){return BI()?8:Qj(Tn())>0?6:4}()}initialize(e,r){this.Hi=e,this.indexManager=r,this.Wi=!0}getDocumentsMatchingQuery(e,r,n,i){let s={result:null};return this.Ji(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Yi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new M_;return this.Zi(e,r,a).next(o=>{if(s.result=o,this.Gi)return this.Xi(e,r,a,o.size)})}).next(()=>s.result)}Xi(e,r,n,i){return n.documentReadCount<this.zi?(Wu()<=Je.DEBUG&&De("QueryEngine","SDK will not create cache indexes for query:",$u(r),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),ve.resolve()):(Wu()<=Je.DEBUG&&De("QueryEngine","Query:",$u(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ji*i?(Wu()<=Je.DEBUG&&De("QueryEngine","The SDK decides to create cache indexes for query:",$u(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ga(r))):ve.resolve())}Ji(e,r){if(RA(r))return ve.resolve(null);let n=Ga(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=l_(r,null,"F"),n=Ga(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=Gr(...s);return this.Hi.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{let l=this.es(r,o);return this.ts(r,l,a,c.readTime)?this.Ji(e,l_(r,null,"F")):this.ns(e,l,r,c)}))})))}Yi(e,r,n,i){return RA(r)||i.isEqual(er.min())?ve.resolve(null):this.Hi.getDocuments(e,n).next(s=>{let a=this.es(r,s);return this.ts(r,a,n,i)?ve.resolve(null):(Wu()<=Je.DEBUG&&De("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),$u(r)),this.ns(e,a,r,qj(i,-1)).next(o=>o))})}es(e,r){let n=new Zr(h7(e));return r.forEach((i,s)=>{uy(e,s)&&(n=n.add(s))}),n}ts(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;let s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Zi(e,r,n){return Wu()<=Je.DEBUG&&De("QueryEngine","Using full collection scan to execute query:",$u(r)),this.Hi.getDocumentsMatchingQuery(e,r,Ya.min(),n)}ns(e,r,n,i){return this.Hi.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}};var V_=class{constructor(e,r,n,i){this.persistence=e,this.rs=r,this.serializer=i,this.ss=new In(At),this.os=new Hs(s=>cy(s),ly),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(n)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new b_(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.ss))}};function V7(t,e,r,n){return new V_(t,e,r,n)}function vS(t,e){return Z(this,null,function*(){let r=St(t);return yield r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.cs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{let a=[],o=[],c=Gr();for(let l of i){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of s){o.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(l=>({ls:l,removedBatchIds:a,addedBatchIds:o}))})})})}function B7(t,e){let r=St(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=r.us.newChangeBuffer({trackRemovals:!0});return function(o,c,l,h){let f=l.batch,d=f.keys(),p=ve.resolve();return d.forEach(v=>{p=p.next(()=>h.getEntry(c,v)).next(m=>{let _=l.docVersions.get(v);dr(_!==null),m.version.compareTo(_)<0&&(f.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),h.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Gr();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function U7(t){let e=St(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.$r.getLastRemoteSnapshotVersion(r))}function j7(t,e){let r=St(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}var Wd=class{constructor(){this.activeTargetIds=v7()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var B_=class{constructor(){this.io=new Wd,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,r,n){this.so[e]=r}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new Wd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var U_=class{oo(e){}shutdown(){}};var $d=class{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){De("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.lo)e(0)}co(){De("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.lo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var kd=null;function Lv(){return kd===null?kd=function(){return 268435456+Math.round(2147483648*Math.random())}():kd++,"0x"+kd.toString(16)}var W7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var j_=class{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}};var zr="WebChannelConnection",W_=class extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;let n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.bo=n+"://"+r.host,this.Do=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get vo(){return!1}Fo(r,n,i,s,a){let o=Lv(),c=this.Mo(r,n.toUriEncodedString());De("RestConnection",`Sending RPC '${r}' ${o}:`,c,i);let l={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(l,s,a),this.Oo(r,c,l,i).then(h=>(De("RestConnection",`Received RPC '${r}' ${o}: `,h),h),h=>{throw Pd("RestConnection",`RPC '${r}' ${o} failed with error: `,h,"url: ",c,"request:",i),h})}No(r,n,i,s,a,o){return this.Fo(r,n,i,s,a)}xo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Rc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}Mo(r,n){let i=W7[r];return`${this.bo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,r,n,i){let s=Lv();return new Promise((a,o)=>{let c=new Rv;c.setWithCredentials(!0),c.listenOnce(Fv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case ju.NO_ERROR:let h=c.getResponseJson();De(zr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case ju.TIMEOUT:De(zr,`RPC '${e}' ${s} timed out`),o(new Fe(le.DEADLINE_EXCEEDED,"Request time out"));break;case ju.HTTP_ERROR:let f=c.getStatus();if(De(zr,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let p=d?.error;if(p&&p.status&&p.message){let v=function(_){let b=_.toLowerCase().replace(/_/g,"-");return Object.values(le).indexOf(b)>=0?b:le.UNKNOWN}(p.status);o(new Fe(v,p.message))}else o(new Fe(le.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Fe(le.UNAVAILABLE,"Connection failed."));break;default:Ze()}}finally{De(zr,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);De(zr,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",l,n,15)})}Lo(e,r,n){let i=Lv(),s=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Mv(),o=Nv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Pv({})),this.xo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;let h=s.join("");De(zr,`Creating RPC '${e}' stream ${i}: ${h}`,c);let f=a.createWebChannel(h,c),d=!1,p=!1,v=new j_({Po:_=>{p?De(zr,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(De(zr,`Opening RPC '${e}' stream ${i} transport.`),f.open(),d=!0),De(zr,`RPC '${e}' stream ${i} sending:`,_),f.send(_))},Io:()=>f.close()}),m=(_,b,S)=>{_.listen(b,T=>{try{S(T)}catch(N){setTimeout(()=>{throw N},0)}})};return m(f,dc.EventType.OPEN,()=>{p||(De(zr,`RPC '${e}' stream ${i} transport opened.`),v.po())}),m(f,dc.EventType.CLOSE,()=>{p||(p=!0,De(zr,`RPC '${e}' stream ${i} transport closed`),v.wo())}),m(f,dc.EventType.ERROR,_=>{p||(p=!0,Pd(zr,`RPC '${e}' stream ${i} transport errored:`,_),v.wo(new Fe(le.UNAVAILABLE,"The operation could not be completed")))}),m(f,dc.EventType.MESSAGE,_=>{var b;if(!p){let S=_.data[0];dr(!!S);let T=S,N=T.error||((b=T[0])===null||b===void 0?void 0:b.error);if(N){De(zr,`RPC '${e}' stream ${i} received error:`,N);let M=N.status,B=function(E){let C=ar[E];if(C!==void 0)return I7(C)}(M),x=N.message;B===void 0&&(B=le.INTERNAL,x="Unknown error status: "+M+" with message "+N.message),p=!0,v.wo(new Fe(B,x)),f.close()}else De(zr,`RPC '${e}' stream ${i} received:`,S),v.So(S)}}),m(o,Ov.STAT_EVENT,_=>{_.stat===Ad.PROXY?De(zr,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===Ad.NOPROXY&&De(zr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.yo()},0),v}};function Vv(){return typeof document<"u"?document:null}function e0(t){return new m_(t,!0)}var Hd=class{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ai=e,this.timerId=r,this.Bo=n,this.ko=i,this.qo=s,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();let r=Math.floor(this.Qo+this.Go()),n=Math.max(0,Date.now()-this.$o),i=Math.max(0,r-n);i>0&&De("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){this.Ko!==null&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){this.Ko!==null&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}};var $_=class{constructor(e,r,n,i,s,a,o,c){this.ai=e,this.jo=n,this.Ho=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new Hd(e,r)}t_(){return this.state===1||this.state===5||this.n_()}n_(){return this.state===2||this.state===3}start(){this.Xo=0,this.state!==4?this.auth():this.r_()}stop(){return Z(this,null,function*(){this.t_()&&(yield this.close(0))})}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&this.Yo===null&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}o_(){return Z(this,null,function*(){if(this.n_())return this.close(0)})}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}close(e,r){return Z(this,null,function*(){this.a_(),this.u_(),this.e_.cancel(),this.Jo++,e!==4?this.e_.reset():r&&r.code===le.RESOURCE_EXHAUSTED?(Xa(r.toString()),Xa("Using maximum backoff delay to prevent overloading the backend."),this.e_.Uo()):r&&r.code===le.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.c_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Vo(r)})}c_(){}auth(){this.state=1;let e=this.l_(this.Jo),r=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Jo===r&&this.h_(n,i)},n=>{e(()=>{let i=new Fe(le.UNKNOWN,"Fetching auth token failed: "+n.message);return this.P_(i)})})}h_(e,r){let n=this.l_(this.Jo);this.stream=this.I_(e,r),this.stream.To(()=>{n(()=>this.listener.To())}),this.stream.Ao(()=>{n(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{n(()=>this.P_(i))}),this.stream.onMessage(i=>{n(()=>++this.Xo==1?this.T_(i):this.onNext(i))})}r_(){this.state=5,this.e_.Wo(()=>Z(this,null,function*(){this.state=0,this.start()}))}P_(e){return De("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return r=>{this.ai.enqueueAndForget(()=>this.Jo===e?r():(De("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var H_=class extends $_{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,r){return this.connection.Lo("Write",e,r)}T_(e){return dr(!!e.streamToken),this.lastStreamToken=e.streamToken,dr(!e.writeResults||e.writeResults.length===0),this.listener.m_()}onNext(e){dr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();let r=F7(e.writeResults,e.commitTime),n=gc(e.commitTime);return this.listener.f_(n,r)}g_(){let e={};e.database=D7(this.serializer),this.__(e)}V_(e){let r={streamToken:this.lastStreamToken,writes:e.map(n=>P7(this.serializer,n))};this.__(r)}};var z_=class extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new Fe(le.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,r,n,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Fo(e,v_(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Fe(le.UNKNOWN,s.toString())})}No(e,r,n,i,s){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.No(e,v_(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===le.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Fe(le.UNKNOWN,a.toString())})}terminate(){this.p_=!0,this.connection.terminate()}},G_=class{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){this.w_===0&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){this.state==="Online"?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,e==="Online"&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(Xa(r),this.b_=!1):De("OnlineStateTracker",r)}M_(){this.S_!==null&&(this.S_.cancel(),this.S_=null)}};var q_=class{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=s,this.B_.oo(a=>{n.enqueueAndForget(()=>Z(this,null,function*(){eh(this)&&(De("RemoteStore","Restarting streams for network reachability change."),yield function(c){return Z(this,null,function*(){let l=St(c);l.N_.add(4),yield Zu(l),l.k_.set("Unknown"),l.N_.delete(4),yield t0(l)})}(this))}))}),this.k_=new G_(n,i)}};function t0(t){return Z(this,null,function*(){if(eh(t))for(let e of t.L_)yield e(!0)})}function Zu(t){return Z(this,null,function*(){for(let e of t.L_)yield e(!1)})}function eh(t){return St(t).N_.size===0}function _S(t,e,r){return Z(this,null,function*(){if(!Zd(e))throw e;t.N_.add(1),yield Zu(t),t.k_.set("Offline"),r||(r=()=>U7(t.localStore)),t.asyncQueue.enqueueRetryable(()=>Z(this,null,function*(){De("RemoteStore","Retrying IndexedDB access"),yield r(),t.N_.delete(1),yield t0(t)}))})}function yS(t,e){return e().catch(r=>_S(t,r,e))}function r0(t){return Z(this,null,function*(){let e=St(t),r=zs(e),n=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;$7(e);)try{let i=yield j7(e.localStore,n);if(i===null){e.x_.length===0&&r.s_();break}n=i.batchId,H7(e,i)}catch(i){yield _S(e,i)}xS(e)&&wS(e)})}function $7(t){return eh(t)&&t.x_.length<10}function H7(t,e){t.x_.push(e);let r=zs(t);r.n_()&&r.R_&&r.V_(e.mutations)}function xS(t){return eh(t)&&!zs(t).t_()&&t.x_.length>0}function wS(t){zs(t).start()}function z7(t){return Z(this,null,function*(){zs(t).g_()})}function G7(t){return Z(this,null,function*(){let e=zs(t);for(let r of t.x_)e.V_(r.mutations)})}function q7(t,e,r){return Z(this,null,function*(){let n=t.x_.shift(),i=d_.from(n,e,r);yield yS(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield r0(t)})}function K7(t,e){return Z(this,null,function*(){e&&zs(t).R_&&(yield function(n,i){return Z(this,null,function*(){if(function(a){return b7(a)&&a!==le.ABORTED}(i.code)){let s=n.x_.shift();zs(n).i_(),yield yS(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield r0(n)}})}(t,e)),xS(t)&&wS(t)})}function LA(t,e){return Z(this,null,function*(){let r=St(t);r.asyncQueue.verifyOperationInProgress(),De("RemoteStore","RemoteStore received new credentials");let n=eh(r);r.N_.add(3),yield Zu(r),n&&r.k_.set("Unknown"),yield r.remoteSyncer.handleCredentialChange(e),r.N_.delete(3),yield t0(r)})}function X7(t,e){return Z(this,null,function*(){let r=St(t);e?(r.N_.delete(2),yield t0(r)):e||(r.N_.add(2),yield Zu(r),r.k_.set("Unknown"))})}function zs(t){return t.K_||(t.K_=function(r,n,i){let s=St(r);return s.y_(),new H_(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{To:()=>Promise.resolve(),Ao:z7.bind(null,t),Vo:K7.bind(null,t),m_:G7.bind(null,t),f_:q7.bind(null,t)}),t.L_.push(e=>Z(this,null,function*(){e?(t.K_.i_(),yield r0(t)):(yield t.K_.stop(),t.x_.length>0&&(De("RemoteStore",`Stopping write stream with ${t.x_.length} pending writes`),t.x_=[]))}))),t.K_}var K_=class t{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ts,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){let a=Date.now()+n,o=new t(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Fe(le.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ES(t,e){if(Xa("AsyncQueue",`${e}: ${t}`),Zd(t))return new Fe(le.UNAVAILABLE,`${e}: ${t}`);throw t}var X_=class{constructor(){this.queries=VA(),this.onlineState="Unknown",this.J_=new Set}terminate(){(function(r,n){let i=St(r),s=i.queries;i.queries=VA(),s.forEach((a,o)=>{for(let c of o.z_)c.onError(n)})})(this,new Fe(le.ABORTED,"Firestore shutting down"))}};function VA(){return new Hs(t=>nS(t),rS)}function Y7(t){t.J_.forEach(e=>{e.next()})}var BA,UA;(UA=BA||(BA={})).X_="default",UA.Cache="cache";var Y_=class{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.va=new Hs(o=>nS(o),rS),this.Fa=new Map,this.Ma=new Set,this.xa=new In(Qe.comparator),this.Oa=new Map,this.Na=new Qu,this.La={},this.Ba=new Map,this.ka=Yu.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return this.qa===!0}};function Q7(t,e,r){return Z(this,null,function*(){let n=tW(t);try{let i=yield function(a,o){let c=St(a),l=qr.now(),h=o.reduce((p,v)=>p.add(v.key),Gr()),f,d;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Bd(),m=Gr();return c.us.getEntries(p,h).next(_=>{v=_,v.forEach((b,S)=>{S.isValidDocument()||(m=m.add(b))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,v)).next(_=>{f=_;let b=[];for(let S of o){let T=T7(S,f.get(S.key).overlayedDocument);T!=null&&b.push(new is(S.key,T,YA(T.value.mapValue),qa.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,b,o)}).next(_=>{d=_;let b=_.applyToLocalDocumentSet(f,m);return c.documentOverlayCache.saveOverlays(p,_.batchId,b)})}).then(()=>({batchId:d.batchId,changes:sS(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.La[a.currentUser.toKey()];l||(l=new In(At)),l=l.insert(o,c),a.La[a.currentUser.toKey()]=l}(n,i.batchId,r),yield n0(n,i.changes),yield r0(n.remoteStore)}catch(i){let s=ES(i,"Failed to persist write");r.reject(s)}})}function jA(t,e,r){let n=St(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){let i=[];n.va.forEach((s,a)=>{let o=a.view.Y_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){let c=St(a);c.onlineState=o;let l=!1;c.queries.forEach((h,f)=>{for(let d of f.z_)d.Y_(o)&&(l=!0)}),l&&Y7(c)}(n.eventManager,e),i.length&&n.Ca.E_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function J7(t,e){return Z(this,null,function*(){let r=St(t),n=e.batch.batchId;try{let i=yield B7(r.localStore,e);bS(r,n,null),TS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),yield n0(r,i)}catch(i){yield GA(i)}})}function Z7(t,e,r){return Z(this,null,function*(){let n=St(t);try{let i=yield function(a,o){let c=St(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,o).next(f=>(dr(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(n.localStore,e);bS(n,e,r),TS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),yield n0(n,i)}catch(i){yield GA(i)}})}function TS(t,e){(t.Ba.get(e)||[]).forEach(r=>{r.resolve()}),t.Ba.delete(e)}function bS(t,e,r){let n=St(t),i=n.La[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.La[n.currentUser.toKey()]=i}}function n0(t,e,r){return Z(this,null,function*(){let n=St(t),i=[],s=[],a=[];n.va.isEmpty()||(n.va.forEach((o,c)=>{a.push(n.Qa(c,e,r).then(l=>{var h;if((l||r)&&n.isPrimaryClient){let f=l?!l.fromCache:(h=r?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(l){i.push(l);let f=N_.Ui(c.targetId,l);s.push(f)}}))}),yield Promise.all(a),n.Ca.E_(i),yield function(c,l){return Z(this,null,function*(){let h=St(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ve.forEach(l,d=>ve.forEach(d.Ki,p=>h.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>ve.forEach(d.$i,p=>h.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!Zd(f))throw f;De("LocalStore","Failed to update sequence numbers: "+f)}for(let f of l){let d=f.targetId;if(!f.fromCache){let p=h.ss.get(d),v=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(v);h.ss=h.ss.insert(d,m)}}})}(n.localStore,s))})}function eW(t,e){return Z(this,null,function*(){let r=St(t);if(!r.currentUser.isEqual(e)){De("SyncEngine","User change. New user:",e.toKey());let n=yield vS(r.localStore,e);r.currentUser=e,function(s,a){s.Ba.forEach(o=>{o.forEach(c=>{c.reject(new Fe(le.CANCELLED,a))})}),s.Ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield n0(r,n.ls)}})}function tW(t){let e=St(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=J7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Z7.bind(null,e),e}var zd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return Z(this,null,function*(){this.serializer=e0(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,r){return null}createIndexBackfillerScheduler(e,r){return null}createLocalStore(e){return V7(this.persistence,new L_,e.initialUser,this.serializer)}createPersistence(e){return new P_(O_.Yr,this.serializer)}createSharedClientState(e){return new B_}terminate(){return Z(this,null,function*(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Q_=class{initialize(e,r){return Z(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>jA(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=eW.bind(null,this.syncEngine),yield X7(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new X_}()}createDatastore(e){let r=e0(e.databaseInfo.databaseId),n=function(s){return new W_(s)}(e.databaseInfo);return function(s,a,o,c){return new z_(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new q_(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>jA(this.syncEngine,r,0),function(){return $d.D()?new $d:new U_}())}createSyncEngine(e,r){return function(i,s,a,o,c,l,h){let f=new Y_(i,s,a,o,c,l);return h&&(f.qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}terminate(){return Z(this,null,function*(){var e,r;yield function(i){return Z(this,null,function*(){let s=St(i);De("RemoteStore","RemoteStore shutting down."),s.N_.add(5),yield Zu(s),s.B_.shutdown(),s.k_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}};var J_=class{constructor(e,r,n,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Er.UNAUTHENTICATED,this.clientId=Od.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>Z(this,null,function*(){De("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(De("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Fe(le.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ts;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>Z(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let n=ES(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function Bv(t,e){return Z(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),De("FirestoreClient","Initializing OfflineComponentProvider");let r=t.configuration;yield e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(i=>Z(this,null,function*(){n.isEqual(i)||(yield vS(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function WA(t,e){return Z(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let r=yield nW(t);De("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>LA(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>LA(e.remoteStore,i)),t._onlineComponents=e})}function rW(t){return t.name==="FirebaseError"?t.code===le.FAILED_PRECONDITION||t.code===le.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function nW(t){return Z(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){De("FirestoreClient","Using user provided OfflineComponentProvider");try{yield Bv(t,t._uninitializedComponentsProvider._offline)}catch(e){let r=e;if(!rW(r))throw r;Pd("Error using user provided cache. Falling back to memory cache: "+r),yield Bv(t,new zd)}}else De("FirestoreClient","Using default OfflineComponentProvider"),yield Bv(t,new zd);return t._offlineComponents})}function iW(t){return Z(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(De("FirestoreClient","Using user provided OnlineComponentProvider"),yield WA(t,t._uninitializedComponentsProvider._online)):(De("FirestoreClient","Using default OnlineComponentProvider"),yield WA(t,new Q_))),t._onlineComponents})}function sW(t){return iW(t).then(e=>e.syncEngine)}function IS(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var $A=new Map;function AS(t,e,r){if(!r)throw new Fe(le.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function aW(t,e,r,n){if(e===!0&&n===!0)throw new Fe(le.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function HA(t){if(!Qe.isDocumentKey(t))throw new Fe(le.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zA(t){if(Qe.isDocumentKey(t))throw new Fe(le.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hy(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ze()}function SS(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Fe(le.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=hy(t);throw new Fe(le.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}var Gd=class{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Fe(le.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Fe(le.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}aW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=IS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Fe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Fe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Fe(le.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Dc=class{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Gd({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Fe(le.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Fe(le.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Gd(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Uv;switch(n.type){case"firstParty":return new Hv(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Fe(le.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){let n=$A.get(r);n&&(De("ComponentProvider","Removing Datastore"),$A.delete(r),n.terminate())}(this),Promise.resolve()}};function CS(t,e,r,n={}){var i;let s=(t=SS(t,Dc))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Pd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=Er.MOCK_USER;else{o=NI(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Fe(le.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Er(l)}t._authCredentials=new jv(new Fd(o,c))}}var Z_=class t{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},rs=class t{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new js(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},js=class t extends Z_{constructor(e,r,n){super(e,r,c7(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new rs(this.firestore,null,new Qe(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function fy(t,e,...r){if(t=si(t),AS("collection","path",e),t instanceof Dc){let n=cr.fromString(e,...r);return zA(n),new js(t,null,n)}{if(!(t instanceof rs||t instanceof js))throw new Fe(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(cr.fromString(e,...r));return zA(n),new js(t.firestore,null,n)}}function kS(t,e,...r){if(t=si(t),arguments.length===1&&(e=Od.newId()),AS("doc","path",e),t instanceof Dc){let n=cr.fromString(e,...r);return HA(n),new rs(t,null,new Qe(n))}{if(!(t instanceof rs||t instanceof js))throw new Fe(le.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(cr.fromString(e,...r));return HA(n),new rs(t.firestore,t instanceof js?t.converter:null,new Qe(n))}}var ey=class{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new Hd(this,"async_queue_retry"),this.Tu=()=>{let r=Vv();r&&De("AsyncQueue","Visibility state changed to "+r.visibilityState),this.e_.zo()};let e=Vv();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;let r=Vv();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});let r=new ts;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}Au(){return Z(this,null,function*(){if(this.au.length!==0){try{yield this.au[0](),this.au.shift(),this.e_.reset()}catch(e){if(!Zd(e))throw e;De("AsyncQueue","Operation failed with retryable error: "+e)}this.au.length>0&&this.e_.Wo(()=>this.Au())}})}du(e){let r=this._u.then(()=>(this.hu=!0,e().catch(n=>{this.lu=n,this.hu=!1;let i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Xa("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.hu=!1,n))));return this._u=r,r}enqueueAfterDelay(e,r,n){this.Eu(),this.Iu.indexOf(e)>-1&&(r=0);let i=K_.createAndSchedule(this,e,r,n,s=>this.Ru(s));return this.cu.push(i),i}Eu(){this.lu&&Ze()}verifyOperationInProgress(){}Vu(){return Z(this,null,function*(){let e;do e=this._u,yield e;while(e!==this._u)})}mu(e){for(let r of this.cu)if(r.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(let r of this.cu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){let r=this.cu.indexOf(e);this.cu.splice(r,1)}};var qd=class extends Dc{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=function(){return new ey}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||RS(this),this._firestoreClient.terminate()}};function DS(t,e){let r=typeof t=="object"?t:Du(),n=typeof t=="string"?t:e||"(default)",i=hv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=FI("firestore");s&&CS(i,...s)}return i}function oW(t){return t._firestoreClient||RS(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function RS(t){var e,r,n;let i=t._freezeSettings(),s=function(o,c,l,h){return new Yv(o,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,IS(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new J_(t._authCredentials,t._appCheckCredentials,t._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Kd=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(ns.fromBase64String(e))}catch(r){throw new Fe(le.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new t(ns.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Xd=class{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Fe(le.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Yd=class{constructor(e){this._methodName=e}};var Qd=class{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Fe(le.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Fe(le.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return At(this._lat,e._lat)||At(this._long,e._long)}};var cW=/^__.*__$/,ty=class{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new is(e,this.data,this.fieldMask,r,this.fieldTransforms):new Za(e,this.data,r,this.fieldTransforms)}};function PS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze()}}var ry=class t{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.Du(e),i}Cu(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return Jd(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(e.length===0)throw this.Fu("Document fields must not be empty");if(PS(this.yu)&&cW.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}},ny=class{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||e0(e)}Ou(e,r,n,i=!1){return new ry({yu:e,methodName:r,xu:n,path:bn.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function lW(t){let e=t._freezeSettings(),r=e0(t._databaseId);return new ny(t._databaseId,!!e.ignoreUndefinedProperties,r)}function uW(t,e,r,n,i,s={}){let a=t.Ou(s.merge||s.mergeFields?2:0,e,r,i);MS("Data must be an object, but it was:",a,n);let o=OS(n,a),c,l;if(s.merge)c=new Ci(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){let h=[];for(let f of s.mergeFields){let d=hW(e,f,r);if(!a.contains(d))throw new Fe(le.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);pW(h,d)||h.push(d)}c=new Ci(h),l=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=a.fieldTransforms;return new ty(new Si(o),c,l)}function FS(t,e){if(NS(t=si(t)))return MS("Unsupported field value:",e,t),OS(t,e);if(t instanceof Yd)return function(n,i){if(!PS(i.yu))throw i.Fu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.bu&&e.yu!==4)throw e.Fu("Nested arrays are not supported");return function(n,i){let s=[],a=0;for(let o of n){let c=FS(o,i.vu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=si(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return _7(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=qr.fromDate(n);return{timestampValue:g_(i.serializer,s)}}if(n instanceof qr){let s=new qr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:g_(i.serializer,s)}}if(n instanceof Qd)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Kd)return{bytesValue:A7(i.serializer,n._byteString)};if(n instanceof rs){let s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Fu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:mS(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Fu(`Unsupported field value: ${hy(n)}`)}(t,e)}function OS(t,e){let r={};return qA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ju(t,(n,i)=>{let s=FS(i,e.Su(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function NS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qr||t instanceof Qd||t instanceof Kd||t instanceof rs||t instanceof Yd)}function MS(t,e,r){if(!NS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){let n=hy(r);throw n==="an object"?e.Fu(t+" a custom object"):e.Fu(t+" "+n)}}function hW(t,e,r){if((e=si(e))instanceof Xd)return e._internalPath;if(typeof e=="string")return dW(t,e);throw Jd("Field path arguments must be of type string or ",t,!1,void 0,r)}var fW=new RegExp("[~\\*/\\[\\]]");function dW(t,e,r){if(e.search(fW)>=0)throw Jd(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new Xd(...e.split("."))._internalPath}catch{throw Jd(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function Jd(t,e,r,n,i){let s=n&&!n.isEmpty(),a=i!==void 0,o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Fe(le.INVALID_ARGUMENT,o+t+c)}function pW(t,e){return t.some(r=>r.isEqual(e))}function mW(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}function dy(t,e){let r=SS(t.firestore,qd),n=kS(t),i=mW(t.converter,e);return gW(r,[uW(lW(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,qa.exists(!1))]).then(()=>n)}function gW(t,e){return function(n,i){let s=new ts;return n.asyncQueue.enqueueAndForget(()=>Z(this,null,function*(){return Q7(yield sW(n),i,s)})),s.promise}(oW(t),e)}(function(e,r=!0){(function(i){Rc=i})(uc),Bs(new zn("firestore",(n,{instanceIdentifier:i,options:s})=>{let a=n.getProvider("app").getImmediate(),o=new qd(new Wv(n.getProvider("auth-internal")),new Gv(n.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Fe(le.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qv(l.options.projectId,h)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),wr(IA,"4.6.5",e),wr(IA,"4.6.5","esm2017")})();var eo=class{constructor(e){return e}},LS="firestore",py=class{constructor(){return Pu(LS)}};var my=new tt("angularfire2.firestore-instances");function vW(t,e){let r=pv(LS,t,e);return r&&new eo(r)}function _W(t){return(e,r)=>{let n=e.runOutsideAngular(()=>t(r));return new eo(n)}}var yW={provide:py,deps:[[new ui,my]]},xW={provide:eo,useFactory:vW,deps:[[new ui,my],Wa]};function VS(t,...e){return wr("angularfire",fc.full,"fst"),qn([xW,yW,{provide:my,useFactory:_W(t),multi:!0,deps:[Vt,ra,Fu,Nu,[new ui,bd],[new ui,Ru],...e]}])}var BS=Ou(DS,!0);var i0=(()=>{let e=class e{constructor(){this.firestore=Ce(eo),this.sugerenciaForm=new xs({nombre:new mi(""),email:new mi(""),mensaje:new mi(""),fecha:new mi(new Date)})}enviarSugerencia(){let n=this.sugerenciaForm.value,i=fy(this.firestore,"sugerencias");dy(i,n),this.sugerenciaForm.reset()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["app-contacto"]],standalone:!0,features:[rr],decls:26,vars:1,consts:[["id","contacto",1,"bg-white"],[1,"bg-white","py-8","lg:py-16","px-4","mx-auto","max-w-screen-xl"],[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"flex-1","flex","flex-col","justify-center","p-4","sm:items-start","sm:text-left","items-center","text-center"],[1,"mb-4","text-4xl","font-extrabold","text-gray-900"],[1,"mb-8","text-gray-500","sm:text-lg","max-w-lg"],[1,"text-gray-700","max-w-lg"],[1,"flex-1","bg-gray-50","p-6","rounded-lg","shadow-md"],["action","#",1,"space-y-6",3,"formGroup"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","email","type","email","id","email","placeholder","name@domain.com","required","",1,"shadow-sm","bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500","block","w-full","p-2.5"],["for","subject",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","nombre","type","text","id","subject","placeholder","Coloque su nombre para poder ayudarle","required","",1,"block","p-3","w-full","text-sm","text-gray-900","bg-white","rounded-lg","border","border-gray-300","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["for","message",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","mensaje","id","message","rows","6","placeholder","Escriba su mensaje o sugerencia...",1,"block","p-2.5","w-full","text-sm","text-gray-900","bg-white","rounded-lg","shadow-sm","border","border-gray-300","focus:ring-indigo-500","focus:border-indigo-500"],["type","submit",1,"py-3","px-5","text-sm","font-medium","text-center","text-white","rounded-lg","bg-indigo-600","hover:bg-indigo-500",3,"click"]],template:function(i,s){i&1&&(Te(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"h2",4),Ne(5,"Contacto"),we(),Te(6,"p",5),Ne(7," \xBFTenes un problema t\xE9cnico? \xBFQueres sugerir nuevas funcionalidades? \xBFNecesitas informaci\xF3n sobre nuestras herramientas? Escribinos. "),we(),Te(8,"p",6),Ne(9," Estamos aqu\xED para ayudarte. Envia tus comentarios, errores o sugerencias para poder mejorar juntos el portal. "),we()(),Te(10,"div",7)(11,"form",8)(12,"div")(13,"label",9),Ne(14,"Mail"),we(),xt(15,"input",10),we(),Te(16,"div")(17,"label",11),Ne(18,"Nombre"),we(),xt(19,"input",12),we(),Te(20,"div")(21,"label",13),Ne(22,"Mensaje"),we(),xt(23,"textarea",14),we(),Te(24,"button",15),Dt("click",function(){return s.enviarSugerencia()}),Ne(25,"Enviar"),we()()()()()()),i&2&&(ft(11),rn("formGroup",s.sugerenciaForm))},dependencies:[Ro,Do,ws,Co,ko,ua,ff,Fl,Ol],encapsulation:2});let t=e;return t})();var US=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["app-home"]],standalone:!0,features:[rr],decls:16,vars:0,consts:[[1,"bg-[#f5f5fa]","py-8","h-full","px-4"],[1,"text-2xl","sm:text-3xl","md:text-4xl","lg:text-5xl","font-bold","text-center","text-gray-800"],[1,"text-center","text-sm","sm:text-base","md:text-lg","lg:text-xl","text-gray-600","mb-12","max-w-[22rem]","md:max-w-[38rem]","lg:max-w-2xl","mx-auto","mt-2"],[1,"flex","flex-wrap","gap-4","justify-center"],["routerLink","/evaluaciones",1,"flex","flex-col","items-center","cursor-pointer","bg-white","shadow-md","rounded-lg","p-6","text-center","relative","hover:shadow-lg","transition-shadow","duration-300","w-full","sm:w-1/2","md:w-1/3","lg:w-1/4","xl:w-1/6","max-h-64"],[1,"mb-4"],["width","48","height","48","src","https://img.icons8.com/fluency/48/untested--v1.png"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-center","text-sm","text-wrap","tracking-tight","text-gray-600","mt-2"],[1,"absolute","top-2","right-2","text-white","text-xs","font-bold","py-1","px-2","rounded-full","shadow-md","bg-cyan-600"]],template:function(i,s){i&1&&(Te(0,"section",0)(1,"h2",1),Ne(2," Herramientas Automatizadas para Docentes "),we(),Te(3,"p",2),Ne(4," Nuestras herramientas online son completamente gratuitas y est\xE1n dise\xF1adas para facilitar las tareas diarias de los docentes. \xA1Simplifica tu trabajo con un par de clics! "),we(),Te(5,"div",3)(6,"div",4)(7,"div",5),xt(8,"img",6),we(),Te(9,"h3",7),Ne(10,"Evaluaciones"),we(),Te(11,"p",8),Ne(12,"Defin\xED las preguntas y nosotros las ordenamos de forma \xFAnica para cada estudiante."),we(),Te(13,"div",9),Ne(14," \xA1Nuevo! "),we()()()(),xt(15,"app-contacto"))},dependencies:[Ex,i0],encapsulation:2});let t=e;return t})();var jS=[{path:"",component:US,pathMatch:"full"},{path:"evaluaciones",component:CI},{path:"contacto",component:i0}];var wW="@",EW=(()=>{let e=class e{constructor(n,i,s,a,o){this.doc=n,this.delegate=i,this.zone=s,this.animationType=a,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Ce(u1,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-P3LI2KLN.js")).catch(i=>{throw new bt(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:s})=>{this._engine=i(this.animationType,this.doc,this.scheduler);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(n,i){let s=this.delegate.createRenderer(n,i);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let a=new gy(s);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(n,i);a.use(c)}).catch(o=>{a.use(s)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(i){A0()},e.\u0275prov=Le({token:e,factory:e.\u0275fac});let t=e;return t})(),gy=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let r of this.replay)r(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,r){return this.delegate.createElement(e,r)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,r){this.delegate.appendChild(e,r)}insertBefore(e,r,n,i){this.delegate.insertBefore(e,r,n,i)}removeChild(e,r,n){this.delegate.removeChild(e,r,n)}selectRootElement(e,r){return this.delegate.selectRootElement(e,r)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,r,n,i){this.delegate.setAttribute(e,r,n,i)}removeAttribute(e,r,n){this.delegate.removeAttribute(e,r,n)}addClass(e,r){this.delegate.addClass(e,r)}removeClass(e,r){this.delegate.removeClass(e,r)}setStyle(e,r,n,i){this.delegate.setStyle(e,r,n,i)}removeStyle(e,r,n){this.delegate.removeStyle(e,r,n)}setProperty(e,r,n){this.shouldReplay(r)&&this.replay.push(i=>i.setProperty(e,r,n)),this.delegate.setProperty(e,r,n)}setValue(e,r){this.delegate.setValue(e,r)}listen(e,r,n){return this.shouldReplay(r)&&this.replay.push(i=>i.listen(e,r,n)),this.delegate.listen(e,r,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(wW)}};function WS(t="animations"){return S0("NgAsyncAnimations"),qn([{provide:xh,useFactory:(e,r,n)=>new EW(e,r,n,t),deps:[gr,Mh,Vt]},{provide:I0,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var $S={firebaseConfig:{apiKey:"AIzaSyAkCAXhb0PSyTe55CW-yKEH9xcmQC_JcZc",authDomain:"examenapp-a4984.firebaseapp.com",projectId:"examenapp-a4984",storageBucket:"examenapp-a4984.appspot.com",messagingSenderId:"112556396178",appId:"1:112556396178:web:7f8fd791bcd43218bae04b"}};var HS={providers:[Tx(jS),WS(),rA(()=>nA($S.firebaseConfig)),VS(()=>BS())]};var zS=(()=>{let e=class e{constructor(n,i){this.router=n,this.viewportScroller=i}scrollTo(n){this.router.navigate(["/"]).then(()=>{this.viewportScroller.scrollToAnchor(n)})}};e.\u0275fac=function(i){return new(i||e)(Ue(bl),Ue(R0))},e.\u0275cmp=tr({type:e,selectors:[["app-navbar"]],standalone:!0,features:[rr],decls:14,vars:0,consts:[[1,"flex","items-center","justify-between","p-5","bg-white","shadow-lg","sticky","top-0","z-10"],[1,"container","mx-auto","flex","items-center","justify-between"],["href","#",1,"flex","items-center","text-2xl","font-semibold","text-gray-900"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"mr-2","h-8","w-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"flex","items-center","gap-5"],["href","#",1,"text-lg","text-gray-700","hover:text-blue-500"],["fragment","contacto",1,"text-lg","text-gray-700","hover:text-blue-500","cursor-pointer",3,"click"]],template:function(i,s){i&1&&(Te(0,"header",0)(1,"div",1)(2,"a",2),ta(),Te(3,"svg",3),xt(4,"circle",4)(5,"circle",5)(6,"circle",6),we(),fo(),Te(7,"span"),Ne(8,"EvaluAr"),we()(),Te(9,"nav",7)(10,"a",8),Ne(11,"Inicio"),we(),Te(12,"a",9),Dt("click",function(){return s.scrollTo("contacto")}),Ne(13,"Contacto"),we()()()())},encapsulation:2});let t=e;return t})();var GS=(()=>{let e=class e{constructor(){this.anio=new Date().getFullYear()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["app-footer"]],standalone:!0,features:[rr],decls:14,vars:1,consts:[[1,"p-4","bg-[f5f5fa]","md:p-8","lg:p-10","border-t-2","border-white","shadow-lg"],[1,"mx-auto","max-w-screen-xl","text-center"],["href","#",1,"flex","justify-center","items-center","text-2xl","font-semibold","text-gray-900"],["width","32","height","32","xmlns","http://www.w3.org/2000/svg",1,"mr-2","h-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"my-6","text-gray-500"],[1,"text-sm","text-gray-500","sm:text-center"]],template:function(i,s){i&1&&(Te(0,"footer",0)(1,"div",1)(2,"a",2),ta(),Te(3,"svg",3),xt(4,"circle",4)(5,"circle",5)(6,"circle",6),we(),Ne(7," EvaluAr "),we(),fo(),Te(8,"p",7),Ne(9,"Este sitio web ha sido desarrollado con el prop\xF3sito de automatizar tareas repetitivas o complejas para los docentes. "),xt(10,"br"),Ne(11," Cabe destacar que este proyecto no tiene ninguna relaci\xF3n con el gobierno."),we(),Te(12,"span",8),Ne(13),we()()()),i&2&&(ft(13),Zc("\xA9 ",s.anio,""))},encapsulation:2});let t=e;return t})();var qS=(()=>{let e=class e{constructor(){this.title="examenes-app"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=tr({type:e,selectors:[["app-root"]],standalone:!0,features:[rr],decls:3,vars:0,consts:[[1,"no-print"]],template:function(i,s){i&1&&xt(0,"app-navbar",0)(1,"router-outlet")(2,"app-footer",0)},dependencies:[el,Ap,zS,GS]});let t=e;return t})();B1(qS,HS).catch(t=>console.error(t));
