import{$ as Ce,$a as ke,A as b0,Aa as Yc,Ab as kh,B as ny,Ba as dy,Bb as ca,C as ms,Ca as Qc,Cb as Ty,D as po,Da as Je,Db as by,E as ia,Ea as Ue,Eb as Dh,F as iy,Fa as R0,Fb as M0,G as I0,Ga as py,Gb as Rh,H as gs,Ha as Eh,I as sy,Ia as Jc,J as sa,Ja as P0,K as vs,Ka as Vt,L as A0,La as Th,M as ay,Ma as sn,N as oy,Na as go,O as cy,Oa as my,P as yh,Pa as gy,Q as Fn,Qa as Zc,R as xh,Ra as On,S as lr,Sa as oa,T as It,Ta as ur,U as Wi,Ua as el,V as Fe,Va as ae,W as Yt,Wa as le,X as ly,Xa as Ye,Y as nt,Ya as _i,Z as S0,Za as ut,_ as je,_a as vr,a as be,aa as gi,ab as tl,b as pt,ba as Xc,bb as rl,ca as gr,cb as vy,d as Z,da as $t,db as pn,e as Q1,ea as Qt,eb as mn,f as J1,fa as Mt,fb as gn,g as ji,ga as Qn,gb as an,h as y0,ha as uy,hb as Ht,i as x0,ia as mo,ib as vo,j as Dn,ja as $i,jb as _y,k as Rn,ka as Jn,kb as bh,l as Z1,la as Zn,lb as Ih,m as ey,ma as ei,mb as F0,n as ps,na as Mr,nb as Ah,o as w0,oa as ti,ob as O0,p as E0,pa as vi,pb as _s,q as T0,qa as C0,qb as yy,r as Zr,ra as aa,rb as Hi,s as We,sa as k0,sb as _o,t as qc,ta as ri,tb as xy,u as ty,ua as kr,ub as wy,v as ry,va as hy,vb as _r,w as rt,wa as wh,wb as N0,x as Kc,xa as fy,xb as Sh,y as Pn,ya as ni,yb as Ch,z as _h,za as D0,zb as Ey}from"./chunk-JHSTAVE3.js";var il=class{},Fh=class{},la=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(r=>{let n=r.indexOf(":");if(n>0){let i=r.slice(0,n),s=i.toLowerCase(),a=r.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((r,n)=>{this.setHeaderEntries(n,r)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([r,n])=>{this.setHeaderEntries(r,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let r=this.headers.get(e.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,r){return this.clone({name:e,value:r,op:"a"})}set(e,r){return this.clone({name:e,value:r,op:"s"})}delete(e,r){return this.clone({name:e,value:r,op:"d"})}maybeSetNormalizedName(e,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(r=>{this.headers.set(r,e.headers.get(r)),this.normalizedNames.set(r,e.normalizedNames.get(r))})}clone(e){let r=new t;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([e]),r}applyUpdate(e){let r=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,r);let i=(e.op==="a"?this.headers.get(r):void 0)||[];i.push(...n),this.headers.set(r,i);break;case"d":let s=e.value;if(!s)this.headers.delete(r),this.normalizedNames.delete(r);else{let a=this.headers.get(r);if(!a)return;a=a.filter(o=>s.indexOf(o)===-1),a.length===0?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,a)}break}}setHeaderEntries(e,r){let n=(Array.isArray(r)?r:[r]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>e(this.normalizedNames.get(r),this.headers.get(r)))}};var V0=class{encodeKey(e){return Iy(e)}encodeValue(e){return Iy(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function _2(t,e){let r=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,o]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=r.get(a)||[];c.push(o),r.set(a,c)}),r}var y2=/%(\d[a-f0-9])/gi,x2={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Iy(t){return encodeURIComponent(t).replace(y2,(e,r)=>x2[r]??e)}function Ph(t){return`${t}`}var ys=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new V0,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=_2(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(r=>{let n=e.fromObject[r],i=Array.isArray(n)?n.map(Ph):[Ph(n)];this.map.set(r,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let r=this.map.get(e);return r?r[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,r){return this.clone({param:e,value:r,op:"a"})}appendAll(e){let r=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(s=>{r.push({param:n,value:s,op:"a"})}):r.push({param:n,value:i,op:"a"})}),this.clone(r)}set(e,r){return this.clone({param:e,value:r,op:"s"})}delete(e,r){return this.clone({param:e,value:r,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let r=this.encoder.encodeKey(e);return this.map.get(e).map(n=>r+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let r=new t({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat(e),r}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let r=(e.op==="a"?this.map.get(e.param):void 0)||[];r.push(Ph(e.value)),this.map.set(e.param,r);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(Ph(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var B0=class{constructor(){this.map=new Map}set(e,r){return this.map.set(e,r),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function w2(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function Ay(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Sy(t){return typeof Blob<"u"&&t instanceof Blob}function Cy(t){return typeof FormData<"u"&&t instanceof FormData}function E2(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var nl=class t{constructor(e,r,n,i){this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(w2(this.method)||i?(this.body=n!==void 0?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new la,this.context??=new B0,!this.params)this.params=new ys,this.urlWithParams=r;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=r;else{let o=r.indexOf("?"),c=o===-1?"?":o<r.length-1?"&":"";this.urlWithParams=r+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||Ay(this.body)||Sy(this.body)||Cy(this.body)||E2(this.body)?this.body:this.body instanceof ys?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||Cy(this.body)?null:Sy(this.body)?this.body.type||null:Ay(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ys?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let r=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,o=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,h=e.params||this.params,f=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,p)=>d.set(p,e.setHeaders[p]),l)),e.setParams&&(h=Object.keys(e.setParams).reduce((d,p)=>d.set(p,e.setParams[p]),h)),new t(r,n,a,{params:h,headers:l,context:f,reportProgress:c,responseType:i,withCredentials:o,transferCache:s})}},yo=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(yo||{}),sl=class{constructor(e,r=Mh.Ok,n="OK"){this.headers=e.headers||new la,this.status=e.status!==void 0?e.status:r,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},U0=class t extends sl{constructor(e={}){super(e),this.type=yo.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Oh=class t extends sl{constructor(e={}){super(e),this.type=yo.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Nh=class extends sl{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Mh=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(Mh||{});function L0(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var j0=(()=>{let e=class e{constructor(n){this.handler=n}request(n,i,s={}){let a;if(n instanceof nl)a=n;else{let l;s.headers instanceof la?l=s.headers:l=new la(s.headers);let h;s.params&&(s.params instanceof ys?h=s.params:h=new ys({fromObject:s.params})),a=new nl(n,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let o=We(a).pipe(ia(l=>this.handler.handle(l)));if(n instanceof nl||s.observe==="events")return o;let c=o.pipe(ms(l=>l instanceof Oh));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return c.pipe(rt(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(rt(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(rt(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(rt(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new ys().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,L0(s,i))}post(n,i,s={}){return this.request("POST",n,L0(s,i))}put(n,i,s={}){return this.request("PUT",n,L0(s,i))}};e.\u0275fac=function(i){return new(i||e)(je(il))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})();function Py(t,e){return e(t)}function T2(t,e){return(r,n)=>e.intercept(r,{handle:i=>t(i,n)})}function b2(t,e,r){return(n,i)=>$i(r,()=>e(n,s=>t(s,i)))}var I2=new nt(""),W0=new nt(""),A2=new nt(""),S2=new nt("");function C2(){let t=null;return(e,r)=>{t===null&&(t=(Ce(I2,{optional:!0})??[]).reduceRight(T2,Py));let n=Ce(Zc),i=n.add();return t(e,r).pipe(sa(()=>n.remove(i)))}}var ky=(()=>{let e=class e extends il{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=Ce(Zc);let s=Ce(S2,{optional:!0});this.backend=s??n}handle(n){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(W0),...this.injector.get(A2,[])]));this.chain=s.reduceRight((a,o)=>b2(a,o,this.injector),Py)}let i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(sa(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)(je(Fh),je(mo))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})();var k2=/^\)\]\}',?\n/;function D2(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var Dy=(()=>{let e=class e{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new It(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Zr(i.\u0275loadImpl()):We(null)).pipe(Fn(()=>new ji(a=>{let o=i.build();if(o.open(n.method,n.urlWithParams),n.withCredentials&&(o.withCredentials=!0),n.headers.forEach((_,T)=>o.setRequestHeader(_,T.join(","))),n.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let _=n.detectContentTypeHeader();_!==null&&o.setRequestHeader("Content-Type",_)}if(n.responseType){let _=n.responseType.toLowerCase();o.responseType=_!=="json"?_:"text"}let c=n.serializeBody(),l=null,h=()=>{if(l!==null)return l;let _=o.statusText||"OK",T=new la(o.getAllResponseHeaders()),A=D2(o)||n.url;return l=new U0({headers:T,status:o.status,statusText:_,url:A}),l},f=()=>{let{headers:_,status:T,statusText:A,url:b}=h(),N=null;T!==Mh.NoContent&&(N=typeof o.response>"u"?o.responseText:o.response),T===0&&(T=N?Mh.Ok:0);let B=T>=200&&T<300;if(n.responseType==="json"&&typeof N=="string"){let M=N;N=N.replace(k2,"");try{N=N!==""?JSON.parse(N):null}catch(x){N=M,B&&(B=!1,N={error:x,text:N})}}B?(a.next(new Oh({body:N,headers:_,status:T,statusText:A,url:b||void 0})),a.complete()):a.error(new Nh({error:N,headers:_,status:T,statusText:A,url:b||void 0}))},d=_=>{let{url:T}=h(),A=new Nh({error:_,status:o.status||0,statusText:o.statusText||"Unknown Error",url:T||void 0});a.error(A)},p=!1,v=_=>{p||(a.next(h()),p=!0);let T={type:yo.DownloadProgress,loaded:_.loaded};_.lengthComputable&&(T.total=_.total),n.responseType==="text"&&o.responseText&&(T.partialText=o.responseText),a.next(T)},m=_=>{let T={type:yo.UploadProgress,loaded:_.loaded};_.lengthComputable&&(T.total=_.total),a.next(T)};return o.addEventListener("load",f),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),n.reportProgress&&(o.addEventListener("progress",v),c!==null&&o.upload&&o.upload.addEventListener("progress",m)),o.send(c),a.next({type:yo.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",f),o.removeEventListener("timeout",d),n.reportProgress&&(o.removeEventListener("progress",v),c!==null&&o.upload&&o.upload.removeEventListener("progress",m)),o.readyState!==o.DONE&&o.abort()}})))}};e.\u0275fac=function(i){return new(i||e)(je(Rh))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),Fy=new nt(""),R2="XSRF-TOKEN",P2=new nt("",{providedIn:"root",factory:()=>R2}),F2="X-XSRF-TOKEN",O2=new nt("",{providedIn:"root",factory:()=>F2}),Lh=class{},N2=(()=>{let e=class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=Ch(n,this.cookieName),this.lastCookieString=n),this.lastToken}};e.\u0275fac=function(i){return new(i||e)(je(_r),je(ni),je(P2))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})();function M2(t,e){let r=t.url.toLowerCase();if(!Ce(Fy)||t.method==="GET"||t.method==="HEAD"||r.startsWith("http://")||r.startsWith("https://"))return e(t);let n=Ce(Lh).getToken(),i=Ce(O2);return n!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,n)})),e(t)}var Oy=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(Oy||{});function L2(t,e){return{\u0275kind:t,\u0275providers:e}}function V2(...t){let e=[j0,Dy,ky,{provide:il,useExisting:ky},{provide:Fh,useExisting:Dy},{provide:W0,useValue:M2,multi:!0},{provide:Fy,useValue:!0},{provide:Lh,useClass:N2}];for(let r of t)e.push(...r.\u0275providers);return Qn(e)}var Ry=new nt("");function B2(){return L2(Oy.LegacyInterceptors,[{provide:Ry,useFactory:C2},{provide:W0,useExisting:Ry,multi:!0}])}var Ny=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({providers:[V2(B2())]});let t=e;return t})();var z0=class extends wy{constructor(){super(...arguments),this.supportsDOMEvents=!0}},G0=class t extends z0{static makeCurrent(){xy(new t)}onAndCancel(e,r,n){return e.addEventListener(r,n),()=>{e.removeEventListener(r,n)}}dispatchEvent(e,r){e.dispatchEvent(r)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,r){return r=r||this.getDefaultDocument(),r.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,r){return r==="window"?window:r==="document"?e:r==="body"?e.body:null}getBaseHref(e){let r=W2();return r==null?null:$2(r)}resetBaseElement(){al=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Ch(document.cookie,e)}},al=null;function W2(){return al=al||document.querySelector("base"),al?al.getAttribute("href"):null}function $2(t){return new URL(t,document.baseURI).pathname}var H2=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),q0=new nt(""),Vy=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(a=>a.supports(n)),!i)throw new It(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)(je(q0),je(Vt))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),Bh=class{constructor(e){this._doc=e}},$0="ng-app-id",By=(()=>{let e=class e{constructor(n,i,s,a={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Dh(a),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${$0}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){let s=this.styleRef;if(s.has(n)){let a=s.get(n);return a.usage+=i,a.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let s=this.styleNodesInDOM,a=s?.get(i);if(a?.parentNode===n)return s.delete(i),a.removeAttribute($0),a;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute($0,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){let s=this.getStyleElement(n,i),a=this.styleRef,o=a.get(i)?.elements;o?o.push(s):a.set(i,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(je(_r),je(wh),je(Yc,8),je(ni))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),H0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},X0=/%COMP%/g,Uy="%COMP%",z2=`_nghost-${Uy}`,G2=`_ngcontent-${Uy}`,q2=!0,K2=new nt("",{providedIn:"root",factory:()=>q2});function X2(t){return G2.replace(X0,t)}function Y2(t){return z2.replace(X0,t)}function jy(t,e){return e.map(r=>r.replace(X0,t))}var Uh=(()=>{let e=class e{constructor(n,i,s,a,o,c,l,h=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=Dh(c),this.defaultRenderer=new ol(n,o,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Xc.ShadowDom&&(i=pt(be({},i),{encapsulation:Xc.Emulated}));let s=this.getOrCreateRenderer(n,i);return s instanceof jh?s.applyToHost(n):s instanceof cl&&s.applyStyles(),s}getOrCreateRenderer(n,i){let s=this.rendererByCompId,a=s.get(i.id);if(!a){let o=this.doc,c=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case Xc.Emulated:a=new jh(l,h,i,this.appId,f,o,c,d);break;case Xc.ShadowDom:return new K0(l,h,n,i,o,c,this.nonce,d);default:a=new cl(l,h,i,f,o,c,d);break}s.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(je(Vy),je(By),je(wh),je(K2),je(_r),je(ni),je(Vt),je(Yc))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),ol=class{constructor(e,r,n,i){this.eventManager=e,this.doc=r,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,r){return r?this.doc.createElementNS(H0[r]||r,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,r){(My(e)?e.content:e).appendChild(r)}insertBefore(e,r,n){e&&(My(e)?e.content:e).insertBefore(r,n)}removeChild(e,r){e&&e.removeChild(r)}selectRootElement(e,r){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new It(-5104,!1);return r||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,r,n,i){if(i){r=i+":"+r;let s=H0[i];s?e.setAttributeNS(s,r,n):e.setAttribute(r,n)}else e.setAttribute(r,n)}removeAttribute(e,r,n){if(n){let i=H0[n];i?e.removeAttributeNS(i,r):e.removeAttribute(`${n}:${r}`)}else e.removeAttribute(r)}addClass(e,r){e.classList.add(r)}removeClass(e,r){e.classList.remove(r)}setStyle(e,r,n,i){i&(Qc.DashCase|Qc.Important)?e.style.setProperty(r,n,i&Qc.Important?"important":""):e.style[r]=n}removeStyle(e,r,n){n&Qc.DashCase?e.style.removeProperty(r):e.style[r]=""}setProperty(e,r,n){e!=null&&(e[r]=n)}setValue(e,r){e.nodeValue=r}listen(e,r,n){if(typeof e=="string"&&(e=_o().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${r}`);return this.eventManager.addEventListener(e,r,this.decoratePreventDefault(n))}decoratePreventDefault(e){return r=>{if(r==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(r)):e(r))===!1&&r.preventDefault()}}};function My(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var K0=class extends ol{constructor(e,r,n,i,s,a,o,c){super(e,s,a,c),this.sharedStylesHost=r,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=jy(i.id,i.styles);for(let h of l){let f=document.createElement("style");o&&f.setAttribute("nonce",o),f.textContent=h,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,r){return super.appendChild(this.nodeOrShadowRoot(e),r)}insertBefore(e,r,n){return super.insertBefore(this.nodeOrShadowRoot(e),r,n)}removeChild(e,r){return super.removeChild(this.nodeOrShadowRoot(e),r)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},cl=class extends ol{constructor(e,r,n,i,s,a,o,c){super(e,s,a,o),this.sharedStylesHost=r,this.removeStylesOnCompDestroy=i,this.styles=c?jy(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},jh=class extends cl{constructor(e,r,n,i,s,a,o,c){let l=i+"-"+n.id;super(e,r,n,s,a,o,c,l),this.contentAttr=X2(l),this.hostAttr=Y2(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,r){let n=super.createElement(e,r);return super.setAttribute(n,this.contentAttr,""),n}},Q2=(()=>{let e=class e extends Bh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(je(_r))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),Ly=["alt","control","meta","shift"],J2={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Z2={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},eC=(()=>{let e=class e extends Bh{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,s){let a=e.parseEventName(i),o=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>_o().onAndCancel(n,a.domEventName,o))}static parseEventName(n){let i=n.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),Ly.forEach(h=>{let f=i.indexOf(h);f>-1&&(i.splice(f,1),o+=h+".")}),o+=a,i.length!=0||a.length===0)return null;let l={};return l.domEventName=s,l.fullKey=o,l}static matchEventFullKeyCode(n,i){let s=J2[n.key]||n.key,a="";return i.indexOf("code.")>-1&&(s=n.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),Ly.forEach(o=>{if(o!==s){let c=Z2[o];c(n)&&(a+=o+".")}}),a+=s,a===i)}static eventCallback(n,i,s){return a=>{e.matchEventFullKeyCode(a,n)&&s.runGuarded(()=>i(a))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)(je(_r))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})();function Wy(t,e){return yy(be({rootComponent:t},tC(e)))}function tC(t){return{appProviders:[...aC,...t?.providers??[]],platformProviders:sC}}function rC(){G0.makeCurrent()}function nC(){return new k0}function iC(){return hy(document),document}var sC=[{provide:ni,useValue:Ty},{provide:fy,useValue:rC,multi:!0},{provide:_r,useFactory:iC,deps:[]}];var aC=[{provide:uy,useValue:"root"},{provide:k0,useFactory:nC,deps:[]},{provide:q0,useClass:Q2,multi:!0,deps:[_r,Vt,ni]},{provide:q0,useClass:eC,multi:!0,deps:[_r]},Uh,By,Vy,{provide:Eh,useExisting:Uh},{provide:Rh,useClass:H2,deps:[]},[]];var $y=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)(je(_r))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ge="primary",Tl=Symbol("RouteTitle"),ep=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r[0]:r}return null}getAll(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r:[r]}return[]}get keys(){return Object.keys(this.params)}};function bo(t){return new ep(t)}function lC(t,e,r){let n=r.path.split("/");if(n.length>t.length||r.pathMatch==="full"&&(e.hasChildren()||n.length<t.length))return null;let i={};for(let s=0;s<n.length;s++){let a=n[s],o=t[s];if(a.startsWith(":"))i[a.substring(1)]=o;else if(a!==o.path)return null}return{consumed:t.slice(0,n.length),posParams:i}}function uC(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!yi(t[r],e[r]))return!1;return!0}function yi(t,e){let r=t?tp(t):void 0,n=e?tp(e):void 0;if(!r||!n||r.length!=n.length)return!1;let i;for(let s=0;s<r.length;s++)if(i=r[s],!Qy(t[i],e[i]))return!1;return!0}function tp(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function Qy(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let r=[...t].sort(),n=[...e].sort();return r.every((i,s)=>n[s]===i)}else return t===e}function Jy(t){return t.length>0?t[t.length-1]:null}function Ts(t){return ty(t)?t:Ih(t)?Zr(Promise.resolve(t)):We(t)}var hC={exact:ex,subset:tx},Zy={exact:fC,subset:dC,ignored:()=>!0};function Hy(t,e,r){return hC[r.paths](t.root,e.root,r.matrixParams)&&Zy[r.queryParams](t.queryParams,e.queryParams)&&!(r.fragment==="exact"&&t.fragment!==e.fragment)}function fC(t,e){return yi(t,e)}function ex(t,e,r){if(!ha(t.segments,e.segments)||!Hh(t.segments,e.segments,r)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!t.children[n]||!ex(t.children[n],e.children[n],r))return!1;return!0}function dC(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(r=>Qy(t[r],e[r]))}function tx(t,e,r){return rx(t,e,e.segments,r)}function rx(t,e,r,n){if(t.segments.length>r.length){let i=t.segments.slice(0,r.length);return!(!ha(i,r)||e.hasChildren()||!Hh(i,r,n))}else if(t.segments.length===r.length){if(!ha(t.segments,r)||!Hh(t.segments,r,n))return!1;for(let i in e.children)if(!t.children[i]||!tx(t.children[i],e.children[i],n))return!1;return!0}else{let i=r.slice(0,t.segments.length),s=r.slice(t.segments.length);return!ha(t.segments,i)||!Hh(t.segments,i,n)||!t.children[Ge]?!1:rx(t.children[Ge],e,s,n)}}function Hh(t,e,r){return e.every((n,i)=>Zy[r](t[i].parameters,n.parameters))}var xs=class{constructor(e=new mt([],{}),r={},n=null){this.root=e,this.queryParams=r,this.fragment=n}get queryParamMap(){return this._queryParamMap??=bo(this.queryParams),this._queryParamMap}toString(){return gC.serialize(this)}},mt=class{constructor(e,r){this.segments=e,this.children=r,this.parent=null,Object.values(r).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return zh(this)}},ua=class{constructor(e,r){this.path=e,this.parameters=r}get parameterMap(){return this._parameterMap??=bo(this.parameters),this._parameterMap}toString(){return ix(this)}};function pC(t,e){return ha(t,e)&&t.every((r,n)=>yi(r.parameters,e[n].parameters))}function ha(t,e){return t.length!==e.length?!1:t.every((r,n)=>r.path===e[n].path)}function mC(t,e){let r=[];return Object.entries(t.children).forEach(([n,i])=>{n===Ge&&(r=r.concat(e(i,n)))}),Object.entries(t.children).forEach(([n,i])=>{n!==Ge&&(r=r.concat(e(i,n)))}),r}var Sp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:()=>new qh,providedIn:"root"});let t=e;return t})(),qh=class{parse(e){let r=new np(e);return new xs(r.parseRootSegment(),r.parseQueryParams(),r.parseFragment())}serialize(e){let r=`/${ll(e.root,!0)}`,n=yC(e.queryParams),i=typeof e.fragment=="string"?`#${vC(e.fragment)}`:"";return`${r}${n}${i}`}},gC=new qh;function zh(t){return t.segments.map(e=>ix(e)).join("/")}function ll(t,e){if(!t.hasChildren())return zh(t);if(e){let r=t.children[Ge]?ll(t.children[Ge],!1):"",n=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Ge&&n.push(`${i}:${ll(s,!1)}`)}),n.length>0?`${r}(${n.join("//")})`:r}else{let r=mC(t,(n,i)=>i===Ge?[ll(t.children[Ge],!1)]:[`${i}:${ll(n,!1)}`]);return Object.keys(t.children).length===1&&t.children[Ge]!=null?`${zh(t)}/${r[0]}`:`${zh(t)}/(${r.join("//")})`}}function nx(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Wh(t){return nx(t).replace(/%3B/gi,";")}function vC(t){return encodeURI(t)}function rp(t){return nx(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Gh(t){return decodeURIComponent(t)}function zy(t){return Gh(t.replace(/\+/g,"%20"))}function ix(t){return`${rp(t.path)}${_C(t.parameters)}`}function _C(t){return Object.entries(t).map(([e,r])=>`;${rp(e)}=${rp(r)}`).join("")}function yC(t){let e=Object.entries(t).map(([r,n])=>Array.isArray(n)?n.map(i=>`${Wh(r)}=${Wh(i)}`).join("&"):`${Wh(r)}=${Wh(n)}`).filter(r=>r);return e.length?`?${e.join("&")}`:""}var xC=/^[^\/()?;#]+/;function Y0(t){let e=t.match(xC);return e?e[0]:""}var wC=/^[^\/()?;=#]+/;function EC(t){let e=t.match(wC);return e?e[0]:""}var TC=/^[^=?&#]+/;function bC(t){let e=t.match(TC);return e?e[0]:""}var IC=/^[^&#]+/;function AC(t){let e=t.match(IC);return e?e[0]:""}var np=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new mt([],{}):new mt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(r).length>0)&&(n[Ge]=new mt(e,r)),n}parseSegment(){let e=Y0(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new It(4009,!1);return this.capture(e),new ua(Gh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let r=EC(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let i=Y0(this.remaining);i&&(n=i,this.capture(n))}e[Gh(r)]=Gh(n)}parseQueryParam(e){let r=bC(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let a=AC(this.remaining);a&&(n=a,this.capture(n))}let i=zy(r),s=zy(n);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Y0(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new It(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Ge);let a=this.parseChildren();r[s]=Object.keys(a).length===1?a[Ge]:new mt([],a),this.consumeOptional("//")}return r}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new It(4011,!1)}};function sx(t){return t.segments.length>0?new mt([],{[Ge]:t}):t}function ax(t){let e={};for(let[n,i]of Object.entries(t.children)){let s=ax(i);if(n===Ge&&s.segments.length===0&&s.hasChildren())for(let[a,o]of Object.entries(s.children))e[a]=o;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let r=new mt(t.segments,e);return SC(r)}function SC(t){if(t.numberOfChildren===1&&t.children[Ge]){let e=t.children[Ge];return new mt(t.segments.concat(e.segments),e.children)}return t}function Io(t){return t instanceof xs}function CC(t,e,r=null,n=null){let i=ox(t);return cx(i,e,r,n)}function ox(t){let e;function r(s){let a={};for(let c of s.children){let l=r(c);a[c.outlet]=l}let o=new mt(s.url,a);return s===t&&(e=o),o}let n=r(t.root),i=sx(n);return e??i}function cx(t,e,r,n){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Q0(i,i,i,r,n);let s=kC(e);if(s.toRoot())return Q0(i,i,new mt([],{}),r,n);let a=DC(s,i,t),o=a.processChildren?fl(a.segmentGroup,a.index,s.commands):ux(a.segmentGroup,a.index,s.commands);return Q0(i,a.segmentGroup,o,r,n)}function Kh(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function ml(t){return typeof t=="object"&&t!=null&&t.outlets}function Q0(t,e,r,n,i){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let a;t===e?a=r:a=lx(t,e,r);let o=sx(ax(a));return new xs(o,s,i)}function lx(t,e,r){let n={};return Object.entries(t.children).forEach(([i,s])=>{s===e?n[i]=r:n[i]=lx(s,e,r)}),new mt(t.segments,n)}var Xh=class{constructor(e,r,n){if(this.isAbsolute=e,this.numberOfDoubleDots=r,this.commands=n,e&&n.length>0&&Kh(n[0]))throw new It(4003,!1);let i=n.find(ml);if(i&&i!==Jy(n))throw new It(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function kC(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new Xh(!0,0,t);let e=0,r=!1,n=t.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let o={};return Object.entries(s.outlets).forEach(([c,l])=>{o[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:o}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((o,c)=>{c==0&&o==="."||(c==0&&o===""?r=!0:o===".."?e++:o!=""&&i.push(o))}),i):[...i,s]},[]);return new Xh(r,e,n)}var Eo=class{constructor(e,r,n){this.segmentGroup=e,this.processChildren=r,this.index=n}};function DC(t,e,r){if(t.isAbsolute)return new Eo(e,!0,0);if(!r)return new Eo(e,!1,NaN);if(r.parent===null)return new Eo(r,!0,0);let n=Kh(t.commands[0])?0:1,i=r.segments.length-1+n;return RC(r,i,t.numberOfDoubleDots)}function RC(t,e,r){let n=t,i=e,s=r;for(;s>i;){if(s-=i,n=n.parent,!n)throw new It(4005,!1);i=n.segments.length}return new Eo(n,!1,i-s)}function PC(t){return ml(t[0])?t[0].outlets:{[Ge]:t}}function ux(t,e,r){if(t??=new mt([],{}),t.segments.length===0&&t.hasChildren())return fl(t,e,r);let n=FC(t,e,r),i=r.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){let s=new mt(t.segments.slice(0,n.pathIndex),{});return s.children[Ge]=new mt(t.segments.slice(n.pathIndex),t.children),fl(s,0,i)}else return n.match&&i.length===0?new mt(t.segments,{}):n.match&&!t.hasChildren()?ip(t,e,r):n.match?fl(t,0,i):ip(t,e,r)}function fl(t,e,r){if(r.length===0)return new mt(t.segments,{});{let n=PC(r),i={};if(Object.keys(n).some(s=>s!==Ge)&&t.children[Ge]&&t.numberOfChildren===1&&t.children[Ge].segments.length===0){let s=fl(t.children[Ge],e,r);return new mt(t.segments,s.children)}return Object.entries(n).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=ux(t.children[s],e,a))}),Object.entries(t.children).forEach(([s,a])=>{n[s]===void 0&&(i[s]=a)}),new mt(t.segments,i)}}function FC(t,e,r){let n=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(n>=r.length)return s;let a=t.segments[i],o=r[n];if(ml(o))break;let c=`${o}`,l=n<r.length-1?r[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!qy(c,l,a))return s;n+=2}else{if(!qy(c,{},a))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function ip(t,e,r){let n=t.segments.slice(0,e),i=0;for(;i<r.length;){let s=r[i];if(ml(s)){let c=OC(s.outlets);return new mt(n,c)}if(i===0&&Kh(r[0])){let c=t.segments[e];n.push(new ua(c.path,Gy(r[0]))),i++;continue}let a=ml(s)?s.outlets[Ge]:`${s}`,o=i<r.length-1?r[i+1]:null;a&&o&&Kh(o)?(n.push(new ua(a,Gy(o))),i+=2):(n.push(new ua(a,{})),i++)}return new mt(n,{})}function OC(t){let e={};return Object.entries(t).forEach(([r,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[r]=ip(new mt([],{}),0,n))}),e}function Gy(t){let e={};return Object.entries(t).forEach(([r,n])=>e[r]=`${n}`),e}function qy(t,e,r){return t==r.path&&yi(e,r.parameters)}var dl="imperative",Dr=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Dr||{}),Nn=class{constructor(e,r){this.id=e,this.url=r}},gl=class extends Nn{constructor(e,r,n="imperative",i=null){super(e,r),this.type=Dr.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},ws=class extends Nn{constructor(e,r,n){super(e,r),this.urlAfterRedirects=n,this.type=Dr.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},_n=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(_n||{}),sp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(sp||{}),Es=class extends Nn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Dr.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},fa=class extends Nn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Dr.NavigationSkipped}},vl=class extends Nn{constructor(e,r,n,i){super(e,r),this.error=n,this.target=i,this.type=Dr.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Yh=class extends Nn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Dr.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ap=class extends Nn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Dr.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},op=class extends Nn{constructor(e,r,n,i,s){super(e,r),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=Dr.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},cp=class extends Nn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Dr.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},lp=class extends Nn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Dr.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},up=class{constructor(e){this.route=e,this.type=Dr.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},hp=class{constructor(e){this.route=e,this.type=Dr.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},fp=class{constructor(e){this.snapshot=e,this.type=Dr.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},dp=class{constructor(e){this.snapshot=e,this.type=Dr.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pp=class{constructor(e){this.snapshot=e,this.type=Dr.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},mp=class{constructor(e){this.snapshot=e,this.type=Dr.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var _l=class{},yl=class{constructor(e){this.url=e}};var gp=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new rf,this.attachRef=null}},rf=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new gp,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Qh=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let r=this.pathFromRoot(e);return r.length>1?r[r.length-2]:null}children(e){let r=vp(e,this._root);return r?r.children.map(n=>n.value):[]}firstChild(e){let r=vp(e,this._root);return r&&r.children.length>0?r.children[0].value:null}siblings(e){let r=_p(e,this._root);return r.length<2?[]:r[r.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return _p(e,this._root).map(r=>r.value)}};function vp(t,e){if(t===e.value)return e;for(let r of e.children){let n=vp(t,r);if(n)return n}return null}function _p(t,e){if(t===e.value)return[e];for(let r of e.children){let n=_p(t,r);if(n.length)return n.unshift(e),n}return[]}var vn=class{constructor(e,r){this.value=e,this.children=r}toString(){return`TreeNode(${this.value})`}};function wo(t){let e={};return t&&t.children.forEach(r=>e[r.value.outlet]=r),e}var Jh=class extends Qh{constructor(e,r){super(e),this.snapshot=r,kp(this,e)}toString(){return this.snapshot.toString()}};function hx(t){let e=NC(t),r=new Rn([new ua("",{})]),n=new Rn({}),i=new Rn({}),s=new Rn({}),a=new Rn(""),o=new da(r,n,s,a,i,Ge,t,e.root);return o.snapshot=e.root,new Jh(new vn(o,[]),e)}function NC(t){let e={},r={},n={},i="",s=new xl([],e,n,i,r,Ge,t,null,{});return new Zh("",new vn(s,[]))}var da=class{constructor(e,r,n,i,s,a,o,c){this.urlSubject=e,this.paramsSubject=r,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=o,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(rt(l=>l[Tl]))??We(void 0),this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(rt(e=>bo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(rt(e=>bo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Cp(t,e,r="emptyOnly"){let n,{routeConfig:i}=t;return e!==null&&(r==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:be(be({},e.params),t.params),data:be(be({},e.data),t.data),resolve:be(be(be(be({},t.data),e.data),i?.data),t._resolvedData)}:n={params:be({},t.params),data:be({},t.data),resolve:be(be({},t.data),t._resolvedData??{})},i&&dx(i)&&(n.resolve[Tl]=i.title),n}var xl=class{get title(){return this.data?.[Tl]}constructor(e,r,n,i,s,a,o,c,l){this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=a,this.component=o,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=bo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=bo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),r=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${r}')`}},Zh=class extends Qh{constructor(e,r){super(r),this.url=e,kp(this,r)}toString(){return fx(this._root)}};function kp(t,e){e.value._routerState=t,e.children.forEach(r=>kp(t,r))}function fx(t){let e=t.children.length>0?` { ${t.children.map(fx).join(", ")} } `:"";return`${t.value}${e}`}function J0(t){if(t.snapshot){let e=t.snapshot,r=t._futureSnapshot;t.snapshot=r,yi(e.queryParams,r.queryParams)||t.queryParamsSubject.next(r.queryParams),e.fragment!==r.fragment&&t.fragmentSubject.next(r.fragment),yi(e.params,r.params)||t.paramsSubject.next(r.params),uC(e.url,r.url)||t.urlSubject.next(r.url),yi(e.data,r.data)||t.dataSubject.next(r.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function yp(t,e){let r=yi(t.params,e.params)&&pC(t.url,e.url),n=!t.parent!=!e.parent;return r&&!n&&(!t.parent||yp(t.parent,e.parent))}function dx(t){return typeof t.title=="string"||t.title===null}var Dp=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Ge,this.activateEvents=new kr,this.deactivateEvents=new kr,this.attachEvents=new kr,this.detachEvents=new kr,this.parentContexts=Ce(rf),this.location=Ce(Th),this.changeDetector=Ce(_s),this.environmentInjector=Ce(mo),this.inputBinder=Ce(Rp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new It(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new It(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new It(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new It(4013,!1);this._activatedRoute=n;let s=this.location,o=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new xp(n,c,s.injector);this.activated=s.createComponent(o,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Mt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Jn]});let t=e;return t})(),xp=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,r,n){this.route=e,this.childContexts=r,this.parent=n}get(e,r){return e===da?this.route:e===rf?this.childContexts:this.parent.get(e,r)}},Rp=new nt("");function MC(t,e,r){let n=wl(t,e._root,r?r._root:void 0);return new Jh(n,e)}function wl(t,e,r){if(r&&t.shouldReuseRoute(e.value,r.value.snapshot)){let n=r.value;n._futureSnapshot=e.value;let i=LC(t,e,r);return new vn(n,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(o=>wl(t,o)),a}}let n=VC(e.value),i=e.children.map(s=>wl(t,s));return new vn(n,i)}}function LC(t,e,r){return e.children.map(n=>{for(let i of r.children)if(t.shouldReuseRoute(n.value,i.value.snapshot))return wl(t,n,i);return wl(t,n)})}function VC(t){return new da(new Rn(t.url),new Rn(t.params),new Rn(t.queryParams),new Rn(t.fragment),new Rn(t.data),t.outlet,t.component,t)}var px="ngNavigationCancelingError";function mx(t,e){let{redirectTo:r,navigationBehaviorOptions:n}=Io(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=gx(!1,_n.Redirect);return i.url=r,i.navigationBehaviorOptions=n,i}function gx(t,e){let r=new Error(`NavigationCancelingError: ${t||""}`);return r[px]=!0,r.cancellationCode=e,r}function BC(t){return vx(t)&&Io(t.url)}function vx(t){return!!t&&t[px]}var UC=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ht],decls:1,vars:0,template:function(i,s){i&1&&Ye(0,"router-outlet")},dependencies:[Dp],encapsulation:2});let t=e;return t})();function jC(t,e){return t.providers&&!t._injector&&(t._injector=gy(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Pp(t){let e=t.children&&t.children.map(Pp),r=e?pt(be({},t),{children:e}):be({},t);return!r.component&&!r.loadComponent&&(e||r.loadChildren)&&r.outlet&&r.outlet!==Ge&&(r.component=UC),r}function xi(t){return t.outlet||Ge}function WC(t,e){let r=t.filter(n=>xi(n)===e);return r.push(...t.filter(n=>xi(n)!==e)),r}function bl(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let r=e.routeConfig;if(r?._loadedInjector)return r._loadedInjector;if(r?._injector)return r._injector}return null}var $C=(t,e,r,n)=>rt(i=>(new wp(e,i.targetRouterState,i.currentRouterState,r,n).activate(t),i)),wp=class{constructor(e,r,n,i,s){this.routeReuseStrategy=e,this.futureState=r,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let r=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(r,n,e),J0(this.futureState.root),this.activateChildRoutes(r,n,e)}deactivateChildRoutes(e,r,n){let i=wo(r);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],n),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(i===s)if(i.component){let a=n.getContext(i.outlet);a&&this.deactivateChildRoutes(e,r,a.children)}else this.deactivateChildRoutes(e,r,n);else s&&this.deactivateRouteAndItsChildren(r,n)}deactivateRouteAndItsChildren(e,r){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,r):this.deactivateRouteAndOutlet(e,r)}detachAndStoreRouteSubtree(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=wo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(n&&n.outlet){let a=n.outlet.detach(),o=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:o})}}deactivateRouteAndOutlet(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=wo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,r,n){let i=wo(r);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new mp(s.value.snapshot))}),e.children.length&&this.forwardEvent(new dp(e.value.snapshot))}activateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(J0(i),i===s)if(i.component){let a=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,r,a.children)}else this.activateChildRoutes(e,r,n);else if(i.component){let a=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let o=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(o.contexts),a.attachRef=o.componentRef,a.route=o.route.value,a.outlet&&a.outlet.attach(o.componentRef,o.route.value),J0(o.route.value),this.activateChildRoutes(e,null,a.children)}else{let o=bl(i.snapshot);a.attachRef=null,a.route=i,a.injector=o,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}},ef=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},To=class{constructor(e,r){this.component=e,this.route=r}};function HC(t,e,r){let n=t._root,i=e?e._root:null;return ul(n,i,r,[n.value])}function zC(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function So(t,e){let r=Symbol(),n=e.get(t,r);return n===r?typeof t=="function"&&!ly(t)?t:e.get(t):n}function ul(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=wo(e);return t.children.forEach(a=>{GC(a,s[a.value.outlet],r,n.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,o])=>pl(o,r.getContext(a),i)),i}function GC(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,a=e?e.value:null,o=r?r.getContext(t.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let c=qC(a,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ef(n)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?ul(t,e,o?o.children:null,n,i):ul(t,e,r,n,i),c&&o&&o.outlet&&o.outlet.isActivated&&i.canDeactivateChecks.push(new To(o.outlet.component,a))}else a&&pl(e,o,i),i.canActivateChecks.push(new ef(n)),s.component?ul(t,null,o?o.children:null,n,i):ul(t,null,r,n,i);return i}function qC(t,e,r){if(typeof r=="function")return r(t,e);switch(r){case"pathParamsChange":return!ha(t.url,e.url);case"pathParamsOrQueryParamsChange":return!ha(t.url,e.url)||!yi(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!yp(t,e)||!yi(t.queryParams,e.queryParams);case"paramsChange":default:return!yp(t,e)}}function pl(t,e,r){let n=wo(t),i=t.value;Object.entries(n).forEach(([s,a])=>{i.component?e?pl(a,e.children.getContext(s),r):pl(a,null,r):pl(a,e,r)}),i.component?e&&e.outlet&&e.outlet.isActivated?r.canDeactivateChecks.push(new To(e.outlet.component,i)):r.canDeactivateChecks.push(new To(null,i)):r.canDeactivateChecks.push(new To(null,i))}function Il(t){return typeof t=="function"}function KC(t){return typeof t=="boolean"}function XC(t){return t&&Il(t.canLoad)}function YC(t){return t&&Il(t.canActivate)}function QC(t){return t&&Il(t.canActivateChild)}function JC(t){return t&&Il(t.canDeactivate)}function ZC(t){return t&&Il(t.canMatch)}function _x(t){return t instanceof ry||t?.name==="EmptyError"}var $h=Symbol("INITIAL_VALUE");function Ao(){return Fn(t=>Kc(t.map(e=>e.pipe(gs(1),yh($h)))).pipe(rt(e=>{for(let r of e)if(r!==!0){if(r===$h)return $h;if(r===!1||r instanceof xs)return r}return!0}),ms(e=>e!==$h),gs(1)))}function ek(t,e){return Pn(r=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=r;return a.length===0&&s.length===0?We(pt(be({},r),{guardsResult:!0})):tk(a,n,i,t).pipe(Pn(o=>o&&KC(o)?rk(n,s,t,e):We(o)),rt(o=>pt(be({},r),{guardsResult:o})))})}function tk(t,e,r,n){return Zr(t).pipe(Pn(i=>ok(i.component,i.route,r,e,n)),vs(i=>i!==!0,!0))}function rk(t,e,r,n){return Zr(e).pipe(ia(i=>_h(ik(i.route.parent,n),nk(i.route,n),ak(t,i.path,r),sk(t,i.route,r))),vs(i=>i!==!0,!0))}function nk(t,e){return t!==null&&e&&e(new pp(t)),We(!0)}function ik(t,e){return t!==null&&e&&e(new fp(t)),We(!0)}function sk(t,e,r){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return We(!0);let i=n.map(s=>b0(()=>{let a=bl(e)??r,o=So(s,a),c=YC(o)?o.canActivate(e,t):$i(a,()=>o(e,t));return Ts(c).pipe(vs())}));return We(i).pipe(Ao())}function ak(t,e,r){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>zC(a)).filter(a=>a!==null).map(a=>b0(()=>{let o=a.guards.map(c=>{let l=bl(a.node)??r,h=So(c,l),f=QC(h)?h.canActivateChild(n,t):$i(l,()=>h(n,t));return Ts(f).pipe(vs())});return We(o).pipe(Ao())}));return We(s).pipe(Ao())}function ok(t,e,r,n,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return We(!0);let a=s.map(o=>{let c=bl(e)??i,l=So(o,c),h=JC(l)?l.canDeactivate(t,e,r,n):$i(c,()=>l(t,e,r,n));return Ts(h).pipe(vs())});return We(a).pipe(Ao())}function ck(t,e,r,n){let i=e.canLoad;if(i===void 0||i.length===0)return We(!0);let s=i.map(a=>{let o=So(a,t),c=XC(o)?o.canLoad(e,r):$i(t,()=>o(e,r));return Ts(c)});return We(s).pipe(Ao(),yx(n))}function yx(t){return J1(lr(e=>{if(Io(e))throw mx(t,e)}),rt(e=>e===!0))}function lk(t,e,r,n){let i=e.canMatch;if(!i||i.length===0)return We(!0);let s=i.map(a=>{let o=So(a,t),c=ZC(o)?o.canMatch(e,r):$i(t,()=>o(e,r));return Ts(c)});return We(s).pipe(Ao(),yx(n))}var El=class{constructor(e){this.segmentGroup=e||null}},tf=class extends Error{constructor(e){super(),this.urlTree=e}};function xo(t){return qc(new El(t))}function uk(t){return qc(new It(4e3,!1))}function hk(t){return qc(gx(!1,_n.GuardRejected))}var Ep=class{constructor(e,r){this.urlSerializer=e,this.urlTree=r}lineralizeSegments(e,r){let n=[],i=r.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return We(n);if(i.numberOfChildren>1||!i.children[Ge])return uk(e.redirectTo);i=i.children[Ge]}}applyRedirectCommands(e,r,n){let i=this.applyRedirectCreateUrlTree(r,this.urlSerializer.parse(r),e,n);if(r.startsWith("/"))throw new tf(i);return i}applyRedirectCreateUrlTree(e,r,n,i){let s=this.createSegmentGroup(e,r.root,n,i);return new xs(s,this.createQueryParams(r.queryParams,this.urlTree.queryParams),r.fragment)}createQueryParams(e,r){let n={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let o=s.substring(1);n[i]=r[o]}else n[i]=s}),n}createSegmentGroup(e,r,n,i){let s=this.createSegments(e,r.segments,n,i),a={};return Object.entries(r.children).forEach(([o,c])=>{a[o]=this.createSegmentGroup(e,c,n,i)}),new mt(s,a)}createSegments(e,r,n,i){return r.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,r,n){let i=n[r.path.substring(1)];if(!i)throw new It(4001,!1);return i}findOrReturn(e,r){let n=0;for(let i of r){if(i.path===e.path)return r.splice(n),i;n++}return e}},Tp={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function fk(t,e,r,n,i){let s=Fp(t,e,r);return s.matched?(n=jC(e,n),lk(n,e,r,i).pipe(rt(a=>a===!0?s:be({},Tp)))):We(s)}function Fp(t,e,r){if(e.path==="**")return dk(r);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||r.length>0)?be({},Tp):{matched:!0,consumedSegments:[],remainingSegments:r,parameters:{},positionalParamSegments:{}};let i=(e.matcher||lC)(r,t,e);if(!i)return be({},Tp);let s={};Object.entries(i.posParams??{}).forEach(([o,c])=>{s[o]=c.path});let a=i.consumed.length>0?be(be({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:r.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function dk(t){return{matched:!0,parameters:t.length>0?Jy(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function Ky(t,e,r,n){return r.length>0&&gk(t,r,n)?{segmentGroup:new mt(e,mk(n,new mt(r,t.children))),slicedSegments:[]}:r.length===0&&vk(t,r,n)?{segmentGroup:new mt(t.segments,pk(t,r,n,t.children)),slicedSegments:r}:{segmentGroup:new mt(t.segments,t.children),slicedSegments:r}}function pk(t,e,r,n){let i={};for(let s of r)if(nf(t,e,s)&&!n[xi(s)]){let a=new mt([],{});i[xi(s)]=a}return be(be({},n),i)}function mk(t,e){let r={};r[Ge]=e;for(let n of t)if(n.path===""&&xi(n)!==Ge){let i=new mt([],{});r[xi(n)]=i}return r}function gk(t,e,r){return r.some(n=>nf(t,e,n)&&xi(n)!==Ge)}function vk(t,e,r){return r.some(n=>nf(t,e,n))}function nf(t,e,r){return(t.hasChildren()||e.length>0)&&r.pathMatch==="full"?!1:r.path===""}function _k(t,e,r,n){return xi(t)!==n&&(n===Ge||!nf(e,r,t))?!1:Fp(e,t,r).matched}function yk(t,e,r){return e.length===0&&!t.children[r]}var bp=class{};function xk(t,e,r,n,i,s,a="emptyOnly"){return new Ip(t,e,r,n,i,a,s).recognize()}var wk=31,Ip=class{constructor(e,r,n,i,s,a,o){this.injector=e,this.configLoader=r,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=o,this.applyRedirects=new Ep(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new It(4002,`'${e.segmentGroup}'`)}recognize(){let e=Ky(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(rt(r=>{let n=new xl([],Object.freeze({}),Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ge,this.rootComponentType,null,{}),i=new vn(n,r),s=new Zh("",i),a=CC(n,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Ge).pipe(po(n=>{if(n instanceof tf)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof El?this.noMatchError(n):n}))}inheritParamsAndData(e,r){let n=e.value,i=Cp(n,r,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,r,n,i){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,r,n):this.processSegment(e,r,n,n.segments,i,!0).pipe(rt(s=>s instanceof vn?[s]:[]))}processChildren(e,r,n){let i=[];for(let s of Object.keys(n.children))s==="primary"?i.unshift(s):i.push(s);return Zr(i).pipe(ia(s=>{let a=n.children[s],o=WC(r,s);return this.processSegmentGroup(e,o,a,s)}),oy((s,a)=>(s.push(...a),s)),I0(null),ay(),Pn(s=>{if(s===null)return xo(n);let a=xx(s);return Ek(a),We(a)}))}processSegment(e,r,n,i,s,a){return Zr(r).pipe(ia(o=>this.processSegmentAgainstRoute(o._injector??e,r,o,n,i,s,a).pipe(po(c=>{if(c instanceof El)return We(null);throw c}))),vs(o=>!!o),po(o=>{if(_x(o))return yk(n,i,s)?We(new bp):xo(n);throw o}))}processSegmentAgainstRoute(e,r,n,i,s,a,o){return _k(n,i,s,a)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,s,a):this.allowRedirects&&o?this.expandSegmentAgainstRouteUsingRedirect(e,i,r,n,s,a):xo(i):xo(i)}expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,a){let{matched:o,consumedSegments:c,positionalParamSegments:l,remainingSegments:h}=Fp(r,i,s);if(!o)return xo(r);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>wk&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(Pn(d=>this.processSegment(e,n,r,d.concat(h),a,!1)))}matchSegmentAgainstRoute(e,r,n,i,s){let a=fk(r,n,i,e,this.urlSerializer);return n.path==="**"&&(r.children={}),a.pipe(Fn(o=>o.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Fn(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:h,remainingSegments:f,parameters:d}=o,p=new xl(h,d,Object.freeze(be({},this.urlTree.queryParams)),this.urlTree.fragment,bk(n),xi(n),n.component??n._loadedComponent??null,n,Ik(n)),{segmentGroup:v,slicedSegments:m}=Ky(r,h,f,c);if(m.length===0&&v.hasChildren())return this.processChildren(l,c,v).pipe(rt(T=>T===null?null:new vn(p,T)));if(c.length===0&&m.length===0)return We(new vn(p,[]));let _=xi(n)===s;return this.processSegment(l,c,v,m,_?Ge:s,!0).pipe(rt(T=>new vn(p,T instanceof vn?[T]:[])))}))):xo(r)))}getChildConfig(e,r,n){return r.children?We({routes:r.children,injector:e}):r.loadChildren?r._loadedRoutes!==void 0?We({routes:r._loadedRoutes,injector:r._loadedInjector}):ck(e,r,n,this.urlSerializer).pipe(Pn(i=>i?this.configLoader.loadChildren(e,r).pipe(lr(s=>{r._loadedRoutes=s.routes,r._loadedInjector=s.injector})):hk(r))):We({routes:[],injector:e})}};function Ek(t){t.sort((e,r)=>e.value.outlet===Ge?-1:r.value.outlet===Ge?1:e.value.outlet.localeCompare(r.value.outlet))}function Tk(t){let e=t.value.routeConfig;return e&&e.path===""}function xx(t){let e=[],r=new Set;for(let n of t){if(!Tk(n)){e.push(n);continue}let i=e.find(s=>n.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...n.children),r.add(i)):e.push(n)}for(let n of r){let i=xx(n.children);e.push(new vn(n.value,i))}return e.filter(n=>!r.has(n))}function bk(t){return t.data||{}}function Ik(t){return t.resolve||{}}function Ak(t,e,r,n,i,s){return Pn(a=>xk(t,e,r,n,a.extractedUrl,i,s).pipe(rt(({state:o,tree:c})=>pt(be({},a),{targetSnapshot:o,urlAfterRedirects:c}))))}function Sk(t,e){return Pn(r=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=r;if(!i.length)return We(r);let s=new Set(i.map(c=>c.route)),a=new Set;for(let c of s)if(!a.has(c))for(let l of wx(c))a.add(l);let o=0;return Zr(a).pipe(ia(c=>s.has(c)?Ck(c,n,t,e):(c.data=Cp(c,c.parent,t).resolve,We(void 0))),lr(()=>o++),A0(1),Pn(c=>o===a.size?We(r):ps))})}function wx(t){let e=t.children.map(r=>wx(r)).flat();return[t,...e]}function Ck(t,e,r,n){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!dx(i)&&(s[Tl]=i.title),kk(s,t,e,n).pipe(rt(a=>(t._resolvedData=a,t.data=Cp(t,t.parent,r).resolve,null)))}function kk(t,e,r,n){let i=tp(t);if(i.length===0)return We({});let s={};return Zr(i).pipe(Pn(a=>Dk(t[a],e,r,n).pipe(vs(),lr(o=>{s[a]=o}))),A0(1),sy(s),po(a=>_x(a)?ps:qc(a)))}function Dk(t,e,r,n){let i=bl(e)??n,s=So(t,i),a=s.resolve?s.resolve(e,r):$i(i,()=>s(e,r));return Ts(a)}function Z0(t){return Fn(e=>{let r=t(e);return r?Zr(r).pipe(rt(()=>e)):We(e)})}var Ex=(()=>{let e=class e{buildTitle(n){let i,s=n.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===Ge);return i}getResolvedTitleForRoute(n){return n.data[Tl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:()=>Ce(Rk),providedIn:"root"});let t=e;return t})(),Rk=(()=>{let e=class e extends Ex{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(je($y))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Op=new nt("",{providedIn:"root",factory:()=>({})}),Np=new nt(""),Pk=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ce(O0)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return We(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=Ts(n.loadComponent()).pipe(rt(Tx),lr(a=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=a}),sa(()=>{this.componentLoaders.delete(n)})),s=new x0(i,()=>new Dn).pipe(y0());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return We({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=Fk(i,this.compiler,n,this.onLoadEndListener).pipe(sa(()=>{this.childrenLoaders.delete(i)})),o=new x0(a,()=>new Dn).pipe(y0());return this.childrenLoaders.set(i,o),o}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Fk(t,e,r,n){return Ts(t.loadChildren()).pipe(rt(Tx),Pn(i=>i instanceof my||Array.isArray(i)?We(i):Zr(e.compileModuleAsync(i))),rt(i=>{n&&n(t);let s,a,o=!1;return Array.isArray(i)?(a=i,o=!0):(s=i.create(r).injector,a=s.get(Np,[],{optional:!0,self:!0}).flat()),{routes:a.map(Pp),injector:s}}))}function Ok(t){return t&&typeof t=="object"&&"default"in t}function Tx(t){return Ok(t)?t.default:t}var Mp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:()=>Ce(Nk),providedIn:"root"});let t=e;return t})(),Nk=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Mk=new nt("");var Lk=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Dn,this.transitionAbortSubject=new Dn,this.configLoader=Ce(Pk),this.environmentInjector=Ce(mo),this.urlSerializer=Ce(Sp),this.rootContexts=Ce(rf),this.location=Ce(Sh),this.inputBindingEnabled=Ce(Rp,{optional:!0})!==null,this.titleStrategy=Ce(Ex),this.options=Ce(Op,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Ce(Mp),this.createViewTransition=Ce(Mk,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>We(void 0),this.rootComponentType=null;let n=s=>this.events.next(new up(s)),i=s=>this.events.next(new hp(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(pt(be(be({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,s){return this.transitions=new Rn({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:dl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(ms(a=>a.id!==0),rt(a=>pt(be({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Fn(a=>{let o=!1,c=!1;return We(a).pipe(Fn(l=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",_n.SupersededByNewNavigation),ps;this.currentTransition=a,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?pt(be({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!h&&f!=="reload"){let d="";return this.events.next(new fa(l.id,this.urlSerializer.serialize(l.rawUrl),d,sp.IgnoredSameUrlNavigation)),l.resolve(null),ps}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return We(l).pipe(Fn(d=>{let p=this.transitions?.getValue();return this.events.next(new gl(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),p!==this.transitions?.getValue()?ps:Promise.resolve(d)}),Ak(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),lr(d=>{a.targetSnapshot=d.targetSnapshot,a.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=pt(be({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let p=new Yh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:p,source:v,restoredState:m,extras:_}=l,T=new gl(d,this.urlSerializer.serialize(p),v,m);this.events.next(T);let A=hx(this.rootComponentType).snapshot;return this.currentTransition=a=pt(be({},l),{targetSnapshot:A,urlAfterRedirects:p,extras:pt(be({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,We(a)}else{let d="";return this.events.next(new fa(l.id,this.urlSerializer.serialize(l.extractedUrl),d,sp.IgnoredByUrlHandlingStrategy)),l.resolve(null),ps}}),lr(l=>{let h=new ap(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),rt(l=>(this.currentTransition=a=pt(be({},l),{guards:HC(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),a)),ek(this.environmentInjector,l=>this.events.next(l)),lr(l=>{if(a.guardsResult=l.guardsResult,Io(l.guardsResult))throw mx(this.urlSerializer,l.guardsResult);let h=new op(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),ms(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",_n.GuardRejected),!1)),Z0(l=>{if(l.guards.canActivateChecks.length)return We(l).pipe(lr(h=>{let f=new cp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),Fn(h=>{let f=!1;return We(h).pipe(Sk(this.paramsInheritanceStrategy,this.environmentInjector),lr({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(h,"",_n.NoDataFromResolver)}}))}),lr(h=>{let f=new lp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}))}),Z0(l=>{let h=f=>{let d=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(f.routeConfig).pipe(lr(p=>{f.component=p}),rt(()=>{})));for(let p of f.children)d.push(...h(p));return d};return Kc(h(l.targetSnapshot.root)).pipe(I0(null),gs(1))}),Z0(()=>this.afterPreactivation()),Fn(()=>{let{currentSnapshot:l,targetSnapshot:h}=a,f=this.createViewTransition?.(this.environmentInjector,l.root,h.root);return f?Zr(f).pipe(rt(()=>a)):We(a)}),rt(l=>{let h=MC(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=a=pt(be({},l),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,a}),lr(()=>{this.events.next(new _l)}),$C(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),gs(1),lr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new ws(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),xh(this.transitionAbortSubject.pipe(lr(l=>{throw l}))),sa(()=>{!o&&!c&&this.cancelNavigationTransition(a,"",_n.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),po(l=>{if(c=!0,vx(l))this.events.next(new Es(a.id,this.urlSerializer.serialize(a.extractedUrl),l.message,l.cancellationCode)),BC(l)?this.events.next(new yl(l.url)):a.resolve(!1);else{this.events.next(new vl(a.id,this.urlSerializer.serialize(a.extractedUrl),l,a.targetSnapshot??void 0));try{a.resolve(n.errorHandler(l))}catch(h){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(h)}}return ps}))}))}cancelNavigationTransition(n,i,s){let a=new Es(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(a),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Vk(t){return t!==dl}var Bk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:()=>Ce(Uk),providedIn:"root"});let t=e;return t})(),Ap=class{shouldDetach(e){return!1}store(e,r){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,r){return e.routeConfig===r.routeConfig}},Uk=(()=>{let e=class e extends Ap{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),bx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:()=>Ce(jk),providedIn:"root"});let t=e;return t})(),jk=(()=>{let e=class e extends bx{constructor(){super(...arguments),this.location=Ce(Sh),this.urlSerializer=Ce(Sp),this.options=Ce(Op,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Ce(Mp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new xs,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=hx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof gl)this.stateMemento=this.createStateMemento();else if(n instanceof fa)this.rawUrlTree=i.initialUrl;else if(n instanceof Yh){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else n instanceof _l?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Es&&(n.code===_n.GuardRejected||n.code===_n.NoDataFromResolver)?this.restoreHistory(i):n instanceof vl?this.restoreHistory(i,!0):n instanceof ws&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,o=be(be({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",o)}else{let a=be(be({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===n.finalUrl&&a===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),hl=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(hl||{});function Wk(t,e){t.events.pipe(ms(r=>r instanceof ws||r instanceof Es||r instanceof vl||r instanceof fa),rt(r=>r instanceof ws||r instanceof fa?hl.COMPLETE:(r instanceof Es?r.code===_n.Redirect||r.code===_n.SupersededByNewNavigation:!1)?hl.REDIRECTING:hl.FAILED),ms(r=>r!==hl.REDIRECTING),gs(1)).subscribe(()=>{e()})}function $k(t){throw t}var Hk={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},zk={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Al=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Ce(bh),this.stateManager=Ce(bx),this.options=Ce(Op,{optional:!0})||{},this.pendingTasks=Ce(Zc),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Ce(Lk),this.urlSerializer=Ce(Sp),this.location=Ce(Sh),this.urlHandlingStrategy=Ce(Mp),this._events=new Dn,this.errorHandler=this.options.errorHandler||$k,this.navigated=!1,this.routeReuseStrategy=Ce(Bk),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Ce(Np,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Ce(Rp,{optional:!0}),this.eventsSubscription=new Q1,this.isNgZoneEnabled=Ce(Vt)instanceof Vt&&Vt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Es&&i.code!==_n.Redirect&&i.code!==_n.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof ws)this.navigated=!0;else if(i instanceof yl){let o=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||Vk(s.source)};this.scheduleNavigation(o,dl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}qk(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),dl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,s){let a={replaceUrl:!0},o=s?.navigationId?s:null;if(s){let l=be({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(a.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,o,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Pp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:s,queryParams:a,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,h=l?this.currentUrlTree.fragment:o,f=null;switch(c){case"merge":f=be(be({},this.currentUrlTree.queryParams),a);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=a||null}f!==null&&(f=this.removeEmptyProps(f));let d;try{let p=s?s.snapshot:this.routerState.snapshot.root;d=ox(p)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),d=this.currentUrlTree.root}return cx(d,n,f,h??null)}navigateByUrl(n,i={skipLocationChange:!1}){let s=Io(n)?n:this.parseUrl(n),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,dl,null,i)}navigate(n,i={skipLocationChange:!1}){return Gk(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let s;if(i===!0?s=be({},Hk):i===!1?s=be({},zk):s=i,Io(n))return Hy(this.currentUrlTree,n,s);let a=this.parseUrl(n);return Hy(this.currentUrlTree,a,s)}removeEmptyProps(n){return Object.entries(n).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(n,i,s,a,o){if(this.disposed)return Promise.resolve(!1);let c,l,h;o?(c=o.resolve,l=o.reject,h=o.promise):h=new Promise((d,p)=>{c=d,l=p});let f=this.pendingTasks.add();return Wk(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:a,resolve:c,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(d=>Promise.reject(d))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Gk(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new It(4008,!1)}function qk(t){return!(t instanceof _l)&&!(t instanceof yl)}var Ix=(()=>{let e=class e{constructor(n,i,s,a,o,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=a,this.el=o,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new Dn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(h=>{h instanceof ws&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,a,o){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||s||a||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:dy(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let s=this.renderer,a=this.el.nativeElement;i!==null?s.setAttribute(a,n,i):s.removeAttribute(a,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Ue(Al),Ue(da),C0("tabindex"),Ue(Jc),Ue(ri),Ue(N0))},e.\u0275dir=Mt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&ut("click",function(o){return s.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),i&2&&oa("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[gr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Hi],skipLocationChange:[gr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Hi],replaceUrl:[gr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Hi],routerLink:"routerLink"},standalone:!0,features:[go,Jn]});let t=e;return t})();var Kk=new nt("");function Ax(t,...e){return Qn([{provide:Np,multi:!0,useValue:t},[],{provide:da,useFactory:Xk,deps:[Al]},{provide:F0,multi:!0,useFactory:Yk},e.map(r=>r.\u0275providers)])}function Xk(t){return t.routerState.root}function Yk(){let t=Ce(aa);return e=>{let r=t.get(Ah);if(e!==r.components[0])return;let n=t.get(Al),i=t.get(Qk);t.get(Jk)===1&&n.initialNavigation(),t.get(Zk,null,S0.Optional)?.setUpPreloading(),t.get(Kk,null,S0.Optional)?.init(),n.resetRootComponentType(r.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Qk=new nt("",{factory:()=>new Dn}),Jk=new nt("",{providedIn:"root",factory:()=>1});var Zk=new nt("");var Nx=(()=>{let e=class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(i){return new(i||e)(Ue(Jc),Ue(ri))},e.\u0275dir=Mt({type:e});let t=e;return t})(),Up=(()=>{let e=class e extends Nx{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275dir=Mt({type:e,features:[sn]});let t=e;return t})(),Rl=new nt(""),tD={provide:Rl,useExisting:Wi(()=>jp),multi:!0},jp=(()=>{let e=class e extends Up{writeValue(n){this.setProperty("checked",n)}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275dir=Mt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,s){i&1&&ut("change",function(o){return s.onChange(o.target.checked)})("blur",function(){return s.onTouched()})},features:[an([tD]),sn]});let t=e;return t})(),rD={provide:Rl,useExisting:Wi(()=>As),multi:!0};function nD(){let t=_o()?_o().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var iD=new nt(""),As=(()=>{let e=class e extends Nx{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!nD())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(Jc),Ue(ri),Ue(iD,8))},e.\u0275dir=Mt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&ut("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},features:[an([rD]),sn]});let t=e;return t})();function bs(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function Mx(t){return t!=null&&typeof t.length=="number"}var Pl=new nt(""),df=new nt(""),sD=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Dl=class{static min(e){return aD(e)}static max(e){return oD(e)}static required(e){return Lx(e)}static requiredTrue(e){return cD(e)}static email(e){return lD(e)}static minLength(e){return uD(e)}static maxLength(e){return hD(e)}static pattern(e){return fD(e)}static nullValidator(e){return af(e)}static compose(e){return $x(e)}static composeAsync(e){return Hx(e)}};function aD(t){return e=>{if(bs(e.value)||bs(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r<t?{min:{min:t,actual:e.value}}:null}}function oD(t){return e=>{if(bs(e.value)||bs(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r>t?{max:{max:t,actual:e.value}}:null}}function Lx(t){return bs(t.value)?{required:!0}:null}function cD(t){return t.value===!0?null:{required:!0}}function lD(t){return bs(t.value)||sD.test(t.value)?null:{email:!0}}function uD(t){return e=>bs(e.value)||!Mx(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function hD(t){return e=>Mx(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function fD(t){if(!t)return af;let e,r;return typeof t=="string"?(r="",t.charAt(0)!=="^"&&(r+="^"),r+=t,t.charAt(t.length-1)!=="$"&&(r+="$"),e=new RegExp(r)):(r=t.toString(),e=t),n=>{if(bs(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:r,actualValue:i}}}}function af(t){return null}function Vx(t){return t!=null}function Bx(t){return Ih(t)?Zr(t):t}function Ux(t){let e={};return t.forEach(r=>{e=r!=null?be(be({},e),r):e}),Object.keys(e).length===0?null:e}function jx(t,e){return e.map(r=>r(t))}function dD(t){return!t.validate}function Wx(t){return t.map(e=>dD(e)?e:r=>e.validate(r))}function $x(t){if(!t)return null;let e=t.filter(Vx);return e.length==0?null:function(r){return Ux(jx(r,e))}}function Wp(t){return t!=null?$x(Wx(t)):null}function Hx(t){if(!t)return null;let e=t.filter(Vx);return e.length==0?null:function(r){let n=jx(r,e).map(Bx);return ny(n).pipe(rt(Ux))}}function $p(t){return t!=null?Hx(Wx(t)):null}function Sx(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function zx(t){return t._rawValidators}function Gx(t){return t._rawAsyncValidators}function Lp(t){return t?Array.isArray(t)?t:[t]:[]}function of(t,e){return Array.isArray(t)?t.includes(e):t===e}function Cx(t,e){let r=Lp(e);return Lp(t).forEach(i=>{of(r,i)||r.push(i)}),r}function kx(t,e){return Lp(e).filter(r=>!of(t,r))}var cf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Wp(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=$p(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,r){return this.control?this.control.hasError(e,r):!1}getError(e,r){return this.control?this.control.getError(e,r):null}},zi=class extends cf{get formDirective(){return null}get path(){return null}},pa=class extends cf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},lf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},pD={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},rH=pt(be({},pD),{"[class.ng-submitted]":"isSubmitted"}),Do=(()=>{let e=class e extends lf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(pa,2))},e.\u0275dir=Mt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&el("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[sn]});let t=e;return t})(),Ro=(()=>{let e=class e extends lf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Ue(zi,10))},e.\u0275dir=Mt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&el("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[sn]});let t=e;return t})();var Sl="VALID",sf="INVALID",Co="PENDING",Cl="DISABLED";function Hp(t){return(pf(t)?t.validators:t)||null}function mD(t){return Array.isArray(t)?Wp(t):t||null}function zp(t,e){return(pf(e)?e.asyncValidators:t)||null}function gD(t){return Array.isArray(t)?$p(t):t||null}function pf(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function qx(t,e,r){let n=t.controls;if(!(e?Object.keys(n):n).length)throw new It(1e3,"");if(!n[r])throw new It(1001,"")}function Kx(t,e,r){t._forEachChild((n,i)=>{if(r[i]===void 0)throw new It(1002,"")})}var ko=class{constructor(e,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(r)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Sl}get invalid(){return this.status===sf}get pending(){return this.status==Co}get disabled(){return this.status===Cl}get enabled(){return this.status!==Cl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Cx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Cx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(kx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(kx(e,this._rawAsyncValidators))}hasValidator(e){return of(this._rawValidators,e)}hasAsyncValidator(e){return of(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(r=>{r.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Co,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=Cl,this.errors=null,this._forEachChild(n=>{n.disable(pt(be({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(pt(be({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=Sl,this._forEachChild(n=>{n.enable(pt(be({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(pt(be({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Sl||this.status===Co)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Cl:Sl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Co,this._hasOwnPendingAsyncValidator=!0;let r=Bx(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,r={}){this.errors=e,this._updateControlsErrors(r.emitEvent!==!1)}get(e){let r=e;return r==null||(Array.isArray(r)||(r=r.split(".")),r.length===0)?null:r.reduce((n,i)=>n&&n._find(i),this)}getError(e,r){let n=r?this.get(r):this;return n&&n.errors?n.errors[e]:null}hasError(e,r){return!!this.getError(e,r)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new kr,this.statusChanges=new kr}_calculateStatus(){return this._allControlsDisabled()?Cl:this.errors?sf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Co)?Co:this._anyControlsHaveStatus(sf)?sf:Sl}_anyControlsHaveStatus(e){return this._anyControls(r=>r.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){pf(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let r=this._parent&&this._parent.dirty;return!e&&!!r&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=mD(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=gD(this._rawAsyncValidators)}},Is=class extends ko{constructor(e,r,n){super(Hp(r),zp(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,r){return this.controls[e]?this.controls[e]:(this.controls[e]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(e,r,n={}){this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(e,r,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],r&&this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,r={}){Kx(this,!0,e),Object.keys(e).forEach(n=>{qx(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e={},r={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(e,r,n)=>(e[n]=r.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(r,n)=>n._syncPendingControls()?!0:r);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(r=>{let n=this.controls[r];n&&e(n,r)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[r,n]of Object.entries(this.controls))if(this.contains(r)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(r,n,i)=>((n.enabled||this.disabled)&&(r[i]=n.value),r))}_reduceChildren(e,r){let n=e;return this._forEachChild((i,s)=>{n=r(n,i,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Vp=class extends Is{};var Fl=new nt("CallSetDisabledState",{providedIn:"root",factory:()=>mf}),mf="always";function Xx(t,e){return[...e.path,t]}function uf(t,e,r=mf){Gp(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||r==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),_D(t,e),xD(t,e),yD(t,e),vD(t,e)}function Dx(t,e,r=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),ff(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function hf(t,e){t.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(e)})}function vD(t,e){if(e.valueAccessor.setDisabledState){let r=n=>{e.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(r),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(r)})}}function Gp(t,e){let r=zx(t);e.validator!==null?t.setValidators(Sx(r,e.validator)):typeof r=="function"&&t.setValidators([r]);let n=Gx(t);e.asyncValidator!==null?t.setAsyncValidators(Sx(n,e.asyncValidator)):typeof n=="function"&&t.setAsyncValidators([n]);let i=()=>t.updateValueAndValidity();hf(e._rawValidators,i),hf(e._rawAsyncValidators,i)}function ff(t,e){let r=!1;if(t!==null){if(e.validator!==null){let i=zx(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.validator);s.length!==i.length&&(r=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=Gx(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.asyncValidator);s.length!==i.length&&(r=!0,t.setAsyncValidators(s))}}}let n=()=>{};return hf(e._rawValidators,n),hf(e._rawAsyncValidators,n),r}function _D(t,e){e.valueAccessor.registerOnChange(r=>{t._pendingValue=r,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&Yx(t,e)})}function yD(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&Yx(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function Yx(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function xD(t,e){let r=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};t.registerOnChange(r),e._registerOnDestroy(()=>{t._unregisterOnChange(r)})}function Qx(t,e){t==null,Gp(t,e)}function wD(t,e){return ff(t,e)}function Jx(t,e){if(!t.hasOwnProperty("model"))return!1;let r=t.model;return r.isFirstChange()?!0:!Object.is(e,r.currentValue)}function ED(t){return Object.getPrototypeOf(t.constructor)===Up}function Zx(t,e){t._syncPendingControls(),e.forEach(r=>{let n=r.control;n.updateOn==="submit"&&n._pendingChange&&(r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function ew(t,e){if(!e)return null;Array.isArray(e);let r,n,i;return e.forEach(s=>{s.constructor===As?r=s:ED(s)?n=s:i=s}),i||n||r||null}function TD(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}var bD={provide:zi,useExisting:Wi(()=>qp)},kl=Promise.resolve(),qp=(()=>{let e=class e extends zi{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new kr,this.form=new Is({},Wp(n),$p(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){kl.then(()=>{let i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),uf(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){kl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){kl.then(()=>{let i=this._findContainer(n.path),s=new Is({});Qx(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){kl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){kl.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,Zx(this.form,this._directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}};e.\u0275fac=function(i){return new(i||e)(Ue(Pl,10),Ue(df,10),Ue(Fl,8))},e.\u0275dir=Mt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&ut("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{options:[gr.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[an([bD]),sn]});let t=e;return t})();function Rx(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}function Px(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var wi=class extends ko{constructor(e=null,r,n){super(Hp(r),zp(n,r)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),pf(r)&&(r.nonNullable||r.initialValueIsDefault)&&(Px(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,r={}){this.value=this._pendingValue=e,this._onChange.length&&r.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,r.emitViewToModelChange!==!1)),this.updateValueAndValidity(r)}patchValue(e,r={}){this.setValue(e,r)}reset(e=this.defaultValue,r={}){this._applyFormState(e),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Rx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Rx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Px(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var ID=t=>t instanceof wi;var AD={provide:pa,useExisting:Wi(()=>Ol)},Fx=Promise.resolve(),Ol=(()=>{let e=class e extends pa{constructor(n,i,s,a,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new wi,this._registered=!1,this.name="",this.update=new kr,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=ew(this,a)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),Jx(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){uf(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){Fx.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,s=i!==0&&Hi(i);Fx.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?Xx(n,this._parent):[n]}};e.\u0275fac=function(i){return new(i||e)(Ue(zi,9),Ue(Pl,10),Ue(df,10),Ue(Rl,10),Ue(_s,8),Ue(Fl,8))},e.\u0275dir=Mt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[gr.None,"disabled","isDisabled"],model:[gr.None,"ngModel","model"],options:[gr.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[an([AD]),sn,Jn]});let t=e;return t})(),Po=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Mt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),SD={provide:Rl,useExisting:Wi(()=>Kp),multi:!0},Kp=(()=>{let e=class e extends Up{writeValue(n){let i=n??"";this.setProperty("value",i)}registerOnChange(n){this.onChange=i=>{n(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275dir=Mt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&ut("input",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},features:[an([SD]),sn]});let t=e;return t})();var tw=new nt("");var CD={provide:zi,useExisting:Wi(()=>Nl)},Nl=(()=>{let e=class e extends zi{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new kr,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ff(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let i=this.form.get(n.path);return uf(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Dx(n.control||null,n,!1),TD(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,Zx(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let i=n.control,s=this.form.get(n.path);i!==s&&(Dx(i||null,n),ID(s)&&(uf(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let i=this.form.get(n.path);Qx(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let i=this.form.get(n.path);i&&wD(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){Gp(this.form,this),this._oldForm&&ff(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(Ue(Pl,10),Ue(df,10),Ue(Fl,8))},e.\u0275dir=Mt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&ut("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{form:[gr.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[an([CD]),sn,Jn]});let t=e;return t})();var kD={provide:pa,useExisting:Wi(()=>Ml)},Ml=(()=>{let e=class e extends pa{set isDisabled(n){}constructor(n,i,s,a,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new kr,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=ew(this,a)}ngOnChanges(n){this._added||this._setUpControl(),Jx(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return Xx(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(Ue(zi,13),Ue(Pl,10),Ue(df,10),Ue(Rl,10),Ue(tw,8))},e.\u0275dir=Mt({type:e,selectors:[["","formControlName",""]],inputs:{name:[gr.None,"formControlName","name"],isDisabled:[gr.None,"disabled","isDisabled"],model:[gr.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[an([kD]),sn,Jn]});let t=e;return t})();var DD=(()=>{let e=class e{constructor(){this._validator=af}ngOnChanges(n){if(this.inputName in n){let i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):af,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=Mt({type:e,features:[Jn]});let t=e;return t})();var RD={provide:Pl,useExisting:Wi(()=>ma),multi:!0};var ma=(()=>{let e=class e extends DD{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Hi,this.createValidator=n=>Lx}enabled(n){return n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=vi(e)))(s||e)}})(),e.\u0275dir=Mt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&oa("required",s._enabled?"":null)},inputs:{required:"required"},features:[an([RD]),sn]});let t=e;return t})();var rw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({});let t=e;return t})(),Bp=class extends ko{constructor(e,r,n){super(Hp(r),zp(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,r={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}insert(e,r,n={}){this.controls.splice(e,0,r),this._registerControl(r),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,r={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:r.emitEvent})}setControl(e,r,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),r&&(this.controls.splice(i,0,r),this._registerControl(r)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,r={}){Kx(this,!1,e),e.forEach((n,i)=>{qx(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e=[],r={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(r=>r._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((r,n)=>n._syncPendingControls()?!0:r,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((r,n)=>{e(r,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(r=>r.enabled&&e(r))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Ox(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var nw=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,i=null){let s=this._reduceControls(n),a={};return Ox(i)?a=i:i!==null&&(a.validators=i.validator,a.asyncValidators=i.asyncValidator),new Is(s,a)}record(n,i=null){let s=this._reduceControls(n);return new Vp(s,i)}control(n,i,s){let a={};return this.useNonNullable?(Ox(i)?a=i:(a.validators=i,a.asyncValidators=s),new wi(n,pt(be({},a),{nonNullable:!0}))):new wi(n,i,s)}array(n,i,s){let a=n.map(o=>this._createControl(o));return new Bp(a,i,s)}_reduceControls(n){let i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){if(n instanceof wi)return n;if(n instanceof ko)return n;if(Array.isArray(n)){let i=n[0],s=n.length>1?n[1]:null,a=n.length>2?n[2]:null;return this.control(i,s,a)}else return this.control(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Fo=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:Fl,useValue:n.callSetDisabledState??mf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({imports:[rw]});let t=e;return t})(),gf=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:tw,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:Fl,useValue:n.callSetDisabledState??mf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({imports:[rw]});let t=e;return t})();var iw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({});let t=e;return t})();var sw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({});let t=e;return t})();var Yp;try{Yp=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Yp=!1}var Vl=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?by(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||Yp)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(i){return new(i||e)(je(ni))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Ll;function FD(){if(Ll==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Ll=!0}))}finally{Ll=Ll||!1}return Ll}function Qp(t){return FD()?t:!!t.capture}function aw(t){return t.composedPath?t.composedPath()[0]:t.target}function ow(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function Jp(t){return Array.isArray(t)?t:[t]}function Zp(t){return t instanceof ri?t.nativeElement:t}var lw=new Set,ga,OD=(()=>{let e=class e{constructor(n,i){this._platform=n,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):MD}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&ND(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(i){return new(i||e)(je(Vl),je(Yc,8))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function ND(t,e){if(!lw.has(t))try{ga||(ga=document.createElement("style"),e&&ga.setAttribute("nonce",e),ga.setAttribute("type","text/css"),document.head.appendChild(ga)),ga.sheet&&(ga.sheet.insertRule(`@media ${t} {body{ }}`,0),lw.add(t))}catch(r){console.error(r)}}function MD(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var hw=(()=>{let e=class e{constructor(n,i){this._mediaMatcher=n,this._zone=i,this._queries=new Map,this._destroySubject=new Dn}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return uw(Jp(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=uw(Jp(n)).map(o=>this._registerQuery(o).observable),a=Kc(s);return a=_h(a.pipe(gs(1)),a.pipe(cy(1),iy(0))),a.pipe(rt(o=>{let c={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:h})=>{c.matches=c.matches||l,c.breakpoints[h]=l}),c}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let i=this._mediaMatcher.matchMedia(n),a={observable:new ji(o=>{let c=l=>this._zone.run(()=>o.next(l));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(yh(i),rt(({matches:o})=>({query:n,matches:o})),xh(this._destroySubject)),mql:i};return this._queries.set(n,a),a}};e.\u0275fac=function(i){return new(i||e)(je(OD),je(Vt))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function uw(t){return t.map(e=>e.split(",")).reduce((e,r)=>e.concat(r)).map(e=>e.trim())}function pw(t){return t.buttons===0||t.detail===0}function mw(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var va=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(va||{}),fw="cdk-high-contrast-black-on-white",dw="cdk-high-contrast-white-on-black",em="cdk-high-contrast-active",gw=(()=>{let e=class e{constructor(n,i){this._platform=n,this._document=i,this._breakpointSubscription=Ce(hw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return va.NONE;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let i=this._document.defaultView||window,s=i&&i.getComputedStyle?i.getComputedStyle(n):null,a=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return va.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return va.BLACK_ON_WHITE}return va.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(em,fw,dw),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===va.BLACK_ON_WHITE?n.add(em,fw):i===va.WHITE_ON_BLACK&&n.add(em,dw)}}};e.\u0275fac=function(i){return new(i||e)(je(Vl),je(_r))},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var tm=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({});let t=e;return t})();function WD(){return!0}var $D=new nt("mat-sanity-checks",{providedIn:"root",factory:WD}),Tw=(()=>{let e=class e{constructor(n,i,s){this._sanityChecks=i,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return ow()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(i){return new(i||e)(je(gw),je($D,8),je(_r))},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({imports:[tm,tm]});let t=e;return t})();var Mn=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Mn||{}),rm=class{constructor(e,r,n,i=!1){this._renderer=e,this.element=r,this.config=n,this._animationForciblyDisabledThroughCss=i,this.state=Mn.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},vw=Qp({passive:!0,capture:!0}),nm=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let r=aw(e);r&&this._events.get(e.type)?.forEach((n,i)=>{(i===r||i.contains(r))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,r,n,i){let s=this._events.get(r);if(s){let a=s.get(n);a?a.add(i):s.set(n,new Set([i]))}else this._events.set(r,new Map([[n,new Set([i])]])),e.runOutsideAngular(()=>{document.addEventListener(r,this._delegateEventHandler,vw)})}removeHandler(e,r,n){let i=this._events.get(e);if(!i)return;let s=i.get(r);s&&(s.delete(n),s.size===0&&i.delete(r),i.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,vw)))}},_w={enterDuration:225,exitDuration:150},HD=800,yw=Qp({passive:!0,capture:!0}),xw=["mousedown","touchstart"],ww=["mouseup","mouseleave","touchend","touchcancel"],Bl=class Bl{constructor(e,r,n,i){this._target=e,this._ngZone=r,this._platform=i,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=Zp(n))}fadeInRipple(e,r,n={}){let i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=be(be({},_w),n.animation);n.centered&&(e=i.left+i.width/2,r=i.top+i.height/2);let a=n.radius||zD(e,r,i),o=e-i.left,c=r-i.top,l=s.enterDuration,h=document.createElement("div");h.classList.add("mat-ripple-element"),h.style.left=`${o-a}px`,h.style.top=`${c-a}px`,h.style.height=`${a*2}px`,h.style.width=`${a*2}px`,n.color!=null&&(h.style.backgroundColor=n.color),h.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(h);let f=window.getComputedStyle(h),d=f.transitionProperty,p=f.transitionDuration,v=d==="none"||p==="0s"||p==="0s, 0s"||i.width===0&&i.height===0,m=new rm(this,h,n,v);h.style.transform="scale3d(1, 1, 1)",m.state=Mn.FADING_IN,n.persistent||(this._mostRecentTransientRipple=m);let _=null;return!v&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let T=()=>this._finishRippleTransition(m),A=()=>this._destroyRipple(m);h.addEventListener("transitionend",T),h.addEventListener("transitioncancel",A),_={onTransitionEnd:T,onTransitionCancel:A}}),this._activeRipples.set(m,_),(v||!l)&&this._finishRippleTransition(m),m}fadeOutRipple(e){if(e.state===Mn.FADING_OUT||e.state===Mn.HIDDEN)return;let r=e.element,n=be(be({},_w),e.config.animation);r.style.transitionDuration=`${n.exitDuration}ms`,r.style.opacity="0",e.state=Mn.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let r=Zp(e);!this._platform.isBrowser||!r||r===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=r,xw.forEach(n=>{Bl._eventManager.addHandler(this._ngZone,n,r,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{ww.forEach(r=>{this._triggerElement.addEventListener(r,this,yw)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Mn.FADING_IN?this._startFadeOutTransition(e):e.state===Mn.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let r=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Mn.VISIBLE,!n&&(!r||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let r=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Mn.HIDDEN,r!==null&&(e.element.removeEventListener("transitionend",r.onTransitionEnd),e.element.removeEventListener("transitioncancel",r.onTransitionCancel)),e.element.remove()}_onMousedown(e){let r=pw(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+HD;!this._target.rippleDisabled&&!r&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!mw(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let r=e.changedTouches;if(r)for(let n=0;n<r.length;n++)this.fadeInRipple(r[n].clientX,r[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let r=e.state===Mn.VISIBLE||e.config.terminateOnPointerUp&&e.state===Mn.FADING_IN;!e.config.persistent&&r&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(xw.forEach(r=>Bl._eventManager.removeHandler(r,e,this)),this._pointerUpEventsRegistered&&(ww.forEach(r=>e.removeEventListener(r,this,yw)),this._pointerUpEventsRegistered=!1))}};Bl._eventManager=new nm;var Ew=Bl;function zD(t,e,r){let n=Math.max(Math.abs(t-r.left),Math.abs(t-r.right)),i=Math.max(Math.abs(e-r.top),Math.abs(e-r.bottom));return Math.sqrt(n*n+i*i)}var bw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Qt({type:e}),e.\u0275inj=Yt({imports:[Tw,iw,sw]});let t=e;return t})();var Zl={};Zl.version="0.18.5";var Ai=1200,Ho=1252,GD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Dm={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Rm=function(t){GD.indexOf(t)!=-1&&(Ho=Dm[0]=t)};function qD(){Rm(1252)}var si=function(t){Ai=t,Rm(t)};function Pm(){si(1200),qD()}function _m(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function KD(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function FE(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var Wl=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?KD(t.slice(2)):e==254&&r==255?FE(t.slice(2)):e==65279?t.slice(1):t},vf=function(e){return String.fromCharCode(e)},Iw=function(e){return String.fromCharCode(e)},gt;var qt=null,Ul=!0,Cs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function eu(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),s=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,i=t.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Cs.charAt(s)+Cs.charAt(a)+Cs.charAt(o)+Cs.charAt(c);return e}function En(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)s=Cs.indexOf(t.charAt(l++)),a=Cs.indexOf(t.charAt(l++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Cs.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Cs.indexOf(t.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var Qe=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qi=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Ds(t){return Qe?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Aw(t){return Qe?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var xn=function(e){return Qe?Qi(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function jf(t){if(typeof ArrayBuffer>"u")return xn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Os(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function XD(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Fm(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Fm(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var wr=Qe?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Qi(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function YD(t){for(var e=[],r=0,n=t.length+250,i=Ds(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Ds(65535),n=65530)}return e.push(i.slice(0,r)),wr(e)}var Wr=/\u0000/g,$l=/[\u0001-\u0006]/g;function Uo(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ai(t,e){var r=""+t;return r.length>=e?r:zt("0",e-r.length)+r}function Om(t,e){var r=""+t;return r.length>=e?r:zt(" ",e-r.length)+r}function Cf(t,e){var r=""+t;return r.length>=e?r:r+zt(" ",e-r.length)}function QD(t,e){var r=""+Math.round(t);return r.length>=e?r:zt("0",e-r.length)+r}function JD(t,e){var r=""+t;return r.length>=e?r:zt("0",e-r.length)+r}var Sw=Math.pow(2,32);function Oo(t,e){if(t>Sw||t<-Sw)return QD(t,e);var r=Math.round(t);return JD(r,e)}function kf(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Cw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],im=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function ZD(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Oe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},kw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},eR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Df(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,l=0,h=0,f=Math.floor(i);l<e&&(f=Math.floor(i),o=f*a+s,h=f*l+c,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,c=l,l=h;if(h>e&&(l>e?(h=c,o=s):(h=l,o=a)),!r)return[0,n*o,h];var d=Math.floor(n*o/h);return[d,n*o-d*h,h]}function ya(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=aR(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var OE=new Date(1899,11,31,0,0,0),tR=OE.getTime(),rR=new Date(1900,2,1,0,0,0);function NE(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=rR&&(r+=24*60*60*1e3),(r-(tR+(t.getTimezoneOffset()-OE.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Nm(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function nR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function iR(t){var e=t<0?12:11,r=Nm(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function sR(t){var e=Nm(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function tu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=iR(t):e===10?r=t.toFixed(10).substr(0,12):r=sR(t),Nm(nR(r.toUpperCase()))}function ba(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):tu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Hn(14,NE(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function aR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function oR(t,e,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return im[r.m-1][1];case 5:return im[r.m-1][0];default:return im[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return Cw[r.q][0];default:return Cw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ai(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ai(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?ai(c,l):"";return h}function ks(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var ME=/%/g;function cR(t,e,r){var n=e.replace(ME,""),i=e.length-n.length;return qi(t,n,r*Math.pow(10,2*i))+zt("%",i)}function lR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function LE(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+LE(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var VE=/# (\?+)( ?)\/( ?)(\d+)/;function uR(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?zt(" ",t[1].length+1+t[4].length):Om(a,t[1].length)+t[2]+"/"+t[3]+ai(o,t[4].length))}function hR(t,e,r){return r+(e===0?"":""+e)+zt(" ",t[1].length+2+t[4].length)}var BE=/^#*0*\.([0#]+)/,UE=/\).*[0#]/,jE=/\(###\) ###\\?-####/;function en(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function Dw(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function Rw(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function fR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function dR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Vn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(UE)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Vn("n",n,r):"("+Vn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return lR(t,e,r);if(e.indexOf("%")!==-1)return cR(t,e,r);if(e.indexOf("E")!==-1)return LE(e,r);if(e.charCodeAt(0)===36)return"$"+Vn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+Oo(c,e.length);if(e.match(/^[#?]+$/))return i=Oo(r,0),i==="0"&&(i=""),i.length>e.length?i:en(e.substr(0,e.length-i.length))+i;if(s=e.match(VE))return uR(s,c,l);if(e.match(/^#+0+$/))return l+Oo(c,e.length-e.indexOf("0"));if(s=e.match(BE))return i=Dw(r,s[1].length).replace(/^([^\.]+)$/,"$1."+en(s[1])).replace(/\.$/,"."+en(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+zt("0",en(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+Dw(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+ks(Oo(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Vn(t,e,-r):ks(""+(Math.floor(r)+fR(r,s[1].length)))+"."+ai(Rw(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Vn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Uo(Vn(t,e.replace(/[\\-]/g,""),r)),a=0,Uo(Uo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(jE))return i=Vn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Df(c,Math.pow(10,a)-1,!1),i=""+l,h=qi("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Cf(o[2],a),h.length<s[4].length&&(h=en(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Df(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Om(o[1],a)+s[2]+"/"+s[3]+Cf(o[2],a):zt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Oo(r,0),e.length<=i.length?i:en(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return en(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=Rw(r,s[1].length),r<0?"-"+Vn(t,e,-r):ks(dR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ai(0,3-v.length):"")+v})+"."+ai(a,s[1].length);switch(e){case"###,##0.00":return Vn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ks(Oo(c,0));return p!=="0"?l+p:"";case"###,###.00":return Vn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Vn(t,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function pR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return qi(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function mR(t,e,r){var n=e.replace(ME,""),i=e.length-n.length;return qi(t,n,r*Math.pow(10,2*i))+zt("%",i)}function WE(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+WE(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ti(t,e,r){if(t.charCodeAt(0)===40&&!e.match(UE)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ti("n",n,r):"("+Ti("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return pR(t,e,r);if(e.indexOf("%")!==-1)return mR(t,e,r);if(e.indexOf("E")!==-1)return WE(e,r);if(e.charCodeAt(0)===36)return"$"+Ti(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+ai(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:en(e.substr(0,e.length-i.length))+i;if(s=e.match(VE))return hR(s,c,l);if(e.match(/^#+0+$/))return l+ai(c,e.length-e.indexOf("0"));if(s=e.match(BE))return i=(""+r).replace(/^([^\.]+)$/,"$1."+en(s[1])).replace(/\.$/,"."+en(s[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+zt("0",en(s[1]).length-m.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+ks(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ti(t,e,-r):ks(""+r)+"."+zt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Ti(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Uo(Ti(t,e.replace(/[\\-]/g,""),r)),a=0,Uo(Uo(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(jE))return i=Ti(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Df(c,Math.pow(10,a)-1,!1),i=""+l,h=qi("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Cf(o[2],a),h.length<s[4].length&&(h=en(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Df(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Om(o[1],a)+s[2]+"/"+s[3]+Cf(o[2],a):zt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:en(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return en(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ti(t,e,-r):ks(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ai(0,3-v.length):"")+v})+"."+ai(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var p=ks(""+c);return p!=="0"?l+p:"";default:if(e.match(/\.[0#?]*$/))return Ti(t,e.slice(0,e.lastIndexOf(".")),r)+en(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function qi(t,e,r){return(r|0)===r?Ti(t,e,r):Vn(t,e,r)}function gR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var $E=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ko(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":kf(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match($E))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function vR(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",l,h,f,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!kf(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var p=t.charAt(++a),v=p==="("||p===")"?p:"t";i[i.length]={t:v,v:p},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=ya(e,r,t.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=ya(e,r),l==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var m={t:o,v:o};if(l==null&&(l=ya(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(m.v=l.H>=12?"P":"A"),m.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(m.v=l.H>=12?"PM":"AM"),m.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(m.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),m.t="T",a+=5,d="h"):(m.t="t",++a),l==null&&m.t==="T")return"";i[i.length]=m,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match($E)){if(l==null&&(l=ya(e,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ko(t)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,T=0,A;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",_<1&&(_=1);break;case"s":(A=i[a].v.match(/\.0+$/))&&(T=Math.max(T,A[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var b="",N;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=oR(i[a].t.charCodeAt(0),i[a].v,l,T),i[a].t="t";break;case"n":case"?":for(N=a+1;i[N]!=null&&((o=i[N].t)==="?"||o==="D"||(o===" "||o==="t")&&i[N+1]!=null&&(i[N+1].t==="?"||i[N+1].t==="t"&&i[N+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[N].v==="/"||i[N].v===" "&&i[N+1]!=null&&i[N+1].t=="?"));)i[a].v+=i[N].v,i[N]={v:"",t:";"},++N;b+=i[a].v,a=N-1;break;case"G":i[a].t="t",i[a].v=ba(e,r);break}var B="",M,x;if(b.length>0){b.charCodeAt(0)==40?(M=e<0&&b.charCodeAt(0)===45?-e:e,x=qi("n",b,M)):(M=e<0&&n>1?-e:e,x=qi("n",b,M),M<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),N=x.length-1;var w=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){w=a;break}var E=i.length;if(w===i.length&&x.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(N>=i[a].v.length-1?(N-=i[a].v.length,i[a].v=x.substr(N+1,i[a].v.length)):N<0?i[a].v="":(i[a].v=x.substr(0,N+1),N=-1),i[a].t="t",E=a);N>=0&&E<i.length&&(i[E].v=x.substr(0,N+1)+i[E].v)}else if(w!==i.length&&x.indexOf("E")===-1){for(N=x.indexOf(".")-1,a=w;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")-1:i[a].v.length-1,B=i[a].v.substr(h+1);h>=0;--h)N>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(B=x.charAt(N--)+B);i[a].v=B,i[a].t="t",E=a}for(N>=0&&E<i.length&&(i[E].v=x.substr(0,N+1)+i[E].v),N=x.indexOf(".")+1,a=w;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==w)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")+1:0,B=i[a].v.substr(0,h);h<i[a].v.length;++h)N<x.length&&(B+=x.charAt(N++));i[a].v=B,i[a].t="t",E=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(M=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=qi(i[a].t,i[a].v,M),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var Pw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Fw(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function _R(t,e){var r=gR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(Pw),o=r[1].match(Pw);return Fw(e,a)?[n,r[0]]:Fw(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Hn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Oe)[t],n==null&&(n=r.table&&r.table[kw[t]]||Oe[kw[t]]),n==null&&(n=eR[t]||"General");break}if(kf(n,0))return ba(e,r);e instanceof Date&&(e=NE(e,r.date1904));var i=_R(n,e);if(kf(i[1]))return ba(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return vR(i[1],e,r,i[0])}function Ki(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Oe[r]==null){e<0&&(e=r);continue}if(Oe[r]==t){e=r;break}}e<0&&(e=391)}return Oe[e]=t,e}function Wf(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ki(t[e],e)}function Xo(){Oe=ZD()}var yR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},HE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xR(t){var e=typeof t=="number"?Oe[t]:t;return e=e.replace(HE,"(\\d+)"),new RegExp("^"+e+"$")}function wR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(HE)||[]).forEach(function(f,d){var p=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":a=p;break;case"s":c=p;break;case"m":a>=0?o=p:i=p;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?h:l+"T"+h}var ER=function(){var t={};t.version="1.2.0";function e(){for(var x=0,w=new Array(256),E=0;E!=256;++E)x=E,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,w[E]=x;return typeof Int32Array<"u"?new Int32Array(w):w}var r=e();function n(x){var w=0,E=0,C=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)D[C]=x[C];for(C=0;C!=256;++C)for(E=x[C],w=256+C;w<4096;w+=256)E=D[w]=E>>>8^x[E&255];var S=[];for(C=1;C!=16;++C)S[C-1]=typeof Int32Array<"u"?D.subarray(C*256,C*256+256):D.slice(C*256,C*256+256);return S}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],h=i[5],f=i[6],d=i[7],p=i[8],v=i[9],m=i[10],_=i[11],T=i[12],A=i[13],b=i[14];function N(x,w){for(var E=w^-1,C=0,D=x.length;C<D;)E=E>>>8^r[(E^x.charCodeAt(C++))&255];return~E}function B(x,w){for(var E=w^-1,C=x.length-15,D=0;D<C;)E=b[x[D++]^E&255]^A[x[D++]^E>>8&255]^T[x[D++]^E>>16&255]^_[x[D++]^E>>>24]^m[x[D++]]^v[x[D++]]^p[x[D++]]^d[x[D++]]^f[x[D++]]^h[x[D++]]^l[x[D++]]^c[x[D++]]^o[x[D++]]^a[x[D++]]^s[x[D++]]^r[x[D++]];for(C+=15;D<C;)E=E>>>8^r[(E^x[D++])&255];return~E}function M(x,w){for(var E=w^-1,C=0,D=x.length,S=0,R=0;C<D;)S=x.charCodeAt(C++),S<128?E=E>>>8^r[(E^S)&255]:S<2048?(E=E>>>8^r[(E^(192|S>>6&31))&255],E=E>>>8^r[(E^(128|S&63))&255]):S>=55296&&S<57344?(S=(S&1023)+64,R=x.charCodeAt(C++)&1023,E=E>>>8^r[(E^(240|S>>8&7))&255],E=E>>>8^r[(E^(128|S>>2&63))&255],E=E>>>8^r[(E^(128|R>>6&15|(S&3)<<4))&255],E=E>>>8^r[(E^(128|R&63))&255]):(E=E>>>8^r[(E^(224|S>>12&15))&255],E=E>>>8^r[(E^(128|S>>6&63))&255],E=E>>>8^r[(E^(128|S&63))&255]);return~E}return t.table=r,t.bstr=N,t.buf=B,t.str=M,t}(),De=function(){var e={};e.version="1.2.1";function r(I,O){for(var P=I.split("/"),F=O.split("/"),L=0,V=0,K=Math.min(P.length,F.length);L<K;++L){if(V=P[L].length-F[L].length)return V;if(P[L]!=F[L])return P[L]<F[L]?-1:1}return P.length-F.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var O=I.lastIndexOf("/");return O===-1?I:I.slice(0,O+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var O=I.lastIndexOf("/");return O===-1?I:I.slice(O+1)}function s(I,O){typeof O=="string"&&(O=new Date(O));var P=O.getHours();P=P<<6|O.getMinutes(),P=P<<5|O.getSeconds()>>>1,I.write_shift(2,P);var F=O.getFullYear()-1980;F=F<<4|O.getMonth()+1,F=F<<5|O.getDate(),I.write_shift(2,F)}function a(I){var O=I.read_shift(2)&65535,P=I.read_shift(2)&65535,F=new Date,L=P&31;P>>>=5;var V=P&15;P>>>=4,F.setMilliseconds(0),F.setFullYear(P+1980),F.setMonth(V-1),F.setDate(L);var K=O&31;O>>>=5;var J=O&63;return O>>>=6,F.setHours(O),F.setMinutes(J),F.setSeconds(K<<1),F}function o(I){Pr(I,0);for(var O={},P=0;I.l<=I.length-4;){var F=I.read_shift(2),L=I.read_shift(2),V=I.l+L,K={};switch(F){case 21589:P=I.read_shift(1),P&1&&(K.mtime=I.read_shift(4)),L>5&&(P&2&&(K.atime=I.read_shift(4)),P&4&&(K.ctime=I.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}I.l=V,O[F]=K}return O}var c;function l(){return c||(c={})}function h(I,O){if(I[0]==80&&I[1]==75)return Lc(I,O);if((I[0]|32)==109&&(I[1]|32)==105)return Js(I,O);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var P=3,F=512,L=0,V=0,K=0,J=0,q=0,X=[],Y=I.slice(0,512);Pr(Y,0);var ce=f(Y);switch(P=ce[0],P){case 3:F=512;break;case 4:F=4096;break;case 0:if(ce[1]==0)return Lc(I,O);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}F!==512&&(Y=I.slice(0,F),Pr(Y,28));var pe=I.slice(0,F);d(Y,P);var Se=Y.read_shift(4,"i");if(P===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);Y.l+=4,K=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),J=Y.read_shift(4,"i"),L=Y.read_shift(4,"i"),q=Y.read_shift(4,"i"),V=Y.read_shift(4,"i");for(var ge=-1,Ee=0;Ee<109&&(ge=Y.read_shift(4,"i"),!(ge<0));++Ee)X[Ee]=ge;var Me=p(I,F);_(q,V,Me,F,X);var wt=A(Me,K,X,F);wt[K].name="!Directory",L>0&&J!==R&&(wt[J].name="!MiniFAT"),wt[X[0]].name="!FAT",wt.fat_addrs=X,wt.ssz=F;var mr={},bt=[],Xt=[],Vi=[];b(K,wt,Me,bt,L,mr,Xt,J),v(Xt,Vi,bt),bt.shift();var ta={FileIndex:Xt,FullPaths:Vi};return O&&O.raw&&(ta.raw={header:pe,sectors:Me}),ta}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(oe,"Header Signature: "),I.l+=16;var O=I.read_shift(2,"u");return[I.read_shift(2,"u"),O]}function d(I,O){var P=9;switch(I.l+=2,P=I.read_shift(2)){case 9:if(O!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(O!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function p(I,O){for(var P=Math.ceil(I.length/O)-1,F=[],L=1;L<P;++L)F[L-1]=I.slice(L*O,(L+1)*O);return F[P-1]=I.slice(P*O),F}function v(I,O,P){for(var F=0,L=0,V=0,K=0,J=0,q=P.length,X=[],Y=[];F<q;++F)X[F]=Y[F]=F,O[F]=P[F];for(;J<Y.length;++J)F=Y[J],L=I[F].L,V=I[F].R,K=I[F].C,X[F]===F&&(L!==-1&&X[L]!==L&&(X[F]=X[L]),V!==-1&&X[V]!==V&&(X[F]=X[V])),K!==-1&&(X[K]=F),L!==-1&&F!=X[F]&&(X[L]=X[F],Y.lastIndexOf(L)<J&&Y.push(L)),V!==-1&&F!=X[F]&&(X[V]=X[F],Y.lastIndexOf(V)<J&&Y.push(V));for(F=1;F<q;++F)X[F]===F&&(V!==-1&&X[V]!==V?X[F]=X[V]:L!==-1&&X[L]!==L&&(X[F]=X[L]));for(F=1;F<q;++F)if(I[F].type!==0){if(J=F,J!=X[J])do J=X[J],O[F]=O[J]+"/"+O[F];while(J!==0&&X[J]!==-1&&J!=X[J]);X[F]=-1}for(O[0]+="/",F=1;F<q;++F)I[F].type!==2&&(O[F]+="/")}function m(I,O,P){for(var F=I.start,L=I.size,V=[],K=F;P&&L>0&&K>=0;)V.push(O.slice(K*S,K*S+S)),L-=S,K=_a(P,K*4);return V.length===0?ee(0):wr(V).slice(0,I.size)}function _(I,O,P,F,L){var V=R;if(I===R){if(O!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var K=P[I],J=(F>>>2)-1;if(!K)return;for(var q=0;q<J&&(V=_a(K,q*4))!==R;++q)L.push(V);_(_a(K,F-4),O-1,P,F,L)}}function T(I,O,P,F,L){var V=[],K=[];L||(L=[]);var J=F-1,q=0,X=0;for(q=O;q>=0;){L[q]=!0,V[V.length]=q,K.push(I[q]);var Y=P[Math.floor(q*4/F)];if(X=q*4&J,F<4+X)throw new Error("FAT boundary crossed: "+q+" 4 "+F);if(!I[Y])break;q=_a(I[Y],X)}return{nodes:V,data:zw([K])}}function A(I,O,P,F){var L=I.length,V=[],K=[],J=[],q=[],X=F-1,Y=0,ce=0,pe=0,Se=0;for(Y=0;Y<L;++Y)if(J=[],pe=Y+O,pe>=L&&(pe-=L),!K[pe]){q=[];var ge=[];for(ce=pe;ce>=0;){ge[ce]=!0,K[ce]=!0,J[J.length]=ce,q.push(I[ce]);var Ee=P[Math.floor(ce*4/F)];if(Se=ce*4&X,F<4+Se)throw new Error("FAT boundary crossed: "+ce+" 4 "+F);if(!I[Ee]||(ce=_a(I[Ee],Se),ge[ce]))break}V[pe]={nodes:J,data:zw([q])}}return V}function b(I,O,P,F,L,V,K,J){for(var q=0,X=F.length?2:0,Y=O[I].data,ce=0,pe=0,Se;ce<Y.length;ce+=128){var ge=Y.slice(ce,ce+128);Pr(ge,64),pe=ge.read_shift(2),Se=Gf(ge,0,pe-X),F.push(Se);var Ee={name:Se,type:ge.read_shift(1),color:ge.read_shift(1),L:ge.read_shift(4,"i"),R:ge.read_shift(4,"i"),C:ge.read_shift(4,"i"),clsid:ge.read_shift(16),state:ge.read_shift(4,"i"),start:0,size:0},Me=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);Me!==0&&(Ee.ct=N(ge,ge.l-8));var wt=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);wt!==0&&(Ee.mt=N(ge,ge.l-8)),Ee.start=ge.read_shift(4,"i"),Ee.size=ge.read_shift(4,"i"),Ee.size<0&&Ee.start<0&&(Ee.size=Ee.type=0,Ee.start=R,Ee.name=""),Ee.type===5?(q=Ee.start,L>0&&q!==R&&(O[q].name="!StreamData")):Ee.size>=4096?(Ee.storage="fat",O[Ee.start]===void 0&&(O[Ee.start]=T(P,Ee.start,O.fat_addrs,O.ssz)),O[Ee.start].name=Ee.name,Ee.content=O[Ee.start].data.slice(0,Ee.size)):(Ee.storage="minifat",Ee.size<0?Ee.size=0:q!==R&&Ee.start!==R&&O[q]&&(Ee.content=m(Ee,O[q].data,(O[J]||{}).data))),Ee.content&&Pr(Ee.content,0),V[Se]=Ee,K.push(Ee)}}function N(I,O){return new Date((xr(I,O+4)/1e7*Math.pow(2,32)+xr(I,O)/1e7-11644473600)*1e3)}function B(I,O){return l(),h(c.readFileSync(I),O)}function M(I,O){var P=O&&O.type;switch(P||Qe&&Buffer.isBuffer(I)&&(P="buffer"),P||"base64"){case"file":return B(I,O);case"base64":return h(xn(En(I)),O);case"binary":return h(xn(I),O)}return h(I,O)}function x(I,O){var P=O||{},F=P.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=F+"/",I.FileIndex[0]={name:F,type:5}),P.CLSID&&(I.FileIndex[0].clsid=P.CLSID),w(I)}function w(I){var O="Sh33tJ5";if(!De.find(I,"/"+O)){var P=ee(4);P[0]=55,P[1]=P[3]=50,P[2]=54,I.FileIndex.push({name:O,type:2,content:P,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+O),E(I)}}function E(I,O){x(I);for(var P=!1,F=!1,L=I.FullPaths.length-1;L>=0;--L){var V=I.FileIndex[L];switch(V.type){case 0:F?P=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:F=!0,isNaN(V.R*V.L*V.C)&&(P=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!O)){var K=new Date(1987,1,19),J=0,q=Object.create?Object.create(null):{},X=[];for(L=0;L<I.FullPaths.length;++L)q[I.FullPaths[L]]=!0,I.FileIndex[L].type!==0&&X.push([I.FullPaths[L],I.FileIndex[L]]);for(L=0;L<X.length;++L){var Y=n(X[L][0]);F=q[Y],F||(X.push([Y,{name:i(Y).replace("/",""),type:1,clsid:Ie,ct:K,mt:K,content:null}]),q[Y]=!0)}for(X.sort(function(Se,ge){return r(Se[0],ge[0])}),I.FullPaths=[],I.FileIndex=[],L=0;L<X.length;++L)I.FullPaths[L]=X[L][0],I.FileIndex[L]=X[L][1];for(L=0;L<X.length;++L){var ce=I.FileIndex[L],pe=I.FullPaths[L];if(ce.name=i(pe).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||Ie,L===0)ce.C=X.length>1?1:-1,ce.size=0,ce.type=5;else if(pe.slice(-1)=="/"){for(J=L+1;J<X.length&&n(I.FullPaths[J])!=pe;++J);for(ce.C=J>=X.length?-1:J,J=L+1;J<X.length&&n(I.FullPaths[J])!=n(pe);++J);ce.R=J>=X.length?-1:J,ce.type=1}else n(I.FullPaths[L+1]||"")==n(pe)&&(ce.R=L+1),ce.type=2}}}function C(I,O){var P=O||{};if(P.fileType=="mad")return oh(I,P);switch(E(I),P.fileType){case"zip":return Qs(I,P)}var F=function(Se){for(var ge=0,Ee=0,Me=0;Me<Se.FileIndex.length;++Me){var wt=Se.FileIndex[Me];if(wt.content){var mr=wt.content.length;mr>0&&(mr<4096?ge+=mr+63>>6:Ee+=mr+511>>9)}}for(var bt=Se.FullPaths.length+3>>2,Xt=ge+7>>3,Vi=ge+127>>7,ta=Xt+Ee+bt+Vi,mi=ta+127>>7,lo=mi<=109?0:Math.ceil((mi-109)/127);ta+mi+lo+127>>7>mi;)lo=++mi<=109?0:Math.ceil((mi-109)/127);var kn=[1,lo,mi,Vi,bt,Ee,ge,0];return Se.FileIndex[0].size=ge<<6,kn[7]=(Se.FileIndex[0].start=kn[0]+kn[1]+kn[2]+kn[3]+kn[4]+kn[5])+(kn[6]+7>>3),kn}(I),L=ee(F[7]<<9),V=0,K=0;{for(V=0;V<8;++V)L.write_shift(1,se[V]);for(V=0;V<8;++V)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),V=0;V<3;++V)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,F[2]),L.write_shift(4,F[0]+F[1]+F[2]+F[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,F[3]?F[0]+F[1]+F[2]-1:R),L.write_shift(4,F[3]),L.write_shift(-4,F[1]?F[0]-1:R),L.write_shift(4,F[1]),V=0;V<109;++V)L.write_shift(-4,V<F[2]?F[1]+V:-1)}if(F[1])for(K=0;K<F[1];++K){for(;V<236+K*127;++V)L.write_shift(-4,V<F[2]?F[1]+V:-1);L.write_shift(-4,K===F[1]-1?R:K+1)}var J=function(Se){for(K+=Se;V<K-1;++V)L.write_shift(-4,V+1);Se&&(++V,L.write_shift(-4,R))};for(K=V=0,K+=F[1];V<K;++V)L.write_shift(-4,xe.DIFSECT);for(K+=F[2];V<K;++V)L.write_shift(-4,xe.FATSECT);J(F[3]),J(F[4]);for(var q=0,X=0,Y=I.FileIndex[0];q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=K,J(X+511>>9)));for(J(F[6]+7>>3);L.l&511;)L.write_shift(-4,xe.ENDOFCHAIN);for(K=V=0,q=0;q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=K,J(X+63>>6)));for(;L.l&511;)L.write_shift(-4,xe.ENDOFCHAIN);for(V=0;V<F[4]<<2;++V){var ce=I.FullPaths[V];if(!ce||ce.length===0){for(q=0;q<17;++q)L.write_shift(4,0);for(q=0;q<3;++q)L.write_shift(4,-1);for(q=0;q<12;++q)L.write_shift(4,0);continue}Y=I.FileIndex[V],V===0&&(Y.start=Y.size?Y.start-1:R);var pe=V===0&&P.root||Y.name;if(X=2*(pe.length+1),L.write_shift(64,pe,"utf16le"),L.write_shift(2,X),L.write_shift(1,Y.type),L.write_shift(1,Y.color),L.write_shift(-4,Y.L),L.write_shift(-4,Y.R),L.write_shift(-4,Y.C),Y.clsid)L.write_shift(16,Y.clsid,"hex");else for(q=0;q<4;++q)L.write_shift(4,0);L.write_shift(4,Y.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,Y.start),L.write_shift(4,Y.size),L.write_shift(4,0)}for(V=1;V<I.FileIndex.length;++V)if(Y=I.FileIndex[V],Y.size>=4096)if(L.l=Y.start+1<<9,Qe&&Buffer.isBuffer(Y.content))Y.content.copy(L,L.l,0,Y.size),L.l+=Y.size+511&-512;else{for(q=0;q<Y.size;++q)L.write_shift(1,Y.content[q]);for(;q&511;++q)L.write_shift(1,0)}for(V=1;V<I.FileIndex.length;++V)if(Y=I.FileIndex[V],Y.size>0&&Y.size<4096)if(Qe&&Buffer.isBuffer(Y.content))Y.content.copy(L,L.l,0,Y.size),L.l+=Y.size+63&-64;else{for(q=0;q<Y.size;++q)L.write_shift(1,Y.content[q]);for(;q&63;++q)L.write_shift(1,0)}if(Qe)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function D(I,O){var P=I.FullPaths.map(function(q){return q.toUpperCase()}),F=P.map(function(q){var X=q.split("/");return X[X.length-(q.slice(-1)=="/"?2:1)]}),L=!1;O.charCodeAt(0)===47?(L=!0,O=P[0].slice(0,-1)+O):L=O.indexOf("/")!==-1;var V=O.toUpperCase(),K=L===!0?P.indexOf(V):F.indexOf(V);if(K!==-1)return I.FileIndex[K];var J=!V.match($l);for(V=V.replace(Wr,""),J&&(V=V.replace($l,"!")),K=0;K<P.length;++K)if((J?P[K].replace($l,"!"):P[K]).replace(Wr,"")==V||(J?F[K].replace($l,"!"):F[K]).replace(Wr,"")==V)return I.FileIndex[K];return null}var S=64,R=-2,oe="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],Ie="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ie,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Pe(I,O,P){l();var F=C(I,P);c.writeFileSync(O,F)}function de(I){for(var O=new Array(I.length),P=0;P<I.length;++P)O[P]=String.fromCharCode(I[P]);return O.join("")}function Ae(I,O){var P=C(I,O);switch(O&&O.type||"buffer"){case"file":return l(),c.writeFileSync(O.filename,P),P;case"binary":return typeof P=="string"?P:de(P);case"base64":return eu(typeof P=="string"?P:de(P));case"buffer":if(Qe)return Buffer.isBuffer(P)?P:Qi(P);case"array":return typeof P=="string"?xn(P):P}return P}var re;function j(I){try{var O=I.InflateRaw,P=new O;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)re=I;else throw new Error("zlib does not expose bytesRead")}catch(F){console.error("cannot use native zlib: "+(F.message||F))}}function G(I,O){if(!re)return nh(I,O);var P=re.InflateRaw,F=new P,L=F._processChunk(I.slice(I.l),F._finishFlushFlag);return I.l+=F.bytesRead,L}function H(I){return re?re.deflateRawSync(I):ze(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],te=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(I){var O=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(O>>16|O>>8|O)&255}for(var fe=typeof Uint8Array<"u",ne=fe?new Uint8Array(256):[],Be=0;Be<256;++Be)ne[Be]=ue(Be);function U(I,O){var P=ne[I&255];return O<=8?P>>>8-O:(P=P<<8|ne[I>>8&255],O<=16?P>>>16-O:(P=P<<8|ne[I>>16&255],P>>>24-O))}function st(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=6?0:I[F+1]<<8))>>>P&3}function He(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=5?0:I[F+1]<<8))>>>P&7}function at(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=4?0:I[F+1]<<8))>>>P&15}function Xe(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=3?0:I[F+1]<<8))>>>P&31}function Te(I,O){var P=O&7,F=O>>>3;return(I[F]|(P<=1?0:I[F+1]<<8))>>>P&127}function Lt(I,O,P){var F=O&7,L=O>>>3,V=(1<<P)-1,K=I[L]>>>F;return P<8-F||(K|=I[L+1]<<8-F,P<16-F)||(K|=I[L+2]<<16-F,P<24-F)||(K|=I[L+3]<<24-F),K&V}function Qr(I,O,P){var F=O&7,L=O>>>3;return F<=5?I[L]|=(P&7)<<F:(I[L]|=P<<F&255,I[L+1]=(P&7)>>8-F),O+3}function un(I,O,P){var F=O&7,L=O>>>3;return P=(P&1)<<F,I[L]|=P,O+1}function hn(I,O,P){var F=O&7,L=O>>>3;return P<<=F,I[L]|=P&255,P>>>=8,I[L+1]=P,O+8}function us(I,O,P){var F=O&7,L=O>>>3;return P<<=F,I[L]|=P&255,P>>>=8,I[L+1]=P&255,I[L+2]=P>>>8,O+16}function di(I,O){var P=I.length,F=2*P>O?2*P:O+5,L=0;if(P>=O)return I;if(Qe){var V=Aw(F);if(I.copy)I.copy(V);else for(;L<I.length;++L)V[L]=I[L];return V}else if(fe){var K=new Uint8Array(F);if(K.set)K.set(I);else for(;L<P;++L)K[L]=I[L];return K}return I.length=F,I}function Ar(I){for(var O=new Array(I),P=0;P<I;++P)O[P]=0;return O}function fn(I,O,P){var F=1,L=0,V=0,K=0,J=0,q=I.length,X=fe?new Uint16Array(32):Ar(32);for(V=0;V<32;++V)X[V]=0;for(V=q;V<P;++V)I[V]=0;q=I.length;var Y=fe?new Uint16Array(q):Ar(q);for(V=0;V<q;++V)X[L=I[V]]++,F<L&&(F=L),Y[V]=0;for(X[0]=0,V=1;V<=F;++V)X[V+16]=J=J+X[V-1]<<1;for(V=0;V<q;++V)J=I[V],J!=0&&(Y[V]=X[J+16]++);var ce=0;for(V=0;V<q;++V)if(ce=I[V],ce!=0)for(J=U(Y[V],F)>>F-ce,K=(1<<F+4-ce)-1;K>=0;--K)O[J|K<<ce]=ce&15|V<<4;return F}var Cn=fe?new Uint16Array(512):Ar(512),jt=fe?new Uint16Array(32):Ar(32);if(!fe){for(var ft=0;ft<512;++ft)Cn[ft]=0;for(ft=0;ft<32;++ft)jt[ft]=0}(function(){for(var I=[],O=0;O<32;O++)I.push(5);fn(I,jt,32);var P=[];for(O=0;O<=143;O++)P.push(8);for(;O<=255;O++)P.push(9);for(;O<=279;O++)P.push(7);for(;O<=287;O++)P.push(8);fn(P,Cn,288)})();var Jr=function(){for(var O=fe?new Uint8Array(32768):[],P=0,F=0;P<me.length-1;++P)for(;F<me[P+1];++F)O[F]=P;for(;F<32768;++F)O[F]=29;var L=fe?new Uint8Array(259):[];for(P=0,F=0;P<te.length-1;++P)for(;F<te[P+1];++F)L[F]=P;function V(J,q){for(var X=0;X<J.length;){var Y=Math.min(65535,J.length-X),ce=X+Y==J.length;for(q.write_shift(1,+ce),q.write_shift(2,Y),q.write_shift(2,~Y&65535);Y-- >0;)q[q.l++]=J[X++]}return q.l}function K(J,q){for(var X=0,Y=0,ce=fe?new Uint16Array(32768):[];Y<J.length;){var pe=Math.min(65535,J.length-Y);if(pe<10){for(X=Qr(q,X,+(Y+pe==J.length)),X&7&&(X+=8-(X&7)),q.l=X/8|0,q.write_shift(2,pe),q.write_shift(2,~pe&65535);pe-- >0;)q[q.l++]=J[Y++];X=q.l*8;continue}X=Qr(q,X,+(Y+pe==J.length)+2);for(var Se=0;pe-- >0;){var ge=J[Y];Se=(Se<<5^ge)&32767;var Ee=-1,Me=0;if((Ee=ce[Se])&&(Ee|=Y&-32768,Ee>Y&&(Ee-=32768),Ee<Y))for(;J[Ee+Me]==J[Y+Me]&&Me<250;)++Me;if(Me>2){ge=L[Me],ge<=22?X=hn(q,X,ne[ge+1]>>1)-1:(hn(q,X,3),X+=5,hn(q,X,ne[ge-23]>>5),X+=3);var wt=ge<8?0:ge-4>>2;wt>0&&(us(q,X,Me-te[ge]),X+=wt),ge=O[Y-Ee],X=hn(q,X,ne[ge]>>3),X-=3;var mr=ge<4?0:ge-2>>1;mr>0&&(us(q,X,Y-Ee-me[ge]),X+=mr);for(var bt=0;bt<Me;++bt)ce[Se]=Y&32767,Se=(Se<<5^J[Y])&32767,++Y;pe-=Me-1}else ge<=143?ge=ge+48:X=un(q,X,1),X=hn(q,X,ne[ge]),ce[Se]=Y&32767,++Y}X=hn(q,X,0)-1}return q.l=(X+7)/8|0,q.l}return function(q,X){return q.length<8?V(q,X):K(q,X)}}();function ze(I){var O=ee(50+Math.floor(I.length*1.1)),P=Jr(I,O);return O.slice(0,P)}var Nt=fe?new Uint16Array(32768):Ar(32768),nn=fe?new Uint16Array(32768):Ar(32768),Dt=fe?new Uint16Array(128):Ar(128),pi=1,Nc=1;function Mc(I,O){var P=Xe(I,O)+257;O+=5;var F=Xe(I,O)+1;O+=5;var L=at(I,O)+4;O+=4;for(var V=0,K=fe?new Uint8Array(19):Ar(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,X=fe?new Uint8Array(8):Ar(8),Y=fe?new Uint8Array(8):Ar(8),ce=K.length,pe=0;pe<L;++pe)K[W[pe]]=V=He(I,O),q<V&&(q=V),X[V]++,O+=3;var Se=0;for(X[0]=0,pe=1;pe<=q;++pe)Y[pe]=Se=Se+X[pe-1]<<1;for(pe=0;pe<ce;++pe)(Se=K[pe])!=0&&(J[pe]=Y[Se]++);var ge=0;for(pe=0;pe<ce;++pe)if(ge=K[pe],ge!=0){Se=ne[J[pe]]>>8-ge;for(var Ee=(1<<7-ge)-1;Ee>=0;--Ee)Dt[Se|Ee<<ge]=ge&7|pe<<3}var Me=[];for(q=1;Me.length<P+F;)switch(Se=Dt[Te(I,O)],O+=Se&7,Se>>>=3){case 16:for(V=3+st(I,O),O+=2,Se=Me[Me.length-1];V-- >0;)Me.push(Se);break;case 17:for(V=3+He(I,O),O+=3;V-- >0;)Me.push(0);break;case 18:for(V=11+Te(I,O),O+=7;V-- >0;)Me.push(0);break;default:Me.push(Se),q<Se&&(q=Se);break}var wt=Me.slice(0,P),mr=Me.slice(P);for(pe=P;pe<286;++pe)wt[pe]=0;for(pe=F;pe<30;++pe)mr[pe]=0;return pi=fn(wt,Nt,286),Nc=fn(mr,nn,30),O}function u0(I,O){if(I[0]==3&&!(I[1]&3))return[Ds(O),2];for(var P=0,F=0,L=Aw(O||1<<18),V=0,K=L.length>>>0,J=0,q=0;!(F&1);){if(F=He(I,P),P+=3,F>>>1)F>>1==1?(J=9,q=5):(P=Mc(I,P),J=pi,q=Nc);else{P&7&&(P+=8-(P&7));var X=I[P>>>3]|I[(P>>>3)+1]<<8;if(P+=32,X>0)for(!O&&K<V+X&&(L=di(L,V+X),K=L.length);X-- >0;)L[V++]=I[P>>>3],P+=8;continue}for(;;){!O&&K<V+32767&&(L=di(L,V+32767),K=L.length);var Y=Lt(I,P,J),ce=F>>>1==1?Cn[Y]:Nt[Y];if(P+=ce&15,ce>>>=4,!(ce>>>8&255))L[V++]=ce;else{if(ce==256)break;ce-=257;var pe=ce<8?0:ce-4>>2;pe>5&&(pe=0);var Se=V+te[ce];pe>0&&(Se+=Lt(I,P,pe),P+=pe),Y=Lt(I,P,q),ce=F>>>1==1?jt[Y]:nn[Y],P+=ce&15,ce>>>=4;var ge=ce<4?0:ce-2>>1,Ee=me[ce];for(ge>0&&(Ee+=Lt(I,P,ge),P+=ge),!O&&K<Se&&(L=di(L,Se+100),K=L.length);V<Se;)L[V]=L[V-Ee],++V}}}return O?[L,P+7>>>3]:[L.slice(0,V),P+7>>>3]}function nh(I,O){var P=I.slice(I.l||0),F=u0(P,O);return I.l+=F[1],F[0]}function ao(I,O){if(I)typeof console<"u"&&console.error(O);else throw new Error(O)}function Lc(I,O){var P=I;Pr(P,0);var F=[],L=[],V={FileIndex:F,FullPaths:L};x(V,{root:O.root});for(var K=P.length-4;(P[K]!=80||P[K+1]!=75||P[K+2]!=5||P[K+3]!=6)&&K>=0;)--K;P.l=K+4,P.l+=4;var J=P.read_shift(2);P.l+=6;var q=P.read_shift(4);for(P.l=q,K=0;K<J;++K){P.l+=20;var X=P.read_shift(4),Y=P.read_shift(4),ce=P.read_shift(2),pe=P.read_shift(2),Se=P.read_shift(2);P.l+=8;var ge=P.read_shift(4),Ee=o(P.slice(P.l+ce,P.l+ce+pe));P.l+=ce+pe+Se;var Me=P.l;P.l=ge+4,ih(P,X,Y,V,Ee),P.l=Me}return V}function ih(I,O,P,F,L){I.l+=2;var V=I.read_shift(2),K=I.read_shift(2),J=a(I);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var q=I.read_shift(4),X=I.read_shift(4),Y=I.read_shift(4),ce=I.read_shift(2),pe=I.read_shift(2),Se="",ge=0;ge<ce;++ge)Se+=String.fromCharCode(I[I.l++]);if(pe){var Ee=o(I.slice(I.l,I.l+pe));(Ee[21589]||{}).mt&&(J=Ee[21589].mt),((L||{})[21589]||{}).mt&&(J=L[21589].mt)}I.l+=pe;var Me=I.slice(I.l,I.l+X);switch(K){case 8:Me=G(I,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var wt=!1;V&8&&(q=I.read_shift(4),q==134695760&&(q=I.read_shift(4),wt=!0),X=I.read_shift(4),Y=I.read_shift(4)),X!=O&&ao(wt,"Bad compressed size: "+O+" != "+X),Y!=P&&ao(wt,"Bad uncompressed size: "+P+" != "+Y),co(F,Se,Me,{unsafe:!0,mt:J})}function Qs(I,O){var P=O||{},F=[],L=[],V=ee(1),K=P.compression?8:0,J=0,q=!1;q&&(J|=8);var X=0,Y=0,ce=0,pe=0,Se=I.FullPaths[0],ge=Se,Ee=I.FileIndex[0],Me=[],wt=0;for(X=1;X<I.FullPaths.length;++X)if(ge=I.FullPaths[X].slice(Se.length),Ee=I.FileIndex[X],!(!Ee.size||!Ee.content||ge=="Sh33tJ5")){var mr=ce,bt=ee(ge.length);for(Y=0;Y<ge.length;++Y)bt.write_shift(1,ge.charCodeAt(Y)&127);bt=bt.slice(0,bt.l),Me[pe]=ER.buf(Ee.content,0);var Xt=Ee.content;K==8&&(Xt=H(Xt)),V=ee(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,J),V.write_shift(2,K),Ee.mt?s(V,Ee.mt):V.write_shift(4,0),V.write_shift(-4,J&8?0:Me[pe]),V.write_shift(4,J&8?0:Xt.length),V.write_shift(4,J&8?0:Ee.content.length),V.write_shift(2,bt.length),V.write_shift(2,0),ce+=V.length,F.push(V),ce+=bt.length,F.push(bt),ce+=Xt.length,F.push(Xt),J&8&&(V=ee(12),V.write_shift(-4,Me[pe]),V.write_shift(4,Xt.length),V.write_shift(4,Ee.content.length),ce+=V.l,F.push(V)),V=ee(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,J),V.write_shift(2,K),V.write_shift(4,0),V.write_shift(-4,Me[pe]),V.write_shift(4,Xt.length),V.write_shift(4,Ee.content.length),V.write_shift(2,bt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,mr),wt+=V.l,L.push(V),wt+=bt.length,L.push(bt),++pe}return V=ee(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,pe),V.write_shift(2,pe),V.write_shift(4,wt),V.write_shift(4,ce),V.write_shift(2,0),wr([wr(F),wr(L),V])}var hs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Vc(I,O){if(I.ctype)return I.ctype;var P=I.name||"",F=P.match(/\.([^\.]+)$/);return F&&hs[F[1]]||O&&(F=(P=O).match(/[\.\\]([^\.\\])+$/),F&&hs[F[1]])?hs[F[1]]:"application/octet-stream"}function Li(I){for(var O=eu(I),P=[],F=0;F<O.length;F+=76)P.push(O.slice(F,F+76));return P.join(`\r
`)+`\r
`}function sh(I){var O=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});O=O.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),O.charAt(0)==`
`&&(O="=0D"+O.slice(1)),O=O.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],F=O.split(`\r
`),L=0;L<F.length;++L){var V=F[L];if(V.length==0){P.push("");continue}for(var K=0;K<V.length;){var J=76,q=V.slice(K,K+J);q.charAt(J-1)=="="?J--:q.charAt(J-2)=="="?J-=2:q.charAt(J-3)=="="&&(J-=3),q=V.slice(K,K+J),K+=J,K<V.length&&(q+="="),P.push(q)}}return P.join(`\r
`)}function oo(I){for(var O=[],P=0;P<I.length;++P){for(var F=I[P];P<=I.length&&F.charAt(F.length-1)=="=";)F=F.slice(0,F.length-1)+I[++P];O.push(F)}for(var L=0;L<O.length;++L)O[L]=O[L].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return xn(O.join(`\r
`))}function ah(I,O,P){for(var F="",L="",V="",K,J=0;J<10;++J){var q=O[J];if(!q||q.match(/^\s*$/))break;var X=q.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":F=X[2].trim();break;case"content-type":V=X[2].trim();break;case"content-transfer-encoding":L=X[2].trim();break}}switch(++J,L.toLowerCase()){case"base64":K=xn(En(O.slice(J).join("")));break;case"quoted-printable":K=oo(O.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var Y=co(I,F.slice(P.length),K,{unsafe:!0});V&&(Y.ctype=V)}function Js(I,O){if(de(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=O&&O.root||"",F=(Qe&&Buffer.isBuffer(I)?I.toString("binary"):de(I)).split(`\r
`),L=0,V="";for(L=0;L<F.length;++L)if(V=F[L],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),P||(P=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),V.slice(0,P.length)!=P););var K=(F[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var J="--"+(K[1]||""),q=[],X=[],Y={FileIndex:q,FullPaths:X};x(Y);var ce,pe=0;for(L=0;L<F.length;++L){var Se=F[L];Se!==J&&Se!==J+"--"||(pe++&&ah(Y,F.slice(ce,L),P),ce=L)}return Y}function oh(I,O){var P=O||{},F=P.boundary||"SheetJS";F="------="+F;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+F.slice(2)+'"',"","",""],V=I.FullPaths[0],K=V,J=I.FileIndex[0],q=1;q<I.FullPaths.length;++q)if(K=I.FullPaths[q].slice(V.length),J=I.FileIndex[q],!(!J.size||!J.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Me){return"_x"+Me.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Me){return"_u"+Me.charCodeAt(0).toString(16)+"_"});for(var X=J.content,Y=Qe&&Buffer.isBuffer(X)?X.toString("binary"):de(X),ce=0,pe=Math.min(1024,Y.length),Se=0,ge=0;ge<=pe;++ge)(Se=Y.charCodeAt(ge))>=32&&Se<128&&++ce;var Ee=ce>=pe*4/5;L.push(F),L.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+K),L.push("Content-Transfer-Encoding: "+(Ee?"quoted-printable":"base64")),L.push("Content-Type: "+Vc(J,K)),L.push(""),L.push(Ee?sh(Y):Li(Y))}return L.push(F+`--\r
`),L.join(`\r
`)}function Sr(I){var O={};return x(O,I),O}function co(I,O,P,F){var L=F&&F.unsafe;L||x(I);var V=!L&&De.find(I,O);if(!V){var K=I.FullPaths[0];O.slice(0,K.length)==K?K=O:(K.slice(-1)!="/"&&(K+="/"),K=(K+O).replace("//","/")),V={name:i(O),type:2},I.FileIndex.push(V),I.FullPaths.push(K),L||De.utils.cfb_gc(I)}return V.content=P,V.size=P?P.length:0,F&&(F.CLSID&&(V.clsid=F.CLSID),F.mt&&(V.mt=F.mt),F.ct&&(V.ct=F.ct)),V}function Zs(I,O){x(I);var P=De.find(I,O);if(P){for(var F=0;F<I.FileIndex.length;++F)if(I.FileIndex[F]==P)return I.FileIndex.splice(F,1),I.FullPaths.splice(F,1),!0}return!1}function ea(I,O,P){x(I);var F=De.find(I,O);if(F){for(var L=0;L<I.FileIndex.length;++L)if(I.FileIndex[L]==F)return I.FileIndex[L].name=i(P),I.FullPaths[L]=P,!0}return!1}function h0(I){E(I,!0)}return e.find=D,e.read=M,e.parse=h,e.write=Ae,e.writeFile=Pe,e.utils={cfb_new:Sr,cfb_add:co,cfb_del:Zs,cfb_mov:ea,cfb_gc:h0,ReadShift:zl,CheckField:cT,prep_blob:Pr,bconcat:wr,use_zlib:j,_deflateRaw:ze,_inflateRaw:nh,consts:xe},e}(),Vo;function TR(t){return typeof t=="string"?jf(t):Array.isArray(t)?XD(t):t}function du(t,e,r){if(typeof Vo<"u"&&Vo.writeFileSync)return r?Vo.writeFileSync(t,e,r):Vo.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=jf(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?Ii(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([TR(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Os(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function bR(t){if(typeof Vo<"u")return Vo.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Kt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function Ow(t,e){for(var r=[],n=Kt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function $f(t){for(var e=[],r=Kt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Hf(t){for(var e=[],r=Kt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function IR(t){for(var e=[],r=Kt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Rf=new Date(1899,11,30,0,0,0);function fr(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=Rf.getTime()+(t.getTimezoneOffset()-Rf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var zE=new Date,AR=Rf.getTime()+(zE.getTimezoneOffset()-Rf.getTimezoneOffset())*6e4,Nw=zE.getTimezoneOffset();function zf(t){var e=new Date;return e.setTime(t*24*60*60*1e3+AR),e.getTimezoneOffset()!==Nw&&e.setTime(e.getTime()+(e.getTimezoneOffset()-Nw)*6e4),e}function SR(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}e+=r*parseInt(i[s],10)}return e}var Mw=new Date("2017-02-19T19:06:09.000Z"),GE=isNaN(Mw.getFullYear())?new Date("2/19/17"):Mw,CR=GE.getFullYear()==2017;function Ft(t,e){var r=new Date(t);if(CR)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(GE.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ia(t,e){if(Qe&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return Ii(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return Ii(FE(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return Ii(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return Ii(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Ot(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Ot(t[r]));return e}function zt(t,e){for(var r="";r.length<e;)r+=t;return r}function oi(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var kR=["january","february","march","april","may","june","july","august","september","october","november","december"];function zo(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&kR.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var DR=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function qE(t){return t?t.content&&t.type?Ia(t.content,!0):t.data?Wl(t.data):t.asNodeBuffer&&Qe?Wl(t.asNodeBuffer().toString("binary")):t.asBinary?Wl(t.asBinary()):t._data&&t._data.getContent?Wl(Ia(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function KE(t){if(!t)return null;if(t.data)return _m(t.data);if(t.asNodeBuffer&&Qe)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?_m(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function RR(t){return t&&t.name.slice(-4)===".bin"?KE(t):qE(t)}function jn(t,e){for(var r=t.FullPaths||Kt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Mm(t,e){var r=jn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ir(t,e,r){if(!r)return RR(Mm(t,e));if(!e)return null;try{return ir(t,e)}catch{return null}}function wn(t,e,r){if(!r)return qE(Mm(t,e));if(!e)return null;try{return wn(t,e)}catch{return null}}function XE(t,e,r){if(!r)return KE(Mm(t,e));if(!e)return null;try{return XE(t,e)}catch{return null}}function Lw(t){for(var e=t.FullPaths||Kt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function qe(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Qe?n=Qi(r):n=YD(r),De.utils.cfb_add(t,e,n)}De.utils.cfb_add(t,e,r)}else t.file(e,r)}function Lm(){return De.utils.cfb_new()}function YE(t,e){switch(e.type){case"base64":return De.read(t,{type:"base64"});case"binary":return De.read(t,{type:"binary"});case"buffer":case"array":return De.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function Hl(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var er=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,PR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Vw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,FR=/<[^>]*>/g,zr=er.match(Vw)?Vw:FR,OR=/<\w*:/,NR=/<(\/?)\w+:/;function Ve(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(PR),o=0,c="",l=0,h="",f="",d=1;if(a)for(l=0;l!=a.length;++l){for(f=a[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+d,f.length-d),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,r||(n[h.toLowerCase()]=c);else{var p=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[p]&&h.slice(o-3,o)=="ext")continue;n[p]=c,r||(n[p.toLowerCase()]=c)}}return n}function Si(t){return t.replace(NR,"<$1")}var QE={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Vm=$f(QE),ot=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,c){return QE[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Bm=/[&<>'"]/g,MR=/[\u0000-\u0008\u000b-\u001f]/g;function yt(t){var e=t+"";return e.replace(Bm,function(r){return Vm[r]}).replace(MR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Bw(t){return yt(t).replace(/ /g,"_x0020_")}var JE=/[\u0000-\u001f]/g;function Um(t){var e=t+"";return e.replace(Bm,function(r){return Vm[r]}).replace(/\n/g,"<br/>").replace(JE,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function LR(t){var e=t+"";return e.replace(Bm,function(r){return Vm[r]}).replace(JE,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Uw=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function VR(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Pt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sm(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function jw(t){var e=Ds(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function Ww(t){return Qi(t,"binary").toString("utf8")}var _f="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Et=Qe&&(Ww(_f)==sm(_f)&&Ww||jw(_f)==sm(_f)&&jw)||sm,Ii=Qe?function(t){return Qi(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},ru=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),ZE=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),BR=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),UR=/<\/?(?:vt:)?variant>/g,jR=/<(?:vt:)([^>]*)>([\s\S]*)</;function $w(t,e){var r=Ve(t),n=t.match(BR(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(UR,"").match(jR);a&&i.push({v:Et(a[2]),t:a[1]})}),i}var eT=/(^\s|\s$|\n)/;function Fr(t,e){return"<"+t+(e.match(eT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function nu(t){return Kt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function ve(t,e,r){return"<"+t+(r!=null?nu(r):"")+(e!=null?(e.match(eT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function ym(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function WR(t,e){switch(typeof t){case"string":var r=ve("vt:lpwstr",yt(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return ve((t|0)==t?"vt:i4":"vt:r8",yt(String(t)));case"boolean":return ve("vt:bool",t?"true":"false")}if(t instanceof Date)return ve("vt:filetime",ym(t));throw new Error("Unable to serialize "+t)}function jm(t){if(Qe&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return Et(Os(Fm(t)));throw new Error("Bad input format: expected Buffer or string")}var iu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,hr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Da=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $R(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function HR(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var Hw=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},zw=Qe?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Qi(e)})):Hw(t)}:Hw,Gw=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Gi(t,i)));return n.join("").replace(Wr,"")},Gf=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Wr,""):Gw(t,e,r)}:Gw,qw=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},tT=Qe?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):qw(t,e,r)}:qw,Kw=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Lo(t,i)));return n.join("")},Yo=Qe?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):Kw(e,r,n)}:Kw,rT=function(t,e){var r=xr(t,e);return r>0?Yo(t,e+4,e+4+r-1):""},Wm=rT,nT=function(t,e){var r=xr(t,e);return r>0?Yo(t,e+4,e+4+r-1):""},$m=nT,iT=function(t,e){var r=2*xr(t,e);return r>0?Yo(t,e+4,e+4+r-1):""},Hm=iT,sT=function(e,r){var n=xr(e,r);return n>0?Gf(e,r+4,r+4+n):""},zm=sT,aT=function(t,e){var r=xr(t,e);return r>0?Yo(t,e+4,e+4+r):""},Gm=aT,oT=function(t,e){return $R(t,e)},Pf=oT,qm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Qe&&(Wm=function(e,r){if(!Buffer.isBuffer(e))return rT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},$m=function(e,r){if(!Buffer.isBuffer(e))return nT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Hm=function(e,r){if(!Buffer.isBuffer(e))return iT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},zm=function(e,r){if(!Buffer.isBuffer(e))return sT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Gm=function(e,r){if(!Buffer.isBuffer(e))return aT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Pf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):oT(e,r)},qm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function zR(){Gf=function(t,e,r){return gt.utils.decode(1200,t.slice(e,r)).replace(Wr,"")},Yo=function(t,e,r){return gt.utils.decode(65001,t.slice(e,r))},Wm=function(t,e){var r=xr(t,e);return r>0?gt.utils.decode(Ho,t.slice(e+4,e+4+r-1)):""},$m=function(t,e){var r=xr(t,e);return r>0?gt.utils.decode(Ai,t.slice(e+4,e+4+r-1)):""},Hm=function(t,e){var r=2*xr(t,e);return r>0?gt.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},zm=function(t,e){var r=xr(t,e);return r>0?gt.utils.decode(1200,t.slice(e+4,e+4+r)):""},Gm=function(t,e){var r=xr(t,e);return r>0?gt.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof gt<"u"&&zR();var Lo=function(t,e){return t[e]},Gi=function(t,e){return t[e+1]*256+t[e]},GR=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},xr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},_a=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},qR=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function zl(t,e){var r="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Qe&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Gi(this,l)),l+=2;t*=2;break;case"utf8":r=Yo(this,this.l,this.l+t);break;case"utf16le":t*=2,r=Gf(this,this.l,this.l+t);break;case"wstr":if(typeof gt<"u")r=gt.utils.decode(Ai,this.slice(this.l,this.l+2*t));else return zl.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=Wm(this,this.l),t=4+xr(this,this.l);break;case"lpstr-cp":r=$m(this,this.l),t=4+xr(this,this.l);break;case"lpwstr":r=Hm(this,this.l),t=4+2*xr(this,this.l);break;case"lpp4":t=4+xr(this,this.l),r=zm(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+xr(this,this.l),r=Gm(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=Lo(this,this.l+t++))!==0;)s.push(vf(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Gi(this,this.l+t))!==0;)s.push(vf(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Lo(this,l),this.l=l+1,o=zl.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(vf(Gi(this,l))),l+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof gt<"u"){r=gt.utils.decode(Ai,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=Lo(this,l),this.l=l+1,o=zl.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(vf(Lo(this,l))),l+=1}r=s.join("");break;default:switch(t){case 1:return n=Lo(this,this.l),this.l++,n;case 2:return n=(e==="i"?GR:Gi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?_a:qR)(this,this.l),this.l+=4,n):(i=xr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Pf(this,this.l):i=Pf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=tT(this,this.l,t);break}}return this.l+=t,r}var KR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},XR=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},YR=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function QR(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)YR(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof gt<"u"&&Ho==874)for(i=0;i!=e.length;++i){var s=gt.utils.encode(Ho,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,KR(this,e,this.l);break;case 8:if(n=8,r==="f"){HR(this,e,this.l);break}case 16:break;case-4:n=4,XR(this,e,this.l);break}return this.l+=n,this}function cT(t,e){var r=tT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Pr(t,e){t.l=e,t.read_shift=zl,t.chk=cT,t.write_shift=QR}function Hr(t,e){t.l+=e}function ee(t){var e=Ds(t);return Pr(e,0),e}function Ji(t,e,r){if(t){var n,i,s;Pr(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=uu[o]||uu[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;c=t.l+s;var h=l.f&&l.f(t,s,r);if(t.l=c,e(h,l,o))return}}}function cn(){var t=[],e=Qe?256:2048,r=function(l){var h=ee(l);return Pr(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,e)))},a=function(){return i(),wr(t)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ie(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=uu[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&qm(r)&&t.push(r)}}function Gl(t,e,r){var n=Ot(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Xw(t,e,r){var n=Ot(t);return n.s=Gl(n.s,e.s,r),n.e=Gl(n.e,e.s,r),n}function ql(t,e){if(t.cRel&&t.c<0)for(t=Ot(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Ot(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Le(t);return!t.cRel&&t.cRel!=null&&(r=eP(r)),!t.rRel&&t.rRel!=null&&(r=JR(r)),r}function am(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Bt(t.s.c)+":"+(t.e.cRel?"":"$")+Bt(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+Zt(t.s.r)+":"+(t.e.rRel?"":"$")+Zt(t.e.r):ql(t.s,e.biff)+":"+ql(t.e,e.biff)}function Km(t){return parseInt(ZR(t),10)-1}function Zt(t){return""+(t+1)}function JR(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function ZR(t){return t.replace(/\$(\d+)$/,"$1")}function Xm(t){for(var e=tP(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Bt(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function eP(t){return t.replace(/^([A-Z])/,"$$$1")}function tP(t){return t.replace(/^\$([A-Z])/,"$1")}function rP(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ut(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Le(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function ln(t){var e=t.indexOf(":");return e==-1?{s:Ut(t),e:Ut(t)}:{s:Ut(t.slice(0,e)),e:Ut(t.slice(e+1))}}function $e(t,e){return typeof e>"u"||typeof e=="number"?$e(t.s,t.e):(typeof t!="string"&&(t=Le(t)),typeof e!="string"&&(e=Le(e)),t==e?t:t+":"+e)}function ct(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function Yw(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Hn(t.z,r?fr(e):e)}catch{}try{return t.w=Hn((t.XF||{}).numFmtId||(r?14:0),r?fr(e):e)}catch{return""+e}}function Yi(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?Zi[t.v]||t.v:e==null?Yw(t,t.v):Yw(t,e))}function Ns(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function lT(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense;qt!=null&&i==null&&(i=qt);var s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=ct(s["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[f].length;++d)if(!(typeof e[f][d]>"u")){var p={v:e[f][d]},v=a+f,m=o+d;if(l.s.r>v&&(l.s.r=v),l.s.c>m&&(l.s.c=m),l.e.r<v&&(l.e.r=v),l.e.c<m&&(l.e.c=m),e[f][d]&&typeof e[f][d]=="object"&&!Array.isArray(e[f][d])&&!(e[f][d]instanceof Date))p=e[f][d];else if(Array.isArray(p.v)&&(p.f=e[f][d][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Oe[14],n.cellDates?(p.t="d",p.w=Hn(p.z,fr(p.v))):(p.t="n",p.v=fr(p.v),p.w=Hn(p.z,p.v))):p.t="s";if(i)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var _=Le({c:m,r:v});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return l.s.c<1e7&&(s["!ref"]=$e(l)),s}function Qo(t,e){return lT(null,t,e)}function nP(t){return t.read_shift(4,"i")}function ci(t,e){return e||(e=ee(4)),e.write_shift(4,t),e}function $r(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Er(t,e){var r=!1;return e==null&&(r=!0,e=ee(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function iP(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function sP(t,e){return e||(e=ee(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function Ym(t,e){var r=t.l,n=t.read_shift(1),i=$r(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(iP(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function aP(t,e){var r=!1;return e==null&&(r=!0,e=ee(15+4*t.t.length)),e.write_shift(1,0),Er(t.t,e),r?e.slice(0,e.l):e}var oP=Ym;function cP(t,e){var r=!1;return e==null&&(r=!0,e=ee(23+4*t.t.length)),e.write_shift(1,1),Er(t.t,e),e.write_shift(4,1),sP({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function zn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ra(t,e){return e==null&&(e=ee(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Pa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Fa(t,e){return e==null&&(e=ee(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var lP=$r,uT=Er;function Qm(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function Ff(t,e){var r=!1;return e==null&&(r=!0,e=ee(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var uP=$r,xm=Qm,Jm=Ff;function Zm(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Pf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):_a(e,0)>>2;return r?i/100:i}function hT(t,e){e==null&&(e=ee(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function fT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function hP(t,e){return e||(e=ee(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Oa=fT,Jo=hP;function jr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Aa(t,e){return(e||ee(8)).write_shift(8,t,"f")}function fP(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=xa[i];l&&(e.rgb=au(l));break;case 2:e.rgb=au([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Of(t,e){if(e||(e=ee(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function dP(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function pP(t,e){e||(e=ee(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function dT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function mP(t){return dT(t,1)}function gP(t){return dT(t,2)}var eg=2,on=3,yf=11,Qw=12,Nf=19;var xf=64,vP=65,_P=71;var yP=4108,xP=4126,yr=80,pT=81,wP=[yr,pT],wm={1:{n:"CodePage",t:eg},2:{n:"Category",t:yr},3:{n:"PresentationFormat",t:yr},4:{n:"ByteCount",t:on},5:{n:"LineCount",t:on},6:{n:"ParagraphCount",t:on},7:{n:"SlideCount",t:on},8:{n:"NoteCount",t:on},9:{n:"HiddenCount",t:on},10:{n:"MultimediaClipCount",t:on},11:{n:"ScaleCrop",t:yf},12:{n:"HeadingPairs",t:yP},13:{n:"TitlesOfParts",t:xP},14:{n:"Manager",t:yr},15:{n:"Company",t:yr},16:{n:"LinksUpToDate",t:yf},17:{n:"CharacterCount",t:on},19:{n:"SharedDoc",t:yf},22:{n:"HyperlinksChanged",t:yf},23:{n:"AppVersion",t:on,p:"version"},24:{n:"DigSig",t:vP},26:{n:"ContentType",t:yr},27:{n:"ContentStatus",t:yr},28:{n:"Language",t:yr},29:{n:"Version",t:yr},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}},Em={1:{n:"CodePage",t:eg},2:{n:"Title",t:yr},3:{n:"Subject",t:yr},4:{n:"Author",t:yr},5:{n:"Keywords",t:yr},6:{n:"Comments",t:yr},7:{n:"Template",t:yr},8:{n:"LastAuthor",t:yr},9:{n:"RevNumber",t:yr},10:{n:"EditTime",t:xf},11:{n:"LastPrinted",t:xf},12:{n:"CreatedDate",t:xf},13:{n:"ModifiedDate",t:xf},14:{n:"PageCount",t:on},15:{n:"WordCount",t:on},16:{n:"CharCount",t:on},17:{n:"Thumbnail",t:_P},18:{n:"Application",t:yr},19:{n:"DocSecurity",t:on},255:{},2147483648:{n:"Locale",t:Nf},2147483651:{n:"Behavior",t:Nf},1919054434:{}},Jw={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},EP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function TP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var bP=TP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),xa=Ot(bP),Zi={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},mT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Tm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},wf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function tg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IP(t){var e=tg();if(!t||!t.match)return e;var r={};if((t.match(zr)||[]).forEach(function(n){var i=Ve(n);switch(i[0].replace(OR,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Tm[i.ContentType]]!==void 0&&e[Tm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==hr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function gT(t,e){var r=IR(Tm),n=[],i;n[n.length]=er,n[n.length]=ve("Types",null,{xmlns:hr.CT,"xmlns:xsd":hr.xsd,"xmlns:xsi":hr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ve("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=ve("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:wf[c][e.bookType]||wf[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(l){n[n.length]=ve("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:wf[c][e.bookType]||wf[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(l){n[n.length]=ve("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ke={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function su(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function Kl(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(zr)||[]).forEach(function(i){var s=Ve(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:Hl(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function jo(t){var e=[er,ve("Relationships",null,{xmlns:hr.RELS})];return Kt(t["!id"]).forEach(function(r){e[e.length]=ve("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function _t(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,s?i.TargetMode=s:[Ke.HLINK,Ke.XPATH,Ke.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var AP="application/vnd.oasis.opendocument.spreadsheet";function SP(t,e){for(var r=jm(t),n,i;n=iu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Ve(n[0],!1),i.path=="/"&&i.type!==AP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function CP(t){var e=[er];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Zw(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function kP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function DP(t){var e=[er];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(Zw(t[r][0],t[r][1])),e.push(kP("",t[r][0]));return e.push(Zw("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function vT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Zl.version+"</meta:generator></office:meta></office:document-meta>"}var $n=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],RP=function(){for(var t=new Array($n.length),e=0;e<$n.length;++e){var r=$n[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function _T(t){var e={};t=Et(t);for(var r=0;r<$n.length;++r){var n=$n[r],i=t.match(RP[r]);i!=null&&i.length>0&&(e[n[1]]=ot(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Ft(e[n[1]]))}return e}function om(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=yt(e),n[n.length]=r?ve(t,e,r):Fr(t,e))}function yT(t,e){var r=e||{},n=[er,ve("cp:coreProperties",null,{"xmlns:cp":hr.CORE_PROPS,"xmlns:dc":hr.dc,"xmlns:dcterms":hr.dcterms,"xmlns:dcmitype":hr.dcmitype,"xmlns:xsi":hr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&om("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:ym(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&om("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:ym(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=$n.length;++s){var a=$n[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&om(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var wa=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],xT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function wT(t,e,r,n){var i=[];if(typeof t=="string")i=$w(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(h){return{v:h}}));var a=typeof e=="string"?$w(e,n).map(function(h){return h.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function PP(t,e,r){var n={};return e||(e={}),t=Et(t),wa.forEach(function(i){var s=(t.match(ru(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=ot(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&wT(n.HeadingPairs,n.TitlesOfParts,e,r),e}function ET(t){var e=[],r=ve;return t||(t={}),t.Application="SheetJS",e[e.length]=er,e[e.length]=ve("Properties",null,{xmlns:hr.EXT_PROPS,"xmlns:vt":hr.vt}),wa.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=yt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+yt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var FP=/<[^>]+>[^<]*/g;function OP(t,e){var r={},n="",i=t.match(FP);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=Ve(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ot(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),h=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=ot(h);break;case"bool":r[n]=Pt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Ft(h);break;case"cy":case"error":r[n]=ot(h);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function TT(t){var e=[er,ve("Properties",null,{xmlns:hr.CUST_PROPS,"xmlns:vt":hr.vt})];if(!t)return e.join("");var r=1;return Kt(t).forEach(function(i){++r,e[e.length]=ve("property",WR(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:yt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var bm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},cm;function NP(t,e,r){cm||(cm=$f(bm)),e=cm[e]||e,t[e]=r}function MP(t,e){var r=[];return Kt(bm).map(function(n){for(var i=0;i<$n.length;++i)if($n[i][1]==n)return $n[i];for(i=0;i<wa.length;++i)if(wa[i][1]==n)return wa[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Fr(bm[n[1]]||n[1],i))}}),ve("DocumentProperties",r.join(""),{xmlns:yn.o})}function LP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Kt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<$n.length;++a)if(s==$n[a][1])return;for(a=0;a<wa.length;++a)if(s==wa[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(ve(Bw(s),o,{"dt:dt":c}))}}),e&&Kt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(ve(Bw(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+yn.o+'">'+i.join("")+"</"+n+">"}function rg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function VP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=ee(8);return a.write_shift(4,n),a.write_shift(4,i),a}function bT(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function IT(t,e,r){var n=t.read_shift(0,"lpwstr");return r&&(t.l+=4-(n.length+1&3)&3),n}function AT(t,e,r){return e===31?IT(t):bT(t,e,r)}function Im(t,e,r){return AT(t,e,r===!1?0:4)}function BP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return AT(t,e,0)}function UP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Wr,""),t.l-i&2&&(t.l+=2)}return r}function jP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Wr,"");return r}function WP(t){var e=t.l,r=Mf(t,pT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Mf(t,on);return[r,n]}function $P(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(WP(t));return r}function eE(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Wr,"").replace($l,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function ST(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function HP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Mf(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==Qw&&n!==e&&wP.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===Qw?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return bT(t,n,4).replace(Wr,"");case 31:return IT(t);case 64:return rg(t);case 65:return ST(t);case 71:return HP(t);case 80:return Im(t,n,!s.raw).replace(Wr,"");case 81:return BP(t,n).replace(Wr,"");case 4108:return $P(t);case 4126:case 4127:return n==4127?UP(t):jP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function tE(t,e){var r=ee(4),n=ee(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ee(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=VP(e);break;case 31:case 80:for(n=ee(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return wr([r,n])}function rE(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var h=t.read_shift(4),f=t.read_shift(4);s[a]=[h,f+r]}s.sort(function(A,b){return A[1]-b[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var p=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,p=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],p=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(p=!1,t.l=s[a][1]),p)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=Mf(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:si(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=Mf(t,eg),si(o),c!==-1){var m=t.l;t.l=s[c][1],l=eE(t,o),t.l=m}}else if(s[a][0]===0){if(o===0){c=a,t.l=s[a+1][1];continue}l=eE(t,o)}else{var _=l[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=ST(t);break;case 30:t.l+=4,T=Im(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Im(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=Jt(t,4);break;case 64:t.l+=4,T=Ft(rg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=T}}return t.l=r+n,d}var CT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function nE(t,e,r){var n=ee(8),i=[],s=[],a=8,o=0,c=ee(8),l=ee(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!e){l=ee(8),l.write_shift(4,0),i.unshift(l);var h=[ee(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(c=ee(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=wr(h),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(CT.indexOf(t[o][0])>-1||xT.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],p=0;if(e){p=+e[t[o][0]];var v=r[p];if(v.p=="version"&&typeof d=="string"){var m=d.split(".");d=(+m[0]<<16)+(+m[1]||0)}c=tE(v.t,d)}else{var _=zP(d);_==-1&&(_=31,d=String(d)),c=tE(_,d)}s.push(c),l=ee(8),l.write_shift(4,e?p:2+o),i.push(l),a+=8+c.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),wr([n].concat(i).concat(s))}function iE(t,e,r){var n=t.content;if(!n)return{};Pr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),h=n.read_shift(16);if(h!==De.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var f=rE(n,e),d={SystemIdentifier:l};for(var p in f)d[p]=f[p];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=rE(n,null)}catch{}for(p in v)d[p]=v[p];return d.FMTID=[s,a],d}function sE(t,e,r,n,i,s){var a=ee(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,De.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=nE(t,r,n);if(o.push(c),i){var l=nE(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return wr(o)}function Ss(t,e){return t.read_shift(e),null}function GP(t,e){e||(e=ee(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function qP(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function Jt(t,e){return t.read_shift(e)===1}function tn(t,e){return e||(e=ee(2)),e.write_shift(2,+!!t),e}function sr(t){return t.read_shift(2,"u")}function Wn(t,e){return e||(e=ee(2)),e.write_shift(2,t),e}function kT(t,e){return qP(t,e,sr)}function KP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function DT(t,e,r){return r||(r=ee(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function pu(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=Ai;if(r&&r.biff>=8&&(Ai=1200),!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return Ai=s,o}function XP(t){var e=Ai;Ai=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,c,l={};s&&(o=t.read_shift(2)),i&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",f=r===0?"":t.read_shift(r,h);return s&&(t.l+=4*o),i&&(t.l+=c),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Ai=e,l}function YP(t){var e=t.t||"",r=1,n=ee(3+(r>1?2:0));n.write_shift(2,e.length),n.write_shift(1,(r>1?8:0)|1),r>1&&n.write_shift(2,r);var i=ee(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[n,i];return wr(s)}function Sa(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function mu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Sa(t,n,r)}function Na(t,e,r){if(r.biff>5)return mu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function RT(t,e,r){return r||(r=ee(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function QP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function JP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Wr,"");return n&&(t.l+=24),i}function ZP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Wr,"");return r+a}function eF(t,e){var r=t.read_shift(16);switch(e-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return JP(t,e);case"0303000000000000c000000000000046":return ZP(t,e);default:throw new Error("Unsupported Moniker "+r)}}function Ef(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Wr,""):"";return r}function aE(t,e){e||(e=ee(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function tF(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,c,l="",h,f;i&16&&(s=Ef(t,r-t.l)),i&128&&(a=Ef(t,r-t.l)),(i&257)===257&&(o=Ef(t,r-t.l)),(i&257)===1&&(c=eF(t,r-t.l)),i&8&&(l=Ef(t,r-t.l)),i&32&&(h=t.read_shift(16)),i&64&&(f=rg(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var p={Target:d};return h&&(p.guid=h),f&&(p.time=f),s&&(p.Tooltip=s),p}function rF(t){var e=ee(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),aE(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&aE(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function PT(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function FT(t,e){var r=PT(t,e);return r[3]=0,r}function Ci(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function Ca(t,e,r,n){return n||(n=ee(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function nF(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function iF(t,e,r){return e===0?"":Na(t,e,r)}function sF(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function OT(t){var e=t.read_shift(2),r=Zm(t);return[e,r]}function aF(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=pu(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function qf(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function NT(t,e){return e||(e=ee(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function MT(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var oF=MT;function LT(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function cF(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function lF(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function Lr(t){t.l+=2,t.l+=t.read_shift(2)}var uF={0:Lr,4:Lr,5:Lr,6:Lr,7:lF,8:Lr,9:Lr,10:Lr,11:Lr,12:Lr,13:cF,14:Lr,15:Lr,16:Lr,17:Lr,18:Lr,19:Lr,20:Lr,21:LT};function hF(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(uF[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Tf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function ng(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ee(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function fF(t,e){return e===0||t.read_shift(2),1200}function dF(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=Na(t,0,r);return t.read_shift(e+n-t.l),i}function pF(t,e){var r=!e||e.biff==8,n=ee(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function mF(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function gF(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=pu(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function vF(t,e){var r=!e||e.biff>=8?2:1,n=ee(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function _F(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(XP(t));return s.Count=n,s.Unique=i,s}function yF(t,e){var r=ee(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=YP(t[i],e);var s=wr([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function xF(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function wF(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function EF(t){var e=nF(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function TF(t){return t.read_shift(2),t.read_shift(4)}function oE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function bF(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function IF(){var t=ee(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function AF(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function SF(t){var e=ee(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function CF(){}function kF(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=pu(t,0,r),n}function DF(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ee(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function RF(t){var e=Ci(t);return e.isst=t.read_shift(4),e}function PF(t,e,r,n){var i=ee(10);return Ca(t,e,n,i),i.write_shift(4,r),i}function FF(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Ci(t,6);r.biff==2&&t.l++;var s=mu(t,n-t.l,r);return i.val=s,i}function OF(t,e,r,n,i){var s=!i||i.biff==8,a=ee(8+ +s+(1+s)*r.length);return Ca(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function NF(t,e,r){var n=t.read_shift(2),i=Na(t,0,r);return[n,i]}function MF(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var LF=Na;function cE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c}}}function VF(t,e){var r=e.biff==8||!e.biff?4:2,n=ee(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function BF(t){var e=t.read_shift(2),r=t.read_shift(2),n=OT(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function UF(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(OT(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function jF(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function WF(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return i.patternType=EP[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function $F(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=WF(t,e,n.fStyle,r),n}function lE(t,e,r,n){var i=r&&r.biff==5;n||(n=ee(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function HF(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function zF(t){var e=ee(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function uE(t,e,r){var n=Ci(t,6);(r.biff==2||e==9)&&++t.l;var i=KP(t,2);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function GF(t,e,r,n,i,s){var a=ee(8);return Ca(t,e,n,a),DT(r,s,a),a}function qF(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ci(t,6),i=jr(t,8);return n.val=i,n}function KF(t,e,r,n){var i=ee(14);return Ca(t,e,n,i),Aa(r,i),i}var hE=iF;function XF(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Sa(t,s),o=[];n>t.l;)o.push(mu(t));return[s,i,a,o]}function fE(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=aF(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var YF=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function dE(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Sa(t,a,r);i&32&&(l=YF[l.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var f=n==t.l||o===0||!(h>0)?[]:hL(t,h,r,o);return{chKey:s,Name:l,itab:c,rgce:f}}function VT(t,e,r){if(r.biff<8)return QF(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(sF(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function QF(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=pu(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function JF(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Sa(t,n,r),a=Sa(t,i,r);return[s,a]}function ZF(t,e,r){var n=MT(t,6);t.l++;var i=t.read_shift(1);return e-=8,[fL(t,e,r),i,n]}function pE(t,e,r){var n=oF(t,6);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,lL(t,e,r,n)]}function eO(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function tO(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=Na(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function rO(t,e,r){return tO(t,e,r)}function nO(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(qf(t,e));return r}function iO(t){var e=ee(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)NT(t[r],e);return e}function sO(t,e,r){if(r&&r.biff<8)return oO(t,e,r);var n=LT(t,22),i=hF(t,e-22,n[1]);return{cmo:n,ft:i}}var aO={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function oO(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((aO[n]||Hr)(t,e,r)),{cmo:[i,n,s],ft:a}}function cO(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=QP(t,6,r);var o=t.read_shift(2);t.read_shift(2),sr(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var h=t[t.l],f=Sa(t,t.lens[l+1]-t.lens[l]-1);if(i+=f,i.length>=(h?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function lO(t,e){var r=qf(t,8);t.l+=16;var n=tF(t,e-24);return[r,n]}function uO(t){var e=ee(24),r=Ut(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return wr([e,rF(t[1])])}function hO(t,e){t.read_shift(2);var r=qf(t,8),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Wr,""),[r,n]}function fO(t){var e=t[1].Tooltip,r=ee(10+2*(e.length+1));r.write_shift(2,2048);var n=Ut(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function dO(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=Jw[r]||r,r=t.read_shift(2),e[1]=Jw[r]||r,e}function pO(t){return t||(t=ee(4)),t.write_shift(2,1),t.write_shift(2,1),t}function mO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FT(t,8));return r}function gO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(FT(t,8));return r}function vO(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function BT(t,e,r){if(!r.cellStyles)return Hr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function _O(t,e){var r=ee(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function yO(t,e){var r={};return e<32||(t.l+=16,r.header=jr(t,8),r.footer=jr(t,8),t.l+=2),r}function xO(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function wO(t){for(var e=ee(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var EO=Ci,TO=kT,bO=mu;function IO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function AO(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ci(t,6);++t.l;var i=Na(t,e-7,r);return n.t="str",n.val=i,n}function SO(t){var e=Ci(t,6);++t.l;var r=jr(t,8);return e.t="n",e.val=r,e}function CO(t,e,r){var n=ee(15);return yu(n,t,e),n.write_shift(8,r,"f"),n}function kO(t){var e=Ci(t,6);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function DO(t,e,r){var n=ee(9);return yu(n,t,e),n.write_shift(2,r),n}function RO(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function PO(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function FO(t,e,r){var n=t.l+e,i=Ci(t,6),s=t.read_shift(2),a=Sa(t,s,r);return t.l=n,i.t="str",i.val=a,i}var OO=[2,3,48,49,131,139,140,245],Am=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=$f({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],h=Ds(1);switch(c.type){case"base64":h=xn(En(o));break;case"binary":h=xn(o);break;case"buffer":case"array":h=o;break}Pr(h,0);var f=h.read_shift(1),d=!!(f&136),p=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:p=!0,d=!0;break;case 49:p=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var m=0,_=521;f==2&&(m=h.read_shift(2)),h.l+=3,f!=2&&(m=h.read_shift(4)),m>1048576&&(m=1e6),f!=2&&(_=h.read_shift(2));var T=h.read_shift(2),A=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(A=t[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var b=[],N={},B=Math.min(h.length,f==2?521:_-10-(p?264:0)),M=v?32:11;h.l<B&&h[h.l]!=13;)switch(N={},N.name=gt.utils.decode(A,h.slice(h.l,h.l+M)).replace(/[\u0000\r\n].*$/g,""),h.l+=M,N.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(N.offset=h.read_shift(4)),N.len=h.read_shift(1),f==2&&(N.offset=h.read_shift(2)),N.dec=h.read_shift(1),N.name.length&&b.push(N),f!=2&&(h.l+=v?13:14),N.type){case"B":(!p||N.len!=8)&&c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+N.name+":"+N.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+N.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var x=0,w=0;for(l[0]=[],w=0;w!=b.length;++w)l[0][w]=b[w].name;for(;m-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,l[++x]=[],w=0,w=0;w!=b.length;++w){var E=h.slice(h.l,h.l+b[w].len);h.l+=b[w].len,Pr(E,0);var C=gt.utils.decode(A,E);switch(b[w].type){case"C":C.trim().length&&(l[x][w]=C.replace(/\s+$/,""));break;case"D":C.length===8?l[x][w]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):l[x][w]=C;break;case"F":l[x][w]=parseFloat(C.trim());break;case"+":case"I":l[x][w]=v?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":l[x][w]=!0;break;case"N":case"F":l[x][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[x][w]="##MEMO##"+(v?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(l[x][w]=+C||0);break;case"@":l[x][w]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":l[x][w]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":l[x][w]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[x][w]=-E.read_shift(-8,"f");break;case"B":if(p&&b[w].len==8){l[x][w]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[w].len;break;case"0":if(b[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[w].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=b,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=Qo(r(o,l),l);return h["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,h}function i(o,c){try{return Ns(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&si(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=cn(),f=Uf(o,{header:1,raw:!0,cellDates:!0}),d=f[0],p=f.slice(1),v=o["!cols"]||[],m=0,_=0,T=0,A=1;for(m=0;m<d.length;++m){if(((v[m]||{}).DBF||{}).name){d[m]=v[m].DBF.name,++T;continue}if(d[m]!=null){if(++T,typeof d[m]=="number"&&(d[m]=d[m].toString(10)),typeof d[m]!="string")throw new Error("DBF Invalid column name "+d[m]+" |"+typeof d[m]+"|");if(d.indexOf(d[m])!==m){for(_=0;_<1024;++_)if(d.indexOf(d[m]+"_"+_)==-1){d[m]+="_"+_;break}}}}var b=ct(o["!ref"]),N=[],B=[],M=[];for(m=0;m<=b.e.c-b.s.c;++m){var x="",w="",E=0,C=[];for(_=0;_<p.length;++_)p[_][m]!=null&&C.push(p[_][m]);if(C.length==0||d[m]==null){N[m]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=C[_]instanceof Date?"D":"C";break;default:w="C"}E=Math.max(E,String(C[_]).length),x=x&&x!=w?"C":w}E>250&&(E=250),w=((v[m]||{}).DBF||{}).type,w=="C"&&v[m].DBF.len>E&&(E=v[m].DBF.len),x=="B"&&w=="N"&&(x="N",M[m]=v[m].DBF.dec,E=v[m].DBF.len),B[m]=x=="C"||w=="N"?E:s[x]||0,A+=B[m],N[m]=x}var D=h.next(32);for(D.write_shift(4,318902576),D.write_shift(4,p.length),D.write_shift(2,296+32*T),D.write_shift(2,A),m=0;m<4;++m)D.write_shift(4,0);for(D.write_shift(4,0|(+e[Ho]||3)<<8),m=0,_=0;m<d.length;++m)if(d[m]!=null){var S=h.next(32),R=(d[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);S.write_shift(1,R,"sbcs"),S.write_shift(1,N[m]=="?"?"C":N[m],"sbcs"),S.write_shift(4,_),S.write_shift(1,B[m]||s[N[m]]||0),S.write_shift(1,M[m]||0),S.write_shift(1,2),S.write_shift(4,0),S.write_shift(1,0),S.write_shift(4,0),S.write_shift(4,0),_+=B[m]||s[N[m]]||0}var oe=h.next(264);for(oe.write_shift(4,13),m=0;m<65;++m)oe.write_shift(4,0);for(m=0;m<p.length;++m){var se=h.next(A);for(se.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(N[_]){case"L":se.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":se.write_shift(8,p[m][_]||0,"f");break;case"N":var Ie="0";for(typeof p[m][_]=="number"&&(Ie=p[m][_].toFixed(M[_]||0)),T=0;T<B[_]-Ie.length;++T)se.write_shift(1,32);se.write_shift(1,Ie,"sbcs");break;case"D":p[m][_]?(se.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(p[m][_]!=null?p[m][_]:"").slice(0,B[_]);for(se.write_shift(1,xe,"sbcs"),T=0;T<B[_]-xe.length;++T)se.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),UT=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Kt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,p){var v=t[p];return typeof v=="number"?Iw(v):v},n=function(d,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?d:Iw(m)};t["|"]=254;function i(d,p){switch(p.type){case"base64":return s(En(d),p);case"binary":return s(d,p);case"buffer":return s(Qe&&Buffer.isBuffer(d)?d.toString("binary"):Os(d),p);case"array":return s(Ia(d),p)}throw new Error("Unrecognized type "+p.type)}function s(d,p){var v=d.split(/[\n\r]+/),m=-1,_=-1,T=0,A=0,b=[],N=[],B=null,M={},x=[],w=[],E=[],C=0,D;for(+p.codepage>=0&&si(+p.codepage);T!==v.length;++T){C=0;var S=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=S.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),oe=R[0],se;if(S.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&N.push(S.slice(3).replace(/;;/g,";"));break;case"C":var Ie=!1,xe=!1,Pe=!1,de=!1,Ae=-1,re=-1;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"A":break;case"X":_=parseInt(R[A].slice(1))-1,xe=!0;break;case"Y":for(m=parseInt(R[A].slice(1))-1,xe||(_=0),D=b.length;D<=m;++D)b[D]=[];break;case"K":se=R[A].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(oi(se))?isNaN(zo(se).getDate())||(se=Ft(se)):(se=oi(se),B!==null&&Ko(B)&&(se=zf(se))),typeof gt<"u"&&typeof se=="string"&&(p||{}).type!="string"&&(p||{}).codepage&&(se=gt.utils.decode(p.codepage,se)),Ie=!0;break;case"E":de=!0;var j=Wo(R[A].slice(1),{r:m,c:_});b[m][_]=[b[m][_],j];break;case"S":Pe=!0,b[m][_]=[b[m][_],"S5S"];break;case"G":break;case"R":Ae=parseInt(R[A].slice(1))-1;break;case"C":re=parseInt(R[A].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+S)}if(Ie&&(b[m][_]&&b[m][_].length==2?b[m][_][0]=se:b[m][_]=se,B=null),Pe){if(de)throw new Error("SYLK shared formula cannot have own formula");var G=Ae>-1&&b[Ae][re];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");b[m][_][1]=ib(G[1],{r:m-Ae,c:_-re})}break;case"F":var H=0;for(A=1;A<R.length;++A)switch(R[A].charAt(0)){case"X":_=parseInt(R[A].slice(1))-1,++H;break;case"Y":for(m=parseInt(R[A].slice(1))-1,D=b.length;D<=m;++D)b[D]=[];break;case"M":C=parseInt(R[A].slice(1))/20;break;case"F":break;case"G":break;case"P":B=N[parseInt(R[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=R[A].slice(1).split(" "),D=parseInt(E[0],10);D<=parseInt(E[1],10);++D)C=parseInt(E[2],10),w[D-1]=C===0?{hidden:!0}:{wch:C},Rs(w[D-1]);break;case"C":_=parseInt(R[A].slice(1))-1,w[_]||(w[_]={});break;case"R":m=parseInt(R[A].slice(1))-1,x[m]||(x[m]={}),C>0?(x[m].hpt=C,x[m].hpx=qo(C)):C===0&&(x[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+S)}H<1&&(B=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+S)}}return x.length>0&&(M["!rows"]=x),w.length>0&&(M["!cols"]=w),p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),[b,M]}function a(d,p){var v=i(d,p),m=v[0],_=v[1],T=Qo(m,p);return Kt(_).forEach(function(A){T[A]=_[A]}),T}function o(d,p){return Ns(a(d,p),p)}function c(d,p,v,m){var _="C;Y"+(v+1)+";X"+(m+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+lg(d.f,{r:v,c:m}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function l(d,p){p.forEach(function(v,m){var _="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=ou(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=cu(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function h(d,p){p.forEach(function(v,m){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*lu(v.hpx)+";"),_.length>2&&d.push(_+"R"+(m+1))})}function f(d,p){var v=["ID;PWXL;N;E"],m=[],_=ct(d["!ref"]),T,A=Array.isArray(d),b=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&l(v,d["!cols"]),d["!rows"]&&h(v,d["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var N=_.s.r;N<=_.e.r;++N)for(var B=_.s.c;B<=_.e.c;++B){var M=Le({r:N,c:B});T=A?(d[N]||[])[B]:d[M],!(!T||T.v==null&&(!T.f||T.F))&&m.push(c(T,d,N,B,p))}return v.join(b)+b+m.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),jT=function(){function t(s,a){switch(a.type){case"base64":return e(En(s),a);case"binary":return e(s,a);case"buffer":return e(Qe&&Buffer.isBuffer(s)?s.toString("binary"):Os(s),a);case"array":return e(Ia(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var d=o[h].trim().split(","),p=d[0],v=d[1];++h;for(var m=o[h]||"";(m.match(/["]/g)||[]).length&1&&h<o.length-1;)m+=`
`+o[++h];switch(m=m.trim(),+p){case-1:if(m==="BOT"){f[++c]=[],l=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?f[c][l]=!0:m==="FALSE"?f[c][l]=!1:isNaN(oi(v))?isNaN(zo(v).getDate())?f[c][l]=v:f[c][l]=Ft(v):f[c][l]=oi(v),++l;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),Ul&&m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),f[c][l++]=m!==""?m:null;break}if(m==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return Qo(t(s,a),a)}function n(s,a){return Ns(r(s,a),a)}var i=function(){var s=function(c,l,h,f,d){c.push(l),c.push(h+","+f),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,h,f){c.push(l+","+h),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],h=ct(c["!ref"]),f,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,h.e.r-h.s.r+1,""),s(l,"TUPLES",0,h.e.c-h.s.c+1,""),s(l,"DATA",0,0,"");for(var p=h.s.r;p<=h.e.r;++p){a(l,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var m=Le({r:p,c:v});if(f=d?(c[p]||[])[v]:c[m],!f){a(l,1,0,"");continue}switch(f.t){case"n":var _=Ul?f.w:f.v;!_&&f.v!=null&&(_=f.v),_==null?Ul&&f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,_,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!Ul||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Hn(f.z||Oe[14],fr(Ft(f.v)))),Ul?a(l,0,f.w,"V"):a(l,1,0,f.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,A=l.join(T);return A}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),WT=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var p=f.split(`
`),v=-1,m=-1,_=0,T=[];_!==p.length;++_){var A=p[_].trim().split(":");if(A[0]==="cell"){var b=Ut(A[1]);if(T.length<=b.r)for(v=T.length;v<=b.r;++v)T[v]||(T[v]=[]);switch(v=b.r,m=b.c,A[2]){case"t":T[v][m]=t(A[3]);break;case"v":T[v][m]=+A[3];break;case"vtf":var N=A[A.length-1];case"vtc":switch(A[3]){case"nl":T[v][m]=!!+A[4];break;default:T[v][m]=+A[4];break}A[2]=="vtf"&&(T[v][m]=[T[v][m],N])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(f,d){return Qo(r(f,d),d)}function i(f,d){return Ns(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var d=[],p=[],v,m="",_=ln(f["!ref"]),T=Array.isArray(f),A=_.s.r;A<=_.e.r;++A)for(var b=_.s.c;b<=_.e.c;++b)if(m=Le({r:A,c:b}),v=T?(f[A]||[])[b]:f[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(e(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=e(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var N=fr(Ft(v.v));p[2]="vtc",p[3]="nd",p[4]=""+N,p[5]=v.w||Hn(v.z||Oe[14],N);break;case"e":continue}d.push(p.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function h(f){return[s,a,o,a,l(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),Go=function(){function t(h,f,d,p,v){v.raw?f[d][p]=h:h===""||(h==="TRUE"?f[d][p]=!0:h==="FALSE"?f[d][p]=!1:isNaN(oi(h))?isNaN(zo(h).getDate())?f[d][p]=h:f[d][p]=Ft(h):f[d][p]=oi(h))}function e(h,f){var d=f||{},p=[];if(!h||h.length===0)return p;for(var v=h.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var _=10,T=0,A=0;A<=m;++A)T=v[A].indexOf(" "),T==-1?T=v[A].length:T++,_=Math.max(_,T);for(A=0;A<=m;++A){p[A]=[];var b=0;for(t(v[A].slice(0,_).trim(),p,A,b,d),b=1;b<=(v[A].length-_)/10+1;++b)t(v[A].slice(_+(b-1)*10,_+b*10).trim(),p,A,b,d)}return d.sheetRows&&(p=p.slice(0,d.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},d=!1,p=0,v=0;p<h.length;++p)(v=h.charCodeAt(p))==34?d=!d:!d&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p]);if(!v.length){f=n;for(p in f)Object.prototype.hasOwnProperty.call(f,p)&&v.push([f[p],p])}return v.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(h,f){var d=f||{},p="";qt!=null&&d.dense==null&&(d.dense=qt);var v=d.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(p=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(p=h.charAt(4),h=h.slice(6)):p=i(h.slice(0,1024)):d&&d.FS?p=d.FS:p=i(h.slice(0,1024));var _=0,T=0,A=0,b=0,N=0,B=p.charCodeAt(0),M=!1,x=0,w=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var E=d.dateNF!=null?xR(d.dateNF):null;function C(){var D=h.slice(b,N),S={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)S.t="z";else if(d.raw)S.t="s",S.v=D;else if(D.trim().length===0)S.t="s",S.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(S.t="s",S.v=D.slice(2,-1).replace(/""/g,'"')):XM(D)?(S.t="n",S.f=D.slice(1)):(S.t="s",S.v=D);else if(D=="TRUE")S.t="b",S.v=!0;else if(D=="FALSE")S.t="b",S.v=!1;else if(!isNaN(A=oi(D)))S.t="n",d.cellText!==!1&&(S.w=D),S.v=A;else if(!isNaN(zo(D).getDate())||E&&D.match(E)){S.z=d.dateNF||Oe[14];var R=0;E&&D.match(E)&&(D=wR(D,d.dateNF,D.match(E)||[]),R=1),d.cellDates?(S.t="d",S.v=Ft(D,R)):(S.t="n",S.v=fr(Ft(D,R))),d.cellText!==!1&&(S.w=Hn(S.z,S.v instanceof Date?fr(S.v):S.v)),d.cellNF||delete S.z}else S.t="s",S.v=D;if(S.t=="z"||(d.dense?(v[_]||(v[_]=[]),v[_][T]=S):v[Le({c:T,r:_})]=S),b=N+1,w=h.charCodeAt(b),m.e.c<T&&(m.e.c=T),m.e.r<_&&(m.e.r=_),x==B)++T;else if(T=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;N<h.length;++N)switch(x=h.charCodeAt(N)){case 34:w===34&&(M=!M);break;case B:case 10:case 13:if(!M&&C())break e;break;default:break}return N-b>0&&C(),v["!ref"]=$e(m),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):Qo(e(h,f),f)}function o(h,f){var d="",p=f.type=="string"?[0,0,0,0]:vg(h,f);switch(f.type){case"base64":d=En(h);break;case"binary":d=h;break;case"buffer":f.codepage==65001?d=h.toString("utf8"):f.codepage&&typeof gt<"u"?d=gt.utils.decode(f.codepage,h):d=Qe&&Buffer.isBuffer(h)?h.toString("binary"):Os(h);break;case"array":d=Ia(h);break;case"string":d=h;break;default:throw new Error("Unrecognized type "+f.type)}return p[0]==239&&p[1]==187&&p[2]==191?d=Et(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=Et(d):f.type=="binary"&&typeof gt<"u"&&f.codepage&&(d=gt.utils.decode(f.codepage,gt.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?WT.to_sheet(f.type=="string"?d:Et(d),f):a(d,f)}function c(h,f){return Ns(o(h,f),f)}function l(h){for(var f=[],d=ct(h["!ref"]),p,v=Array.isArray(h),m=d.s.r;m<=d.e.r;++m){for(var _=[],T=d.s.c;T<=d.e.c;++T){var A=Le({r:m,c:T});if(p=v?(h[m]||[])[T]:h[A],!p||p.v==null){_.push("          ");continue}for(var b=(p.w||(Yi(p),p.w)||"").slice(0,10);b.length<10;)b+=" ";_.push(b+(T===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function NO(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=UT.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Go.to_workbook(t,e)}}var Ea=function(){function t(j,G,H){if(j){Pr(j,j.l||0);for(var W=H.Enum||Ae;j.l<j.length;){var te=j.read_shift(2),me=W[te]||W[65535],ue=j.read_shift(2),fe=j.l+ue,ne=me.f&&me.f(j,ue,H);if(j.l=fe,G(ne,me,te))return}}}function e(j,G){switch(G.type){case"base64":return r(xn(En(j)),G);case"binary":return r(xn(j),G);case"buffer":case"array":return r(j,G)}throw"Unsupported type "+G.type}function r(j,G){if(!j)return j;var H=G||{};qt!=null&&H.dense==null&&(H.dense=qt);var W=H.dense?[]:{},te="Sheet1",me="",ue=0,fe={},ne=[],Be=[],U={s:{r:0,c:0},e:{r:0,c:0}},st=H.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)H.Enum=Ae,t(j,function(Te,Lt,Qr){switch(Qr){case 0:H.vers=Te,Te>=4096&&(H.qpro=!0);break;case 6:U=Te;break;case 204:Te&&(me=Te);break;case 222:me=Te;break;case 15:case 51:H.qpro||(Te[1].v=Te[1].v.slice(1));case 13:case 14:case 16:Qr==14&&(Te[2]&112)==112&&(Te[2]&15)>1&&(Te[2]&15)<15&&(Te[1].z=H.dateNF||Oe[14],H.cellDates&&(Te[1].t="d",Te[1].v=zf(Te[1].v))),H.qpro&&Te[3]>ue&&(W["!ref"]=$e(U),fe[te]=W,ne.push(te),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ue=Te[3],te=me||"Sheet"+(ue+1),me="");var un=H.dense?(W[Te[0].r]||[])[Te[0].c]:W[Le(Te[0])];if(un){un.t=Te[1].t,un.v=Te[1].v,Te[1].z!=null&&(un.z=Te[1].z),Te[1].f!=null&&(un.f=Te[1].f);break}H.dense?(W[Te[0].r]||(W[Te[0].r]=[]),W[Te[0].r][Te[0].c]=Te[1]):W[Le(Te[0])]=Te[1];break;default:}},H);else if(j[2]==26||j[2]==14)H.Enum=re,j[2]==14&&(H.qpro=!0,j.l=0),t(j,function(Te,Lt,Qr){switch(Qr){case 204:te=Te;break;case 22:Te[1].v=Te[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Te[3]>ue&&(W["!ref"]=$e(U),fe[te]=W,ne.push(te),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ue=Te[3],te="Sheet"+(ue+1)),st>0&&Te[0].r>=st)break;H.dense?(W[Te[0].r]||(W[Te[0].r]=[]),W[Te[0].r][Te[0].c]=Te[1]):W[Le(Te[0])]=Te[1],U.e.c<Te[0].c&&(U.e.c=Te[0].c),U.e.r<Te[0].r&&(U.e.r=Te[0].r);break;case 27:Te[14e3]&&(Be[Te[14e3][0]]=Te[14e3][1]);break;case 1537:Be[Te[0]]=Te[1],Te[0]==ue&&(te=Te[1]);break;default:break}},H);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(W["!ref"]=$e(U),fe[me||te]=W,ne.push(me||te),!Be.length)return{SheetNames:ne,Sheets:fe};for(var He={},at=[],Xe=0;Xe<Be.length;++Xe)fe[ne[Xe]]?(at.push(Be[Xe]||ne[Xe]),He[Be[Xe]]=fe[Be[Xe]]||fe[ne[Xe]]):(at.push(Be[Xe]),He[Be[Xe]]={"!ref":"A1"});return{SheetNames:at,Sheets:He}}function n(j,G){var H=G||{};if(+H.codepage>=0&&si(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var W=cn(),te=ct(j["!ref"]),me=Array.isArray(j),ue=[];_e(W,0,s(1030)),_e(W,6,c(te));for(var fe=Math.min(te.e.r,8191),ne=te.s.r;ne<=fe;++ne)for(var Be=Zt(ne),U=te.s.c;U<=te.e.c;++U){ne===te.s.r&&(ue[U]=Bt(U));var st=ue[U]+Be,He=me?(j[ne]||[])[U]:j[st];if(!(!He||He.t=="z"))if(He.t=="n")(He.v|0)==He.v&&He.v>=-32768&&He.v<=32767?_e(W,13,p(ne,U,He.v)):_e(W,14,m(ne,U,He.v));else{var at=Yi(He);_e(W,15,f(ne,U,at.slice(0,239)))}}return _e(W,1),W.end()}function i(j,G){var H=G||{};if(+H.codepage>=0&&si(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var W=cn();_e(W,0,a(j));for(var te=0,me=0;te<j.SheetNames.length;++te)(j.Sheets[j.SheetNames[te]]||{})["!ref"]&&_e(W,27,de(j.SheetNames[te],me++));var ue=0;for(te=0;te<j.SheetNames.length;++te){var fe=j.Sheets[j.SheetNames[te]];if(!(!fe||!fe["!ref"])){for(var ne=ct(fe["!ref"]),Be=Array.isArray(fe),U=[],st=Math.min(ne.e.r,8191),He=ne.s.r;He<=st;++He)for(var at=Zt(He),Xe=ne.s.c;Xe<=ne.e.c;++Xe){He===ne.s.r&&(U[Xe]=Bt(Xe));var Te=U[Xe]+at,Lt=Be?(fe[He]||[])[Xe]:fe[Te];if(!(!Lt||Lt.t=="z"))if(Lt.t=="n")_e(W,23,C(He,Xe,ue,Lt.v));else{var Qr=Yi(Lt);_e(W,22,x(He,Xe,ue,Qr.slice(0,239)))}}++ue}}return _e(W,1),W.end()}function s(j){var G=ee(2);return G.write_shift(2,j),G}function a(j){var G=ee(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var H=0,W=0,te=0,me=0;me<j.SheetNames.length;++me){var ue=j.SheetNames[me],fe=j.Sheets[ue];if(!(!fe||!fe["!ref"])){++te;var ne=ln(fe["!ref"]);H<ne.e.r&&(H=ne.e.r),W<ne.e.c&&(W=ne.e.c)}}return H>8191&&(H=8191),G.write_shift(2,H),G.write_shift(1,te),G.write_shift(1,W),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(j,G,H){var W={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&H.qpro?(W.s.c=j.read_shift(1),j.l++,W.s.r=j.read_shift(2),W.e.c=j.read_shift(1),j.l++,W.e.r=j.read_shift(2),W):(W.s.c=j.read_shift(2),W.s.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.e.c=j.read_shift(2),W.e.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(j){var G=ee(8);return G.write_shift(2,j.s.c),G.write_shift(2,j.s.r),G.write_shift(2,j.e.c),G.write_shift(2,j.e.r),G}function l(j,G,H){var W=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(W[0].c=j.read_shift(1),W[3]=j.read_shift(1),W[0].r=j.read_shift(2),j.l+=2):(W[2]=j.read_shift(1),W[0].c=j.read_shift(2),W[0].r=j.read_shift(2)),W}function h(j,G,H){var W=j.l+G,te=l(j,G,H);if(te[1].t="s",H.vers==20768){j.l++;var me=j.read_shift(1);return te[1].v=j.read_shift(me,"utf8"),te}return H.qpro&&j.l++,te[1].v=j.read_shift(W-j.l,"cstr"),te}function f(j,G,H){var W=ee(7+H.length);W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(1,39);for(var te=0;te<W.length;++te){var me=H.charCodeAt(te);W.write_shift(1,me>=128?95:me)}return W.write_shift(1,0),W}function d(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(2,"i"),W}function p(j,G,H){var W=ee(7);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(2,H,"i"),W}function v(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(8,"f"),W}function m(j,G,H){var W=ee(13);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(8,H,"f"),W}function _(j,G,H){var W=j.l+G,te=l(j,G,H);if(te[1].v=j.read_shift(8,"f"),H.qpro)j.l=W;else{var me=j.read_shift(2);N(j.slice(j.l,j.l+me),te),j.l+=me}return te}function T(j,G,H){var W=G&32768;return G&=-32769,G=(W?j:0)+(G>=8192?G-16384:G),(W?"":"$")+(H?Bt(G):Zt(G))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function N(j,G){Pr(j,0);for(var H=[],W=0,te="",me="",ue="",fe="";j.l<j.length;){var ne=j[j.l++];switch(ne){case 0:H.push(j.read_shift(8,"f"));break;case 1:me=T(G[0].c,j.read_shift(2),!0),te=T(G[0].r,j.read_shift(2),!1),H.push(me+te);break;case 2:{var Be=T(G[0].c,j.read_shift(2),!0),U=T(G[0].r,j.read_shift(2),!1);me=T(G[0].c,j.read_shift(2),!0),te=T(G[0].r,j.read_shift(2),!1),H.push(Be+U+":"+me+te)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(j.read_shift(2));break;case 6:{for(var st="";ne=j[j.l++];)st+=String.fromCharCode(ne);H.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:fe=H.pop(),ue=H.pop(),H.push(["AND","OR"][ne-20]+"("+ue+","+fe+")");break;default:if(ne<32&&b[ne])fe=H.pop(),ue=H.pop(),H.push(ue+b[ne]+fe);else if(A[ne]){if(W=A[ne][1],W==69&&(W=j[j.l++]),W>H.length){console.error("WK1 bad formula parse 0x"+ne.toString(16)+":|"+H.join("|")+"|");return}var He=H.slice(-W);H.length-=W,H.push(A[ne][0]+"("+He.join(",")+")")}else return ne<=7?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=24?console.error("WK1 unsupported op "+ne.toString(16)):ne<=30?console.error("WK1 invalid opcode "+ne.toString(16)):ne<=115?console.error("WK1 unsupported function opcode "+ne.toString(16)):console.error("WK1 unrecognized opcode "+ne.toString(16))}}H.length==1?G[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function B(j){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=j.read_shift(2),G[3]=j[j.l++],G[0].c=j[j.l++],G}function M(j,G){var H=B(j,G);return H[1].t="s",H[1].v=j.read_shift(G-4,"cstr"),H}function x(j,G,H,W){var te=ee(6+W.length);te.write_shift(2,j),te.write_shift(1,H),te.write_shift(1,G),te.write_shift(1,39);for(var me=0;me<W.length;++me){var ue=W.charCodeAt(me);te.write_shift(1,ue>=128?95:ue)}return te.write_shift(1,0),te}function w(j,G){var H=B(j,G);H[1].v=j.read_shift(2);var W=H[1].v>>1;if(H[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return H[1].v=W,H}function E(j,G){var H=B(j,G),W=j.read_shift(4),te=j.read_shift(4),me=j.read_shift(2);if(me==65535)return W===0&&te===3221225472?(H[1].t="e",H[1].v=15):W===0&&te===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ue=me&32768;return me=(me&32767)-16446,H[1].v=(1-ue*2)*(te*Math.pow(2,me+32)+W*Math.pow(2,me)),H}function C(j,G,H,W){var te=ee(14);if(te.write_shift(2,j),te.write_shift(1,H),te.write_shift(1,G),W==0)return te.write_shift(4,0),te.write_shift(4,0),te.write_shift(2,65535),te;var me=0,ue=0,fe=0,ne=0;return W<0&&(me=1,W=-W),ue=Math.log2(W)|0,W/=Math.pow(2,ue-31),ne=W>>>0,ne&2147483648||(W/=2,++ue,ne=W>>>0),W-=ne,ne|=2147483648,ne>>>=0,W*=Math.pow(2,32),fe=W>>>0,te.write_shift(4,fe),te.write_shift(4,ne),ue+=16383+(me?32768:0),te.write_shift(2,ue),te}function D(j,G){var H=E(j,14);return j.l+=G-14,H}function S(j,G){var H=B(j,G),W=j.read_shift(4);return H[1].v=W>>6,H}function R(j,G){var H=B(j,G),W=j.read_shift(8,"f");return H[1].v=W,H}function oe(j,G){var H=R(j,14);return j.l+=G-10,H}function se(j,G){return j[j.l+G-1]==0?j.read_shift(G,"cstr"):""}function Ie(j,G){var H=j[j.l++];H>G-1&&(H=G-1);for(var W="";W.length<H;)W+=String.fromCharCode(j[j.l++]);return W}function xe(j,G,H){if(!(!H.qpro||G<21)){var W=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var te=j.read_shift(G-21,"cstr");return[W,te]}}function Pe(j,G){for(var H={},W=j.l+G;j.l<W;){var te=j.read_shift(2);if(te==14e3){for(H[te]=[0,""],H[te][0]=j.read_shift(2);j[j.l];)H[te][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return H}function de(j,G){var H=ee(5+j.length);H.write_shift(2,14e3),H.write_shift(2,G);for(var W=0;W<j.length;++W){var te=j.charCodeAt(W);H[H.l++]=te>127?95:te}return H[H.l++]=0,H}var Ae={0:{n:"BOF",f:sr},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:Ie},65535:{n:""}},re={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:S},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function MO(t){var e={},r=t.match(zr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Ve(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=Dm[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var LO=function(){var t=ru("t"),e=ru("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:ot(a[1])},c=s.match(e);return c&&(o.s=MO(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),VO=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),BO=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,UO=/<(?:\w+:)?r>/,jO=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function ig(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ot(Et(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Et(t),r&&(n.h=Um(n.t))):t.match(UO)&&(n.r=Et(t),n.t=ot(Et((t.replace(jO,"").match(BO)||[]).join("").replace(zr,""))),r&&(n.h=VO(LO(n.r)))),n):{t:""}}var WO=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,$O=/<(?:\w+:)?(?:si|sstItem)>/g,HO=/<\/(?:\w+:)?(?:si|sstItem)>/;function zO(t,e){var r=[],n="";if(!t)return r;var i=t.match(WO);if(i){n=i[2].replace($O,"").split(HO);for(var s=0;s!=n.length;++s){var a=ig(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=Ve(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var GO=/^\s|\s$|[\t\n\r]/;function $T(t,e){if(!e.bookSST)return"";var r=[er];r[r.length]=ve("sst",null,{xmlns:Da[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(GO)&&(s+=' xml:space="preserve"'),s+=">"+yt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qO(t){return[t.read_shift(4),t.read_shift(4)]}function KO(t,e){var r=[],n=!1;return Ji(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function XO(t,e){return e||(e=ee(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var YO=aP;function QO(t){var e=cn();ie(e,159,XO(t));for(var r=0;r<t.length;++r)ie(e,19,YO(t[r]));return ie(e,160),e.end()}function HT(t){if(typeof gt<"u")return gt.utils.encode(Ho,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function Xi(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function JO(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=Xi(t,4),e.U=Xi(t,4),e.W=Xi(t,4),e}function ZO(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function eN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(ZO(t));return e}function tN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function rN(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=Xi(t,4),e.U=Xi(t,4),e.W=Xi(t,4),e}function nN(t){var e=rN(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function zT(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function GT(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function iN(t){var e=Xi(t);switch(e.Minor){case 2:return[e.Minor,sN(t,e)];case 3:return[e.Minor,aN(t,e)];case 4:return[e.Minor,oN(t,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function sN(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=zT(t,r),i=GT(t,t.length-t.l);return{t:"Std",h:n,v:i}}function aN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function oN(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(zr,function(s){var a=Ve(s);switch(Si(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function cN(t,e){var r={},n=r.EncryptionVersionInfo=Xi(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=zT(t,i),e-=i,r.EncryptionVerifier=GT(t,e),r}function lN(t){var e={},r=e.EncryptionVersionInfo=Xi(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function sg(t){var e=0,r,n=HT(t),i=n.length+1,s,a,o,c,l;for(r=Ds(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var qT=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var h=a[l],f=0;f!=7;++f)h&64&&(o^=r[c]),h*=2,--c;return o};return function(a){for(var o=HT(a),c=s(o),l=o.length,h=Ds(16),f=0;f!=16;++f)h[f]=0;var d,p,v;for((l&1)===1&&(d=c>>8,h[l]=i(t[0],d),--l,d=c&255,p=o[o.length-1],h[l]=i(p,d));l>0;)--l,d=c>>8,h[l]=i(o[l],d),--l,d=c&255,h[l]=i(o[l],d);for(l=15,v=15-o.length;v>0;)d=c>>8,h[l]=i(t[v],d),--l,--v,d=c&255,h[l]=i(o[l],d),--l,--v;return h}}(),uN=function(t,e,r,n,i){i||(i=e),n||(n=qT(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},hN=function(t){var e=0,r=qT(t);return function(n){var i=uN("",n,e,r);return e=i[1],i[0]}};function fN(t,e,r,n){var i={key:sr(t),verificationBytes:sr(t)};return r.password&&(i.verifier=sg(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=hN(r.password)),i}function dN(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=lN(t,e):n.Data=cN(t,e),n}function pN(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?dN(t,e-2,n):fN(t,r.biff>=8?e:e-2,r,n),n}var KT=function(){function t(i,s){switch(s.type){case"base64":return e(En(i),s);case"binary":return e(i,s);case"buffer":return e(Qe&&Buffer.isBuffer(i)?i.toString("binary"):Os(i),s);case"array":return e(Ia(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,p=0,v,m=-1;v=d.exec(h);){switch(v[0]){case"\\cell":var _=h.slice(p,d.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var T={v:_,t:"s"};Array.isArray(o)?o[f][m]=T:o[Le({r:f,c:m})]=T}break}p=d.lastIndex}m>l.e.c&&(l.e.c=m)}),o["!ref"]=$e(l),o}function r(i,s){return Ns(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ct(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Le({r:l,c:h});o=c?(i[l]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Yi(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function mN(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function au(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function gN(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function vN(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function Lf(t,e){if(e===0)return t;var r=gN(mN(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),au(vN(r))}var XT=6,_N=15,yN=1,Ur=XT;function ou(t){return Math.floor((t+Math.round(128/Ur)/256)*Ur)}function cu(t){return Math.floor((t-5)/Ur*100+.5)/100}function Vf(t){return Math.round((t*Ur+5)/Ur*256)/256}function lm(t){return Vf(cu(ou(t)))}function ag(t){var e=Math.abs(t-lm(t)),r=Ur;if(e>.005)for(Ur=yN;Ur<_N;++Ur)Math.abs(t-lm(t))<=e&&(e=Math.abs(t-lm(t)),r=Ur);Ur=r}function Rs(t){t.width?(t.wpx=ou(t.width),t.wch=cu(t.wpx),t.MDW=Ur):t.wpx?(t.wch=cu(t.wpx),t.width=Vf(t.wch),t.MDW=Ur):typeof t.wch=="number"&&(t.width=Vf(t.wch),t.wpx=ou(t.width),t.MDW=Ur),t.customWidth&&delete t.customWidth}var xN=96,YT=xN;function lu(t){return t*96/YT}function qo(t){return t*YT/96}var wN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function EN(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Ve(a);switch(Si(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Pt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Pt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function TN(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Ve(a);switch(Si(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function bN(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(zr)||[]).forEach(function(a){var o=Ve(a);switch(Si(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=Et(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Pt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Pt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Pt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Pt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Pt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Pt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Pt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Dm[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Pt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=xa[i.color.index];i.color.index==81&&(c=xa[1]),c||(c=xa[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Lf(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function IN(t,e,r){e.NumberFmt=[];for(var n=Kt(Oe),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Oe[n[i]];var s=t[0].match(zr);if(s)for(i=0;i<s.length;++i){var a=Ve(s[i]);switch(Si(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ot(Et(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}Ki(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function AN(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=ve("numFmt",null,{numFmtId:n,formatCode:yt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=ve("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var bf=["numFmtId","fillId","fontId","borderId","xfId"],If=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function SN(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(zr)||[]).forEach(function(s){var a=Ve(s),o=0;switch(Si(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<bf.length;++o)n[bf[o]]&&(n[bf[o]]=parseInt(n[bf[o]],10));for(o=0;o<If.length;++o)n[If[o]]&&(n[If[o]]=Pt(n[If[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Pt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function CN(t){var e=[];return e[e.length]=ve("cellXfs",null),t.forEach(function(r){e[e.length]=ve("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=ve("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var kN=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&IN(f,h,l),(f=o.match(i))&&bN(f,h,c,l),(f=o.match(n))&&TN(f,h,c,l),(f=o.match(s))&&EN(f,h,c,l),(f=o.match(r))&&SN(f,h,l),h}}();function QT(t,e){var r=[er,ve("styleSheet",null,{xmlns:Da[0],"xmlns:vt":hr.vt})],n;return t.SSF&&(n=AN(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CN(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function DN(t,e){var r=t.read_shift(2),n=$r(t,e-2);return[r,n]}function RN(t,e,r){r||(r=ee(6+4*e.length)),r.write_shift(2,t),Er(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function PN(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=dP(t,2,r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=fP(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=$r(t,e-21),n}function FN(t,e){e||(e=ee(25+4*32)),e.write_shift(2,t.sz*20),pP(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Of(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),Er(t.name,e),e.length>e.l?e.slice(0,e.l):e}var ON=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],um,NN=Hr;function mE(t,e){e||(e=ee(4*3+8*7+16*1)),um||(um=$f(ON));var r=um[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Of({auto:1},e),Of({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function MN(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function JT(t,e,r){r||(r=ee(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function jl(t,e){return e||(e=ee(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var LN=Hr;function VN(t,e){return e||(e=ee(51)),e.write_shift(1,0),jl(null,e),jl(null,e),jl(null,e),jl(null,e),jl(null,e),e.length>e.l?e.slice(0,e.l):e}function BN(t,e){return e||(e=ee(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),Ff(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function UN(t,e,r){var n=ee(2052);return n.write_shift(4,t),Ff(e,n),Ff(r,n),n.length>n.l?n.slice(0,n.l):n}function jN(t,e,r){var n={};n.NumberFmt=[];for(var i in Oe)n.NumberFmt[i]=Oe[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return Ji(t,function(c,l,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],Ki(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Lf(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(h),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(h);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function WN(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ie(t,615,ci(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ie(t,44,RN(i,e[i]))}),ie(t,616))}}function $N(t){var e=1;e!=0&&(ie(t,611,ci(e)),ie(t,43,FN({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ie(t,612))}function HN(t){var e=2;e!=0&&(ie(t,603,ci(e)),ie(t,45,mE({patternType:"none"})),ie(t,45,mE({patternType:"gray125"})),ie(t,604))}function zN(t){var e=1;e!=0&&(ie(t,613,ci(e)),ie(t,46,VN({})),ie(t,614))}function GN(t){var e=1;ie(t,626,ci(e)),ie(t,47,JT({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ie(t,627)}function qN(t,e){ie(t,617,ci(e.length)),e.forEach(function(r){ie(t,47,JT(r,0))}),ie(t,618)}function KN(t){var e=1;ie(t,619,ci(e)),ie(t,48,BN({xfId:0,builtinId:0,name:"Normal"})),ie(t,620)}function XN(t){var e=0;ie(t,505,ci(e)),ie(t,506)}function YN(t){var e=0;ie(t,508,UN(e,"TableStyleMedium9","PivotStyleMedium4")),ie(t,509)}function QN(t,e){var r=cn();return ie(r,278),WN(r,t.SSF),$N(r,t),HN(r,t),zN(r,t),GN(r,t),qN(r,e.cellXfs),KN(r,t),XN(r,t),YN(r,t),ie(r,279),r.end()}var JN=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function ZN(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(zr)||[]).forEach(function(i){var s=Ve(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[JN.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function eM(){}function tM(){}var rM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,nM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,iM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function sM(t,e,r){e.themeElements={};var n;[["clrScheme",rM,ZN],["fontScheme",nM,eM],["fmtScheme",iM,tM]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var aM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function ZT(t,e){(!t||t.length===0)&&(t=og());var r,n={};if(!(r=t.match(aM)))throw new Error("themeElements not found in theme");return sM(r[0],n,e),n.raw=t,n}function og(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[er];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function oM(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=YE(s,{type:"array"})}catch{return}var o=wn(a,"theme/theme/theme1.xml",!0);if(o)return ZT(o,r)}}function cM(t){return t.read_shift(4)}function lM(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=uM(t,4);break;case 2:e.xclrValue=PT(t,4);break;case 3:e.xclrValue=cM(t,4);break;case 4:t.l+=4;break}return t.l+=8,e}function uM(t,e){return Hr(t,e)}function hM(t,e){return Hr(t,e)}function fM(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=lM(t,r);break;case 6:n[1]=hM(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function dM(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(fM(t,r-t.l));return{ixfe:n,ext:s}}function pM(t,e){e.forEach(function(r){switch(r[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function mM(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:$r(t,e-8)}}function gM(t){var e=ee(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Er(t.name,e),e.slice(0,e.l)}function vM(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function _M(t){var e=ee(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function yM(t,e){var r=ee(8+2*e.length);return r.write_shift(4,t),Er(e,r),r.slice(0,r.l)}function xM(t){return t.l+=4,t.read_shift(4)!=0}function wM(t,e){var r=ee(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function EM(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return Ji(t,function(c,l,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(h),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function TM(){var t=cn();return ie(t,332),ie(t,334,ci(1)),ie(t,335,gM({name:"XLDAPR",version:12e4,flags:3496657072})),ie(t,336),ie(t,339,yM(1,"XLDAPR")),ie(t,52),ie(t,35,ci(514)),ie(t,4096,ci(0)),ie(t,4097,Wn(1)),ie(t,36),ie(t,53),ie(t,340),ie(t,337,wM(1,!0)),ie(t,51,_M([[1,0]])),ie(t,338),ie(t,333),t.end()}function bM(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(zr,function(o){var c=Ve(o);switch(Si(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function eb(){var t=[er];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function IM(t){var e=[];if(!t)return e;var r=1;return(t.match(zr)||[]).forEach(function(n){var i=Ve(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function AM(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Le(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function SM(t,e,r){var n=[],i=!1;return Ji(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function CM(t,e,r,n){if(!t)return t;var i=n||{},s=!1,a=!1;Ji(t,function(c,l,h){if(!a)switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function kM(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var Bo=1024;function tb(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[ve("xml",null,{"xmlns:v":yn.v,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:mv":yn.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Bo<t*1e3;)Bo+=1e3;return e.forEach(function(s){var a=Ut(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=ve("v:fill",c,o),h={on:"t",obscured:"t"};++Bo,i=i.concat(["<v:shape"+nu({id:"_x0000_s"+Bo,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,ve("v:shadow",null,h),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Fr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Fr("x:AutoFill","False"),Fr("x:Row",String(a.r)),Fr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function gE(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Ut(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var c=ct(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=$e(c);l!==t["!ref"]&&(t["!ref"]=l)}s.c||(s.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function DM(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Ve(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ut(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&ig(f[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function rb(t){var e=[er,ve("comments",null,{xmlns:Da[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=yt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(yt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Fr("t",yt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Fr("t",yt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function RM(t,e){var r=[],n=!1,i={},s=0;return t.replace(zr,function(o,c){var l=Ve(o);switch(Si(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function PM(t,e,r){var n=[er,ve("ThreadedComments",null,{xmlns:hr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(ve("threadedComment",Fr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function FM(t,e){var r=[],n=!1;return t.replace(zr,function(s){var a=Ve(s);switch(Si(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function OM(t){var e=[er,ve("personList",null,{xmlns:hr.TCMNT,"xmlns:x":Da[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function NM(t){var e={};e.iauthor=t.read_shift(4);var r=Oa(t,16);return e.rfx=r.s,e.ref=Le(r.s),t.l+=16,e}function MM(t,e){return e==null&&(e=ee(36)),e.write_shift(4,t[1].iauthor),Jo(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var LM=$r;function VM(t){return Er(t.slice(0,54))}function BM(t,e){var r=[],n=[],i={},s=!1;return Ji(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function UM(t){var e=cn(),r=[];return ie(e,628),ie(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ie(e,632,VM(i.a)))})}),ie(e,631),ie(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Ut(n[0]),e:Ut(n[0])};ie(e,635,MM([s,i])),i.t&&i.t.length>0&&ie(e,637,cP(i)),ie(e,636),delete i.iauthor})}),ie(e,634),ie(e,629),e.end()}var jM="application/vnd.ms-office.vbaProject";function WM(t){var e=De.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");De.utils.cfb_add(e,i,t.FileIndex[n].content)}}),De.write(e)}function $M(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&De.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var nb=["xlsb","xlsm","xlam","biff8","xla"];function HM(){return{"!type":"dialog"}}function zM(){return{"!type":"dialog"}}function GM(){return{"!type":"macro"}}function qM(){return{"!type":"macro"}}var Wo=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,c?l+=e.r:--l,i+(o?"":"$")+Bt(h)+(c?"":"$")+Zt(l)}return function(i,s){return e=s,i.replace(t,r)}}(),cg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,lg=function(){return function(e,r){return e.replace(cg,function(n,i,s,a,o,c){var l=Xm(a)-(s?0:r.c),h=Km(c)-(o?0:r.r),f=h==0?"":o?h+1:"["+h+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+f+"C"+d})}}();function ib(t,e){return t.replace(cg,function(r,n,i,s,a,o){return n+(i=="$"?i+s:Bt(Xm(s)+e.c))+(a=="$"?a+o:Zt(Km(o)+e.r))})}function KM(t,e,r){var n=ln(e),i=n.s,s=Ut(r),a={r:s.r-i.r,c:s.c-i.c};return ib(t,a)}function XM(t){return t.length!=1}function vE(t){return t.replace(/_xlfn\./g,"")}function nr(t){t.l+=1}function Ps(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function sb(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return ab(t,e,r);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Ps(t,2),o=Ps(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function ab(t){var e=Ps(t,2),r=Ps(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function YM(t,e,r){if(r.biff<8)return ab(t,e,r);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Ps(t,2),a=Ps(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function ob(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return QM(t,e,r);var n=t.read_shift(r&&r.biff==12?4:2),i=Ps(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function QM(t){var e=Ps(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function JM(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function ZM(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return e4(t,e,r);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function e4(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function t4(t,e,r){var n=(t[t.l++]&96)>>5,i=sb(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function r4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=sb(t,s,r);return[n,i,a]}function n4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function i4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function s4(t,e,r){var n=(t[t.l++]&96)>>5,i=YM(t,e-1,r);return[n,i]}function a4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function _E(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function o4(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function c4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function l4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function u4(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function h4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function cb(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function f4(t){return t.read_shift(2),cb(t,2)}function d4(t){return t.read_shift(2),cb(t,2)}function p4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ob(t,0,r);return[n,i]}function m4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=ZM(t,0,r);return[n,i]}function g4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=ob(t,0,r);return[n,i,s]}function v4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[xL[i],hb[i],n]}function _4(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:y4(t);return[i,(s[0]===0?hb:yL)[s[1]]]}function y4(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function x4(t,e,r){t.l+=r&&r.biff==2?3:4}function w4(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function E4(t){return t.l++,Zi[t.read_shift(1)]}function T4(t){return t.l++,t.read_shift(2)}function b4(t){return t.l++,t.read_shift(1)!==0}function I4(t){return t.l++,jr(t,8)}function A4(t,e,r){return t.l++,pu(t,e-1,r)}function S4(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Jt(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=Zi[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=jr(t,8);break;case 2:r[1]=Na(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function C4(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Oa:qf)(t,8));return i}function k4(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=S4(t,r.biff);return a}function D4(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function R4(t,e,r){if(r.biff==5)return P4(t,e,r);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function P4(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function F4(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function O4(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function N4(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function M4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var L4=Hr,V4=Hr,B4=Hr;function gu(t,e,r){return t.l+=2,[JM(t,4,r)]}function ug(t){return t.l+=6,[]}var U4=gu,j4=ug,W4=ug,$4=gu;function lb(t){return t.l+=2,[sr(t),t.read_shift(2)&1]}var H4=gu,z4=lb,G4=ug,q4=gu,K4=gu,X4=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Y4(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=X4[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function Q4(t){return t.l+=2,[t.read_shift(4)]}function J4(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function Z4(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function eL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function tL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function rL(t){return t.l+=4,[0,0]}var yE={1:{n:"PtgExp",f:w4},2:{n:"PtgTbl",f:B4},3:{n:"PtgAdd",f:nr},4:{n:"PtgSub",f:nr},5:{n:"PtgMul",f:nr},6:{n:"PtgDiv",f:nr},7:{n:"PtgPower",f:nr},8:{n:"PtgConcat",f:nr},9:{n:"PtgLt",f:nr},10:{n:"PtgLe",f:nr},11:{n:"PtgEq",f:nr},12:{n:"PtgGe",f:nr},13:{n:"PtgGt",f:nr},14:{n:"PtgNe",f:nr},15:{n:"PtgIsect",f:nr},16:{n:"PtgUnion",f:nr},17:{n:"PtgRange",f:nr},18:{n:"PtgUplus",f:nr},19:{n:"PtgUminus",f:nr},20:{n:"PtgPercent",f:nr},21:{n:"PtgParen",f:nr},22:{n:"PtgMissArg",f:nr},23:{n:"PtgStr",f:A4},26:{n:"PtgSheet",f:J4},27:{n:"PtgEndSheet",f:Z4},28:{n:"PtgErr",f:E4},29:{n:"PtgBool",f:b4},30:{n:"PtgInt",f:T4},31:{n:"PtgNum",f:I4},32:{n:"PtgArray",f:a4},33:{n:"PtgFunc",f:v4},34:{n:"PtgFuncVar",f:_4},35:{n:"PtgName",f:D4},36:{n:"PtgRef",f:p4},37:{n:"PtgArea",f:t4},38:{n:"PtgMemArea",f:F4},39:{n:"PtgMemErr",f:L4},40:{n:"PtgMemNoMem",f:V4},41:{n:"PtgMemFunc",f:O4},42:{n:"PtgRefErr",f:N4},43:{n:"PtgAreaErr",f:n4},44:{n:"PtgRefN",f:m4},45:{n:"PtgAreaN",f:s4},46:{n:"PtgMemAreaN",f:eL},47:{n:"PtgMemNoMemN",f:tL},57:{n:"PtgNameX",f:R4},58:{n:"PtgRef3d",f:g4},59:{n:"PtgArea3d",f:r4},60:{n:"PtgRefErr3d",f:M4},61:{n:"PtgAreaErr3d",f:i4},255:{}},nL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},iL={1:{n:"PtgElfLel",f:lb},2:{n:"PtgElfRw",f:q4},3:{n:"PtgElfCol",f:U4},6:{n:"PtgElfRwV",f:K4},7:{n:"PtgElfColV",f:$4},10:{n:"PtgElfRadical",f:H4},11:{n:"PtgElfRadicalS",f:G4},13:{n:"PtgElfColS",f:j4},15:{n:"PtgElfColSV",f:W4},16:{n:"PtgElfRadicalLel",f:z4},25:{n:"PtgList",f:Y4},29:{n:"PtgSxName",f:Q4},255:{}},sL={0:{n:"PtgAttrNoop",f:rL},1:{n:"PtgAttrSemi",f:h4},2:{n:"PtgAttrIf",f:l4},4:{n:"PtgAttrChoose",f:o4},8:{n:"PtgAttrGoto",f:c4},16:{n:"PtgAttrSum",f:x4},32:{n:"PtgAttrBaxcel",f:_E},33:{n:"PtgAttrBaxcel",f:_E},64:{n:"PtgAttrSpace",f:f4},65:{n:"PtgAttrSpaceSemi",f:d4},128:{n:"PtgAttrIfError",f:u4},255:{}};function vu(t,e,r,n){if(n.biff<8)return Hr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=k4(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=C4(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0];default:break}return e=i-t.l,e!==0&&s.push(Hr(t,e)),s}function _u(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=yE[s]||yE[nL[s]],(s===24||s===25)&&(i=(s===24?iL:sL)[t[t.l+1]]),!i||!i.f?Hr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function aL(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var oL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function cL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function ub(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function xE(t,e,r){var n=ub(t,e,r);return n=="#REF"?n:cL(n,r)}function Br(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,h,f=0,d=0,p,v="";if(!t[0]||!t[0][0])return"";for(var m=-1,_="",T=0,A=t[0].length;T<A;++T){var b=t[0][T];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),m>=0){switch(t[0][m][1][0]){case 0:_=zt(" ",t[0][m][1][1]);break;case 1:_=zt("\r",t[0][m][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}l=l+_,m=-1}o.push(l+oL[b[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=Gl(b[1][1],a,i),o.push(ql(h,s));break;case"PtgRefN":h=r?Gl(b[1][1],r,i):b[1][1],o.push(ql(h,s));break;case"PtgRef3d":f=b[1][1],h=Gl(b[1][2],a,i),v=xE(n,f,i);var N=v;o.push(v+"!"+ql(h,s));break;case"PtgFunc":case"PtgFuncVar":var B=b[1][0],M=b[1][1];B||(B=0),B&=127;var x=B==0?[]:o.slice(-B);o.length-=B,M==="User"&&(M=x.shift()),o.push(M+"("+x.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":p=Xw(b[1][1],r?{s:r}:a,i),o.push(am(p,i));break;case"PtgArea":p=Xw(b[1][1],a,i),o.push(am(p,i));break;case"PtgArea3d":f=b[1][1],p=b[1][2],v=xE(n,f,i),o.push(v+"!"+am(p,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=b[1][2];var w=(n.names||[])[d-1]||(n[0]||[])[d],E=w?w.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var C=b[1][1];d=b[1][2];var D;if(i.biff<=5)C<0&&(C=-C),n[C]&&(D=n[C][d]);else{var S="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(S=n.SheetNames[n[C][d].itab-1]+"!"):S=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])S+=n[C][d].Name;else if(n[0]&&n[0][d])S+=n[0][d].Name;else{var R=(ub(n,C,i)||"").split(";;");R[d-1]?S=R[d-1]:S+="SH33TJSERRX"}o.push(S);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var oe="(",se=")";if(m>=0){switch(_="",t[0][m][1][0]){case 2:oe=zt(" ",t[0][m][1][1])+oe;break;case 3:oe=zt("\r",t[0][m][1][1])+oe;break;case 4:se=zt(" ",t[0][m][1][1])+se;break;case 5:se=zt("\r",t[0][m][1][1])+se;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][m][1][0])}m=-1}o.push(oe+o.pop()+se);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:b[1][1],r:b[1][0]};var Ie={c:r.c,r:r.r};if(n.sharedf[Le(h)]){var xe=n.sharedf[Le(h)];o.push(Br(xe,a,Ie,n,i))}else{var Pe=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push(Br(l[1],a,Ie,n,i)),Pe=!0;break}Pe||o.push(b[1])}break;case"PtgArray":o.push("{"+aL(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&de.indexOf(t[0][T][0])==-1){b=t[0][m];var Ae=!0;switch(b[1][0]){case 4:Ae=!1;case 0:_=zt(" ",b[1][1]);break;case 5:Ae=!1;case 1:_=zt("\r",b[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((Ae?_:"")+o.pop()+(Ae?"":_)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function lL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Hr(t,e-2)];var o=_u(t,a,r);return e!==a+i&&(s=vu(t,e-a-i,o,r)),t.l=n,[o,s]}function uL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Hr(t,e-2)];var o=_u(t,a,r);return e!==a+i&&(s=vu(t,e-a-i,o,r)),t.l=n,[o,s]}function hL(t,e,r,n){var i=t.l+e,s=_u(t,n,r),a;return i!==t.l&&(a=vu(t,i-t.l,s,r)),[s,a]}function fL(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=_u(t,s,r);return s==65535?[[],Hr(t,e-2)]:(e!==s+2&&(i=vu(t,n-s-2,a,r)),[a,i])}function dL(t){var e;if(Gi(t,t.l+6)!==65535)return[jr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function pL(t){if(t==null){var e=ee(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Aa(t);return Aa(0)}function hm(t,e,r){var n=t.l+e,i=Ci(t,6);r.biff==2&&++t.l;var s=dL(t,8),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=uL(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function mL(t,e,r,n,i){var s=Ca(e,r,i),a=pL(t.v),o=ee(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=ee(t.bf.length),h=0;h<t.bf.length;++h)l[h]=t.bf[h];var f=wr([s,a,o,l]);return f}function Kf(t,e,r){var n=t.read_shift(4),i=_u(t,n,r),s=t.read_shift(4),a=s>0?vu(t,s,i,r):null;return[i,a]}var gL=Kf,Xf=Kf,vL=Kf,_L=Kf,yL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},hb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},xL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function wE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function wL(t){var e="of:="+t.replace(cg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function fm(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function EL(t){return t.replace(/\./,"!")}var Xl={},$o={},Yl=typeof Map<"u";function hg(t,e,r){var n=0,i=t.length;if(r){if(Yl?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Yl?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Yl?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function Yf(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Ur=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=cu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Vf(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Ta(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ms(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ki(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function fb(t,e,r,n,i,s){try{n.cellNF&&(t.z=Oe[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Ft(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Oe[e]==null&&Ki(yR[e]||"General",e),t.t==="e")t.w=t.w||Zi[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v);else if(t.t==="d"){var a=fr(t.v);(a|0)===a?t.w=a.toString(10):t.w=tu(a)}else{if(t.v===void 0)return"";t.w=ba(t.v,$o)}else t.t==="d"?t.w=Hn(e,fr(t.v),$o):t.w=Hn(e,t.v,$o)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Lf(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Lf(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function TL(t,e,r){if(t&&t["!ref"]){var n=ct(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function bL(t,e){var r=ct(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=$e(r))}var IL=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,AL=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,SL=/<(?:\w:)?hyperlink [^>]*>/mg,CL=/"(\w*:\w*)"/,kL=/<(?:\w:)?col\b[^>]*[\/]?>/g,DL=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,RL=/<(?:\w:)?pageMargins[^>]*\/>/g,db=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,PL=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,FL=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function OL(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}}),qt!=null&&e.dense==null&&(e.dense=qt);var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",h="",f=t.match(AL);f?(l=t.slice(0,f.index),h=t.slice(f.index+f[0].length)):l=h=t;var d=l.match(db);d?fg(d[0],o,i,r):(d=l.match(PL))&&ML(d[0],d[1]||"",o,i,r,a,s);var p=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=l.slice(p,p+50).match(CL);v&&bL(o,v[1])}var m=l.match(FL);m&&m[1]&&XL(m[1],i);var _=[];if(e.cellStyles){var T=l.match(kL);T&&HL(_,T)}f&&JL(f[1],o,e,c,s,a);var A=h.match(DL);A&&(o["!autofilter"]=GL(A[0]));var b=[],N=h.match(IL);if(N)for(p=0;p!=N.length;++p)b[p]=ct(N[p].slice(N[p].indexOf('"')+1));var B=h.match(SL);B&&jL(o,B,n);var M=h.match(RL);if(M&&(o["!margins"]=WL(Ve(M[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=$e(c)),e.sheetRows>0&&o["!ref"]){var x=ct(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>c.e.r&&(x.e.r=c.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>c.e.c&&(x.e.c=c.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(x))}return _.length>0&&(o["!cols"]=_),b.length>0&&(o["!merges"]=b),o}function NL(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+$e(t[r])+'"/>';return e+"</mergeCells>"}function fg(t,e,r,n){var i=Ve(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=ot(Et(i.codeName)))}function ML(t,e,r,n,i){fg(t.slice(0,t.indexOf(">")),r,n,i)}function LL(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=Ii(yt(c))}if(t&&t["!outline"]){var l={summaryBelow:1,summaryRight:1};t["!outline"].above&&(l.summaryBelow=0),t["!outline"].left&&(l.summaryRight=0),o=(o||"")+ve("outlinePr",null,l)}!s&&!o||(i[i.length]=ve("sheetPr",o,a))}var VL=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BL=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function UL(t){var e={sheet:1};return VL.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),BL.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=sg(t.password).toString(16).toUpperCase()),ve("sheetProtection",null,e)}function jL(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=Ve(Et(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+ot(s.location))):(s.Target="#"+ot(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ct(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var h=Le({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=s):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=s)}}}function WL(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function $L(t){return Ta(t),ve("pageMargins",null,t)}function HL(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=Ve(e[n],!0);i.hidden&&(i.hidden=Pt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,ag(i.width)),Rs(i);s<=a;)t[s++]=Ot(i)}}function zL(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=ve("col",null,Yf(i,n)));return r[r.length]="</cols>",r.join("")}function GL(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function qL(t,e,r,n){var i=typeof t.ref=="string"?t.ref:$e(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=ln(i);a.s.r==a.e.r&&(a.e.r=ln(e["!ref"]).e.r,i=$e(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),ve("autoFilter",null,{ref:i})}var KL=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function XL(t,e){e.Views||(e.Views=[{}]),(t.match(KL)||[]).forEach(function(r,n){var i=Ve(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Pt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function YL(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,i),{})}function QL(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=Zi[t.v];break;case"d":n&&n.cellDates?i=Ft(t.v,-1).toISOString():(t=Ot(t),t.t="n",i=""+(t.v=fr(Ft(t.v)))),typeof t.z>"u"&&(t.z=Oe[14]);break;default:i=t.v;break}var o=Fr("v",yt(i)),c={r:e},l=Ms(n.cellXfs,t,n);switch(l!==0&&(c.s=l),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Fr("v",""+hg(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=ve("f",yt(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),ve("c",o,c)}var JL=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=ru("v"),a=ru("f");return function(c,l,h,f,d,p){for(var v=0,m="",_=[],T=[],A=0,b=0,N=0,B="",M,x,w=0,E=0,C,D,S=0,R=0,oe=Array.isArray(p.CellXf),se,Ie=[],xe=[],Pe=Array.isArray(l),de=[],Ae={},re=!1,j=!!h.sheetStubs,G=c.split(e),H=0,W=G.length;H!=W;++H){m=G[H].trim();var te=m.length;if(te!==0){var me=0;e:for(v=0;v<te;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(x=Ve(m.slice(me,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,h.sheetRows&&h.sheetRows<w)continue;Ae={},re=!1,x.ht&&(re=!0,Ae.hpt=parseFloat(x.ht),Ae.hpx=qo(Ae.hpt)),x.hidden=="1"&&(re=!0,Ae.hidden=!0),x.outlineLevel!=null&&(re=!0,Ae.level=+x.outlineLevel),re&&(de[w-1]=Ae)}break;case"<":me=v;break}if(me>=v)break;if(x=Ve(m.slice(me,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,!(h.sheetRows&&h.sheetRows<w)){f.s.r>w-1&&(f.s.r=w-1),f.e.r<w-1&&(f.e.r=w-1),h&&h.cellStyles&&(Ae={},re=!1,x.ht&&(re=!0,Ae.hpt=parseFloat(x.ht),Ae.hpx=qo(Ae.hpt)),x.hidden=="1"&&(re=!0,Ae.hidden=!0),x.outlineLevel!=null&&(re=!0,Ae.level=+x.outlineLevel),re&&(de[w-1]=Ae)),_=m.slice(v).split(t);for(var ue=0;ue!=_.length&&_[ue].trim().charAt(0)=="<";++ue);for(_=_.slice(ue),v=0;v!=_.length;++v)if(m=_[v].trim(),m.length!==0){if(T=m.match(r),A=v,b=0,N=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,T!=null&&T.length===2){for(A=0,B=T[1],b=0;b!=B.length&&!((N=B.charCodeAt(b)-64)<1||N>26);++b)A=26*A+N;--A,E=A}else++E;for(b=0;b!=m.length&&m.charCodeAt(b)!==62;++b);if(++b,x=Ve(m.slice(0,b),!0),x.r||(x.r=Le({r:w-1,c:E})),B=m.slice(b),M={t:""},(T=B.match(s))!=null&&T[1]!==""&&(M.v=ot(T[1])),h.cellFormula){if((T=B.match(a))!=null&&T[1]!==""){if(M.f=ot(Et(T[1])).replace(/\r\n/g,`
`),h.xlfn||(M.f=vE(M.f)),T[0].indexOf('t="array"')>-1)M.F=(B.match(i)||[])[1],M.F.indexOf(":")>-1&&Ie.push([ct(M.F),M.F]);else if(T[0].indexOf('t="shared"')>-1){D=Ve(T[0]);var fe=ot(Et(T[1]));h.xlfn||(fe=vE(fe)),xe[parseInt(D.si,10)]=[D,fe,x.r]}}else(T=B.match(/<f[^>]*\/>/))&&(D=Ve(T[0]),xe[D.si]&&(M.f=KM(xe[D.si][1],xe[D.si][2],x.r)));var ne=Ut(x.r);for(b=0;b<Ie.length;++b)ne.r>=Ie[b][0].s.r&&ne.r<=Ie[b][0].e.r&&ne.c>=Ie[b][0].s.c&&ne.c<=Ie[b][0].e.c&&(M.F=Ie[b][1])}if(x.t==null&&M.v===void 0)if(M.f||M.F)M.v=0,M.t="n";else if(j)M.t="z";else continue;else M.t=x.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),M.t){case"n":if(M.v==""||M.v==null){if(!j)continue;M.t="z"}else M.v=parseFloat(M.v);break;case"s":if(typeof M.v>"u"){if(!j)continue;M.t="z"}else C=Xl[parseInt(M.v,10)],M.v=C.t,M.r=C.r,h.cellHTML&&(M.h=C.h);break;case"str":M.t="s",M.v=M.v!=null?Et(M.v):"",h.cellHTML&&(M.h=Um(M.v));break;case"inlineStr":T=B.match(n),M.t="s",T!=null&&(C=ig(T[1]))?(M.v=C.t,h.cellHTML&&(M.h=C.h)):M.v="";break;case"b":M.v=Pt(M.v);break;case"d":h.cellDates?M.v=Ft(M.v,1):(M.v=fr(Ft(M.v,1)),M.t="n");break;case"e":(!h||h.cellText!==!1)&&(M.w=M.v),M.v=mT[M.v];break}if(S=R=0,se=null,oe&&x.s!==void 0&&(se=p.CellXf[x.s],se!=null&&(se.numFmtId!=null&&(S=se.numFmtId),h.cellStyles&&se.fillId!=null&&(R=se.fillId))),fb(M,S,R,h,d,p),h.cellDates&&oe&&M.t=="n"&&Ko(Oe[S])&&(M.t="d",M.v=zf(M.v)),x.cm&&h.xlmeta){var Be=(h.xlmeta.Cell||[])[+x.cm-1];Be&&Be.type=="XLDAPR"&&(M.D=!0)}if(Pe){var U=Ut(x.r);l[U.r]||(l[U.r]=[]),l[U.r][U.c]=M}else l[x.r]=M}}}}de.length>0&&(l["!rows"]=de)}}();function ZL(t,e,r,n){var i=[],s=[],a=ct(t["!ref"]),o="",c,l="",h=[],f=0,d=0,p=t["!rows"],v=Array.isArray(t),m={r:l},_,T=-1;for(d=a.s.c;d<=a.e.c;++d)h[d]=Bt(d);for(f=a.s.r;f<=a.e.r;++f){for(s=[],l=Zt(f),d=a.s.c;d<=a.e.c;++d){c=h[d]+l;var A=v?(t[f]||[])[d]:t[c];A!==void 0&&(o=QL(A,c,t,e,r,n))!=null&&s.push(o)}(s.length>0||p&&p[f])&&(m={r:l},p&&p[f]&&(_=p[f],_.hidden&&(m.hidden=1),T=-1,_.hpx?T=lu(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(m.ht=T,m.customHeight=1),_.level&&(m.outlineLevel=_.level)),i[i.length]=ve("row",s.join(""),m))}if(p)for(;f<p.length;++f)p&&p[f]&&(m={r:f+1},_=p[f],_.hidden&&(m.hidden=1),T=-1,_.hpx?T=lu(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(m.ht=T,m.customHeight=1),_.level&&(m.outlineLevel=_.level),i[i.length]=ve("row","",m));return i.join("")}function pb(t,e,r,n){var i=[er,ve("worksheet",null,{xmlns:Da[0],"xmlns:r":hr.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",h=ct(l);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=$e(h)}n||(n={}),c["!comments"]=[];var f=[];LL(c,r,t,e,i),i[i.length]=ve("dimension",null,{ref:l}),i[i.length]=YL(c,e,t,r),e.sheetFormat&&(i[i.length]=ve("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=zL(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=ZL(c,e,t,r,n),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=UL(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=qL(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=NL(c["!merges"]));var d=-1,p,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=_t(n,-1,yt(m[1].Target).replace(/#.*$/,""),Ke.HLINK),p["r:id"]="rId"+v),(d=m[1].Target.indexOf("#"))>-1&&(p.location=yt(m[1].Target.slice(d+1))),m[1].Tooltip&&(p.tooltip=yt(m[1].Tooltip)),i[i.length]=ve("hyperlink",null,p))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=$L(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Fr("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(v=_t(n,-1,"../drawings/drawing"+(t+1)+".xml",Ke.DRAW),i[i.length]=ve("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=_t(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ke.VML),i[i.length]=ve("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function e3(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function t3(t,e,r){var n=ee(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=lu(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,d=-1,p=h<<10;p<h+1<<10;++p){l.c=p;var v=Array.isArray(r)?(r[l.r]||[])[l.c]:r[Le(l)];v&&(f<0&&(f=p),d=p)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function r3(t,e,r,n){var i=t3(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ie(t,0,i)}var n3=Oa,i3=Jo;function s3(){}function a3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=lP(t,e-19),r}function o3(t,e,r){r==null&&(r=ee(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Of({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),uT(t,r),r.slice(0,r.l)}function c3(t){var e=zn(t);return[e]}function l3(t,e,r){return r==null&&(r=ee(8)),Ra(e,r)}function u3(t){var e=Pa(t);return[e]}function h3(t,e,r){return r==null&&(r=ee(4)),Fa(e,r)}function f3(t){var e=zn(t),r=t.read_shift(1);return[e,r,"b"]}function d3(t,e,r){return r==null&&(r=ee(9)),Ra(e,r),r.write_shift(1,t.v?1:0),r}function p3(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"b"]}function m3(t,e,r){return r==null&&(r=ee(5)),Fa(e,r),r.write_shift(1,t.v?1:0),r}function g3(t){var e=zn(t),r=t.read_shift(1);return[e,r,"e"]}function v3(t,e,r){return r==null&&(r=ee(9)),Ra(e,r),r.write_shift(1,t.v),r}function _3(t){var e=Pa(t),r=t.read_shift(1);return[e,r,"e"]}function y3(t,e,r){return r==null&&(r=ee(8)),Fa(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function x3(t){var e=zn(t),r=t.read_shift(4);return[e,r,"s"]}function w3(t,e,r){return r==null&&(r=ee(12)),Ra(e,r),r.write_shift(4,e.v),r}function E3(t){var e=Pa(t),r=t.read_shift(4);return[e,r,"s"]}function T3(t,e,r){return r==null&&(r=ee(8)),Fa(e,r),r.write_shift(4,e.v),r}function b3(t){var e=zn(t),r=jr(t);return[e,r,"n"]}function I3(t,e,r){return r==null&&(r=ee(16)),Ra(e,r),Aa(t.v,r),r}function mb(t){var e=Pa(t),r=jr(t);return[e,r,"n"]}function A3(t,e,r){return r==null&&(r=ee(12)),Fa(e,r),Aa(t.v,r),r}function S3(t){var e=zn(t),r=Zm(t);return[e,r,"n"]}function C3(t,e,r){return r==null&&(r=ee(12)),Ra(e,r),hT(t.v,r),r}function k3(t){var e=Pa(t),r=Zm(t);return[e,r,"n"]}function D3(t,e,r){return r==null&&(r=ee(8)),Fa(e,r),hT(t.v,r),r}function R3(t){var e=zn(t),r=Ym(t);return[e,r,"is"]}function P3(t){var e=zn(t),r=$r(t);return[e,r,"str"]}function F3(t,e,r){return r==null&&(r=ee(12+4*t.v.length)),Ra(e,r),Er(t.v,r),r.length>r.l?r.slice(0,r.l):r}function O3(t){var e=Pa(t),r=$r(t);return[e,r,"str"]}function N3(t,e,r){return r==null&&(r=ee(8+4*t.v.length)),Fa(e,r),Er(t.v,r),r.length>r.l?r.slice(0,r.l):r}function M3(t,e,r){var n=t.l+e,i=zn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=Xf(t,n-t.l,r);a[3]=Br(o,null,i,r.supbooks,r)}else t.l=n;return a}function L3(t,e,r){var n=t.l+e,i=zn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=Xf(t,n-t.l,r);a[3]=Br(o,null,i,r.supbooks,r)}else t.l=n;return a}function V3(t,e,r){var n=t.l+e,i=zn(t);i.r=r["!row"];var s=jr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=Xf(t,n-t.l,r);a[3]=Br(o,null,i,r.supbooks,r)}else t.l=n;return a}function B3(t,e,r){var n=t.l+e,i=zn(t);i.r=r["!row"];var s=$r(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=Xf(t,n-t.l,r);a[3]=Br(o,null,i,r.supbooks,r)}else t.l=n;return a}var U3=Oa,j3=Jo;function W3(t,e){return e==null&&(e=ee(4)),e.write_shift(4,t),e}function $3(t,e){var r=t.l+e,n=Oa(t,16),i=Qm(t),s=$r(t),a=$r(t),o=$r(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function H3(t,e){var r=ee(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Jo({s:Ut(t[0]),e:Ut(t[0])},r),Jm("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Er(i||"",r),Er(t[1].Tooltip||"",r),Er("",r),r.slice(0,r.l)}function z3(){}function G3(t,e,r){var n=t.l+e,i=fT(t,16),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=gL(t,n-t.l,r);a[1]=o}else t.l=n;return a}function q3(t,e,r){var n=t.l+e,i=Oa(t,16),s=[i];if(r.cellFormula){var a=_L(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function K3(t,e,r){r==null&&(r=ee(18));var n=Yf(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var gb=["left","right","top","bottom","header","footer"];function X3(t){var e={};return gb.forEach(function(r){e[r]=jr(t,8)}),e}function Y3(t,e){return e==null&&(e=ee(6*8)),Ta(t),gb.forEach(function(r){Aa(t[r],e)}),e}function Q3(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function J3(t,e,r){r==null&&(r=ee(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Z3(t){var e=ee(24);return e.write_shift(4,4),e.write_shift(4,1),Jo(t,e),e}function eV(t,e){return e==null&&(e=ee(16*4+2)),e.write_shift(2,t.password?sg(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function tV(){}function rV(){}function nV(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}}),qt!=null&&o.dense==null&&(o.dense=qt);var c=o.dense?[]:{},l,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],d=!1,p=!1,v,m,_,T,A,b,N,B,M,x=[];o.biff=12,o["!row"]=0;var w=0,E=!1,C=[],D={},S=o.supbooks||i.supbooks||[[]];if(S.sharedf=D,S.arrayf=C,S.SheetNames=i.SheetNames||i.Sheets.map(function(Ae){return Ae.name}),!o.supbooks&&(o.supbooks=S,i.Names))for(var R=0;R<i.Names.length;++R)S[0][R+1]=i.Names[R];var oe=[],se=[],Ie=!1;uu[16]={n:"BrtShortReal",f:mb};var xe,Pe;if(Ji(t,function(re,j,G){if(!p)switch(G){case 148:l=re;break;case 0:v=re,o.sheetRows&&o.sheetRows<=v.r&&(p=!0),B=Zt(T=v.r),o["!row"]=v.r,(re.hidden||re.hpt||re.level!=null)&&(re.hpt&&(re.hpx=qo(re.hpt)),se[re.r]=re);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:re[2]},re[2]){case"n":m.v=re[1];break;case"s":N=Xl[re[1]],m.v=N.t,m.r=N.r;break;case"b":m.v=!!re[1];break;case"e":m.v=re[1],o.cellText!==!1&&(m.w=Zi[m.v]);break;case"str":m.t="s",m.v=re[1];break;case"is":m.t="s",m.v=re[1].t;break}if((_=a.CellXf[re[0].iStyleRef])&&fb(m,_.numFmtId,null,o,s,a),A=re[0].c==-1?A+1:re[0].c,o.dense?(c[T]||(c[T]=[]),c[T][A]=m):c[Bt(A)+B]=m,o.cellFormula){for(E=!1,w=0;w<C.length;++w){var H=C[w];v.r>=H[0].s.r&&v.r<=H[0].e.r&&A>=H[0].s.c&&A<=H[0].e.c&&(m.F=$e(H[0]),E=!0)}!E&&re.length>3&&(m.f=re[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>A&&(h.s.c=A),h.e.r<v.r&&(h.e.r=v.r),h.e.c<A&&(h.e.c=A),o.cellDates&&_&&m.t=="n"&&Ko(Oe[_.numFmtId])){var W=ya(m.v);W&&(m.t="d",m.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}xe&&(xe.type=="XLDAPR"&&(m.D=!0),xe=void 0),Pe&&(Pe=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;m={t:"z",v:void 0},A=re[0].c==-1?A+1:re[0].c,o.dense?(c[T]||(c[T]=[]),c[T][A]=m):c[Bt(A)+B]=m,h.s.r>v.r&&(h.s.r=v.r),h.s.c>A&&(h.s.c=A),h.e.r<v.r&&(h.e.r=v.r),h.e.c<A&&(h.e.c=A),xe&&(xe.type=="XLDAPR"&&(m.D=!0),xe=void 0),Pe&&(Pe=void 0);break;case 176:x.push(re);break;case 49:xe=((o.xlmeta||{}).Cell||[])[re-1];break;case 494:var te=n["!id"][re.relId];for(te?(re.Target=te.Target,re.loc&&(re.Target+="#"+re.loc),re.Rel=te):re.relId==""&&(re.Target="#"+re.loc),T=re.rfx.s.r;T<=re.rfx.e.r;++T)for(A=re.rfx.s.c;A<=re.rfx.e.c;++A)o.dense?(c[T]||(c[T]=[]),c[T][A]||(c[T][A]={t:"z",v:void 0}),c[T][A].l=re):(b=Le({c:A,r:T}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=re);break;case 426:if(!o.cellFormula)break;C.push(re),M=o.dense?c[T][A]:c[Bt(A)+B],M.f=Br(re[1],h,{r:v.r,c:A},S,o),M.F=$e(re[0]);break;case 427:if(!o.cellFormula)break;D[Le(re[0].s)]=re[1],M=o.dense?c[T][A]:c[Bt(A)+B],M.f=Br(re[1],h,{r:v.r,c:A},S,o);break;case 60:if(!o.cellStyles)break;for(;re.e>=re.s;)oe[re.e--]={width:re.w/256,hidden:!!(re.flags&1),level:re.level},Ie||(Ie=!0,ag(re.w/256)),Rs(oe[re.e+1]);break;case 161:c["!autofilter"]={ref:$e(re)};break;case 476:c["!margins"]=re;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),re.name&&(i.Sheets[r].CodeName=re.name),(re.above||re.left)&&(c["!outline"]={above:re.above,left:re.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),re.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:f.push(G),d=!0;break;case 38:f.pop(),d=!1;break;default:if(!j.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=$e(l||h)),o.sheetRows&&c["!ref"]){var de=ct(c["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>h.e.r&&(de.e.r=h.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>h.e.c&&(de.e.c=h.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=$e(de))}return x.length>0&&(c["!merges"]=x),oe.length>0&&(c["!cols"]=oe),se.length>0&&(c["!rows"]=se),c}function iV(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Ot(e),e.z=e.z||Oe[14],e.v=fr(Ft(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Ms(i.cellXfs,e,i),e.l&&s["!links"].push([Le(c),e.l]),e.c&&s["!comments"].push([Le(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=hg(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?ie(t,18,T3(e,c)):ie(t,7,w3(e,c))):(c.t="str",a?ie(t,17,N3(e,c)):ie(t,6,F3(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ie(t,13,D3(e,c)):ie(t,2,C3(e,c)):a?ie(t,16,A3(e,c)):ie(t,5,I3(e,c)),!0;case"b":return c.t="b",a?ie(t,15,m3(e,c)):ie(t,4,d3(e,c)),!0;case"e":return c.t="e",a?ie(t,14,y3(e,c)):ie(t,3,v3(e,c)),!0}return a?ie(t,12,h3(e,c)):ie(t,1,l3(e,c)),!0}function sV(t,e,r,n){var i=ct(e["!ref"]||"A1"),s,a="",o=[];ie(t,145);var c=Array.isArray(e),l=i.e.r;e["!rows"]&&(l=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=l;++h){a=Zt(h),r3(t,e,i,h);var f=!1;if(h<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(o[d]=Bt(d)),s=o[d]+a;var p=c?(e[h]||[])[d]:e[s];if(!p){f=!1;continue}f=iV(t,p,h,d,n,e,f)}}ie(t,146)}function aV(t,e){!e||!e["!merges"]||(ie(t,177,W3(e["!merges"].length)),e["!merges"].forEach(function(r){ie(t,176,j3(r))}),ie(t,178))}function oV(t,e){!e||!e["!cols"]||(ie(t,390),e["!cols"].forEach(function(r,n){r&&ie(t,60,K3(n,r))}),ie(t,391))}function cV(t,e){!e||!e["!ref"]||(ie(t,648),ie(t,649,Z3(ct(e["!ref"]))),ie(t,650))}function lV(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=_t(r,-1,n[1].Target.replace(/#.*$/,""),Ke.HLINK);ie(t,494,H3(n,i))}}),delete e["!links"]}function uV(t,e,r,n){if(e["!comments"].length>0){var i=_t(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ke.VML);ie(t,551,Jm("rId"+i)),e["!legacy"]=i}}function hV(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:$e(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=ln(s);o.s.r==o.e.r&&(o.e.r=ln(e["!ref"]).e.r,s=$e(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ie(t,161,Jo(ct(s))),ie(t,162)}}function fV(t,e,r){ie(t,133),ie(t,137,J3(e,r)),ie(t,138),ie(t,134)}function dV(t,e){e["!protect"]&&ie(t,535,eV(e["!protect"]))}function pV(t,e,r,n){var i=cn(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=ct(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ie(i,129),(r.vbaraw||a["!outline"])&&ie(i,147,o3(o,a["!outline"])),ie(i,148,i3(c)),fV(i,a,r.Workbook),oV(i,a,t,e,r),sV(i,a,t,e,r),dV(i,a),hV(i,a,r,t),aV(i,a),lV(i,a,n),a["!margins"]&&ie(i,476,Y3(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&cV(i,a),uV(i,a,t,n),ie(i,130),i.end()}function mV(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=ot((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function gV(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,c=0,l="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=mV(f);h.s.r=h.s.c=0,h.e.c=o,l=Bt(o),d[0].forEach(function(p,v){a[l+Zt(v)]={t:"n",v:p,z:d[1]},c=v}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(a["!ref"]=$e(h)),a}function vV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(db);return o&&fg(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function _V(t,e){t.l+=10;var r=$r(t,e-10);return{name:r}}function yV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=[],o=!1;return Ji(t,function(l,h,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f);break;case 38:a.pop();break;default:if(h.T>0)a.push(f);else if(h.T<0)a.pop();else if(!o||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var dg=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],xV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],wV=[],EV=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function EE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Pt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function TE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Pt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function vb(t){TE(t.WBProps,dg),TE(t.CalcPr,EV),EE(t.WBView,xV),EE(t.Sheets,wV),$o.date1904=Pt(t.WBProps.date1904)}function TV(t){return!t.Workbook||!t.Workbook.WBProps?"false":Pt(t.Workbook.WBProps.date1904)?"true":"false"}var bV="][*?/\\".split("");function _b(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return bV.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function IV(t,e,r){t.forEach(function(n,i){_b(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function AV(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];IV(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)TL(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var SV=/<\w+:workbook/;function CV(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(zr,function(c,l){var h=Ve(c);switch(Si(h[0])){case"<?xml":break;case"<workbook":c.match(SV)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":dg.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Pt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=Et(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=ot(Et(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Et(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Pt(h.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=ot(Et(t.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),Da.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return vb(r),r}function yb(t){var e=[er];e[e.length]=ve("workbook",null,{xmlns:Da[0],"xmlns:r":hr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(dg.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=ve("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:yt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=ve("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=ve("definedName",yt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function kV(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=xm(t,e-8),r.name=$r(t),r}function DV(t,e){return e||(e=ee(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),Jm(t.strRelID,e),Er(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function RV(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?$r(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function PV(t,e){e||(e=ee(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),uT(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function FV(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function OV(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=uP(t),a=vL(t,0,r),o=Qm(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function NV(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],uu[16]={n:"BrtFRTArchID$",f:FV},Ji(t,function(c,l,h){switch(h){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=Br(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,c]):a[0]=[h,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),vb(r),r.Names=s,r.supbooks=a,r}function MV(t,e){ie(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ie(t,156,DV(i))}ie(t,144)}function LV(t,e){e||(e=ee(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Er("SheetJS",e),Er(Zl.version,e),Er(Zl.version,e),Er("7262",e),e.length>e.l?e.slice(0,e.l):e}function VV(t,e){e||(e=ee(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function BV(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ie(t,135),ie(t,158,VV(i)),ie(t,136))}}function UV(t,e){var r=cn();return ie(r,131),ie(r,128,LV()),ie(r,153,PV(t.Workbook&&t.Workbook.WBProps||null)),BV(r,t,e),MV(r,t,e),ie(r,132),r.end()}function jV(t,e,r){return e.slice(-4)===".bin"?NV(t,r):CV(t,r)}function WV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?nV(t,n,r,i,s,a,o):OL(t,n,r,i,s,a,o)}function $V(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?yV(t,n,r,i,s,a,o):vV(t,n,r,i,s,a,o)}function HV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?GM(t,n,r,i,s,a,o):qM(t,n,r,i,s,a,o)}function zV(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?HM(t,n,r,i,s,a,o):zM(t,n,r,i,s,a,o)}function GV(t,e,r,n){return e.slice(-4)===".bin"?jN(t,r,n):kN(t,r,n)}function qV(t,e,r){return ZT(t,r)}function KV(t,e,r){return e.slice(-4)===".bin"?KO(t,r):zO(t,r)}function XV(t,e,r){return e.slice(-4)===".bin"?BM(t,r):DM(t,r)}function YV(t,e,r){return e.slice(-4)===".bin"?SM(t,e,r):IM(t,e,r)}function QV(t,e,r,n){return r.slice(-4)===".bin"?CM(t,e,r,n):void 0}function JV(t,e,r){return e.slice(-4)===".bin"?EM(t,e,r):bM(t,e,r)}function ZV(t,e,r){return(e.slice(-4)===".bin"?UV:yb)(t,r)}function e6(t,e,r,n,i){return(e.slice(-4)===".bin"?pV:pb)(t,r,n,i)}function t6(t,e,r){return(e.slice(-4)===".bin"?QN:QT)(t,r)}function r6(t,e,r){return(e.slice(-4)===".bin"?QO:$T)(t,r)}function n6(t,e,r){return(e.slice(-4)===".bin"?UM:rb)(t,r)}function i6(t){return(t.slice(-4)===".bin"?TM:eb)()}var xb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,wb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ii(t,e){var r=t.split(/\s+/),n=[];if(e||(n[0]=r[0]),r.length===1)return n;var i=t.match(xb),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(wb),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function s6(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(xb),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(wb),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var Ql;function a6(t,e){var r=Ql[t]||ot(t);return r==="General"?ba(e):Hn(r,e)}function o6(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Pt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Ft(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[ot(e)]=i}function c6(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||Zi[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v):t.w=ba(t.v):t.w=a6(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=Ql[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&Ko(n)){var i=ya(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function l6(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=wN[n.Pattern]||n.Pattern)}t[e.ID]=e}function u6(t,e,r,n,i,s,a,o,c,l){var h="General",f=n.StyleID,d={};l=l||{};var p=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&p.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Pt(t);break;case"String":n.t="s",n.r=Uw(ot(t)),n.v=t.indexOf("<")>-1?ot(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Ft(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ot(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=mT[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=Uw(e||t));break}if(c6(n,h,l),l.cellFormula!==!1)if(n.Formula){var m=ot(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=Wo(m,i),delete n.Formula,n.ArrayRange=="RC"?n.F=Wo("RC:RC",i):n.ArrayRange&&(n.F=Wo(n.ArrayRange,i),c.push([ct(n.F),n.F]))}else for(v=0;v<c.length;++v)i.r>=c[v][0].s.r&&i.r<=c[v][0].e.r&&i.c>=c[v][0].s.c&&i.c<=c[v][0].e.c&&(n.F=c[v][1]);l.cellStyles&&(p.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function h6(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function dm(t,e){var r=e||{};Xo();var n=Wl(jm(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof gt<"u"?n=gt.utils.decode(65001,_m(n)):n=Et(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Ot(r);return a.type="string",Go.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Lt){i.indexOf("<"+Lt)>=0&&(s=!0)}),s)return Y6(n,r);Ql={"General Number":"General","General Date":Oe[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Oe[15],"Short Date":Oe[14],"Long Time":Oe[19],"Medium Time":Oe[18],"Short Time":Oe[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Oe[2],Standard:Oe[4],Percent:Oe[10],Scientific:Oe[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;qt!=null&&r.dense==null&&(r.dense=qt);var h={},f=[],d=r.dense?[]:{},p="",v={},m={},_=ii('<Data ss:Type="String">'),T=0,A=0,b=0,N={s:{r:2e6,c:2e6},e:{r:0,c:0}},B={},M={},x="",w=0,E=[],C={},D={},S=0,R=[],oe=[],se={},Ie=[],xe,Pe=!1,de=[],Ae=[],re={},j=0,G=0,H={Sheets:[],WBProps:{date1904:!1}},W={};iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var te="";o=iu.exec(n);)switch(o[3]=(te=o[3]).toLowerCase()){case"data":if(te=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?u6(n.slice(T,o.index),x,_,c[c.length-1][0]=="comment"?se:v,{c:A,r:b},B,Ie[A],m,de,r):(x="",_=ii(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(v.c=oe),(!r.sheetRows||r.sheetRows>b)&&v.v!==void 0&&(r.dense?(d[b]||(d[b]=[]),d[b][A]=v):d[Bt(A)+Zt(b)]=v),v.HRef&&(v.l={Target:ot(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(j=A+(parseInt(v.MergeAcross,10)|0),G=b+(parseInt(v.MergeDown,10)|0),E.push({s:{c:A,r:b},e:{c:j,r:G}})),!r.sheetStubs)v.MergeAcross?A=j+1:++A;else if(v.MergeAcross||v.MergeDown){for(var me=A;me<=j;++me)for(var ue=b;ue<=G;++ue)(me>A||ue>b)&&(r.dense?(d[ue]||(d[ue]=[]),d[ue][me]={t:"z"}):d[Bt(me)+Zt(ue)]={t:"z"});A=j+1}else++A;else v=s6(o[0]),v.Index&&(A=+v.Index-1),A<N.s.c&&(N.s.c=A),A>N.e.c&&(N.e.c=A),o[0].slice(-2)==="/>"&&++A,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<N.s.r&&(N.s.r=b),b>N.e.r&&(N.e.r=b),o[0].slice(-2)==="/>"&&(m=ii(o[0]),m.Index&&(b=+m.Index-1)),A=0,++b):(m=ii(o[0]),m.Index&&(b=+m.Index-1),re={},(m.AutoFitHeight=="0"||m.Height)&&(re.hpx=parseInt(m.Height,10),re.hpt=lu(re.hpx),Ae[b]=re),m.Hidden=="1"&&(re.hidden=!0,Ae[b]=re));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(p),N.s.r<=N.e.r&&N.s.c<=N.e.c&&(d["!ref"]=$e(N),r.sheetRows&&r.sheetRows<=N.e.r&&(d["!fullref"]=d["!ref"],N.e.r=r.sheetRows-1,d["!ref"]=$e(N))),E.length&&(d["!merges"]=E),Ie.length>0&&(d["!cols"]=Ie),Ae.length>0&&(d["!rows"]=Ae),h[p]=d}else N={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=A=0,c.push([o[3],!1]),l=ii(o[0]),p=ot(l.Name),d=r.dense?[]:{},E=[],de=[],Ae=[],W={name:p,Hidden:0},H.Sheets.push(W);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),Ie=[],Pe=!1}break;case"style":o[1]==="/"?l6(B,M,r):M=ii(o[0]);break;case"numberformat":M.nf=ot(ii(o[0]).Format||"General"),Ql[M.nf]&&(M.nf=Ql[M.nf]);for(var fe=0;fe!=392&&Oe[fe]!=M.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Oe[fe]==null){Ki(M.nf,fe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(xe=ii(o[0]),xe.Hidden&&(xe.hidden=!0,delete xe.Hidden),xe.Width&&(xe.wpx=parseInt(xe.Width,10)),!Pe&&xe.wpx>10){Pe=!0,Ur=XT;for(var ne=0;ne<Ie.length;++ne)Ie[ne]&&Rs(Ie[ne])}Pe&&Rs(xe),Ie[xe.Index-1||Ie.length]=xe;for(var Be=0;Be<+xe.Span;++Be)Ie[Ie.length]=Ot(xe);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var U=Ve(o[0]),st={Name:U.Name,Ref:Wo(U.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(st.Sheet=H.Sheets.length-1),H.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(w,o.index):w=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;M.Interior=ii(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?NP(C,te,n.slice(S,o.index)):S=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));h6(se),oe.push(se)}else c.push([o[3],!1]),l=ii(o[0]),se={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var He=ii(o[0]);d["!autofilter"]={ref:Wo(He.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return CE(n,r);var at=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(S,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else S=o.index+o[0].length;break;case"header":d["!margins"]||Ta(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].header=+Ve(o[0]).Margin);break;case"footer":d["!margins"]||Ta(d["!margins"]={},"xlml"),isNaN(+Ve(o[0]).Margin)||(d["!margins"].footer=+Ve(o[0]).Margin);break;case"pagemargins":var Xe=Ve(o[0]);d["!margins"]||Ta(d["!margins"]={},"xlml"),isNaN(+Xe.Top)||(d["!margins"].top=+Xe.Top),isNaN(+Xe.Left)||(d["!margins"].left=+Xe.Left),isNaN(+Xe.Right)||(d["!margins"].right=+Xe.Right),isNaN(+Xe.Bottom)||(d["!margins"].bottom=+Xe.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?o6(D,te,R,n.slice(S,o.index)):(R=o,S=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var Te={};return!r.bookSheets&&!r.bookProps&&(Te.Sheets=h),Te.SheetNames=f,Te.Workbook=H,Te.SSF=Ot(Oe),Te.Props=C,Te.Custprops=D,Te}function Sm(t,e){switch(mg(e=e||{}),e.type||"base64"){case"base64":return dm(En(t),e);case"binary":case"buffer":case"file":return dm(t,e);case"array":return dm(Os(t),e)}}function f6(t,e){var r=[];return t.Props&&r.push(MP(t.Props,e)),t.Custprops&&r.push(LP(t.Props,t.Custprops,e)),r.join("")}function d6(){return""}function p6(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(ve("NumberFormat",null,{"ss:Format":yt(Oe[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(ve("Style",s.join(""),a))}),ve("Styles",r.join(""))}function Eb(t){return ve("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+lg(t.Ref,{r:0,c:0})})}function m6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Eb(i)))}return ve("Names",r.join(""))}function g6(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Eb(o)))}return s.join("")}function v6(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(ve("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(ve("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(ve("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Fr("ProtectContents","True")),t["!protect"].objects&&i.push(Fr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Fr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Fr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Fr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":ve("WorksheetOptions",i.join(""),{xmlns:yn.x})}function _6(t){return t.map(function(e){var r=VR(e.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":e.a})}).join("")}function y6(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+yt(lg(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=Ut(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=yt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=yt(t.l.Tooltip))),r["!merges"])for(var l=r["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var f="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(t.v);break;case"b":f="Boolean",d=t.v?"1":"0";break;case"e":f="Error",d=Zi[t.v];break;case"d":f="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Oe[14]);break;case"s":f="String",d=LR(t.v||"");break}var p=Ms(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=a.c+1;var v=t.v!=null?d:"",m=t.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(t.c||[]).length>0&&(m+=_6(t.c)),ve("Cell",m,o)}function x6(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=qo(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function w6(t,e,r,n){if(!t["!ref"])return"";var i=ct(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,T){Rs(_);var A=!!_.width,b=Yf(T,_),N={"ss:Index":T+1};A&&(N["ss:Width"]=ou(b.width)),_.hidden&&(N["ss:Hidden"]="1"),o.push(ve("Column",null,N))});for(var c=Array.isArray(t),l=i.s.r;l<=i.e.r;++l){for(var h=[x6(l,(t["!rows"]||[])[l])],f=i.s.c;f<=i.e.c;++f){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>l)&&!(s[a].e.c<f)&&!(s[a].e.r<l)){(s[a].s.c!=f||s[a].s.r!=l)&&(d=!0);break}if(!d){var p={r:l,c:f},v=Le(p),m=c?(t[l]||[])[f]:t[v];h.push(y6(m,v,t,e,r,n,p))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function E6(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?g6(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?w6(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(v6(s,e,t,r)),n.join("")}function T6(t,e){e||(e={}),t.SSF||(t.SSF=Ot(Oe)),t.SSF&&(Xo(),Wf(t.SSF),e.revssf=Hf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(f6(t,e)),r.push(d6(t,e)),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(ve("Worksheet",E6(n,e,t),{"ss:Name":yt(t.SheetNames[n])}));return r[2]=p6(t,e),r[3]=m6(t,e),er+ve("Workbook",r.join(""),{xmlns:yn.ss,"xmlns:o":yn.o,"xmlns:x":yn.x,"xmlns:ss":yn.ss,"xmlns:dt":yn.dt,"xmlns:html":yn.html})}function b6(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=mP(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=gP(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var I6=[60,1084,2066,2165,2175];function A6(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=Gi(r,r.l),l=Cm[c],h=0;l!=null&&I6.indexOf(c)>-1;)s=Gi(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+s),a.push(o),r.l+=4+s,l=Cm[c=Gi(r,r.l)];var f=wr(a);Pr(f,0);var d=0;f.lens=[];for(var p=0;p<a.length;++p)f.lens.push(d),d+=a[p].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,i)}function Ei(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Oe[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||Zi[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=tu(t.v):t.w=ba(t.v):t.w=Hn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&Ko(Oe[n]||String(n))){var i=ya(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Af(t,e,r){return{v:t,ixfe:e,t:r}}function S6(t,e){var r={opts:{}},n={};qt!=null&&e.dense==null&&(e.dense=qt);var i=e.dense?[]:{},s={},a={},o=null,c=[],l="",h={},f,d="",p,v,m,_,T={},A=[],b,N,B=[],M=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},E=function(ze){return ze<8?xa[ze]:ze<64&&M[ze-8]||xa[ze]},C=function(ze,Nt,nn){var Dt=Nt.XF.data;if(!(!Dt||!Dt.patternType||!nn||!nn.cellStyles)){Nt.s={},Nt.s.patternType=Dt.patternType;var pi;(pi=au(E(Dt.icvFore)))&&(Nt.s.fgColor={rgb:pi}),(pi=au(E(Dt.icvBack)))&&(Nt.s.bgColor={rgb:pi})}},D=function(ze,Nt,nn){if(!(re>1)&&!(nn.sheetRows&&ze.r>=nn.sheetRows)){if(nn.cellStyles&&Nt.XF&&Nt.XF.data&&C(ze,Nt,nn),delete Nt.ixfe,delete Nt.XF,f=ze,d=Le(ze),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),ze.r<a.s.r&&(a.s.r=ze.r),ze.c<a.s.c&&(a.s.c=ze.c),ze.r+1>a.e.r&&(a.e.r=ze.r+1),ze.c+1>a.e.c&&(a.e.c=ze.c+1),nn.cellFormula&&Nt.f){for(var Dt=0;Dt<A.length;++Dt)if(!(A[Dt][0].s.c>ze.c||A[Dt][0].s.r>ze.r)&&!(A[Dt][0].e.c<ze.c||A[Dt][0].e.r<ze.r)){Nt.F=$e(A[Dt][0]),(A[Dt][0].s.c!=ze.c||A[Dt][0].s.r!=ze.r)&&delete Nt.f,Nt.f&&(Nt.f=""+Br(A[Dt][1],a,ze,de,S));break}}nn.dense?(i[ze.r]||(i[ze.r]=[]),i[ze.r][ze.c]=Nt):i[d]=Nt}},S={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(S.password=e.password);var R,oe=[],se=[],Ie=[],xe=[],Pe=!1,de=[];de.SheetNames=S.snames,de.sharedf=S.sharedf,de.arrayf=S.arrayf,de.names=[],de.XTI=[];var Ae=0,re=0,j=0,G=[],H=[],W;S.codepage=1200,si(1200);for(var te=!1;t.l<t.length-1;){var me=t.l,ue=t.read_shift(2);if(ue===0&&Ae===10)break;var fe=t.l===t.length?0:t.read_shift(2),ne=Cm[ue];if(ne&&ne.f){if(e.bookSheets&&Ae===133&&ue!==133)break;if(Ae=ue,ne.r===2||ne.r==12){var Be=t.read_shift(2);if(fe-=2,!S.enc&&Be!==ue&&((Be&255)<<8|Be>>8)!==ue)throw new Error("rt mismatch: "+Be+"!="+ue);ne.r==12&&(t.l+=10,fe-=10)}var U={};if(ue===10?U=ne.f(t,fe,S):U=A6(ue,ne,t,fe,S),re==0&&[9,521,1033,2057].indexOf(Ae)===-1)continue;switch(ue){case 34:r.opts.Date1904=x.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(S.enc||(t.l=0),S.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:S.lastuser=U;break;case 66:var st=Number(U);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}si(S.codepage=st),te=!0;break;case 317:S.rrtabid=U;break;case 25:S.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:S.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:B.push(U);break;case 430:de.push([U]),de[de.length-1].XTI=[];break;case 35:case 547:de[de.length-1].push(U);break;case 24:case 536:W={Name:U.Name,Ref:Br(U.rgce,a,null,de,S)},U.itab>0&&(W.Sheet=U.itab-1),de.names.push(W),de[0]||(de[0]=[],de[0].XTI=[]),de[de.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(H[U.itab-1]={ref:$e(U.rgce[0][0][1][2])});break;case 22:S.ExternCount=U;break;case 23:de.length==0&&(de[0]=[],de[0].XTI=[]),de[de.length-1].XTI=de[de.length-1].XTI.concat(U),de.XTI=de.XTI.concat(U);break;case 2196:if(S.biff<8)break;W!=null&&(W.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&S.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,S.snames.push(U.name);break;case 10:{if(--re)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=$e(a),e.sheetRows&&e.sheetRows<=a.e.r){var He=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=$e(a),a.e.r=He}a.e.r++,a.e.c++}oe.length>0&&(i["!merges"]=oe),se.length>0&&(i["!objects"]=se),Ie.length>0&&(i["!cols"]=Ie),xe.length>0&&(i["!rows"]=xe),x.Sheets.push(w)}l===""?h=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(S.biff===8&&(S.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),S.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(S.biff=5,te=!0,si(S.codepage=28591)),S.biff==8&&U.BIFFVer==0&&U.dt==16&&(S.biff=2),re++)break;if(i=e.dense?[]:{},S.biff<8&&!te&&(te=!0,si(S.codepage=e.codepage||1252)),S.biff<5||U.BIFFVer==0&&U.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:t.l-fe,name:l};s[at.pos]=at,S.snames.push(l)}else l=(s[me]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),oe=[],se=[],S.arrayf=A=[],Ie=[],xe=[],Pe=!1,w={Hidden:(s[me]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[U.r]||[])[U.c]:i[Le({c:U.c,r:U.r})])&&++U.c,b={ixfe:U.ixfe,XF:B[U.ixfe]||{},v:U.val,t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 5:case 517:b={ixfe:U.ixfe,XF:B[U.ixfe],v:U.val,t:U.t},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 638:b={ixfe:U.ixfe,XF:B[U.ixfe],v:U.rknum,t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 189:for(var Xe=U.c;Xe<=U.C;++Xe){var Te=U.rkrec[Xe-U.c][0];b={ixfe:Te,XF:B[Te],v:U.rkrec[Xe-U.c][1],t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:Xe,r:U.r},b,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(b=Af(U.val,U.cell.ixfe,U.tt),b.XF=B[b.ixfe],e.cellFormula){var Lt=U.formula;if(Lt&&Lt[0]&&Lt[0][0]&&Lt[0][0][0]=="PtgExp"){var Qr=Lt[0][0][1][0],un=Lt[0][0][1][1],hn=Le({r:Qr,c:un});T[hn]?b.f=""+Br(U.formula,a,U.cell,de,S):b.F=((e.dense?(i[Qr]||[])[un]:i[hn])||{}).F}else b.f=""+Br(U.formula,a,U.cell,de,S)}j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D(U.cell,b,e),o=U}break;case 7:case 519:if(o)o.val=U,b=Af(U,o.cell.ixfe,"s"),b.XF=B[b.ixfe],e.cellFormula&&(b.f=""+Br(o.formula,a,o.cell,de,S)),j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D(o.cell,b,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(U);var us=Le(U[0].s);if(p=e.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[us],e.cellFormula&&p){if(!o||!us||!p)break;p.f=""+Br(U[1],a,U[0],de,S),p.F=$e(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Le(o.cell)]=U[0],p=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Le(o.cell)],(p||{}).f=""+Br(U[0],a,f,de,S)}}break;case 253:b=Af(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(b.h=c[U.isst].h),b.XF=B[b.ixfe],j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:U.ixfe,XF:B[U.ixfe],t:"z"},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e));break;case 190:if(e.sheetStubs)for(var di=U.c;di<=U.C;++di){var Ar=U.ixfe[di-U.c];b={ixfe:Ar,XF:B[Ar],t:"z"},j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:di,r:U.r},b,e)}break;case 214:case 516:case 4:b=Af(U.val,U.ixfe,"s"),b.XF=B[b.ixfe],j>0&&(b.z=G[b.ixfe>>8&63]),Ei(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 0:case 512:re===1&&(a=U);break;case 252:c=U;break;case 1054:if(S.biff==4){G[j++]=U[1];for(var fn=0;fn<j+163&&Oe[fn]!=U[1];++fn);fn>=163&&Ki(U[1],j+163)}else Ki(U[1],U[0]);break;case 30:{G[j++]=U;for(var Cn=0;Cn<j+163&&Oe[Cn]!=U;++Cn);Cn>=163&&Ki(U,j+163)}break;case 229:oe=oe.concat(U);break;case 93:se[U.cmo[0]]=S.lastobj=U;break;case 438:S.lastobj.TxO=U;break;case 127:S.lastobj.ImData=U;break;case 440:for(_=U[0].s.r;_<=U[0].e.r;++_)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Le({c:m,r:_})],p&&(p.l=U[1]);break;case 2048:for(_=U[0].s.r;_<=U[0].e.r;++_)for(m=U[0].s.c;m<=U[0].e.c;++m)p=e.dense?(i[_]||[])[m]:i[Le({c:m,r:_})],p&&p.l&&(p.l.Tooltip=U[1]);break;case 28:{if(S.biff<=5&&S.biff>=2)break;p=e.dense?(i[U[0].r]||[])[U[0].c]:i[Le(U[0])];var jt=se[U[2]];p||(e.dense?(i[U[0].r]||(i[U[0].r]=[]),p=i[U[0].r][U[0].c]={t:"z"}):p=i[Le(U[0])]={t:"z"},a.e.r=Math.max(a.e.r,U[0].r),a.s.r=Math.min(a.s.r,U[0].r),a.e.c=Math.max(a.e.c,U[0].c),a.s.c=Math.min(a.s.c,U[0].c)),p.c||(p.c=[]),v={a:U[1],t:jt.TxO.t},p.c.push(v)}break;case 2173:pM(B[U.ixfe],U.ext);break;case 125:{if(!S.cellStyles)break;for(;U.e>=U.s;)Ie[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Pe||(Pe=!0,ag(U.w/256)),Rs(Ie[U.e+1])}break;case 520:{var ft={};U.level!=null&&(xe[U.r]=ft,ft.level=U.level),U.hidden&&(xe[U.r]=ft,ft.hidden=!0),U.hpt&&(xe[U.r]=ft,ft.hpt=U.hpt,ft.hpx=qo(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Ta(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=U;break;case 161:i["!margins"]||Ta(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(x.Views[0].RTL=!0);break;case 146:M=U;break;case 2198:R=U;break;case 140:N=U;break;case 442:l?w.CodeName=U||w.name:x.WBProps.CodeName=U||"ThisWorkbook";break}}else ne||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),t.l+=fe}return r.SheetNames=Kt(s).sort(function(Jr,ze){return Number(Jr)-Number(ze)}).map(function(Jr){return s[Jr].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(Jr,ze){r.Sheets[r.SheetNames[ze]]["!autofilter"]=Jr}),r.Strings=c,r.SSF=Ot(Oe),S.enc&&(r.Encryption=S.enc),R&&(r.Themes=R),r.Metadata={},N!==void 0&&(r.Metadata.Country=N),de.names.length>0&&(x.Names=de.names),r.Workbook=x,r}var Jl={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function C6(t,e,r){var n=De.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=iE(n,wm,Jl.DSI);for(var s in i)e[s]=i[s]}catch(l){if(r.WTF)throw l}var a=De.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=iE(a,Em,Jl.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(wT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function k6(t,e){var r=[],n=[],i=[],s=0,a,o=Ow(wm,"n"),c=Ow(Em,"n");if(t.Props)for(a=Kt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Kt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)CT.indexOf(i[s][0])>-1||xT.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&De.utils.cfb_add(e,"/SummaryInformation",sE(n,Jl.SI,c,Em)),(r.length||l.length)&&De.utils.cfb_add(e,"/DocumentSummaryInformation",sE(r,Jl.DSI,o,wm,l.length?l:null,Jl.UDI))}function Tb(t,e){e||(e={}),mg(e),Pm(),e.codepage&&Rm(e.codepage);var r,n;if(t.FullPaths){if(De.find(t,"/encryption"))throw new Error("File is password-protected");r=De.find(t,"!CompObj"),n=De.find(t,"/Workbook")||De.find(t,"/Book")}else{switch(e.type){case"base64":t=xn(En(t));break;case"binary":t=xn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Pr(t,0),n={content:t}}var i,s;if(r&&b6(r),e.bookProps&&!e.bookSheets)i={};else{var a=Qe?"buffer":"array";if(n&&n.content)i=S6(n.content,e);else if((s=De.find(t,"PerfectOffice_MAIN"))&&s.content)i=Ea.to_workbook(s.content,(e.type=a,e));else if((s=De.find(t,"NativeContent_MAIN"))&&s.content)i=Ea.to_workbook(s.content,(e.type=a,e));else throw(s=De.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&De.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=WM(t))}var o={};return t.FullPaths&&C6(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function D6(t,e){var r=e||{},n=De.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return De.utils.cfb_add(n,i,bb(t,r)),r.biff==8&&(t.Props||t.Custprops)&&k6(t,n),r.biff==8&&t.vbaraw&&$M(n,De.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var uu={0:{f:e3},1:{f:c3},2:{f:S3},3:{f:g3},4:{f:f3},5:{f:b3},6:{f:P3},7:{f:x3},8:{f:B3},9:{f:V3},10:{f:M3},11:{f:L3},12:{f:u3},13:{f:k3},14:{f:_3},15:{f:p3},16:{f:mb},17:{f:O3},18:{f:E3},19:{f:Ym},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:OV},40:{},42:{},43:{f:PN},44:{f:DN},45:{f:NN},46:{f:LN},47:{f:MN},48:{},49:{f:nP},50:{},51:{f:vM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:BT},62:{f:R3},63:{f:AM},64:{f:tV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Hr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Q3},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:a3},148:{f:n3,p:16},151:{f:z3},152:{},153:{f:RV},154:{},155:{},156:{f:kV},157:{},158:{},159:{T:1,f:qO},160:{T:-1},161:{T:1,f:Oa},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:U3},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:mM},336:{T:-1},337:{f:xM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:xm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:VT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:G3},427:{f:q3},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:X3},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:s3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:$3},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:xm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:LM},633:{T:1},634:{T:-1},635:{T:1,f:NM},636:{T:-1},637:{f:oP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:_V},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Cm={6:{f:hm},10:{f:Ss},12:{f:sr},13:{f:sr},14:{f:Jt},15:{f:Jt},16:{f:jr},17:{f:Jt},18:{f:Jt},19:{f:sr},20:{f:hE},21:{f:hE},23:{f:VT},24:{f:dE},25:{f:Jt},26:{},27:{},28:{f:rO},29:{},34:{f:Jt},35:{f:fE},38:{f:jr},39:{f:jr},40:{f:jr},41:{f:jr},42:{f:Jt},43:{f:Jt},47:{f:pN},49:{f:kF},51:{f:sr},60:{},61:{f:bF},64:{f:Jt},65:{f:CF},66:{f:sr},77:{},80:{},81:{},82:{},85:{f:sr},89:{},90:{},91:{},92:{f:dF},93:{f:sO},94:{},95:{f:Jt},96:{},97:{},99:{f:Jt},125:{f:BT},128:{f:HF},129:{f:mF},130:{f:sr},131:{f:Jt},132:{f:Jt},133:{f:gF},134:{},140:{f:dO},141:{f:sr},144:{},146:{f:gO},151:{},152:{},153:{},154:{},155:{},156:{f:sr},157:{},158:{},160:{f:TO},161:{f:yO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:UF},190:{f:jF},193:{f:Ss},197:{},198:{},199:{},200:{},201:{},202:{f:Jt},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:sr},220:{},221:{f:Jt},222:{},224:{f:$F},225:{f:fF},226:{f:Ss},227:{},229:{f:nO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:_F},253:{f:RF},255:{f:xF},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:kT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jt},353:{f:Ss},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:XF},431:{f:Jt},432:{},433:{},434:{},437:{},438:{f:cO},439:{f:Jt},440:{f:lO},441:{},442:{f:mu},443:{},444:{f:sr},445:{},446:{},448:{f:Ss},449:{f:TF,r:2},450:{f:Ss},512:{f:cE},513:{f:EO},515:{f:qF},516:{f:FF},517:{f:uE},519:{f:bO},520:{f:wF},523:{},545:{f:pE},549:{f:oE},566:{},574:{f:AF},638:{f:BF},659:{},1048:{},1054:{f:NF},1084:{},1212:{f:ZF},2048:{f:hO},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Tf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ss},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:vO,r:12},2173:{f:dM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jt,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:JF,r:12},2197:{},2198:{f:oM,r:12},2199:{},2200:{},2201:{},2202:{f:eO,r:12},2203:{f:Ss},2204:{},2205:{},2206:{},2207:{},2211:{f:EF},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:sr},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:xO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:mO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:cE},1:{},2:{f:kO},3:{f:SO},4:{f:AO},5:{f:uE},7:{f:RO},8:{},9:{f:Tf},11:{},22:{f:sr},30:{f:LF},31:{},32:{},33:{f:pE},36:{},37:{f:oE},50:{f:PO},62:{},52:{},67:{},68:{f:sr},69:{},86:{},126:{},127:{f:IO},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:FO},223:{},234:{},354:{},421:{},518:{f:hm},521:{f:Tf},536:{f:dE},547:{f:fE},561:{},579:{},1030:{f:hm},1033:{f:Tf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function _e(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&qm(r)&&t.push(r)}}function R6(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return _e(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,s),h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l;c<i;){for(h=t.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l}}}function yu(t,e,r){return t||(t=ee(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function P6(t,e,r,n){var i=ee(9);return yu(i,t,e),DT(r,n||"b",i),i}function F6(t,e,r){var n=ee(8+2*r.length);return yu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function O6(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?fr(Ft(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?_e(t,2,DO(r,n,i)):_e(t,3,CO(r,n,i));return;case"b":case"e":_e(t,5,P6(r,n,e.v,e.t));return;case"s":case"str":_e(t,4,F6(r,n,(e.v||"").slice(0,255)));return}_e(t,1,yu(null,r,n))}function N6(t,e,r,n){var i=Array.isArray(e),s=ct(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=$e(s)}for(var l=s.s.r;l<=s.e.r;++l){o=Zt(l);for(var h=s.s.c;h<=s.e.c;++h){l===s.s.r&&(c[h]=Bt(h)),a=c[h]+o;var f=i?(e[l]||[])[h]:e[a];f&&O6(t,f,l,h,n)}}}function M6(t,e){var r=e||{};qt!=null&&r.dense==null&&(r.dense=qt);for(var n=cn(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,ng(t,16,r)),N6(n,t.Sheets[t.SheetNames[i]],i,r,t),_e(n,10),n.end()}function L6(t,e,r){_e(t,49,DF({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function V6(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&_e(t,1054,MF(i,e[i],r))})}function B6(t,e){var r=ee(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(t,2151,r),r=ee(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),NT(ct(e["!ref"]||"A1"),r),r.write_shift(4,4),_e(t,2152,r)}function U6(t,e){for(var r=0;r<16;++r)_e(t,224,lE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){_e(t,224,lE(n,0,e))})}function j6(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];_e(t,440,uO(n)),n[1].Tooltip&&_e(t,2048,fO(n))}delete e["!links"]}function W6(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&_e(t,125,_O(Yf(i,n),i))})}}function $6(t,e,r,n,i){var s=16+Ms(i.cellXfs,e,i);if(e.v==null&&!e.bf){_e(t,513,Ca(r,n,s));return}if(e.bf)_e(t,6,mL(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?fr(Ft(e.v)):e.v;_e(t,515,KF(r,n,a,s,i));break;case"b":case"e":_e(t,517,GF(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=hg(i.Strings,e.v,i.revStrings);_e(t,253,PF(r,n,o,s,i))}else _e(t,516,OF(r,n,(e.v||"").slice(0,255),s,i));break;default:_e(t,513,Ca(r,n,s))}}function H6(t,e,r){var n=cn(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),l=e.biff==8,h,f="",d=[],p=ct(s["!ref"]||"A1"),v=l?65536:16384;if(p.e.c>255||p.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,v-1)}_e(n,2057,ng(r,16,e)),_e(n,13,Wn(1)),_e(n,12,Wn(100)),_e(n,15,tn(!0)),_e(n,17,tn(!1)),_e(n,16,Aa(.001)),_e(n,95,tn(!0)),_e(n,42,tn(!1)),_e(n,43,tn(!1)),_e(n,130,Wn(1)),_e(n,128,zF([0,0])),_e(n,131,tn(!1)),_e(n,132,tn(!1)),l&&W6(n,s["!cols"]),_e(n,512,VF(p,e)),l&&(s["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){f=Zt(m);for(var _=p.s.c;_<=p.e.c;++_){m===p.s.r&&(d[_]=Bt(_)),h=d[_]+f;var T=c?(s[m]||[])[_]:s[h];T&&($6(n,T,m,_,e),l&&T.l&&s["!links"].push([h,T.l]))}}var A=o.CodeName||o.name||i;return l&&_e(n,574,SF((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&_e(n,229,iO(s["!merges"])),l&&j6(n,s),_e(n,442,RT(A,e)),l&&B6(n,s),_e(n,10),n.end()}function z6(t,e,r){var n=cn(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(_e(n,2057,ng(t,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,o?Wn(1200):null),_e(n,193,GP(2)),c&&_e(n,191),c&&_e(n,192),_e(n,226),_e(n,92,pF("SheetJS",r)),_e(n,66,Wn(o?1200:1252)),o&&_e(n,353,Wn(0)),o&&_e(n,448),_e(n,317,wO(t.SheetNames.length)),o&&t.vbaraw&&_e(n,211),o&&t.vbaraw){var l=a.CodeName||"ThisWorkbook";_e(n,442,RT(l,r))}_e(n,156,Wn(17)),_e(n,25,tn(!1)),_e(n,18,tn(!1)),_e(n,19,Wn(0)),o&&_e(n,431,tn(!1)),o&&_e(n,444,Wn(0)),_e(n,61,IF(r)),_e(n,64,tn(!1)),_e(n,141,Wn(0)),_e(n,34,tn(TV(t)=="true")),_e(n,14,tn(!0)),o&&_e(n,439,tn(!1)),_e(n,218,Wn(0)),L6(n,t,r),V6(n,t.SSF,r),U6(n,r),o&&_e(n,352,tn(!1));var h=n.end(),f=cn();o&&_e(f,140,pO()),o&&r.Strings&&R6(f,252,yF(r.Strings,r)),_e(f,10);var d=f.end(),p=cn(),v=0,m=0;for(m=0;m<t.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*t.SheetNames[m].length;var _=h.length+v+d.length;for(m=0;m<t.SheetNames.length;++m){var T=s[m]||{};_e(p,133,vF({pos:_,hs:T.Hidden||0,dt:0,name:t.SheetNames[m]},r)),_+=e[m].length}var A=p.end();if(v!=A.length)throw new Error("BS8 "+v+" != "+A.length);var b=[];return h.length&&b.push(h),A.length&&b.push(A),d.length&&b.push(d),wr(b)}function G6(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Ot(Oe)),t&&t.SSF&&(Xo(),Wf(t.SSF),r.revssf=Hf(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,gg(r),r.cellXfs=[],Ms(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=H6(i,r,t);return n.unshift(z6(t,n,r)),wr(n)}function bb(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=ln(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return G6(t,e);case 4:case 3:case 2:return M6(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function bE(t,e){var r=e||{};qt!=null&&r.dense==null&&(r.dense=qt);var n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,c=DR(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,h=0,f=0,d=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<c.length;++a){var m=c[a].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var T=m.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var A=T[o].trim();if(A.match(/<t[dh]/i)){for(var b=A,N=0;b.charAt(0)=="<"&&(N=b.indexOf(">"))>-1;)b=b.slice(N+1);for(var B=0;B<v.length;++B){var M=v[B];M.s.c==h&&M.s.r<l&&l<=M.e.r&&(h=M.e.c+1,B=-1)}var x=Ve(A.slice(0,A.indexOf(">")));d=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||d>1)&&v.push({s:{r:l,c:h},e:{r:l+(f||1)-1,c:h+d-1}});var w=x.t||x["data-t"]||"";if(!b.length){h+=d;continue}if(b=ZE(b),p.s.r>l&&(p.s.r=l),p.e.r<l&&(p.e.r=l),p.s.c>h&&(p.s.c=h),p.e.c<h&&(p.e.c=h),!b.length){h+=d;continue}var E={t:"s",v:b};r.raw||!b.trim().length||w=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(oi(b))?isNaN(zo(b).getDate())||(E={t:"d",v:Ft(b)},r.cellDates||(E={t:"n",v:fr(E.v)}),E.z=r.dateNF||Oe[14]):E={t:"n",v:oi(b)}),r.dense?(n[l]||(n[l]=[]),n[l][h]=E):n[Le({r:l,c:h})]=E,h+=d}}}}return n["!ref"]=$e(p),v.length&&(n["!merges"]=v),n}function q6(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var h=Le({r,c:a}),f=n.dense?(t[r]||[])[a]:t[h],d=f&&f.v!=null&&(f.h||Um(f.w||(Yi(f),f.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(p["data-t"]=f&&f.t||"z",f.v!=null&&(p["data-v"]=f.v),f.z!=null&&(p["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),p.id=(n.id||"sjs")+"-"+h,s.push(ve("td",d,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var K6='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',X6="</body></html>";function Y6(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Ns(bE(r[0],e),e);var n=yg();return r.forEach(function(i,s){xg(n,bE(i,e),"Sheet"+(s+1))}),n}function Q6(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ib(t,e){var r=e||{},n=r.header!=null?r.header:K6,i=r.footer!=null?r.footer:X6,s=[n],a=ln(t["!ref"]);r.dense=Array.isArray(t),s.push(Q6(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(q6(t,a,o,r));return s.push("</table>"+i),s.join("")}function Ab(t,e,r){var n=r||{};qt!=null&&(n.dense=qt);var i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Ut(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=ln(t["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),i==-1&&(l.e.r=i=h.e.r+1)}var f=[],d=0,p=t["!rows"]||(t["!rows"]=[]),v=0,m=0,_=0,T=0,A=0,b=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&m<c;++v){var N=o[v];if(IE(N)){if(n.display)continue;p[m]={hidden:!0}}var B=N.children;for(_=T=0;_<B.length;++_){var M=B[_];if(!(n.display&&IE(M))){var x=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):ZE(M.innerHTML),w=M.getAttribute("data-z")||M.getAttribute("z");for(d=0;d<f.length;++d){var E=f[d];E.s.c==T+s&&E.s.r<m+i&&m+i<=E.e.r&&(T=E.e.c+1-s,d=-1)}b=+M.getAttribute("colspan")||1,((A=+M.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:m+i,c:T+s},e:{r:m+i+(A||1)-1,c:T+s+(b||1)-1}});var C={t:"s",v:x},D=M.getAttribute("data-t")||M.getAttribute("t")||"";x!=null&&(x.length==0?C.t=D||"z":n.raw||x.trim().length==0||D=="s"||(x==="TRUE"?C={t:"b",v:!0}:x==="FALSE"?C={t:"b",v:!1}:isNaN(oi(x))?isNaN(zo(x).getDate())||(C={t:"d",v:Ft(x)},n.cellDates||(C={t:"n",v:fr(C.v)}),C.z=n.dateNF||Oe[14]):C={t:"n",v:oi(x)})),C.z===void 0&&w!=null&&(C.z=w);var S="",R=M.getElementsByTagName("A");if(R&&R.length)for(var oe=0;oe<R.length&&!(R[oe].hasAttribute("href")&&(S=R[oe].getAttribute("href"),S.charAt(0)!="#"));++oe);S&&S.charAt(0)!="#"&&(C.l={Target:S}),n.dense?(t[m+i]||(t[m+i]=[]),t[m+i][T+s]=C):t[Le({c:T+s,r:m+i})]=C,l.e.c<T+s&&(l.e.c=T+s),T+=b}}++m}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,m-1+i),t["!ref"]=$e(l),m>=c&&(t["!fullref"]=$e((l.e.r=o.length-v+m-1+i,l))),t}function Sb(t,e){var r=e||{},n=r.dense?[]:{};return Ab(n,t,e)}function J6(t,e){return Ns(Sb(t,e),e)}function IE(t){var e="",r=Z6(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Z6(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function e8(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ot(e.replace(/<[^>]*>/g,""));return[r]}var AE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Cb(t,e){var r=e||{};qt!=null&&r.dense==null&&(r.dense=qt);var n=jm(t),i=[],s,a,o={name:""},c="",l=0,h,f,d={},p=[],v=r.dense?[]:{},m,_,T={value:""},A="",b=0,N,B=[],M=-1,x=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,C={},D=[],S={},R=0,oe=0,se=[],Ie=1,xe=1,Pe=[],de={Names:[]},Ae={},re=["",""],j=[],G={},H="",W=0,te=!1,me=!1,ue=0;for(iu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=iu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":m[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=$e(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=$e(w)),D.length&&(v["!merges"]=D),se.length&&(v["!rows"]=se),h.name=h.\u540D\u79F0||h.name,typeof JSON<"u"&&JSON.stringify(h),p.push(h.name),d[h.name]=v,me=!1):m[0].charAt(m[0].length-2)!=="/"&&(h=Ve(m[0],!1),M=x=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},D=[],se=[],me=!0);break;case"table-row-group":m[1]==="/"?--E:++E;break;case"table-row":case"\u884C":if(m[1]==="/"){M+=Ie,Ie=1;break}if(f=Ve(m[0],!1),f.\u884C\u53F7?M=f.\u884C\u53F7-1:M==-1&&(M=0),Ie=+f["number-rows-repeated"]||1,Ie<10)for(ue=0;ue<Ie;++ue)E>0&&(se[M+ue]={level:E});x=-1;break;case"covered-table-cell":m[1]!=="/"&&++x,r.sheetStubs&&(r.dense?(v[M]||(v[M]=[]),v[M][x]={t:"z"}):v[Le({r:M,c:x})]={t:"z"}),A="",B=[];break;case"table-cell":case"\u6570\u636E":if(m[0].charAt(m[0].length-2)==="/")++x,T=Ve(m[0],!1),xe=parseInt(T["number-columns-repeated"]||"1",10),_={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(_.f=wE(ot(T.formula))),(T.\u6570\u636E\u7C7B\u578B||T["value-type"])=="string"&&(_.t="s",_.v=ot(T["string-value"]||""),r.dense?(v[M]||(v[M]=[]),v[M][x]=_):v[Le({r:M,c:x})]=_),x+=xe-1;else if(m[1]!=="/"){++x,A="",b=0,B=[],xe=1;var fe=Ie?M+Ie-1:M;if(x>w.e.c&&(w.e.c=x),x<w.s.c&&(w.s.c=x),M<w.s.r&&(w.s.r=M),fe>w.e.r&&(w.e.r=fe),T=Ve(m[0],!1),j=[],G={},_={t:T.\u6570\u636E\u7C7B\u578B||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=ot(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(R=parseInt(T["number-matrix-rows-spanned"],10)||0,oe=parseInt(T["number-matrix-columns-spanned"],10)||0,S={s:{r:M,c:x},e:{r:M+R-1,c:x+oe-1}},_.F=$e(S),Pe.push([S,_.F])),T.formula)_.f=wE(T.formula);else for(ue=0;ue<Pe.length;++ue)M>=Pe[ue][0].s.r&&M<=Pe[ue][0].e.r&&x>=Pe[ue][0].s.c&&x<=Pe[ue][0].e.c&&(_.F=Pe[ue][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(R=parseInt(T["number-rows-spanned"],10)||0,oe=parseInt(T["number-columns-spanned"],10)||0,S={s:{r:M,c:x},e:{r:M+R-1,c:x+oe-1}},D.push(S)),T["number-columns-repeated"]&&(xe=parseInt(T["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Pt(T["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(T.value);break;case"percentage":_.t="n",_.v=parseFloat(T.value);break;case"currency":_.t="n",_.v=parseFloat(T.value);break;case"date":_.t="d",_.v=Ft(T["date-value"]),r.cellDates||(_.t="n",_.v=fr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=SR(T["time-value"])/86400,r.cellDates&&(_.t="d",_.v=zf(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(T.\u6570\u636E\u6570\u503C);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",T["string-value"]!=null&&(A=ot(T["string-value"]),B=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(te=!1,_.t==="s"&&(_.v=A||"",B.length&&(_.R=B),te=b==0),Ae.Target&&(_.l=Ae),j.length>0&&(_.c=j,j=[]),A&&r.cellText!==!1&&(_.w=A),te&&(_.t="z",delete _.v),(!te||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=M))for(var ne=0;ne<Ie;++ne){if(xe=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(v[M+ne]||(v[M+ne]=[]),v[M+ne][x]=ne==0?_:Ot(_);--xe>0;)v[M+ne][x+xe]=Ot(_);else for(v[Le({r:M+ne,c:x})]=_;--xe>0;)v[Le({r:M+ne,c:x+xe})]=Ot(_);w.e.c<=x&&(w.e.c=x)}xe=parseInt(T["number-columns-repeated"]||"1",10),x+=xe-1,xe=0,_={},A="",B=[]}Ae={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s;G.t=A,B.length&&(G.R=B),G.a=H,j.push(G)}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);H="",W=0,A="",b=0,B=[];break;case"creator":m[1]==="/"?H=n.slice(W,m.index):W=m.index+m[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&i.push([m[3],!1]);A="",b=0,B=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(C[o.name]=c,(s=i.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=Ve(m[0],!1),i.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ve(m[0],!1),c+=AE[m[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=Ve(m[0],!1),c+=AE[m[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,m.index);break}else l=m.index+m[0].length;break;case"named-range":a=Ve(m[0],!1),re=fm(a["cell-range-address"]);var Be={Name:a.name,Ref:re[0]+"!"+re[1]};me&&(Be.Sheet=p.length),de.Names.push(Be);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(m[1]==="/"&&(!T||!T["string-value"])){var U=e8(n.slice(b,m.index),N);A=(A.length>0?A+`
`:"")+U[0]}else N=Ve(m[0],!1),b=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{re=fm(Ve(m[0])["target-range-address"]),d[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(Ae=Ve(m[0],!1),!Ae.href)break;Ae.Target=ot(Ae.href),delete Ae.href,Ae.Target.charAt(0)=="#"&&Ae.Target.indexOf(".")>-1?(re=fm(Ae.Target.slice(1)),Ae.Target="#"+re[0]+"!"+re[1]):Ae.Target.match(/^\.\.[\\\/]/)&&(Ae.Target=Ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(m)}}var st={Sheets:d,SheetNames:p,Workbook:de};return r.bookSheets&&delete st.Sheets,st}function SE(t,e){e=e||{},jn(t,"META-INF/manifest.xml")&&SP(ir(t,"META-INF/manifest.xml"),e);var r=wn(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Cb(Et(r),e);return jn(t,"meta.xml")&&(n.Props=_T(ir(t,"meta.xml"))),n}function CE(t,e){return Cb(t,e)}var t8=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+nu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return er+e}}(),kE=function(){var t=function(s){return yt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+yt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,f=ln(s["!ref"]||"A1"),d=s["!merges"]||[],p=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var m="",_=s["!rows"]||[];for(l=0;l<f.s.r;++l)m=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;l<=f.e.r;++l){for(m=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+m+`>
`),h=0;h<f.s.c;++h)c.push(e);for(;h<=f.e.c;++h){var T=!1,A={},b="";for(p=0;p!=d.length;++p)if(!(d[p].s.c>h)&&!(d[p].s.r>l)&&!(d[p].e.c<h)&&!(d[p].e.r<l)){(d[p].s.c!=h||d[p].s.r!=l)&&(T=!0),A["table:number-columns-spanned"]=d[p].e.c-d[p].s.c+1,A["table:number-rows-spanned"]=d[p].e.r-d[p].s.r+1;break}if(T){c.push(r);continue}var N=Le({r:l,c:h}),B=v?(s[l]||[])[h]:s[N];if(B&&B.f&&(A["table:formula"]=yt(wL(B.f)),B.F&&B.F.slice(0,N.length)==N)){var M=ln(B.F);A["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,A["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!B){c.push(e);continue}switch(B.t){case"b":b=B.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=B.v?"true":"false";break;case"n":b=B.w||String(B.v||0),A["office:value-type"]="float",A["office:value"]=B.v||0;break;case"s":case"str":b=B.v==null?"":B.v,A["office:value-type"]="string";break;case"d":b=B.w||Ft(B.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Ft(B.v).toISOString(),A["table:style-name"]="ce1";break;default:c.push(e);continue}var x=t(b);if(B.l&&B.l.Target){var w=B.l.Target;w=w.charAt(0)=="#"?"#"+EL(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),x=ve("text:a",x,{"xlink:href":w.replace(/&/g,"&amp;")})}c.push("          "+ve("table:table-cell",ve("text:p",x,{}),A)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var f=l["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Rs(f),f.ods=o;var d=l["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var f=l["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[er],l=nu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=nu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(vT().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function kb(t,e){if(e.bookType=="fods")return kE(t,e);var r=Lm(),n="",i=[],s=[];return n="mimetype",qe(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",qe(r,n,kE(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",qe(r,n,t8(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",qe(r,n,er+vT()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",qe(r,n,DP(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",qe(r,n,CP(i)),r}function ka(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function km(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):Et(Os(t))}function r8(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):xn(Ii(t))}function n8(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Fs(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function DE(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function i8(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function s8(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function hu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function vt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Gt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ht(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=hu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=hu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function Rr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(vt(n*8+i.type)),i.type==2&&e.push(vt(i.data.length)),e.push(i.data))})}),Fs(e)}function pg(t,e){return t?.map(function(r){return e(r.data)})||[]}function Bn(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=hu(t,n),s=ht(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Gt(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=ht(o.data),l=Gt(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Gt(s[3][0].data)>>>0>0),r.push(a)}return r}function No(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:vt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:vt(a.data.length)}],n[2].push({data:Rr(a.meta),type:2})});var s=Rr(n);e.push(vt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),Fs(e)}function a8(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=hu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Fs(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var h=Fs(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Un(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(a8(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Fs(e)}function Mo(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=vt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return Fs(e)}function o8(t,e,r,n){var i=ka(t),s=i.getUint32(4,!0),a=(n>1?12:8)+DE(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,h=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=DE(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function c8(t,e,r){var n=ka(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,h=new Date(2001,0,1);i&1&&(c=i8(t,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return f}function pm(t,e){var r=new Uint8Array(32),n=ka(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,s8(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function mm(t,e){var r=new Uint8Array(32),n=ka(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function l8(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return o8(t,e,r,t[0]);case 5:return c8(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Vr(t){var e=ht(t);return hu(e[1][0].data)}function RE(t,e){var r=ht(e.data),n=Gt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=ht(a.data),c=Gt(o[1][0].data)>>>0;switch(n){case 1:s[c]=km(o[3][0].data);break;case 8:{var l=t[Vr(o[9][0].data)][0],h=ht(l.data),f=t[Vr(h[1][0].data)][0],d=Gt(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var p=ht(f.data);s[c]=p[3].map(function(v){return km(v.data)}).join("")}break}}),s}function u8(t,e){var r,n,i,s,a,o,c,l,h,f,d,p,v,m,_=ht(t),T=Gt(_[1][0].data)>>>0,A=Gt(_[2][0].data)>>>0,b=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Gt(_[8][0].data)>0||!1,N,B;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)N=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,B=(l=(c=_[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(h=_[4])==null?void 0:h[0])!=null&&f.data&&e!=1)N=(p=(d=_[4])==null?void 0:d[0])==null?void 0:p.data,B=(m=(v=_[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var M=b?4:1,x=ka(N),w=[],E=0;E<N.length/2;++E){var C=x.getUint16(E*2,!0);C<65535&&w.push([E,C])}if(w.length!=A)throw"Expected ".concat(A," cells, found ").concat(w.length);var D=[];for(E=0;E<w.length-1;++E)D[w[E][0]]=B.subarray(w[E][1]*M,w[E+1][1]*M);return w.length>=1&&(D[w[w.length-1][0]]=B.subarray(w[w.length-1][1]*M)),{R:T,cells:D}}function h8(t,e){var r,n=ht(e.data),i=(r=n?.[7])!=null&&r[0]?Gt(n[7][0].data)>>>0>0?1:0:-1,s=pg(n[5],function(a){return u8(a,i)});return{nrows:Gt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function f8(t,e,r){var n,i=ht(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Gt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Gt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=$e(s);var a=ht(i[4][0].data),o=RE(t,t[Vr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?RE(t,t[Vr(a[17][0].data)][0]):[],l=ht(a[3][0].data),h=0;l[1].forEach(function(f){var d=ht(f.data),p=t[Vr(d[2][0].data)][0],v=Gt(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=h8(t,p);m.data.forEach(function(_,T){_.forEach(function(A,b){var N=Le({r:h+T,c:b}),B=l8(A,o,c);B&&(r[N]=B)})}),h+=m.nrows})}function d8(t,e){var r=ht(e.data),n={"!ref":"A1"},i=t[Vr(r[2][0].data)],s=Gt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return f8(t,i[0],n),n}function p8(t,e){var r,n=ht(e.data),i={name:(r=n[1])!=null&&r[0]?km(n[1][0].data):"",sheets:[]},s=pg(n[2],Vr);return s.forEach(function(a){t[a].forEach(function(o){var c=Gt(o.meta[1][0].data);c==6e3&&i.sheets.push(d8(t,o))})}),i}function m8(t,e){var r=yg(),n=ht(e.data),i=pg(n[1],Vr);if(i.forEach(function(s){t[s].forEach(function(a){var o=Gt(a.meta[1][0].data);if(o==2){var c=p8(t,a);c.sheets.forEach(function(l,h){xg(r,l,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function gm(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=Un(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=Bn(l)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Gt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var h=Gt(l.meta[1][0].data)>>>0;if(h==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return m8(s,o)}function g8(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Gt(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=ka(t[7][0].data),h=0,f=[],d=ka(t[4][0].data),p=0,v=[],m=0;m<e.length;++m){if(e[m]==null){l.setUint16(m*2,65535,!0),d.setUint16(m*2,65535);continue}l.setUint16(m*2,h,!0),d.setUint16(m*2,p,!0);var _,T;switch(typeof e[m]){case"string":_=pm({t:"s",v:e[m]},r),T=mm({t:"s",v:e[m]},r);break;case"number":_=pm({t:"n",v:e[m]},r),T=mm({t:"n",v:e[m]},r);break;case"boolean":_=pm({t:"b",v:e[m]},r),T=mm({t:"b",v:e[m]},r);break;default:throw new Error("Unsupported value "+e[m])}f.push(_),h+=_.length,v.push(T),p+=T.length,++c}for(t[2][0].data=vt(c);m<t[7][0].data.length/2;++m)l.setUint16(m*2,65535,!0),d.setUint16(m*2,65535,!0);return t[6][0].data=Fs(f),t[3][0].data=Fs(v),c}function v8(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=ln(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($e(n)));var s=Uf(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],l=De.read(e.numbers,{type:"base64"});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],te=H[1];if(W.type==2&&W.name.match(/\.iwa/)){var me=W.content,ue=Un(me),fe=Bn(ue);fe.forEach(function(ne){c.push(ne.id),o[ne.id]={deps:[],location:te,type:Gt(ne.messages[0].meta[1][0].data)}})}}),c.sort(function(H,W){return H-W});var h=c.filter(function(H){return H>1}).map(function(H){return[H,vt(H)]});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],te=H[1];if(W.name.match(/\.iwa/)){var me=Bn(Un(W.content));me.forEach(function(ue){ue.messages.forEach(function(fe){h.forEach(function(ne){ue.messages.some(function(Be){return Gt(Be.meta[1][0].data)!=11006&&n8(Be.data,ne[1])})&&o[ne[0]].deps.push(ue.id)})})})}});function f(){for(var H=927262;H<2e6;++H)if(!o[H])return H;throw new Error("Too many messages")}for(var d=De.find(l,o[1].location),p=Bn(Un(d.content)),v,m=0;m<p.length;++m){var _=p[m];_.id==1&&(v=_)}var T=Vr(ht(v.messages[0].data)[1][0].data);for(d=De.find(l,o[T].location),p=Bn(Un(d.content)),m=0;m<p.length;++m)_=p[m],_.id==T&&(v=_);for(T=Vr(ht(v.messages[0].data)[2][0].data),d=De.find(l,o[T].location),p=Bn(Un(d.content)),m=0;m<p.length;++m)_=p[m],_.id==T&&(v=_);for(T=Vr(ht(v.messages[0].data)[2][0].data),d=De.find(l,o[T].location),p=Bn(Un(d.content)),m=0;m<p.length;++m)_=p[m],_.id==T&&(v=_);var A=ht(v.messages[0].data);{A[6][0].data=vt(n.e.r+1),A[7][0].data=vt(n.e.c+1);var b=Vr(A[46][0].data),N=De.find(l,o[b].location),B=Bn(Un(N.content));{for(var M=0;M<B.length&&B[M].id!=b;++M);if(B[M].id!=b)throw"Bad ColumnRowUIDMapArchive";var x=ht(B[M].messages[0].data);x[1]=[],x[2]=[],x[3]=[];for(var w=0;w<=n.e.c;++w){var E=[];E[1]=E[2]=[{type:0,data:vt(w+420690)}],x[1].push({type:2,data:Rr(E)}),x[2].push({type:0,data:vt(w)}),x[3].push({type:0,data:vt(w)})}x[4]=[],x[5]=[],x[6]=[];for(var C=0;C<=n.e.r;++C)E=[],E[1]=E[2]=[{type:0,data:vt(C+726270)}],x[4].push({type:2,data:Rr(E)}),x[5].push({type:0,data:vt(C)}),x[6].push({type:0,data:vt(C)});B[M].messages[0].data=Rr(x)}N.content=Mo(No(B)),N.size=N.content.length,delete A[46];var D=ht(A[4][0].data);{D[7][0].data=vt(n.e.r+1);var S=ht(D[1][0].data),R=Vr(S[2][0].data);N=De.find(l,o[R].location),B=Bn(Un(N.content));{if(B[0].id!=R)throw"Bad HeaderStorageBucket";var oe=ht(B[0].messages[0].data);for(C=0;C<s.length;++C){var se=ht(oe[2][0].data);se[1][0].data=vt(C),se[4][0].data=vt(s[C].length),oe[2][C]={type:oe[2][0].type,data:Rr(se)}}B[0].messages[0].data=Rr(oe)}N.content=Mo(No(B)),N.size=N.content.length;var Ie=Vr(D[2][0].data);N=De.find(l,o[Ie].location),B=Bn(Un(N.content));{if(B[0].id!=Ie)throw"Bad HeaderStorageBucket";for(oe=ht(B[0].messages[0].data),w=0;w<=n.e.c;++w)se=ht(oe[2][0].data),se[1][0].data=vt(w),se[4][0].data=vt(n.e.r+1),oe[2][w]={type:oe[2][0].type,data:Rr(se)};B[0].messages[0].data=Rr(oe)}N.content=Mo(No(B)),N.size=N.content.length;var xe=Vr(D[4][0].data);(function(){for(var H=De.find(l,o[xe].location),W=Bn(Un(H.content)),te,me=0;me<W.length;++me){var ue=W[me];ue.id==xe&&(te=ue)}var fe=ht(te.messages[0].data);{fe[3]=[];var ne=[];a.forEach(function(st,He){ne[1]=[{type:0,data:vt(He)}],ne[2]=[{type:0,data:vt(1)}],ne[3]=[{type:2,data:r8(st)}],fe[3].push({type:2,data:Rr(ne)})})}te.messages[0].data=Rr(fe);var Be=No(W),U=Mo(Be);H.content=U,H.size=H.content.length})();var Pe=ht(D[3][0].data);{var de=Pe[1][0];delete Pe[2];var Ae=ht(de.data);{var re=Vr(Ae[2][0].data);(function(){for(var H=De.find(l,o[re].location),W=Bn(Un(H.content)),te,me=0;me<W.length;++me){var ue=W[me];ue.id==re&&(te=ue)}var fe=ht(te.messages[0].data);{delete fe[6],delete Pe[7];var ne=new Uint8Array(fe[5][0].data);fe[5]=[];for(var Be=0,U=0;U<=n.e.r;++U){var st=ht(ne);Be+=g8(st,s[U],a),st[1][0].data=vt(U),fe[5].push({data:Rr(st),type:2})}fe[1]=[{type:0,data:vt(n.e.c+1)}],fe[2]=[{type:0,data:vt(n.e.r+1)}],fe[3]=[{type:0,data:vt(Be)}],fe[4]=[{type:0,data:vt(n.e.r+1)}]}te.messages[0].data=Rr(fe);var He=No(W),at=Mo(He);H.content=at,H.size=H.content.length})()}de.data=Rr(Ae)}D[3][0].data=Rr(Pe)}A[4][0].data=Rr(D)}v.messages[0].data=Rr(A);var j=No(p),G=Mo(j);return d.content=G,d.size=d.content.length,l}function Db(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function mg(t){Db([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function gg(t){Db([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function _8(t){return Ke.WS.indexOf(t)>-1?"sheet":Ke.CS&&t==Ke.CS?"chart":Ke.DS&&t==Ke.DS?"dialog":Ke.MS&&t==Ke.MS?"macro":t&&t.length?t:"sheet"}function y8(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,_8(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function x8(t,e,r,n,i,s,a,o,c,l,h,f){try{s[n]=Kl(wn(t,r,!0),e);var d=ir(t,e),p;switch(o){case"sheet":p=WV(d,e,i,c,s[n],l,h,f);break;case"chart":if(p=$V(d,e,i,c,s[n],l,h,f),!p||!p["!drawel"])break;var v=Hl(p["!drawel"].Target,e),m=su(v),_=kM(wn(t,v,!0),Kl(wn(t,m,!0),v)),T=Hl(_,v),A=su(T);p=gV(wn(t,T,!0),T,c,Kl(wn(t,A,!0),T),l,p);break;case"macro":p=HV(d,e,i,c,s[n],l,h,f);break;case"dialog":p=zV(d,e,i,c,s[n],l,h,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=p;var b=[];s&&s[n]&&Kt(s[n]).forEach(function(N){var B="";if(s[n][N].Type==Ke.CMNT){B=Hl(s[n][N].Target,e);var M=XV(ir(t,B,!0),B,c);if(!M||!M.length)return;gE(p,M,!1)}s[n][N].Type==Ke.TCMNT&&(B=Hl(s[n][N].Target,e),b=b.concat(RM(ir(t,B,!0),c)))}),b&&b.length&&gE(p,b,!0,c.people||[])}catch(N){if(c.WTF)throw N}}function Ln(t){return t.charAt(0)=="/"?t.slice(1):t}function w8(t,e){if(Xo(),e=e||{},mg(e),jn(t,"META-INF/manifest.xml")||jn(t,"objectdata.xml"))return SE(t,e);if(jn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gm<"u"){if(t.FileIndex)return gm(t);var r=De.utils.cfb_new();return Lw(t).forEach(function(oe){qe(r,oe,XE(t,oe))}),gm(r)}throw new Error("Unsupported NUMBERS file")}if(!jn(t,"[Content_Types].xml"))throw jn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):jn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Lw(t),i=IP(wn(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",ir(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!ir(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(Xl=[],i.sst)try{Xl=KV(ir(t,Ln(i.sst)),i.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&i.themes.length&&(c=qV(wn(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=GV(ir(t,Ln(i.style)),i.style,c,e))}i.links.map(function(oe){try{var se=Kl(wn(t,su(Ln(oe))),oe);return QV(ir(t,Ln(oe)),se,oe,e)}catch{}});var h=jV(ir(t,Ln(i.workbooks[0])),i.workbooks[0],e),f={},d="";i.coreprops.length&&(d=ir(t,Ln(i.coreprops[0]),!0),d&&(f=_T(d)),i.extprops.length!==0&&(d=ir(t,Ln(i.extprops[0]),!0),d&&PP(d,f,e)));var p={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=wn(t,Ln(i.custprops[0]),!0),d&&(p=OP(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(se){return se.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(v.Props=f,v.Custprops=p),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var m={};e.bookDeps&&i.calcchain&&(m=YV(ir(t,Ln(i.calcchain)),i.calcchain,e));var _=0,T={},A,b;{var N=h.Sheets;f.Worksheets=N.length,f.SheetNames=[];for(var B=0;B!=N.length;++B)f.SheetNames[B]=N[B].name}var M=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),w=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");jn(t,w)||(w="xl/_rels/workbook."+M+".rels");var E=Kl(wn(t,w,!0),w.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=JV(ir(t,Ln(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=FM(ir(t,Ln(i.people[0])),e)),E&&(E=y8(E,h.Sheets));var C=ir(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var D="sheet";if(E&&E[_]?(A="xl/"+E[_][1].replace(/[\/]?xl\//,""),jn(t,A)||(A=E[_][1]),jn(t,A)||(A=w.replace(/_rels\/.*$/,"")+E[_][1]),D=E[_][2]):(A="xl/worksheets/sheet"+(_+1-C)+"."+M,A=A.replace(/sheet0\./,"sheet.")),b=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var S=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==_&&(S=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==f.SheetNames[_].toLowerCase()&&(S=1);if(!S)continue e}}x8(t,A,b,f.SheetNames[_],_,T,a,D,e,h,c,l)}return v={Directory:i,Workbook:h,Props:f,Custprops:p,Deps:m,Sheets:a,SheetNames:f.SheetNames,Strings:Xl,Styles:l,Themes:c,SSF:Ot(Oe)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(oe,se){oe=oe.replace(/^Root Entry[\/]/,""),v.keys.push(oe),v.files[oe]=t.FileIndex[se]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=ir(t,Ln(i.vba[0]),!0):i.defaults&&i.defaults.bin===jM&&(v.vbaraw=ir(t,"xl/vbaProject.bin",!0))),v}function E8(t,e){var r=e||{},n="Workbook",i=De.find(t,n);try{if(n="/!DataSpaces/Version",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(JO(i.content),n="/!DataSpaces/DataSpaceMap",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=eN(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=tN(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);nN(i.content)}catch{}if(n="/EncryptionInfo",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=iN(i.content);if(n="/EncryptedPackage",i=De.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function T8(t,e){return e.bookType=="ods"?kb(t,e):e.bookType=="numbers"?v8(t,e):e.bookType=="xlsb"?b8(t,e):I8(t,e)}function b8(t,e){Bo=1024,t&&!t.SSF&&(t.SSF=Ot(Oe)),t&&t.SSF&&(Xo(),Wf(t.SSF),e.revssf=Hf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Yl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=nb.indexOf(e.bookType)>-1,i=tg();gg(e=e||{});var s=Lm(),a="",o=0;if(e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",qe(s,a,yT(t.Props,e)),i.coreprops.push(a),_t(e.rels,2,a,Ke.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,qe(s,a,ET(t.Props,e)),i.extprops.push(a),_t(e.rels,3,a,Ke.EXT_PROPS),t.Custprops!==t.Props&&Kt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",qe(s,a,TT(t.Custprops,e)),i.custprops.push(a),_t(e.rels,4,a,Ke.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,qe(s,a,e6(o-1,a,e,t,h)),i.sheets.push(a),_t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ke.WS[0])}if(f){var p=f["!comments"],v=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,qe(s,m,n6(p,m,e)),i.comments.push(m),_t(h,-1,"../comments"+o+"."+r,Ke.CMNT),v=!0),f["!legacy"]&&v&&qe(s,"xl/drawings/vmlDrawing"+o+".vml",tb(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&qe(s,su(a),jo(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,qe(s,a,r6(e.Strings,a,e)),i.strs.push(a),_t(e.wbrels,-1,"sharedStrings."+r,Ke.SST)),a="xl/workbook."+r,qe(s,a,ZV(t,a,e)),i.workbooks.push(a),_t(e.rels,1,a,Ke.WB),a="xl/theme/theme1.xml",qe(s,a,og(t.Themes,e)),i.themes.push(a),_t(e.wbrels,-1,"theme/theme1.xml",Ke.THEME),a="xl/styles."+r,qe(s,a,t6(t,a,e)),i.styles.push(a),_t(e.wbrels,-1,"styles."+r,Ke.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",qe(s,a,t.vbaraw),i.vba.push(a),_t(e.wbrels,-1,"vbaProject.bin",Ke.VBA)),a="xl/metadata."+r,qe(s,a,i6(a)),i.metadata.push(a),_t(e.wbrels,-1,"metadata."+r,Ke.XLMETA),qe(s,"[Content_Types].xml",gT(i,e)),qe(s,"_rels/.rels",jo(e.rels)),qe(s,"xl/_rels/workbook."+r+".rels",jo(e.wbrels)),delete e.revssf,delete e.ssf,s}function I8(t,e){Bo=1024,t&&!t.SSF&&(t.SSF=Ot(Oe)),t&&t.SSF&&(Xo(),Wf(t.SSF),e.revssf=Hf(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Yl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=nb.indexOf(e.bookType)>-1,i=tg();gg(e=e||{});var s=Lm(),a="",o=0;if(e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",qe(s,a,yT(t.Props,e)),i.coreprops.push(a),_t(e.rels,2,a,Ke.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,qe(s,a,ET(t.Props,e)),i.extprops.push(a),_t(e.rels,3,a,Ke.EXT_PROPS),t.Custprops!==t.Props&&Kt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",qe(s,a,TT(t.Custprops,e)),i.custprops.push(a),_t(e.rels,4,a,Ke.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,qe(s,a,pb(o-1,e,t,f)),i.sheets.push(a),_t(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Ke.WS[0])}if(d){var v=d["!comments"],m=!1,_="";if(v&&v.length>0){var T=!1;v.forEach(function(A){A[1].forEach(function(b){b.T==!0&&(T=!0)})}),T&&(_="xl/threadedComments/threadedComment"+o+"."+r,qe(s,_,PM(v,h,e)),i.threadedcomments.push(_),_t(f,-1,"../threadedComments/threadedComment"+o+"."+r,Ke.TCMNT)),_="xl/comments"+o+"."+r,qe(s,_,rb(v,e)),i.comments.push(_),_t(f,-1,"../comments"+o+"."+r,Ke.CMNT),m=!0}d["!legacy"]&&m&&qe(s,"xl/drawings/vmlDrawing"+o+".vml",tb(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&qe(s,su(a),jo(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,qe(s,a,$T(e.Strings,e)),i.strs.push(a),_t(e.wbrels,-1,"sharedStrings."+r,Ke.SST)),a="xl/workbook."+r,qe(s,a,yb(t,e)),i.workbooks.push(a),_t(e.rels,1,a,Ke.WB),a="xl/theme/theme1.xml",qe(s,a,og(t.Themes,e)),i.themes.push(a),_t(e.wbrels,-1,"theme/theme1.xml",Ke.THEME),a="xl/styles."+r,qe(s,a,QT(t,e)),i.styles.push(a),_t(e.wbrels,-1,"styles."+r,Ke.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",qe(s,a,t.vbaraw),i.vba.push(a),_t(e.wbrels,-1,"vbaProject.bin",Ke.VBA)),a="xl/metadata."+r,qe(s,a,eb()),i.metadata.push(a),_t(e.wbrels,-1,"metadata."+r,Ke.XLMETA),h.length>1&&(a="xl/persons/person.xml",qe(s,a,OM(h,e)),i.people.push(a),_t(e.wbrels,-1,"persons/person.xml",Ke.PEOPLE)),qe(s,"[Content_Types].xml",gT(i,e)),qe(s,"_rels/.rels",jo(e.rels)),qe(s,"xl/_rels/workbook."+r+".rels",jo(e.wbrels)),delete e.revssf,delete e.ssf,s}function vg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=En(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function A8(t,e){return De.find(t,"EncryptedPackage")?E8(t,e):Tb(t,e)}function S8(t,e){var r,n=t,i=e||{};return i.type||(i.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r=YE(n,i),w8(r,i)}function Rb(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Sm(t.slice(r),e);default:break e}return Go.to_workbook(t,e)}function C8(t,e){var r="",n=vg(t,e);switch(e.type){case"base64":r=En(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ia(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Et(r)),e.type="binary",Rb(r,e)}function k8(t,e){var r=t;return e.type=="base64"&&(r=En(r)),r=gt.utils.decode(1200,r.slice(2),"str"),e.type="binary",Rb(r,e)}function D8(t){return t.match(/[^\x00-\x7F]/)?Ii(t):t}function vm(t,e,r,n){return n?(r.type="string",Go.to_workbook(t,r)):Go.to_workbook(e,r)}function Bf(t,e){Pm();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return Bf(new Uint8Array(t),(r=Ot(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),$o={},r.dateNF&&($o.dateNF=r.dateNF),r.type||(r.type=Qe&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Qe?"buffer":"binary",n=bR(t),typeof Uint8Array<"u"&&!Qe&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=D8(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Ot(r),r.type="array",Bf(Fm(n),r)}switch((i=vg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return A8(De.read(n,r),r);break;case 9:if(i[1]<=8)return Tb(n,r);break;case 60:return Sm(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return NO(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return jT.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?S8(n,r):vm(t,n,r,s);case 239:return i[3]===60?Sm(n,r):vm(t,n,r,s);case 255:if(i[1]===254)return k8(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return Ea.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return Ea.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Am.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return KT.to_workbook(n,r);break;case 10:case 13:case 32:return C8(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return OO.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Am.to_workbook(n,r):vm(t,n,r,s)}function Pb(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return du(e.file,De.write(t,{type:Qe?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return De.write(t,e)}function R8(t,e){var r=Ot(e||{}),n=T8(t,r);return P8(n,r)}function P8(t,e){var r={},n=Qe?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?De.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(jf(i))}return e.password&&typeof encrypt_agile<"u"?Pb(encrypt_agile(i,e.password),e):e.type==="file"?du(e.file,i):e.type=="string"?Et(i):i}function F8(t,e){var r=e||{},n=D6(t,r);return Pb(n,r)}function bi(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return eu(Ii(n));case"binary":return Ii(n);case"string":return t;case"file":return du(e.file,n,"utf8");case"buffer":return Qe?Qi(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):bi(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function O8(t,e){switch(e.type){case"base64":return eu(t);case"binary":return t;case"string":return t;case"file":return du(e.file,t,"binary");case"buffer":return Qe?Qi(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Sf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?eu(r):e.type=="string"?Et(r):r;case"file":return du(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function Fb(t,e){Pm(),AV(t);var r=Ot(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=Fb(t,r);return r.type="array",jf(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return bi(T6(t,r),r);case"slk":case"sylk":return bi(UT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return bi(Ib(t.Sheets[t.SheetNames[i]],r),r);case"txt":return O8(Nb(t.Sheets[t.SheetNames[i]],r),r);case"csv":return bi(_g(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return bi(jT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Sf(Am.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return bi(Go.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return bi(KT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return bi(WT.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return bi(kb(t,r),r);case"wk1":return Sf(Ea.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Sf(Ea.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Sf(bb(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),F8(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return R8(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function N8(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function Ob(t,e,r){var n=r||{};return n.type="file",n.file=e,N8(n),Fb(t,n)}function M8(t,e,r,n,i,s,a,o){var c=Zt(r),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var p=e.s.c;p<=e.e.c;++p){var v=a?t[r][p]:t[n[p]+c];if(v===void 0||v.t===void 0){if(l===void 0)continue;s[p]!=null&&(d[s[p]]=l);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)d[s[p]]=null;else if(l!==void 0)d[s[p]]=l;else if(h&&m===null)d[s[p]]=null;else continue;else d[s[p]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:Yi(v,m,o);m!=null&&(f=!1)}}return{row:d,isempty:f}}function Uf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},h=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof h){case"string":c=ct(h);break;case"number":c=ct(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=Zt(c.s.r),d=[],p=[],v=0,m=0,_=Array.isArray(t),T=c.s.r,A=0,b={};_&&!t[T]&&(t[T]=[]);var N=l.skipHidden&&t["!cols"]||[],B=l.skipHidden&&t["!rows"]||[];for(A=c.s.c;A<=c.e.c;++A)if(!(N[A]||{}).hidden)switch(d[A]=Bt(A),r=_?t[T][A]:t[d[A]+f],n){case 1:s[A]=A-c.s.c;break;case 2:s[A]=d[A];break;case 3:s[A]=l.header[A-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=Yi(r,null,l),m=b[a]||0,!m)b[a]=1;else{do o=a+"_"+m++;while(b[o]);b[a]=m,b[o]=1}s[A]=o}for(T=c.s.r+i;T<=c.e.r;++T)if(!(B[T]||{}).hidden){var M=M8(t,c,T,d,n,s,_,l);(M.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(p[v++]=M.row)}return p.length=v,p}var PE=/"/g;function L8(t,e,r,n,i,s,a,o){for(var c=!0,l=[],h="",f=Zt(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var p=o.dense?(t[r]||[])[d]:t[n[d]+f];if(p==null)h="";else if(p.v!=null){c=!1,h=""+(o.rawNumbers&&p.t=="n"?p.v:Yi(p,null,o));for(var v=0,m=0;v!==h.length;++v)if((m=h.charCodeAt(v))===i||m===s||m===34||o.forceQuotes){h='"'+h.replace(PE,'""')+'"';break}h=="ID"&&(h='"ID"')}else p.f!=null&&!p.F?(c=!1,h="="+p.f,h.indexOf(",")>=0&&(h='"'+h.replace(PE,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function _g(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ct(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],p=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(f[v]=Bt(v));for(var m=0,_=i.s.r;_<=i.e.r;++_)(p[_]||{}).hidden||(h=L8(t,i,_,f,a,c,s,n),h!=null&&(n.strip&&(h=h.replace(l,"")),(h||n.blankrows!==!1)&&r.push((m++?o:"")+h)));return delete n.dense,r.join("")}function Nb(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=_g(t,e);if(typeof gt>"u"||e.type=="string")return r;var n=gt.utils.encode(1200,r,"str");return"\xFF\xFE"+n}function V8(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ct(t["!ref"]),s="",a=[],o,c=[],l=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=Bt(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=Zt(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=l?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function Mb(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ut(n.origin):n.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=ct(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var d=n.header||[],p=0;e.forEach(function(m,_){Kt(m).forEach(function(T){(p=d.indexOf(T))==-1&&(d[p=d.length]=T);var A=m[T],b="z",N="",B=Le({c:o+p,r:a+_+i});l=fu(s,B),A&&typeof A=="object"&&!(A instanceof Date)?s[B]=A:(typeof A=="number"?b="n":typeof A=="boolean"?b="b":typeof A=="string"?b="s":A instanceof Date?(b="d",n.cellDates||(b="n",A=fr(A)),N=n.dateNF||Oe[14]):A===null&&n.nullError&&(b="e",A=0),l?(l.t=b,l.v=A,delete l.w,delete l.R,N&&(l.z=N)):s[B]=l={t:b,v:A},N&&(l.z=N))})}),h.e.c=Math.max(h.e.c,o+d.length-1);var v=Zt(a);if(i)for(p=0;p<d.length;++p)s[Bt(p+o)+v]={t:"s",v:d[p]};return s["!ref"]=$e(h),s}function B8(t,e){return Mb(null,t,e)}function fu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ut(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?fu(t,Le(e)):fu(t,Le({r:e,c:r||0}))}function U8(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function yg(){return{SheetNames:[],Sheets:{}}}function xg(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(_b(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function j8(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=U8(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function W8(t,e){return t.z=e,t}function Lb(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function $8(t,e,r){return Lb(t,"#"+e,r)}function H8(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function z8(t,e,r,n){for(var i=typeof e!="string"?e:ct(e),s=typeof e=="string"?e:$e(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=fu(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var xu={encode_col:Bt,encode_row:Zt,encode_cell:Le,encode_range:$e,decode_col:Xm,decode_row:Km,split_cell:rP,decode_cell:Ut,decode_range:ln,format_cell:Yi,sheet_add_aoa:lT,sheet_add_json:Mb,sheet_add_dom:Ab,aoa_to_sheet:Qo,json_to_sheet:B8,table_to_sheet:Sb,table_to_book:J6,sheet_to_csv:_g,sheet_to_txt:Nb,sheet_to_json:Uf,sheet_to_html:Ib,sheet_to_formulae:V8,sheet_to_row_object_array:Uf,sheet_get_cell:fu,book_new:yg,book_append_sheet:xg,book_set_sheet_visibility:j8,cell_set_number_format:W8,cell_set_hyperlink:Lb,cell_set_internal_link:$8,cell_add_comment:H8,sheet_set_array_formula:z8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var vz=Zl.version;var Qf=(()=>{let e=class e{constructor(){this.data={}}setHeaderData(n){this.data=n}getHeaderData(){return this.data}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Bb=(()=>{let e=class e{constructor(n){this.headerDataService=n,this.guardarHeader=new kr,this.cerrarModal=new kr,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[];let i=this.headerDataService.getHeaderData();i&&(this.institucion=i.institucion,this.examen=i.examen,this.fecha=i.fecha==null||i.fecha==""?this.getFechaActual():i.fecha,this.duracion=i.duracion,this.profesor=i.profesor,this.catedra=i.catedra,this.dniChecked=i.dniChecked,this.puntosChecked=i.puntosChecked,this.logoFiles=i.logoFile==null?[]:i.logoFile)}guardarDatosHeader(){let n={institucion:this.institucion,examen:this.examen,fecha:this.fecha,duracion:this.duracion,profesor:this.profesor,catedra:this.catedra,logoFile:this.logoFiles,dniChecked:this.dniChecked,puntosChecked:this.puntosChecked};this.headerDataService.setHeaderData(n),this.guardarHeader.emit(n),this.cerrarModal.emit()}onClose(){this.cerrarModal.emit()}onLogoChange(n){let i=n.target,s=i.files&&i.files[0];s&&this.logoFiles.push(s)}getFechaActual(){let n=new Date,i=new Date(n.toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"})),s=i.getFullYear(),a=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return`${s}-${a}-${o}`}};e.\u0275fac=function(i){return new(i||e)(Ue(Qf))},e.\u0275cmp=$t({type:e,selectors:[["app-header"]],outputs:{guardarHeader:"guardarHeader",cerrarModal:"cerrarModal"},standalone:!0,features:[Ht],decls:48,vars:8,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-gray-900","bg-opacity-50"],["id","modal",1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-lg","w-full","mx-4","max-h-[85vh]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit"],["for","institucion",1,"block","font-semibold","mb-2"],["type","text","id","institucion","name","institucion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","logo",1,"block","font-semibold","mb-2"],["type","file","id","logoInput","accept","image/*",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"change"],["for","examen",1,"block","font-semibold","mb-2"],["type","text","id","examen","name","examen","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","flex-col","sm:flex-row","gap-2"],[1,"flex-1"],["for","fecha",1,"block","font-semibold","mb-2"],["type","date","id","fecha","name","fecha","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","duracion",1,"block","font-semibold","mb-2"],["type","text","id","duracion","name","duracion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","profesor",1,"block","font-semibold","mb-2"],["type","text","id","profesor","name","profesor","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","catedra",1,"block","font-semibold","mb-2"],["type","text","id","catedra","name","catedra","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","mb-4"],["type","checkbox","id","dniCheckbox","name","dniCheckbox",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","dniCheckbox",1,"ms-2","font-semibold"],["type","checkbox","id","puntosCheckbox","name","puntos",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","puntos",1,"ms-2","font-semibold"],[1,"flex","justify-end","space-x-4"],["type","button",1,"bg-gray-300","text-gray-800","py-2","px-4","rounded","hover:bg-gray-400",3,"click"],["type","submit",1,"bg-blue-500","text-white","py-2","px-4","rounded","hover:bg-blue-600"]],template:function(i,s){i&1&&(ae(0,"div",0)(1,"div",1)(2,"h2",2),ke(3,"Ingresar datos del membrete"),le(),ae(4,"form",3),ut("ngSubmit",function(){return s.guardarDatosHeader()}),ae(5,"div")(6,"label",4),ke(7,"Instituci\xF3n:"),le(),ae(8,"input",5),gn("ngModelChange",function(o){return mn(s.institucion,o)||(s.institucion=o),o}),le()(),ae(9,"div")(10,"label",6),ke(11,"Logo de la instituci\xF3n:"),le(),ae(12,"input",7),ut("change",function(o){return s.onLogoChange(o)}),le()(),ae(13,"div")(14,"label",8),ke(15,"Examen:"),le(),ae(16,"input",9),gn("ngModelChange",function(o){return mn(s.examen,o)||(s.examen=o),o}),le()(),ae(17,"div",10)(18,"div",11)(19,"label",12),ke(20,"Fecha:"),le(),ae(21,"input",13),gn("ngModelChange",function(o){return mn(s.fecha,o)||(s.fecha=o),o}),le()(),ae(22,"div",11)(23,"label",14),ke(24,"Duraci\xF3n:"),le(),ae(25,"input",15),gn("ngModelChange",function(o){return mn(s.duracion,o)||(s.duracion=o),o}),le()()(),ae(26,"div",10)(27,"div",11)(28,"label",16),ke(29,"Profesor:"),le(),ae(30,"input",17),gn("ngModelChange",function(o){return mn(s.profesor,o)||(s.profesor=o),o}),le()(),ae(31,"div",11)(32,"label",18),ke(33,"C\xE1tedra:"),le(),ae(34,"input",19),gn("ngModelChange",function(o){return mn(s.catedra,o)||(s.catedra=o),o}),le()()(),ae(35,"div",20)(36,"input",21),gn("ngModelChange",function(o){return mn(s.dniChecked,o)||(s.dniChecked=o),o}),le(),ae(37,"label",22),ke(38,"DNI Alumno"),le()(),ae(39,"div",20)(40,"input",23),gn("ngModelChange",function(o){return mn(s.puntosChecked,o)||(s.puntosChecked=o),o}),le(),ae(41,"label",24),ke(42,"Puntos"),le()(),ae(43,"div",25)(44,"button",26),ut("click",function(){return s.onClose()}),ke(45," Cancelar "),le(),ae(46,"button",27),ke(47," Guardar "),le()()()()()),i&2&&(Je(8),pn("ngModel",s.institucion),Je(8),pn("ngModel",s.examen),Je(5),pn("ngModel",s.fecha),Je(4),pn("ngModel",s.duracion),Je(5),pn("ngModel",s.profesor),Je(4),pn("ngModel",s.catedra),Je(2),pn("ngModel",s.dniChecked),Je(4),pn("ngModel",s.puntosChecked))},dependencies:[Fo,Po,As,jp,Do,Ro,ma,Ol,qp],encapsulation:2});let t=e;return t})();function Ub(t,e){return typeof t=="function"?t(e):t}function wg(t){return t.split("-")[0]}function jb(t){return t.split("-")[1]}function Wb(t){return["top","bottom"].includes(wg(t))?"y":"x"}function K8(t,e){return Z(this,null,function*(){let{placement:r,platform:n,elements:i}=t,s=yield n.isRTL==null?void 0:n.isRTL(i.floating),a=wg(r),o=jb(r),c=Wb(r)==="y",l=["left","top"].includes(a)?-1:1,h=s&&c?-1:1,f=Ub(e,t),{mainAxis:d,crossAxis:p,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:be({mainAxis:0,crossAxis:0,alignmentAxis:null},f);return o&&typeof v=="number"&&(p=o==="end"?v*-1:v),c?{x:p*h,y:d*l}:{x:d*l,y:p*h}})}var $b=function(t){return t===void 0&&(t=0),{name:"offset",options:t,fn(r){return Z(this,null,function*(){var n,i;let{x:s,y:a,placement:o,middlewareData:c}=r,l=yield K8(r,t);return o===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:a+l.y,data:pt(be({},l),{placement:o})}})}}};var li=$b;var Hb=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-loading-print"]],standalone:!0,features:[Ht],decls:7,vars:0,consts:[["id","printOverlay",1,"fixed","inset-0","bg-white","flex","flex-col","items-center","justify-center","z-50","print:flex"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"animate-spin","h-16","w-16","mb-4"],["cx","16","cy","16","r","14","fill","#3498db",1,"shadow-md"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"text-lg","font-semibold","text-gray-700"]],template:function(i,s){i&1&&(ae(0,"div",0),Mr(),ae(1,"svg",1),Ye(2,"circle",2)(3,"circle",3)(4,"circle",4),le(),ti(),ae(5,"p",5),ke(6,"Cargando, por favor espere..."),le()())},encapsulation:2});let t=e;return t})();var Zo=(()=>{let e=class e{constructor(){this.toastSubject=new Dn}getToast(){return this.toastSubject.asObservable()}showToast(n){this.toastSubject.next(n),setTimeout(()=>this.toastSubject.next({type:n.type,message:n.message,active:n.active}))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function X8(t,e){if(t&1){let r=_i();ae(0,"div",4)(1,"div",5),Mr(),ae(2,"svg",6),Ye(3,"path",7),le()(),ti(),ae(4,"div",8)(5,"div",9),ke(6,"\xC9xito"),le(),ae(7,"div",10),ke(8),le()(),ae(9,"button",11),ut("click",function(){Zn(r);let i=vr();return ei(i.closeToast())}),Mr(),ae(10,"svg",12),Ye(11,"path",13),le()()()}if(t&2){let r=vr();Je(8),tl(r.toast.message)}}function Y8(t,e){if(t&1){let r=_i();ae(0,"div",14)(1,"div",15),Mr(),ae(2,"svg",16)(3,"g",17),Ye(4,"path",18),le()()(),ti(),ae(5,"div",8)(6,"div",19),ke(7,"Error"),le(),ae(8,"div",10),ke(9),le()(),ae(10,"button",11),ut("click",function(){Zn(r);let i=vr();return ei(i.closeToast())}),Mr(),ae(11,"svg",12),Ye(12,"path",13),le()()()}if(t&2){let r=vr();Je(9),tl(r.toast.message)}}function Q8(t,e){if(t&1){let r=_i();ae(0,"div",20)(1,"div",21),Mr(),ae(2,"svg",22),Ye(3,"path",23),le()(),ti(),ae(4,"div",8)(5,"div",24),ke(6,"Advertencia"),le(),ae(7,"div",10),ke(8),le()(),ae(9,"button",11),ut("click",function(){Zn(r);let i=vr();return ei(i.closeToast())}),Mr(),ae(10,"svg",12),Ye(11,"path",13),le()()()}if(t&2){let r=vr();Je(8),tl(r.toast.message)}}function J8(t,e){if(t&1){let r=_i();ae(0,"div",25)(1,"div",26),Mr(),ae(2,"svg",22),Ye(3,"path",27),le()(),ti(),ae(4,"div",8)(5,"div",28),ke(6,"Informaci\xF3n"),le(),ae(7,"div",10),ke(8),le()(),ae(9,"button",11),ut("click",function(){Zn(r);let i=vr();return ei(i.closeToast())}),Mr(),ae(10,"svg",12),Ye(11,"path",13),le()()()}if(t&2){let r=vr();Je(8),tl(r.toast.message)}}var Jf=(()=>{let e=class e{constructor(){this.toast={message:"",type:"",active:!1},this.toastService=Ce(Zo)}ngOnInit(){this.toastService.getToast().subscribe(n=>{this.toast=n,n&&setTimeout(()=>this.toast.active=!1,1e4)})}closeToast(){this.toast.active=!1}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-toast"]],standalone:!0,features:[Ht],decls:4,vars:4,consts:[["class","fixed top-24 right-4 z-50 w-full max-w-xs p-4 text-gray-500 bg-green-50 rounded-lg shadow-lg border border-green-200 flex items-center",4,"ngIf"],["class","fixed top-24 right-4 z-50 w-full max-w-xs p-4 text-gray-500 bg-red-50 rounded-lg shadow-lg border border-red-200 flex items-center",4,"ngIf"],["class","fixed top-24 right-4 z-50 w-full max-w-xs p-4 text-gray-500 bg-yellow-50 rounded-lg shadow-lg border border-yellow-200 flex items-center",4,"ngIf"],["class","fixed top-24 right-4 z-50 w-full max-w-xs p-4 text-gray-500 bg-blue-50 rounded-lg shadow-lg border border-blue-200 flex items-center",4,"ngIf"],[1,"fixed","top-24","right-4","z-50","w-full","max-w-xs","p-4","text-gray-500","bg-green-50","rounded-lg","shadow-lg","border","border-green-200","flex","items-center"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","text-green-500","bg-green-200","rounded-lg"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"w-5","h-5"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"],[1,"ml-3"],[1,"text-sm","font-semibold","text-green-700"],[1,"text-sm","font-normal"],["type","button",1,"absolute","top-1","right-1","text-gray-400","hover:text-gray-900","rounded-lg","p-1.5","inline-flex","items-center","justify-center","h-8","w-8",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"fixed","top-24","right-4","z-50","w-full","max-w-xs","p-4","text-gray-500","bg-red-50","rounded-lg","shadow-lg","border","border-red-200","flex","items-center"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","bg-red-200","rounded-lg"],["width","24px","height","24px","viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg"],["fill","#FF0000","transform","translate(42.666667, 42.666667)"],["d","M213.333333,0 C331.136,0 426.666667,95.5306667 426.666667,213.333333 C426.666667,331.136 331.136,426.666667 213.333333,426.666667 C95.5306667,426.666667 0,331.136 0,213.333333 C0,95.5306667 95.5306667,0 213.333333,0 Z M262.250667,134.250667 L213.333333,183.168 L164.416,134.250667 L134.250667,164.416 L183.168,213.333333 L134.250667,262.250667 L164.416,292.416 L213.333333,243.498667 L262.250667,292.416 L292.416,262.250667 L243.498667,213.333333 L292.416,164.416 L262.250667,134.250667 Z"],[1,"text-sm","font-semibold","text-red-700"],[1,"fixed","top-24","right-4","z-50","w-full","max-w-xs","p-4","text-gray-500","bg-yellow-50","rounded-lg","shadow-lg","border","border-yellow-200","flex","items-center"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","bg-yellow-200","rounded-lg"],["width","24px","height","24px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["fill-rule","evenodd","clip-rule","evenodd","d","M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75ZM12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z","fill","#F59E0B"],[1,"text-sm","font-semibold","text-yellow-700"],[1,"fixed","top-24","right-4","z-50","w-full","max-w-xs","p-4","text-gray-500","bg-blue-50","rounded-lg","shadow-lg","border","border-blue-200","flex","items-center"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","bg-blue-200","rounded-lg"],["fill-rule","evenodd","clip-rule","evenodd","d","M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75ZM12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z","fill","#1D4ED8"],[1,"text-sm","font-semibold","text-blue-700"]],template:function(i,s){i&1&&On(0,X8,12,1,"div",0)(1,Y8,13,1,"div",1)(2,Q8,12,1,"div",2)(3,J8,12,1,"div",3),i&2&&(ur("ngIf",s.toast.active&&s.toast.type==="success"),Je(),ur("ngIf",s.toast.active&&s.toast.type==="error"),Je(),ur("ngIf",s.toast.active&&s.toast.type==="warning"),Je(),ur("ngIf",s.toast.active&&s.toast.type==="info"))},dependencies:[ca,kh],encapsulation:2});let t=e;return t})();var zb=(()=>{let e=class e{generateExams(n,i,s,a){let o=[];if(s!=0)for(let c=0;c<n;c++){let l=[],h=0;for(;h<s&&a.length!==0;){let d=Math.floor(Math.random()*a.length),p=a[d];!l.some(m=>m.pregunta===p.pregunta)&&Number(p.puntaje)<=s&&(l.push(p),h-=Number(p.puntaje))}let f=l.map(d=>be({},d));o.push(f)}else for(let c=0;c<n;c++){let l=[];for(;l.length<i;){let d=this.getRandomQuestion(a),p=this.mezclarArray(d.respuesta);d.respuesta=p,l.some(m=>m.pregunta===d.pregunta)||l.push(d)}let h=100/i,f=l.map(d=>pt(be({},d),{puntaje:h}));o.push(f)}return o}getRandomQuestion(n){let i=Math.floor(Math.random()*n.length);return n[i]}mezclarArray(n){let i=[...n];for(let s=i.length-1;s>0;s--){let a=Math.floor(Math.random()*(s+1)),o=i[s];i[s]=i[a],i[a]=o}return i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var e5=function(e){return t5(e)&&!r5(e)};function t5(t){return!!t&&typeof t=="object"}function r5(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||s5(t)}var n5=typeof Symbol=="function"&&Symbol.for,i5=n5?Symbol.for("react.element"):60103;function s5(t){return t.$$typeof===i5}function a5(t){return Array.isArray(t)?[]:{}}function Eu(t,e){return e.clone!==!1&&e.isMergeableObject(t)?sc(a5(t),t,e):t}function o5(t,e,r){return t.concat(e).map(function(n){return Eu(n,r)})}function c5(t,e){if(!e.customMerge)return sc;var r=e.customMerge(t);return typeof r=="function"?r:sc}function l5(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function Gb(t){return Object.keys(t).concat(l5(t))}function hI(t,e){try{return e in t}catch{return!1}}function u5(t,e){return hI(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function h5(t,e,r){var n={};return r.isMergeableObject(t)&&Gb(t).forEach(function(i){n[i]=Eu(t[i],r)}),Gb(e).forEach(function(i){u5(t,i)||(hI(t,i)&&r.isMergeableObject(e[i])?n[i]=c5(i,r)(t[i],e[i],r):n[i]=Eu(e[i],r))}),n}function sc(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||o5,r.isMergeableObject=r.isMergeableObject||e5,r.cloneUnlessOtherwiseSpecified=Eu;var n=Array.isArray(e),i=Array.isArray(t),s=n===i;return s?n?r.arrayMerge(t,e,r):h5(t,e,r):Eu(e,r)}sc.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,i){return sc(n,i,r)},{})};var f5=sc,Lg=f5;function d5(t){return t instanceof Element}function Vg(t){return t instanceof HTMLElement}function Ua(t){return typeof t=="function"}function Tu(t){return typeof t=="string"}function Gr(t){return t===void 0}var bu=class{on(e,r,n,i=!1){return Gr(this.bindings)&&(this.bindings={}),Gr(this.bindings[e])&&(this.bindings[e]=[]),this.bindings[e].push({handler:r,ctx:n,once:i}),this}once(e,r,n){return this.on(e,r,n,!0)}off(e,r){return Gr(this.bindings)||Gr(this.bindings[e])?this:(Gr(r)?delete this.bindings[e]:this.bindings[e].forEach((n,i)=>{n.handler===r&&this.bindings[e].splice(i,1)}),this)}trigger(e,...r){return!Gr(this.bindings)&&this.bindings[e]&&this.bindings[e].forEach((n,i)=>{let{ctx:s,handler:a,once:o}=n,c=s||this;a.apply(c,r),o&&this.bindings[e].splice(i,1)}),this}};function fI(t){let e=Object.getOwnPropertyNames(t.constructor.prototype);for(let r=0;r<e.length;r++){let n=e[r],i=t[n];n!=="constructor"&&typeof i=="function"&&(t[n]=i.bind(t))}return t}function p5(t,e){return r=>{if(e.isOpen()){let n=e.el&&r.currentTarget===e.el;(!Gr(t)&&r.currentTarget.matches(t)||n)&&e.tour.next()}}}function m5(t){let{event:e,selector:r}=t.options.advanceOn||{};if(e){let n=p5(r,t),i;try{i=document.querySelector(r)}catch{}if(!Gr(r)&&!i)return console.error(`No element was found for the selector supplied to advanceOn: ${r}`);i?(i.addEventListener(e,n),t.on("destroy",()=>i.removeEventListener(e,n))):(document.body.addEventListener(e,n,!0),t.on("destroy",()=>document.body.removeEventListener(e,n,!0)))}else return console.error("advanceOn was defined, but no event name was passed.")}function dI(t){return!Tu(t)||t===""?"":t.charAt(t.length-1)!=="-"?`${t}-`:t}function g5(t){let e=t.options.attachTo||{},r=Object.assign({},e);if(Ua(r.element)&&(r.element=r.element.call(t)),Tu(r.element)){try{r.element=document.querySelector(r.element)}catch{}r.element||console.error(`The element for this Shepherd step was not found ${e.element}`)}return r}function pI(t){return t==null?!0:!t.element||!t.on}function Bg(){let t=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e=="x"?r:r&3|8).toString(16)})}function qr(){return qr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qr.apply(this,arguments)}function mI(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var ac=Math.min,La=Math.max,td=Math.round,Zf=Math.floor,Vs=t=>({x:t,y:t}),v5={left:"right",right:"left",bottom:"top",top:"bottom"},_5={start:"end",end:"start"};function Tg(t,e,r){return La(t,ac(e,r))}function oc(t,e){return typeof t=="function"?t(e):t}function ja(t){return t.split("-")[0]}function od(t){return t.split("-")[1]}function Ug(t){return t==="x"?"y":"x"}function jg(t){return t==="y"?"height":"width"}function cd(t){return["top","bottom"].includes(ja(t))?"y":"x"}function Wg(t){return Ug(cd(t))}function y5(t,e,r){r===void 0&&(r=!1);let n=od(t),i=Wg(t),s=jg(i),a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=rd(a)),[a,rd(a)]}function x5(t){let e=rd(t);return[bg(t),e,bg(e)]}function bg(t){return t.replace(/start|end/g,e=>_5[e])}function w5(t,e,r){let n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return r?e?i:n:e?n:i;case"left":case"right":return e?s:a;default:return[]}}function E5(t,e,r,n){let i=od(t),s=w5(ja(t),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(bg)))),s}function rd(t){return t.replace(/left|right|bottom|top/g,e=>v5[e])}function T5(t){return qr({top:0,right:0,bottom:0,left:0},t)}function gI(t){return typeof t!="number"?T5(t):{top:t,right:t,bottom:t,left:t}}function nd(t){return qr({},t,{top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height})}var b5=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],I5=["mainAxis","crossAxis","limiter"];function qb(t,e,r){let{reference:n,floating:i}=t,s=cd(e),a=Wg(e),o=jg(a),c=ja(e),l=s==="y",h=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,d=n[o]/2-i[o]/2,p;switch(c){case"top":p={x:h,y:n.y-i.height};break;case"bottom":p={x:h,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:f};break;case"left":p={x:n.x-i.width,y:f};break;default:p={x:n.x,y:n.y}}switch(od(e)){case"start":p[a]-=d*(r&&l?-1:1);break;case"end":p[a]+=d*(r&&l?-1:1);break}return p}var A5=(t,e,r)=>Z(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),c=yield a.isRTL==null?void 0:a.isRTL(e),l=yield a.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:f}=qb(l,n,c),d=n,p={},v=0;for(let m=0;m<o.length;m++){let{name:_,fn:T}=o[m],{x:A,y:b,data:N,reset:B}=yield T({x:h,y:f,initialPlacement:n,placement:d,strategy:i,middlewareData:p,rects:l,platform:a,elements:{reference:t,floating:e}});if(h=A??h,f=b??f,p=qr({},p,{[_]:qr({},p[_],N)}),B&&v<=50){v++,typeof B=="object"&&(B.placement&&(d=B.placement),B.rects&&(l=B.rects===!0?yield a.getElementRects({reference:t,floating:e,strategy:i}):B.rects),{x:h,y:f}=qb(l,d,c)),m=-1;continue}}return{x:h,y:f,placement:d,strategy:i,middlewareData:p}});function vI(t,e){return Z(this,null,function*(){var r;e===void 0&&(e={});let{x:n,y:i,platform:s,rects:a,elements:o,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:d=!1,padding:p=0}=oc(e,t),v=gI(p),_=o[d?f==="floating"?"reference":"floating":f],T=nd(yield s.getClippingRect({element:(r=yield s.isElement==null?void 0:s.isElement(_))==null||r?_:_.contextElement||(yield s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:l,rootBoundary:h,strategy:c})),A=f==="floating"?qr({},a.floating,{x:n,y:i}):a.reference,b=yield s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating),N=(yield s.isElement==null?void 0:s.isElement(b))?(yield s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},B=nd(s.convertOffsetParentRelativeRectToViewportRelativeRect?yield s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:A,offsetParent:b,strategy:c}):A);return{top:(T.top-B.top+v.top)/N.y,bottom:(B.bottom-T.bottom+v.bottom)/N.y,left:(T.left-B.left+v.left)/N.x,right:(B.right-T.right+v.right)/N.x}})}var S5=t=>({name:"arrow",options:t,fn(r){return Z(this,null,function*(){let{x:n,y:i,placement:s,rects:a,platform:o,elements:c}=r,{element:l,padding:h=0}=oc(t,r)||{};if(l==null)return{};let f=gI(h),d={x:n,y:i},p=Wg(s),v=jg(p),m=yield o.getDimensions(l),_=p==="y",T=_?"top":"left",A=_?"bottom":"right",b=_?"clientHeight":"clientWidth",N=a.reference[v]+a.reference[p]-d[p]-a.floating[v],B=d[p]-a.reference[p],M=yield o.getOffsetParent==null?void 0:o.getOffsetParent(l),x=M?M[b]:0;(!x||!(yield o.isElement==null?void 0:o.isElement(M)))&&(x=c.floating[b]||a.floating[v]);let w=N/2-B/2,E=x/2-m[v]/2-1,C=ac(f[T],E),D=ac(f[A],E),S=C,R=x-m[v]-D,oe=x/2-m[v]/2+w,se=Tg(S,oe,R),xe=od(s)!=null&&oe!=se&&a.reference[v]/2-(oe<S?C:D)-m[v]/2<0?oe<S?S-oe:R-oe:0;return{[p]:d[p]-xe,data:{[p]:se,centerOffset:oe-se+xe}}})}}),C5=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(n){return Z(this,null,function*(){var i;let{placement:s,middlewareData:a,rects:o,initialPlacement:c,platform:l,elements:h}=n,f=oc(e,n),{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:v,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:T=!0}=f,A=mI(f,b5),b=ja(s),N=ja(c)===c,B=yield l.isRTL==null?void 0:l.isRTL(h.floating),M=v||(N||!T?[rd(c)]:x5(c));!v&&_!=="none"&&M.push(...E5(c,T,_,B));let x=[c,...M],w=yield vI(n,A),E=[],C=((i=a.flip)==null?void 0:i.overflows)||[];if(d&&E.push(w[b]),p){let oe=y5(s,o,B);E.push(w[oe[0]],w[oe[1]])}if(C=[...C,{placement:s,overflows:E}],!E.every(oe=>oe<=0)){var D,S;let oe=(((D=a.flip)==null?void 0:D.index)||0)+1,se=x[oe];if(se)return{data:{index:oe,overflows:C},reset:{placement:se}};let Ie=(S=C.filter(xe=>xe.overflows[0]<=0).sort((xe,Pe)=>xe.overflows[1]-Pe.overflows[1])[0])==null?void 0:S.placement;if(!Ie)switch(m){case"bestFit":{var R;let xe=(R=C.map(Pe=>[Pe.placement,Pe.overflows.filter(de=>de>0).reduce((de,Ae)=>de+Ae,0)]).sort((Pe,de)=>Pe[1]-de[1])[0])==null?void 0:R[0];xe&&(Ie=xe);break}case"initialPlacement":Ie=c;break}if(s!==Ie)return{reset:{placement:Ie}}}return{}})}}},k5=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(n){return Z(this,null,function*(){let{x:i,y:s,placement:a}=n,o=oc(e,n),{mainAxis:c=!0,crossAxis:l=!1,limiter:h={fn:b=>{let{x:N,y:B}=b;return{x:N,y:B}}}}=o,f=mI(o,I5),d={x:i,y:s},p=yield vI(n,f),v=cd(ja(a)),m=Ug(v),_=d[m],T=d[v];if(c){let b=m==="y"?"top":"left",N=m==="y"?"bottom":"right",B=_+p[b],M=_-p[N];_=Tg(B,_,M)}if(l){let b=v==="y"?"top":"left",N=v==="y"?"bottom":"right",B=T+p[b],M=T-p[N];T=Tg(B,T,M)}let A=h.fn(qr({},n,{[m]:_,[v]:T}));return qr({},A,{data:{x:A.x-i,y:A.y-s}})})}}},D5=function(e){return e===void 0&&(e={}),{options:e,fn(r){let{x:n,y:i,placement:s,rects:a,middlewareData:o}=r,{offset:c=0,mainAxis:l=!0,crossAxis:h=!0}=oc(e,r),f={x:n,y:i},d=cd(s),p=Ug(d),v=f[p],m=f[d],_=oc(c,r),T=typeof _=="number"?{mainAxis:_,crossAxis:0}:qr({mainAxis:0,crossAxis:0},_);if(l){let N=p==="y"?"height":"width",B=a.reference[p]-a.floating[N]+T.mainAxis,M=a.reference[p]+a.reference[N]-T.mainAxis;v<B?v=B:v>M&&(v=M)}if(h){var A,b;let N=p==="y"?"width":"height",B=["top","left"].includes(ja(s)),M=a.reference[d]-a.floating[N]+(B&&((A=o.offset)==null?void 0:A[d])||0)+(B?0:T.crossAxis),x=a.reference[d]+a.reference[N]+(B?0:((b=o.offset)==null?void 0:b[d])||0)-(B?T.crossAxis:0);m<M?m=M:m>x&&(m=x)}return{[p]:v,[d]:m}}}};function Bs(t){return _I(t)?(t.nodeName||"").toLowerCase():"#document"}function Tn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ts(t){var e;return(e=(_I(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function _I(t){return t instanceof Node||t instanceof Tn(t).Node}function es(t){return t instanceof Element||t instanceof Tn(t).Element}function ki(t){return t instanceof HTMLElement||t instanceof Tn(t).HTMLElement}function Kb(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Tn(t).ShadowRoot}function Su(t){let{overflow:e,overflowX:r,overflowY:n,display:i}=Gn(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function R5(t){return["table","td","th"].includes(Bs(t))}function $g(t){let e=Hg(),r=Gn(t);return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function P5(t){let e=cc(t);for(;ki(e)&&!ld(e);){if($g(e))return e;e=cc(e)}return null}function Hg(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function ld(t){return["html","body","#document"].includes(Bs(t))}function Gn(t){return Tn(t).getComputedStyle(t)}function ud(t){return es(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function cc(t){if(Bs(t)==="html")return t;let e=t.assignedSlot||t.parentNode||Kb(t)&&t.host||ts(t);return Kb(e)?e.host:e}function yI(t){let e=cc(t);return ld(e)?t.ownerDocument?t.ownerDocument.body:t.body:ki(e)&&Su(e)?e:yI(e)}function id(t,e){var r;e===void 0&&(e=[]);let n=yI(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),s=Tn(n);return i?e.concat(s,s.visualViewport||[],Su(n)?n:[]):e.concat(n,id(n))}function xI(t){let e=Gn(t),r=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=ki(t),s=i?t.offsetWidth:r,a=i?t.offsetHeight:n,o=td(r)!==s||td(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function zg(t){return es(t)?t:t.contextElement}function nc(t){let e=zg(t);if(!ki(e))return Vs(1);let r=e.getBoundingClientRect(),{width:n,height:i,$:s}=xI(e),a=(s?td(r.width):r.width)/n,o=(s?td(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}var F5=Vs(0);function wI(t){let e=Tn(t);return!Hg()||!e.visualViewport?F5:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function O5(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Tn(t)?!1:e}function Wa(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);let i=t.getBoundingClientRect(),s=zg(t),a=Vs(1);e&&(n?es(n)&&(a=nc(n)):a=nc(t));let o=O5(s,r,n)?wI(s):Vs(0),c=(i.left+o.x)/a.x,l=(i.top+o.y)/a.y,h=i.width/a.x,f=i.height/a.y;if(s){let d=Tn(s),p=n&&es(n)?Tn(n):n,v=d.frameElement;for(;v&&n&&p!==d;){let m=nc(v),_=v.getBoundingClientRect(),T=Gn(v),A=_.left+(v.clientLeft+parseFloat(T.paddingLeft))*m.x,b=_.top+(v.clientTop+parseFloat(T.paddingTop))*m.y;c*=m.x,l*=m.y,h*=m.x,f*=m.y,c+=A,l+=b,v=Tn(v).frameElement}}return nd({width:h,height:f,x:c,y:l})}function N5(t){let{rect:e,offsetParent:r,strategy:n}=t,i=ki(r),s=ts(r);if(r===s)return e;let a={scrollLeft:0,scrollTop:0},o=Vs(1),c=Vs(0);if((i||!i&&n!=="fixed")&&((Bs(r)!=="body"||Su(s))&&(a=ud(r)),ki(r))){let l=Wa(r);o=nc(r),c.x=l.x+r.clientLeft,c.y=l.y+r.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+c.x,y:e.y*o.y-a.scrollTop*o.y+c.y}}function M5(t){return Array.from(t.getClientRects())}function EI(t){return Wa(ts(t)).left+ud(t).scrollLeft}function L5(t){let e=ts(t),r=ud(t),n=t.ownerDocument.body,i=La(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=La(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),a=-r.scrollLeft+EI(t),o=-r.scrollTop;return Gn(n).direction==="rtl"&&(a+=La(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function V5(t,e){let r=Tn(t),n=ts(t),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,c=0;if(i){s=i.width,a=i.height;let l=Hg();(!l||l&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:s,height:a,x:o,y:c}}function B5(t,e){let r=Wa(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=ki(t)?nc(t):Vs(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,c=i*s.x,l=n*s.y;return{width:a,height:o,x:c,y:l}}function Xb(t,e,r){let n;if(e==="viewport")n=V5(t,r);else if(e==="document")n=L5(ts(t));else if(es(e))n=B5(e,r);else{let i=wI(t);n=qr({},e,{x:e.x-i.x,y:e.y-i.y})}return nd(n)}function TI(t,e){let r=cc(t);return r===e||!es(r)||ld(r)?!1:Gn(r).position==="fixed"||TI(r,e)}function U5(t,e){let r=e.get(t);if(r)return r;let n=id(t).filter(o=>es(o)&&Bs(o)!=="body"),i=null,s=Gn(t).position==="fixed",a=s?cc(t):t;for(;es(a)&&!ld(a);){let o=Gn(a),c=$g(a);!c&&o.position==="fixed"&&(i=null),(s?!c&&!i:!c&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Su(a)&&!c&&TI(t,a))?n=n.filter(h=>h!==a):i=o,a=cc(a)}return e.set(t,n),n}function j5(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t,a=[...r==="clippingAncestors"?U5(e,this._c):[].concat(r),n],o=a[0],c=a.reduce((l,h)=>{let f=Xb(e,h,i);return l.top=La(f.top,l.top),l.right=ac(f.right,l.right),l.bottom=ac(f.bottom,l.bottom),l.left=La(f.left,l.left),l},Xb(e,o,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function W5(t){return xI(t)}function $5(t,e,r){let n=ki(e),i=ts(e),s=r==="fixed",a=Wa(t,!0,s,e),o={scrollLeft:0,scrollTop:0},c=Vs(0);if(n||!n&&!s)if((Bs(e)!=="body"||Su(i))&&(o=ud(e)),n){let l=Wa(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=EI(i));return{x:a.left+o.scrollLeft-c.x,y:a.top+o.scrollTop-c.y,width:a.width,height:a.height}}function Yb(t,e){return!ki(t)||Gn(t).position==="fixed"?null:e?e(t):t.offsetParent}function bI(t,e){let r=Tn(t);if(!ki(t))return r;let n=Yb(t,e);for(;n&&R5(n)&&Gn(n).position==="static";)n=Yb(n,e);return n&&(Bs(n)==="html"||Bs(n)==="body"&&Gn(n).position==="static"&&!$g(n))?r:n||P5(t)||r}var H5=function(e){return Z(this,null,function*(){let{reference:r,floating:n,strategy:i}=e,s=this.getOffsetParent||bI,a=this.getDimensions;return{reference:$5(r,yield s(n),i),floating:qr({x:0,y:0},yield a(n))}})};function z5(t){return Gn(t).direction==="rtl"}var G5={convertOffsetParentRelativeRectToViewportRelativeRect:N5,getDocumentElement:ts,getClippingRect:j5,getOffsetParent:bI,getElementRects:H5,getClientRects:M5,getDimensions:W5,getScale:nc,isElement:es,isRTL:z5};function q5(t,e){let r=null,n,i=ts(t);function s(){clearTimeout(n),r&&r.disconnect(),r=null}function a(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),s();let{left:l,top:h,width:f,height:d}=t.getBoundingClientRect();if(o||e(),!f||!d)return;let p=Zf(h),v=Zf(i.clientWidth-(l+f)),m=Zf(i.clientHeight-(h+d)),_=Zf(l),A={rootMargin:-p+"px "+-v+"px "+-m+"px "+-_+"px",threshold:La(0,ac(1,c))||1},b=!0;function N(B){let M=B[0].intersectionRatio;if(M!==c){if(!b)return a();M?a(!1,M):n=setTimeout(()=>{a(!1,1e-7)},100)}b=!1}try{r=new IntersectionObserver(N,qr({},A,{root:i.ownerDocument}))}catch{r=new IntersectionObserver(N,A)}r.observe(t)}return a(!0),s}function K5(t,e,r,n){n===void 0&&(n={});let{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,l=zg(t),h=i||s?[...l?id(l):[],...id(e)]:[];h.forEach(T=>{i&&T.addEventListener("scroll",r,{passive:!0}),s&&T.addEventListener("resize",r)});let f=l&&o?q5(l,r):null,d=-1,p=null;a&&(p=new ResizeObserver(T=>{let[A]=T;A&&A.target===l&&p&&(p.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{p&&p.observe(e)})),r()}),l&&!c&&p.observe(l),p.observe(e));let v,m=c?Wa(t):null;c&&_();function _(){let T=Wa(t);m&&(T.x!==m.x||T.y!==m.y||T.width!==m.width||T.height!==m.height)&&r(),m=T,v=requestAnimationFrame(_)}return r(),()=>{h.forEach(T=>{i&&T.removeEventListener("scroll",r),s&&T.removeEventListener("resize",r)}),f&&f(),p&&p.disconnect(),p=null,c&&cancelAnimationFrame(v)}}var X5=(t,e,r)=>{let n=new Map,i=qr({platform:G5},r),s=qr({},i.platform,{_c:n});return A5(t,e,qr({},i,{platform:s}))};function Y5(t){t.cleanup&&t.cleanup();let e=t._getResolvedAttachToOptions(),r=e.element,n=rB(e,t),i=pI(e);return i&&(r=document.body,t.shepherdElementComponent.getElement().classList.add("shepherd-centered")),t.cleanup=K5(r,t.el,()=>{if(!t.el){t.cleanup();return}Z5(r,t,n,i)}),t.target=e.element,n}function Q5(t,e){return{floatingUIOptions:Lg(t.floatingUIOptions||{},e.floatingUIOptions||{})}}function J5(t){t.cleanup&&t.cleanup(),t.cleanup=null}function Z5(t,e,r,n){return X5(t,e.el,r).then(eB(e,n)).then(i=>new Promise(s=>{setTimeout(()=>s(i),300)})).then(i=>{i&&i.el&&i.el.focus({preventScroll:!0})})}function eB(t,e){return({x:r,y:n,placement:i,middlewareData:s})=>(t.el&&(e?Object.assign(t.el.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}):Object.assign(t.el.style,{position:"absolute",left:`${r}px`,top:`${n}px`}),t.el.dataset.popperPlacement=i,tB(t.el,s)),t)}function tB(t,e){let r=t.querySelector(".shepherd-arrow");if(r&&e.arrow){let{x:n,y:i}=e.arrow;Object.assign(r.style,{left:n!=null?`${n}px`:"",top:i!=null?`${i}px`:""})}}function rB(t,e){let r={strategy:"absolute",middleware:[]},n=nB(e);return pI(t)||(r.middleware.push(C5(),k5({limiter:D5(),crossAxis:!0})),n&&r.middleware.push(S5({element:n})),r.placement=t.on),Lg(e.options.floatingUIOptions||{},r)}function nB(t){return t.options.arrow&&t.el?t.el.querySelector(".shepherd-arrow"):!1}function bn(){}function iB(t,e){for(let r in e)t[r]=e[r];return t}function II(t){return t()}function Qb(){return Object.create(null)}function Cu(t){t.forEach(II)}function Gg(t){return typeof t=="function"}function rs(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function sB(t){return Object.keys(t).length===0}function lc(t,e){t.appendChild(e)}function hi(t,e,r){t.insertBefore(e,r||null)}function qn(t){t.parentNode&&t.parentNode.removeChild(t)}function aB(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function Di(t){return document.createElement(t)}function Jb(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function AI(t){return document.createTextNode(t)}function sd(){return AI(" ")}function oB(){return AI("")}function hd(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function St(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}var cB=["width","height"];function Zb(t,e){let r=Object.getOwnPropertyDescriptors(t.__proto__);for(let n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:r[n]&&r[n].set&&cB.indexOf(n)===-1?t[n]=e[n]:St(t,n,e[n])}function lB(t){return Array.from(t.childNodes)}function ec(t,e,r){t.classList[r?"add":"remove"](e)}var Iu;function wu(t){Iu=t}function SI(){if(!Iu)throw new Error("Function called outside component initialization");return Iu}function uB(t){SI().$$.on_mount.push(t)}function qg(t){SI().$$.after_update.push(t)}var rc=[],uc=[],ic=[],eI=[],hB=Promise.resolve(),Ig=!1;function fB(){Ig||(Ig=!0,hB.then(CI))}function Ag(t){ic.push(t)}var Eg=new Set,tc=0;function CI(){if(tc!==0)return;let t=Iu;do{try{for(;tc<rc.length;){let e=rc[tc];tc++,wu(e),dB(e.$$)}}catch(e){throw rc.length=0,tc=0,e}for(wu(null),rc.length=0,tc=0;uc.length;)uc.pop()();for(let e=0;e<ic.length;e+=1){let r=ic[e];Eg.has(r)||(Eg.add(r),r())}ic.length=0}while(rc.length);for(;eI.length;)eI.pop()();Ig=!1,Eg.clear(),wu(t)}function dB(t){if(t.fragment!==null){t.update(),Cu(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ag)}}function pB(t){let e=[],r=[];ic.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),ic=e}var ed=new Set,Ma;function Va(){Ma={r:0,c:[],p:Ma}}function Ba(){Ma.r||Cu(Ma.c),Ma=Ma.p}function xt(t,e){t&&t.i&&(ed.delete(t),t.i(e))}function tr(t,e,r,n){if(t&&t.o){if(ed.has(t))return;ed.add(t),Ma.c.push(()=>{ed.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function mB(t,e){let r={},n={},i={$$scope:1},s=t.length;for(;s--;){let a=t[s],o=e[s];if(o){for(let c in a)c in o||(n[c]=1);for(let c in o)i[c]||(r[c]=o[c],i[c]=1);t[s]=o}else for(let c in a)i[c]=1}for(let a in n)a in r||(r[a]=void 0);return r}function $a(t){t&&t.c()}function Us(t,e,r,n){let{fragment:i,after_update:s}=t.$$;i&&i.m(e,r),n||Ag(()=>{let a=t.$$.on_mount.map(II).filter(Gg);t.$$.on_destroy?t.$$.on_destroy.push(...a):Cu(a),t.$$.on_mount=[]}),s.forEach(Ag)}function js(t,e){let r=t.$$;r.fragment!==null&&(pB(r.after_update),Cu(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function gB(t,e){t.$$.dirty[0]===-1&&(rc.push(t),fB(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ns(t,e,r,n,i,s,a,o=[-1]){let c=Iu;wu(t);let l=t.$$={fragment:null,ctx:[],props:s,update:bn,not_equal:i,bound:Qb(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Qb(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};a&&a(l.root);let h=!1;if(l.ctx=r?r(t,e.props||{},(f,d,...p)=>{let v=p.length?p[0]:d;return l.ctx&&i(l.ctx[f],l.ctx[f]=v)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](v),h&&gB(t,f)),d}):[],l.update(),h=!0,Cu(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){let f=lB(e.target);l.fragment&&l.fragment.l(f),f.forEach(qn)}else l.fragment&&l.fragment.c();e.intro&&xt(t.$$.fragment),Us(t,e.target,e.anchor,e.customElement),CI()}wu(c)}var ui=class{$destroy(){js(this,1),this.$destroy=bn}$on(e,r){if(!Gg(r))return bn;let n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{let i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!sB(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};function vB(t){let e,r,n,i,s;return{c(){e=Di("button"),St(e,"aria-label",r=t[3]?t[3]:null),St(e,"class",n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`),e.disabled=t[2],St(e,"tabindex","0")},m(a,o){hi(a,e,o),e.innerHTML=t[5],i||(s=hd(e,"click",function(){Gg(t[0])&&t[0].apply(this,arguments)}),i=!0)},p(a,[o]){t=a,o&32&&(e.innerHTML=t[5]),o&8&&r!==(r=t[3]?t[3]:null)&&St(e,"aria-label",r),o&18&&n!==(n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`)&&St(e,"class",n),o&4&&(e.disabled=t[2])},i:bn,o:bn,d(a){a&&qn(e),i=!1,s()}}}function _B(t,e,r){let{config:n,step:i}=e,s,a,o,c,l,h;function f(d){return Ua(d)?d=d.call(i):d}return t.$$set=d=>{"config"in d&&r(6,n=d.config),"step"in d&&r(7,i=d.step)},t.$$.update=()=>{t.$$.dirty&192&&(r(0,s=n.action?n.action.bind(i.tour):null),r(1,a=n.classes),r(2,o=n.disabled?f(n.disabled):!1),r(3,c=n.label?f(n.label):null),r(4,l=n.secondary),r(5,h=n.text?f(n.text):null))},[s,a,o,c,l,h,n,i]}var Sg=class extends ui{constructor(e){super(),ns(this,e,_B,vB,rs,{config:6,step:7})}};function tI(t,e,r){let n=t.slice();return n[2]=e[r],n}function rI(t){let e,r,n=t[1],i=[];for(let a=0;a<n.length;a+=1)i[a]=nI(tI(t,n,a));let s=a=>tr(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=oB()},m(a,o){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,o);hi(a,e,o),r=!0},p(a,o){if(o&3){n=a[1];let c;for(c=0;c<n.length;c+=1){let l=tI(a,n,c);i[c]?(i[c].p(l,o),xt(i[c],1)):(i[c]=nI(l),i[c].c(),xt(i[c],1),i[c].m(e.parentNode,e))}for(Va(),c=n.length;c<i.length;c+=1)s(c);Ba()}},i(a){if(!r){for(let o=0;o<n.length;o+=1)xt(i[o]);r=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)tr(i[o]);r=!1},d(a){aB(i,a),a&&qn(e)}}}function nI(t){let e,r;return e=new Sg({props:{config:t[2],step:t[0]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.config=n[2]),i&1&&(s.step=n[0]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function yB(t){let e,r,n=t[1]&&rI(t);return{c(){e=Di("footer"),n&&n.c(),St(e,"class","shepherd-footer")},m(i,s){hi(i,e,s),n&&n.m(e,null),r=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&xt(n,1)):(n=rI(i),n.c(),xt(n,1),n.m(e,null)):n&&(Va(),tr(n,1,1,()=>{n=null}),Ba())},i(i){r||(xt(n),r=!0)},o(i){tr(n),r=!1},d(i){i&&qn(e),n&&n.d()}}}function xB(t,e,r){let n,{step:i}=e;return t.$$set=s=>{"step"in s&&r(0,i=s.step)},t.$$.update=()=>{t.$$.dirty&1&&r(1,n=i.options.buttons)},[i,n]}var Cg=class extends ui{constructor(e){super(),ns(this,e,xB,yB,rs,{step:0})}};function wB(t){let e,r,n,i,s;return{c(){e=Di("button"),r=Di("span"),r.textContent="\xD7",St(r,"aria-hidden","true"),St(e,"aria-label",n=t[0].label?t[0].label:"Close Tour"),St(e,"class","shepherd-cancel-icon"),St(e,"type","button")},m(a,o){hi(a,e,o),lc(e,r),i||(s=hd(e,"click",t[1]),i=!0)},p(a,[o]){o&1&&n!==(n=a[0].label?a[0].label:"Close Tour")&&St(e,"aria-label",n)},i:bn,o:bn,d(a){a&&qn(e),i=!1,s()}}}function EB(t,e,r){let{cancelIcon:n,step:i}=e,s=a=>{a.preventDefault(),i.cancel()};return t.$$set=a=>{"cancelIcon"in a&&r(0,n=a.cancelIcon),"step"in a&&r(2,i=a.step)},[n,s,i]}var kg=class extends ui{constructor(e){super(),ns(this,e,EB,wB,rs,{cancelIcon:0,step:2})}};function TB(t){let e;return{c(){e=Di("h3"),St(e,"id",t[1]),St(e,"class","shepherd-title")},m(r,n){hi(r,e,n),t[3](e)},p(r,[n]){n&2&&St(e,"id",r[1])},i:bn,o:bn,d(r){r&&qn(e),t[3](null)}}}function bB(t,e,r){let{labelId:n,element:i,title:s}=e;qg(()=>{Ua(s)&&r(2,s=s()),r(0,i.innerHTML=s,i)});function a(o){uc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"labelId"in o&&r(1,n=o.labelId),"element"in o&&r(0,i=o.element),"title"in o&&r(2,s=o.title)},[i,n,s,a]}var Dg=class extends ui{constructor(e){super(),ns(this,e,bB,TB,rs,{labelId:1,element:0,title:2})}};function iI(t){let e,r;return e=new Dg({props:{labelId:t[0],title:t[2]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.labelId=n[0]),i&4&&(s.title=n[2]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function sI(t){let e,r;return e=new kg({props:{cancelIcon:t[3],step:t[1]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&8&&(s.cancelIcon=n[3]),i&2&&(s.step=n[1]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function IB(t){let e,r,n,i=t[2]&&iI(t),s=t[3]&&t[3].enabled&&sI(t);return{c(){e=Di("header"),i&&i.c(),r=sd(),s&&s.c(),St(e,"class","shepherd-header")},m(a,o){hi(a,e,o),i&&i.m(e,null),lc(e,r),s&&s.m(e,null),n=!0},p(a,[o]){a[2]?i?(i.p(a,o),o&4&&xt(i,1)):(i=iI(a),i.c(),xt(i,1),i.m(e,r)):i&&(Va(),tr(i,1,1,()=>{i=null}),Ba()),a[3]&&a[3].enabled?s?(s.p(a,o),o&8&&xt(s,1)):(s=sI(a),s.c(),xt(s,1),s.m(e,null)):s&&(Va(),tr(s,1,1,()=>{s=null}),Ba())},i(a){n||(xt(i),xt(s),n=!0)},o(a){tr(i),tr(s),n=!1},d(a){a&&qn(e),i&&i.d(),s&&s.d()}}}function AB(t,e,r){let{labelId:n,step:i}=e,s,a;return t.$$set=o=>{"labelId"in o&&r(0,n=o.labelId),"step"in o&&r(1,i=o.step)},t.$$.update=()=>{t.$$.dirty&2&&(r(2,s=i.options.title),r(3,a=i.options.cancelIcon))},[n,i,s,a]}var Rg=class extends ui{constructor(e){super(),ns(this,e,AB,IB,rs,{labelId:0,step:1})}};function SB(t){let e;return{c(){e=Di("div"),St(e,"class","shepherd-text"),St(e,"id",t[1])},m(r,n){hi(r,e,n),t[3](e)},p(r,[n]){n&2&&St(e,"id",r[1])},i:bn,o:bn,d(r){r&&qn(e),t[3](null)}}}function CB(t,e,r){let{descriptionId:n,element:i,step:s}=e;qg(()=>{let{text:o}=s.options;Ua(o)&&(o=o.call(s)),Vg(o)?i.appendChild(o):r(0,i.innerHTML=o,i)});function a(o){uc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"descriptionId"in o&&r(1,n=o.descriptionId),"element"in o&&r(0,i=o.element),"step"in o&&r(2,s=o.step)},[i,n,s,a]}var Pg=class extends ui{constructor(e){super(),ns(this,e,CB,SB,rs,{descriptionId:1,element:0,step:2})}};function aI(t){let e,r;return e=new Rg({props:{labelId:t[1],step:t[2]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.labelId=n[1]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function oI(t){let e,r;return e=new Pg({props:{descriptionId:t[0],step:t[2]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.descriptionId=n[0]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function cI(t){let e,r;return e=new Cg({props:{step:t[2]}}),{c(){$a(e.$$.fragment)},m(n,i){Us(e,n,i),r=!0},p(n,i){let s={};i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(xt(e.$$.fragment,n),r=!0)},o(n){tr(e.$$.fragment,n),r=!1},d(n){js(e,n)}}}function kB(t){let e,r=!Gr(t[2].options.title)||t[2].options.cancelIcon&&t[2].options.cancelIcon.enabled,n,i=!Gr(t[2].options.text),s,a=Array.isArray(t[2].options.buttons)&&t[2].options.buttons.length,o,c=r&&aI(t),l=i&&oI(t),h=a&&cI(t);return{c(){e=Di("div"),c&&c.c(),n=sd(),l&&l.c(),s=sd(),h&&h.c(),St(e,"class","shepherd-content")},m(f,d){hi(f,e,d),c&&c.m(e,null),lc(e,n),l&&l.m(e,null),lc(e,s),h&&h.m(e,null),o=!0},p(f,[d]){d&4&&(r=!Gr(f[2].options.title)||f[2].options.cancelIcon&&f[2].options.cancelIcon.enabled),r?c?(c.p(f,d),d&4&&xt(c,1)):(c=aI(f),c.c(),xt(c,1),c.m(e,n)):c&&(Va(),tr(c,1,1,()=>{c=null}),Ba()),d&4&&(i=!Gr(f[2].options.text)),i?l?(l.p(f,d),d&4&&xt(l,1)):(l=oI(f),l.c(),xt(l,1),l.m(e,s)):l&&(Va(),tr(l,1,1,()=>{l=null}),Ba()),d&4&&(a=Array.isArray(f[2].options.buttons)&&f[2].options.buttons.length),a?h?(h.p(f,d),d&4&&xt(h,1)):(h=cI(f),h.c(),xt(h,1),h.m(e,null)):h&&(Va(),tr(h,1,1,()=>{h=null}),Ba())},i(f){o||(xt(c),xt(l),xt(h),o=!0)},o(f){tr(c),tr(l),tr(h),o=!1},d(f){f&&qn(e),c&&c.d(),l&&l.d(),h&&h.d()}}}function DB(t,e,r){let{descriptionId:n,labelId:i,step:s}=e;return t.$$set=a=>{"descriptionId"in a&&r(0,n=a.descriptionId),"labelId"in a&&r(1,i=a.labelId),"step"in a&&r(2,s=a.step)},[n,i,s]}var Fg=class extends ui{constructor(e){super(),ns(this,e,DB,kB,rs,{descriptionId:0,labelId:1,step:2})}};function lI(t){let e;return{c(){e=Di("div"),St(e,"class","shepherd-arrow"),St(e,"data-popper-arrow","")},m(r,n){hi(r,e,n)},d(r){r&&qn(e)}}}function RB(t){let e,r,n,i,s,a,o,c,l=t[4].options.arrow&&t[4].options.attachTo&&t[4].options.attachTo.element&&t[4].options.attachTo.on&&lI();n=new Fg({props:{descriptionId:t[2],labelId:t[3],step:t[4]}});let h=[{"aria-describedby":i=Gr(t[4].options.text)?null:t[2]},{"aria-labelledby":s=t[4].options.title?t[3]:null},t[1],{role:"dialog"},{tabindex:"0"}],f={};for(let d=0;d<h.length;d+=1)f=iB(f,h[d]);return{c(){e=Di("div"),l&&l.c(),r=sd(),$a(n.$$.fragment),Zb(e,f),ec(e,"shepherd-has-cancel-icon",t[5]),ec(e,"shepherd-has-title",t[6]),ec(e,"shepherd-element",!0)},m(d,p){hi(d,e,p),l&&l.m(e,null),lc(e,r),Us(n,e,null),t[13](e),a=!0,o||(c=hd(e,"keydown",t[7]),o=!0)},p(d,[p]){d[4].options.arrow&&d[4].options.attachTo&&d[4].options.attachTo.element&&d[4].options.attachTo.on?l||(l=lI(),l.c(),l.m(e,r)):l&&(l.d(1),l=null);let v={};p&4&&(v.descriptionId=d[2]),p&8&&(v.labelId=d[3]),p&16&&(v.step=d[4]),n.$set(v),Zb(e,f=mB(h,[(!a||p&20&&i!==(i=Gr(d[4].options.text)?null:d[2]))&&{"aria-describedby":i},(!a||p&24&&s!==(s=d[4].options.title?d[3]:null))&&{"aria-labelledby":s},p&2&&d[1],{role:"dialog"},{tabindex:"0"}])),ec(e,"shepherd-has-cancel-icon",d[5]),ec(e,"shepherd-has-title",d[6]),ec(e,"shepherd-element",!0)},i(d){a||(xt(n.$$.fragment,d),a=!0)},o(d){tr(n.$$.fragment,d),a=!1},d(d){d&&qn(e),l&&l.d(),js(n),t[13](null),o=!1,c()}}}var PB=9,FB=27,OB=37,NB=39;function uI(t){return t.split(" ").filter(e=>!!e.length)}function MB(t,e,r){let{classPrefix:n,element:i,descriptionId:s,firstFocusableElement:a,focusableElements:o,labelId:c,lastFocusableElement:l,step:h,dataStepId:f}=e,d,p,v,m=()=>i;uB(()=>{r(1,f={[`data-${n}shepherd-step-id`]:h.id}),r(9,o=i.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),r(8,a=o[0]),r(10,l=o[o.length-1])}),qg(()=>{v!==h.options.classes&&_()});function _(){T(v),v=h.options.classes,A(v)}function T(B){if(Tu(B)){let M=uI(B);M.length&&i.classList.remove(...M)}}function A(B){if(Tu(B)){let M=uI(B);M.length&&i.classList.add(...M)}}let b=B=>{let{tour:M}=h;switch(B.keyCode){case PB:if(o.length===0){B.preventDefault();break}B.shiftKey?(document.activeElement===a||document.activeElement.classList.contains("shepherd-element"))&&(B.preventDefault(),l.focus()):document.activeElement===l&&(B.preventDefault(),a.focus());break;case FB:M.options.exitOnEsc&&(B.stopPropagation(),h.cancel());break;case OB:M.options.keyboardNavigation&&(B.stopPropagation(),M.back());break;case NB:M.options.keyboardNavigation&&(B.stopPropagation(),M.next());break}};function N(B){uc[B?"unshift":"push"](()=>{i=B,r(0,i)})}return t.$$set=B=>{"classPrefix"in B&&r(11,n=B.classPrefix),"element"in B&&r(0,i=B.element),"descriptionId"in B&&r(2,s=B.descriptionId),"firstFocusableElement"in B&&r(8,a=B.firstFocusableElement),"focusableElements"in B&&r(9,o=B.focusableElements),"labelId"in B&&r(3,c=B.labelId),"lastFocusableElement"in B&&r(10,l=B.lastFocusableElement),"step"in B&&r(4,h=B.step),"dataStepId"in B&&r(1,f=B.dataStepId)},t.$$.update=()=>{t.$$.dirty&16&&(r(5,d=h.options&&h.options.cancelIcon&&h.options.cancelIcon.enabled),r(6,p=h.options&&h.options.title))},[i,f,s,c,h,d,p,b,a,o,l,n,m,N]}var Og=class extends ui{constructor(e){super(),ns(this,e,MB,RB,rs,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}},Au=class extends bu{constructor(e,r={}){return super(e,r),this.tour=e,this.classPrefix=this.tour.options?dI(this.tour.options.classPrefix):"",this.styles=e.styles,this._resolvedAttachTo=null,fI(this),this._setOptions(r),this}cancel(){this.tour.cancel(),this.trigger("cancel")}complete(){this.tour.complete(),this.trigger("complete")}destroy(){J5(this),Vg(this.el)&&(this.el.remove(),this.el=null),this._updateStepTargetOnHide(),this.trigger("destroy")}getTour(){return this.tour}hide(){this.tour.modal.hide(),this.trigger("before-hide"),this.el&&(this.el.hidden=!0),this._updateStepTargetOnHide(),this.trigger("hide")}_resolveAttachToOptions(){return this._resolvedAttachTo=g5(this),this._resolvedAttachTo}_getResolvedAttachToOptions(){return this._resolvedAttachTo===null?this._resolveAttachToOptions():this._resolvedAttachTo}isOpen(){return!!(this.el&&!this.el.hidden)}show(){return Ua(this.options.beforeShowPromise)?Promise.resolve(this.options.beforeShowPromise()).then(()=>this._show()):Promise.resolve(this._show())}updateStepOptions(e){Object.assign(this.options,e),this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){let e=`${this.id}-description`,r=`${this.id}-label`;return this.shepherdElementComponent=new Og({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:e,labelId:r,step:this,styles:this.styles}}),this.shepherdElementComponent.getElement()}_scrollTo(e){let{element:r}=this._getResolvedAttachToOptions();Ua(this.options.scrollToHandler)?this.options.scrollToHandler(r):d5(r)&&typeof r.scrollIntoView=="function"&&r.scrollIntoView(e)}_getClassOptions(e){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions,n=e.classes?e.classes:"",i=r&&r.classes?r.classes:"",s=[...n.split(" "),...i.split(" ")],a=new Set(s);return Array.from(a).join(" ").trim()}_setOptions(e={}){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;r=Lg({},r||{}),this.options=Object.assign({arrow:!0},r,e,Q5(r,e));let{when:n}=this.options;this.options.classes=this._getClassOptions(e),this.destroy(),this.id=this.options.id||`step-${Bg()}`,n&&Object.keys(n).forEach(i=>{this.on(i,n[i],this)})}_setupElements(){Gr(this.el)||this.destroy(),this.el=this._createTooltipContent(),this.options.advanceOn&&m5(this),Y5(this)}_show(){this.trigger("before-show"),this._resolveAttachToOptions(),this._setupElements(),this.tour.modal||this.tour._setupModal(),this.tour.modal.setupForStep(this),this._styleTargetElementForStep(this),this.el.hidden=!1,this.options.scrollTo&&setTimeout(()=>{this._scrollTo(this.options.scrollTo)}),this.el.hidden=!1;let e=this.shepherdElementComponent.getElement(),r=this.target||document.body;r.classList.add(`${this.classPrefix}shepherd-enabled`),r.classList.add(`${this.classPrefix}shepherd-target`),e.classList.add("shepherd-enabled"),this.trigger("show")}_styleTargetElementForStep(e){let r=e.target;r&&(e.options.highlightClass&&r.classList.add(e.options.highlightClass),r.classList.remove("shepherd-target-click-disabled"),e.options.canClickTarget===!1&&r.classList.add("shepherd-target-click-disabled"))}_updateStepTargetOnHide(){let e=this.target||document.body;this.options.highlightClass&&e.classList.remove(this.options.highlightClass),e.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}};function LB(t){if(t){let{steps:e}=t;e.forEach(r=>{r.options&&r.options.canClickTarget===!1&&r.options.attachTo&&r.target instanceof HTMLElement&&r.target.classList.remove("shepherd-target-click-disabled")})}}function VB({width:t,height:e,x:r=0,y:n=0,r:i=0}){let{innerWidth:s,innerHeight:a}=window,{topLeft:o=0,topRight:c=0,bottomRight:l=0,bottomLeft:h=0}=typeof i=="number"?{topLeft:i,topRight:i,bottomRight:i,bottomLeft:i}:i;return`M${s},${a}H0V0H${s}V${a}ZM${r+o},${n}a${o},${o},0,0,0-${o},${o}V${e+n-h}a${h},${h},0,0,0,${h},${h}H${t+r-l}a${l},${l},0,0,0,${l}-${l}V${n+c}a${c},${c},0,0,0-${c}-${c}Z`}function BB(t){let e,r,n,i,s;return{c(){e=Jb("svg"),r=Jb("path"),St(r,"d",t[2]),St(e,"class",n=`${t[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)},m(a,o){hi(a,e,o),lc(e,r),t[11](e),i||(s=hd(e,"touchmove",t[3]),i=!0)},p(a,[o]){o&4&&St(r,"d",a[2]),o&2&&n!==(n=`${a[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)&&St(e,"class",n)},i:bn,o:bn,d(a){a&&qn(e),t[11](null),i=!1,s()}}}function kI(t){if(!t)return null;let r=t instanceof HTMLElement&&window.getComputedStyle(t).overflowY;return r!=="hidden"&&r!=="visible"&&t.scrollHeight>=t.clientHeight?t:kI(t.parentElement)}function UB(t,e){let r=t.getBoundingClientRect(),n=r.y||r.top,i=r.bottom||n+r.height;if(e){let a=e.getBoundingClientRect(),o=a.y||a.top,c=a.bottom||o+a.height;n=Math.max(n,o),i=Math.min(i,c)}let s=Math.max(i-n,0);return{y:n,height:s}}function jB(t,e,r){let{element:n,openingProperties:i}=e;Bg();let s=!1,a,o;l();let c=()=>n;function l(){r(4,i={width:0,height:0,x:0,y:0,r:0})}function h(){r(1,s=!1),T()}function f(N=0,B=0,M,x){if(x){let{y:w,height:E}=UB(x,M),{x:C,width:D,left:S}=x.getBoundingClientRect();r(4,i={width:D+N*2,height:E+N*2,x:(C||S)-N,y:w-N,r:B})}else l()}function d(N){T(),N.tour.options.useModalOverlay?(A(N),p()):h()}function p(){r(1,s=!0)}let v=N=>{N.preventDefault()},m=N=>{N.stopPropagation()};function _(){window.addEventListener("touchmove",v,{passive:!1})}function T(){a&&(cancelAnimationFrame(a),a=void 0),window.removeEventListener("touchmove",v,{passive:!1})}function A(N){let{modalOverlayOpeningPadding:B,modalOverlayOpeningRadius:M}=N.options,x=kI(N.target),w=()=>{a=void 0,f(B,M,x,N.target),a=requestAnimationFrame(w)};w(),_()}function b(N){uc[N?"unshift":"push"](()=>{n=N,r(0,n)})}return t.$$set=N=>{"element"in N&&r(0,n=N.element),"openingProperties"in N&&r(4,i=N.openingProperties)},t.$$.update=()=>{t.$$.dirty&16&&r(2,o=VB(i))},[n,s,o,m,i,c,l,h,f,d,p,b]}var Ng=class extends ui{constructor(e){super(),ns(this,e,jB,BB,rs,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModal:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModal(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}},Ls=new bu,Mg=class extends bu{constructor(e={}){super(e),fI(this);let r={exitOnEsc:!0,keyboardNavigation:!0};return this.options=Object.assign({},r,e),this.classPrefix=dI(this.options.classPrefix),this.steps=[],this.addSteps(this.options.steps),["active","cancel","complete","inactive","show","start"].map(i=>{(s=>{this.on(s,a=>{a=a||{},a.tour=this,Ls.trigger(s,a)})})(i)}),this._setTourID(),this}addStep(e,r){let n=e;return n instanceof Au?n.tour=this:n=new Au(this,n),Gr(r)?this.steps.push(n):this.steps.splice(r,0,n),n}addSteps(e){return Array.isArray(e)&&e.forEach(r=>{this.addStep(r)}),this}back(){let e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}cancel(){return Z(this,null,function*(){if(this.options.confirmCancel){let e=typeof this.options.confirmCancel=="function",r=this.options.confirmCancelMessage||"Are you sure you want to stop the tour?";(e?yield this.options.confirmCancel():window.confirm(r))&&this._done("cancel")}else this._done("cancel")})}complete(){this._done("complete")}getById(e){return this.steps.find(r=>r.id===e)}getCurrentStep(){return this.currentStep}hide(){let e=this.getCurrentStep();if(e)return e.hide()}isActive(){return Ls.activeTour===this}next(){let e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?this.complete():this.show(e+1,!0)}removeStep(e){let r=this.getCurrentStep();this.steps.some((n,i)=>{if(n.id===e)return n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1),!0}),r&&r.id===e&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(e=0,r=!0){let n=Tu(e)?this.getById(e):this.steps[e];n&&(this._updateStateBeforeShow(),Ua(n.options.showOn)&&!n.options.showOn()?this._skipStep(n,r):(this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show()))}start(){this.trigger("start"),this.focusedElBeforeOpen=document.activeElement,this.currentStep=null,this._setupModal(),this._setupActiveTour(),this.next()}_done(e){let r=this.steps.indexOf(this.currentStep);if(Array.isArray(this.steps)&&this.steps.forEach(n=>n.destroy()),LB(this),this.trigger(e,{index:r}),Ls.activeTour=null,this.trigger("inactive",{tour:this}),this.modal&&this.modal.hide(),(e==="cancel"||e==="complete")&&this.modal){let n=document.querySelector(".shepherd-modal-overlay-container");n&&n.remove()}Vg(this.focusedElBeforeOpen)&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this}),Ls.activeTour=this}_setupModal(){this.modal=new Ng({target:this.options.modalContainer||document.body,props:{classPrefix:this.classPrefix,styles:this.styles}})}_skipStep(e,r){let n=this.steps.indexOf(e);if(n===this.steps.length-1)this.complete();else{let i=r?n+1:n-1;this.show(i,r)}}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide(),this.isActive()||this._setupActiveTour()}_setTourID(){let e=this.options.tourName||"tour";this.id=`${e}--${Bg()}`}},WB=typeof window>"u",ad=class{constructor(){}};WB?Object.assign(Ls,{Tour:ad,Step:ad}):Object.assign(Ls,{Tour:Mg,Step:Au});function $B(t){return t.offsetWidth===0&&t.offsetHeight===0}function HB(t){let{classes:e,disabled:r,label:n,secondary:i,type:s,text:a}=t,o=["back","cancel","next"];if(!s)return t;if(o.indexOf(s)===-1)throw new Error("'type' property must be one of 'back', 'cancel', or 'next'");return{action:this[s].bind(this),classes:e,disabled:r,label:n,secondary:i,text:a}}var DI=(()=>{let e=class e{constructor(){this.confirmCancel=!1,this.confirmCancelMessage=null,this.defaultStepOptions={},this.errorTitle=null,this.isActive=!1,this.keyboardNavigation=!0,this.messageForUser=null,this.modal=!1,this.requiredElements=[],this.tourName=void 0,this.tourObject=null,this.exitOnEsc=!0}back(){this.tourObject.back()}cancel(){this.tourObject.cancel()}complete(){this.tourObject.complete()}hide(){this.tourObject.hide()}next(){this.tourObject.next()}show(n){this.tourObject.show(n)}start(){this.isActive=!0,this.tourObject.start()}onTourFinish(n){this.isActive=!1}addSteps(n){this._initialize();let i=this.tourObject;if(!(!n||!Array.isArray(n)||n.length===0)){if(!this.requiredElementsPresent()){i.addStep({buttons:[{text:"Exit",action:i.cancel}],id:"error",title:this.errorTitle,text:[this.messageForUser]});return}n.forEach(s=>{s.buttons&&(s.buttons=s.buttons.map(HB.bind(this),this)),i.addStep(s)})}}requiredElementsPresent(){let n=!0;return this.requiredElements.forEach(i=>{let s=document.querySelector(i.selector);n&&(!s||$B(s))&&(n=!1,this.errorTitle=i.title,this.messageForUser=i.message)}),n}_initialize(){let n=new Ls.Tour({confirmCancel:this.confirmCancel,confirmCancelMessage:this.confirmCancelMessage,defaultStepOptions:this.defaultStepOptions,keyboardNavigation:this.keyboardNavigation,tourName:this.tourName,useModalOverlay:this.modal,exitOnEsc:this.exitOnEsc});n.on("complete",this.onTourFinish.bind(this,"complete")),n.on("cancel",this.onTourFinish.bind(this,"cancel")),this.tourObject=n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Fe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function GB(t,e){if(t&1&&(ae(0,"li",36),ke(1),le()),t&2){let r=e.$implicit;Je(),rl(" ",r," ")}}function qB(t,e){if(t&1&&(ae(0,"div",31)(1,"div",32)(2,"div",33),ke(3),le()(),ae(4,"ul",34),On(5,GB,2,1,"li",35),le()()),t&2){let r=e.$implicit,n=e.index;Je(3),vy("",n+1,". ",r.pregunta,""),Je(2),ur("ngForOf",r.respuesta)}}function KB(t,e){if(t&1){let r=_i();ae(0,"app-header",37),ut("guardarHeader",function(i){Zn(r);let s=vr();return ei(s.actualizarHeader(i))})("cerrarModal",function(){Zn(r);let i=vr();return ei(i.mostrarModal=!1)}),le()}}function XB(t,e){if(t&1){let r=_i();ae(0,"div",38)(1,"label",39),ke(2,"Cantidad de preguntas por evaluaci\xF3n:"),le(),ae(3,"input",18),gn("ngModelChange",function(i){Zn(r);let s=vr();return mn(s.preguntasPorExamen,i)||(s.preguntasPorExamen=i),ei(i)}),le()()}if(t&2){let r=vr();Je(3),pn("ngModel",r.preguntasPorExamen)}}function YB(t,e){if(t&1){let r=_i();ae(0,"div")(1,"label",40),ke(2,"Puntaje total por examen:"),le(),ae(3,"input",41),gn("ngModelChange",function(i){Zn(r);let s=vr();return mn(s.puntajeTotal,i)||(s.puntajeTotal=i),ei(i)}),le()()}if(t&2){let r=vr();Je(3),pn("ngModel",r.puntajeTotal)}}function QB(t,e){t&1&&Ye(0,"i",42)}function JB(t,e){t&1&&Ye(0,"div",43)}function ZB(t,e){t&1&&Ye(0,"app-loading-print",44)}var RI=(()=>{let e=class e{constructor(n,i,s,a,o){this.fb=n,this.http=i,this.examService=s,this.headerDataService=a,this.shepherdService=o,this.toastService=Ce(Zo),this.mapeoDificultad={facil:"F\xE1cil",f\u00E1cil:"F\xE1cil",media:"Media",dificil:"Dif\xEDcil",dif\u00EDcil:"Dif\xEDcil"},this.toast={message:"",type:"",active:!1},this.tutorialSeen=localStorage.getItem("tutorialSeen"),this.information=localStorage.getItem("information"),this.preguntasList=[],this.dificultad=1,this.preguntasPorExamen=1,this.cantidadExamenes=1,this.puntajeTotal=0,this.criterioSeleccionado="questionsPerExam",this.cargandoPDF=!1,this.mostrarModal=!1,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[],this.loading=!1;let c=`
    Qu\xE9 gusto tiene la sal?
    Salada
    Amarga
    Dulce
    
    Cu\xE1ntos a\xF1os tiene Mirtha Legrand?
    98
    95
    97
`,l=navigator.userAgent;this.isMobile=/Mobi|Android|iPhone|iPad|iPod/.test(l),this.isMobile&&this.toastService.showToast({type:"info",message:"Record\xE1 que la descarga del PDF no est\xE1 disponible en dispositivos m\xF3viles.",active:!0}),this.questionForm=this.fb.group({preguntasTextarea:[c,[Dl.required]]})}ngAfterViewInit(){this.shepherdService.defaultStepOptions={cancelIcon:{enabled:!0},scrollTo:{behavior:"smooth",block:"center"},when:{show:function(){if(this.id!="firstStep"){let i=this.getElement()?.querySelector(".shepherd-footer");i?.classList.remove("single-button","multiple-buttons"),i?.classList.add("multiple-buttons")}}}},this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps([{id:"firstStep",text:"Gracias por elegir nuestra aplicaci\xF3n. Te voy a guiar en un recorrido breve para que puedas aprovechar todas sus funcionalidades.",modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Siguiente",action(){return this.next()}}]},{text:"Ac\xE1 pod\xE9s modificar el membrete de la evaluaci\xF3n. Hac\xE9 clic para abrir el popup.",attachTo:{element:"#buttonModal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.next()},1))}]},{text:`
        Estos son los campos que pod\xE9s modificar en el membrete. Todos son opcionales, y si no se completan, se mostrar\xE1n autom\xE1ticamente la fecha, el puntaje total y el nombre del examen.
        <br><br>
        <strong>Instituci\xF3n:</strong> Ingres\xE1 el nombre de la instituci\xF3n.
        <br><br>
        <strong>Logos de la instituci\xF3n:</strong> Pod\xE9s agregar uno o varios logos de la instituci\xF3n.
        <br><br>
        <strong>Examen:</strong> Indic\xE1 el nombre del examen.
        <br><br>
        <strong>Fecha:</strong> Seleccion\xE1 la fecha del examen.
        <br><br>
        <strong>Duraci\xF3n:</strong> Indic\xE1 la duraci\xF3n del examen.
        <br><br>
        <strong>Profesor:</strong> Ingres\xE1 el nombre del profesor.
        <br><br>
        <strong>C\xE1tedra:</strong> Indic\xE1 el nombre de la c\xE1tedra o materia.
        <br><br>
        <strong>DNI Alumno:</strong> Si seleccionas esta opci\xF3n, se incluir\xE1 el campo DNI en el membrete.
        <br><br>
        <strong>Puntos:</strong> Si seleccionas esta opci\xF3n, se mostrar\xE1n los puntos asignados a cada pregunta, calculados autom\xE1ticamente como 100 dividido por la cantidad de preguntas.
        `,attachTo:{element:"#modal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!1,this.shepherdService.back())},{text:"Siguiente",action:()=>(this.mostrarModal=!1,this.shepherdService.next())}]},{text:`
        Ac\xE1 se ingresan las preguntas.
        <br><br>
        El formato a seguir es:
        <br><br>
        <strong>Pregunta:</strong>
        <br>
        <strong>Opciones de respuesta</strong> <span class="text-sm text-gray-500">(opcional)</span>
        <br>
        <strong>Presionar la tecla Enter</strong> para agregar la siguiente pregunta.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        - Si no se agregan opciones de respuesta, solo se mostrar\xE1 la pregunta.
        <br>
        - Record\xE1 presionar Enter despu\xE9s de ingresar cada pregunta para a\xF1adir la siguiente.
        `,attachTo:{element:"#preguntasTextarea",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.back()},1))},{text:"Siguiente",action(){return this.next()}}]},{text:"Una vez que hayas ingresado todas las preguntas, hac\xE9 clic en este bot\xF3n para guardarlas.",attachTo:{element:"#guardarPreguntas",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Aqu\xED es donde ingres\xE1s las cantidades deseadas. 
        Si no se completan estos campos, no se podr\xE1 generar el PDF.
        <br><br>
        <strong>Cantidad de evaluaciones:</strong> Indica cu\xE1ntas evaluaciones quer\xE9s generar.
        <br><br>
        <strong>Cantidad de preguntas por evaluaci\xF3n:</strong> Define cu\xE1ntas preguntas tendr\xE1 cada evaluaci\xF3n.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        La cantidad de preguntas no puede superar el total de preguntas ingresadas.
        `,attachTo:{element:"#cantidades",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Estos son los tres botones m\xE1s importantes de la aplicaci\xF3n:
        <br><br>
        <strong class="text-green-600">Verde:</strong> Descarga un Excel con las preguntas de la evaluaci\xF3n.
        <br><br>
        <strong class="text-yellow-600">Amarillo:</strong> Permite cargar el Excel que descargaste, evitando que tengas que volver a escribir las preguntas.
        <br><br>
        <strong class="text-red-600">Rojo:</strong> Genera el PDF con los ex\xE1menes.
        `,attachTo:{element:"#botones",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:"En esta secci\xF3n se mostrar\xE1n todas las preguntas que hayas agregado.",attachTo:{element:"#listadoPreguntas",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        \xA1Mucho \xE9xito! Si ten\xE9s alguna duda o sugerencia, no dudes en <a href="#contacto" class="text-blue-600 hover:text-blue-800 underline">contactarnos</a>. 
        Estamos para ayudarte en lo que necesites.
      `,modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Finalizar",action(){return this.next()}}]}]),!this.tutorialSeen&&!this.isMobile&&(this.shepherdService.start(),localStorage.setItem("tutorialSeen","true")),!this.isMobile&&!this.information&&this.tutorialSeen&&(this.shepherdService.addSteps([{id:"firstStep",text:`
      <p>
        Queremos informarles que hemos decidido <strong>eliminar tanto el puntaje como la dificultad</strong> de las preguntas, ya que por el momento no planeamos utilizarlos. 
      </p>
      <br>
      <p>
        Sin embargo, <em>no se preocupen</em>, los archivos Excel que contengan esta informaci\xF3n <strong>pueden seguir utiliz\xE1ndose sin ning\xFAn problema</strong>, aunque ya no es necesario incluir esos datos.
      </p>
      <br>
      <p>
        \xA1<strong>Muchas gracias</strong> por su comprensi\xF3n y colaboraci\xF3n!
      </p>
`,modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[li({mainAxis:30,crossAxis:40})]},attachTo:{element:"#preguntasTextarea",on:"right"},buttons:[{text:"Finalizar",action(){return this.next()}}]}]),this.shepherdService.start(),localStorage.setItem("information","true"))}actualizarHeader(n){this.institucion=n.institucion,this.examen=n.examen,this.fecha=n.fecha,this.duracion=n.duracion,this.profesor=n.profesor,this.catedra=n.catedra,this.logoFiles=n.logoFile,this.dniChecked=n.dniChecked,this.puntosChecked=n.puntosChecked,this.mostrarModal=!1}formatDate(n){return new Intl.DateTimeFormat("es-ES",{day:"numeric",month:"long",year:"numeric"}).format(n)}updateDificultad(n){return this.dificultad=n.target.value,this.dificultad.toString()}createRespuesta(){return this.fb.group({respuesta:["",Dl.required]})}addRespuesta(){this.questionForm.get("respuestas").push(this.createRespuesta())}deleteRespuesta(n){this.questionForm.get("respuestas").removeAt(n)}normalizarDificultad(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}verificarDificultad(n,i){return this.normalizarDificultad(n.dificultad)===i}convertToExcelData(){let n=[];return this.preguntasList.forEach(i=>{let s={Pregunta:i.pregunta,Respuestas:i.respuesta.join(", ")};n.push(s)}),n}downloadExcel(){let n=this.convertToExcelData(),i=xu.json_to_sheet(n),s=xu.book_new();xu.book_append_sheet(s,i,"Preguntas"),Ob(s,"preguntasList.xlsx")}onFileChange(n){let i=n.target.files[0];i&&this.loadExcelFile(i)}loadExcelFile(n){let i=new FileReader;i.onload=s=>{this.preguntasList=[];let a=s.target?.result;if(a){let o=Bf(a,{type:"binary"}),c=o.SheetNames[0],l=o.Sheets[c],h=xu.sheet_to_json(l);this.preguntasList=h.map(f=>({pregunta:f.Pregunta,respuesta:f.Respuestas.split(", ").map(d=>d.trim())}))}},i.readAsBinaryString(n)}generarPDF(){return Z(this,null,function*(){if(this.isMobile){this.toastService.showToast({type:"error",message:"La descarga de evaluaciones no est\xE1 disponible en dispositivos m\xF3viles. Por favor, utilice una computadora.",active:!0});return}this.loading=!0,this.cargandoPDF=!0;let n=this.cantidadExamenes,i=this.preguntasPorExamen,s=this.puntajeTotal,a=this.preguntasList,o=this.examService.generateExams(n,i,s,a),c=document.createElement("div");c.id="printDiv";for(let d=0;d<o.length;d++){let p=o[d],v=document.createElement("div"),m=yield this.http.get("assets/reporteExamen.html",{responseType:"text"}).toPromise();v.innerHTML=m;let _=document.createElement("div"),T=document.createElement("div");if(T.classList.add("header-info","text-right"),this.logoFiles?.length>0&&(T.style.borderTop="2px solid #ccc",T.style.marginTop="20px",_.classList.add("header-img"),Array.from(this.logoFiles).forEach(M=>{this.convertFileToBase64(M).subscribe(x=>{let w=document.createElement("img");w.src=x,w.width=100,w.height=100,_.appendChild(w)})})),this.institucion){let M=document.createElement("h1");M.textContent=`${this.institucion}`,M.classList.add("text-xl","font-bold"),T.appendChild(M)}if(this.examen){let M=document.createElement("h2");M.textContent=`${this.examen??""}`,T.appendChild(M)}let A=document.createElement("p"),b=this.fecha!==""?new Date(this.fecha):new Date;if(this.duracion?A.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(b)} | <strong>Duraci\xF3n:</strong> ${this.duracion??""} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`:A.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(b)} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`,T.appendChild(A),this.profesor){let M=document.createElement("p");M.innerHTML=`<strong>Profesor:</strong> ${this.profesor??""} | <strong>C\xE1tedra:</strong> ${this.catedra??""}`,T.appendChild(M)}let N=document.createElement("p");this.dniChecked?N.innerHTML='<strong>Nombre:</strong> <span style="margin-left: 240px;"></span>| <strong>DNI:</strong>':N.innerHTML="<strong>Nombre:</strong>",T.appendChild(N),v.insertBefore(T,v.firstChild),v.insertBefore(_,v.firstChild);let B=v.querySelector("#preguntasContainer");B&&(B.innerHTML="",d>0&&(v.style.pageBreakBefore="always"),p.forEach((M,x)=>{let w=document.createElement("div");w.classList.add("mb-6");let E=document.createElement("div");E.classList.add("text-lg","font-semibold","mb-2"),E.textContent=`${x+1}. ${M.pregunta}`;let C=document.createElement("span");C.classList.add("text-sm","font-bold","text-gray-600","ml-2"),this.puntosChecked&&(C.textContent=` (${M.puntaje} pts)`),E.appendChild(C),w.appendChild(E);let D=document.createElement("ul");D.classList.add("space-y-2"),M.respuesta.forEach((S,R)=>{let oe=document.createElement("li");oe.classList.add("flex","items-center");let se=document.createElement("input");se.type="checkbox",se.value=S,se.classList.add("mr-2");let Ie=document.createElement("label");Ie.htmlFor=se.id,Ie.textContent=S,oe.appendChild(se),oe.appendChild(Ie),D.appendChild(oe)}),w.appendChild(D),B.appendChild(w)}),c.appendChild(v))}if(document.body.appendChild(c),this.cargandoPDF=!1,yield new Promise(d=>setTimeout(d,1e3)),this.examen!=""?document.title=this.institucion!=""?`${this.examen}-${this.institucion}`:`${this.profesor}-${this.examen}`:document.title="Evaluaciones",this.isMobile){var l="",h=new Blob([this.base64ToArrayBuffer(l)],{type:"application/pdf"}),f=URL.createObjectURL(h);window.open(f)}window.print(),c.remove(),document.title="EvaluAr",this.loading=!1})}base64ToArrayBuffer(n){let i=window.atob(n),s=i.length,a=new Uint8Array(s);for(let o=0;o<s;o++)a[o]=i.charCodeAt(o);return a.buffer}convertFileToBase64(n){return new ji(i=>{let s=new FileReader;s.onload=()=>{let a=s.result;i.next(a),i.complete()},s.onerror=a=>{i.error(a)},s.readAsDataURL(n)})}onSubmit(){this.questionForm.value.preguntasTextarea.trim().split(/\n\s*\n/).forEach(s=>{let a=s.split(`
`),[o,...c]=a,[l,h,f]=o.split(" - "),d=f?.toLowerCase(),p=this.mapeoDificultad[d]||f,v={pregunta:l.trim(),respuesta:c.map(m=>m.trim()).filter(m=>m!=="")};this.preguntasList.push(v)}),this.questionForm.reset()}};e.\u0275fac=function(i){return new(i||e)(Ue(nw),Ue(j0),Ue(zb),Ue(Qf),Ue(DI))},e.\u0275cmp=$t({type:e,selectors:[["app-preguntas"]],standalone:!0,features:[Ht],decls:39,vars:9,consts:[[1,"no-print","container","mx-auto","px-4","py-6",2,"margin-bottom","200px"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["id","listadoPreguntas",1,"bg-white","p-6","rounded-lg","shadow-lg","max-h-[400px]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],["id","listadoPreguntas",1,"space-y-4"],["class","border rounded-lg p-4 shadow-sm",4,"ngFor","ngForOf"],[1,"bg-white","p-6","rounded-lg","shadow-lg"],[1,"flex","flex-row","justify-between","mb-4"],[1,"text-2xl","font-semibold"],["id","buttonModal",1,"w-20","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"fas","fa-file-alt"],[3,"guardarHeader","cerrarModal",4,"ngIf"],[1,"space-y-6","mb-4",3,"ngSubmit","formGroup"],["for","preguntasTextarea",1,"block","font-semibold","mb-2"],["id","preguntasTextarea","formControlName","preguntasTextarea","rows","10","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500"],["id","guardarPreguntas","type","submit",1,"w-full","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600"],["id","cantidades"],["for","cantidadExamenes",1,"block","font-semibold","mb-2"],["type","number",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["class","mt-2",4,"ngIf"],[4,"ngIf"],["id","botones",1,"flex","flex-row","mt-6"],["id","descargarExcel",1,"w-full","bg-green-500","text-white","font-bold","py-2","rounded","hover:bg-green-600",3,"click"],[1,"fas","fa-file-excel"],["id","importarExcel","onclick","document.getElementById('importExcelInput').click()",1,"w-full","bg-yellow-500","hover:bg-yellow-600","border","p-2","rounded","text-white","font-bold","text-center"],[1,"fas","fa-upload"],["id","importExcelInput","type","file","accept",".xls, .xlsx",2,"display","none",3,"change"],["id","descargarPDF",1,"w-full","bg-red-500","text-white","font-bold","py-2","rounded","hover:bg-red-600","disabled",3,"click"],["class","fas fa-file-pdf",4,"ngIf"],["class","inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",4,"ngIf"],["class","no-print",4,"ngIf"],[1,"border","rounded-lg","p-4","shadow-sm"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-semibold","text-lg"],[1,"list-[lower-alpha]","pl-6"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"guardarHeader","cerrarModal"],[1,"mt-2"],["for","preguntasPorExamen",1,"block","font-semibold","mb-2"],["for","puntajeTotal"],["type","puntajeTotal",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"fas","fa-file-pdf"],[1,"inline-block","h-4","w-4","animate-spin","rounded-full","border-2","border-solid","border-current","border-e-transparent","align-[-0.125em]","text-surface","motion-reduce:animate-[spin_1.5s_linear_infinite]","dark:text-white"],[1,"no-print"]],template:function(i,s){i&1&&(ae(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),ke(4,"Listado de Preguntas"),le(),ae(5,"div",4),On(6,qB,6,3,"div",5),le()(),ae(7,"div",6)(8,"div",7)(9,"h2",8),ke(10,"Agregar Configuraci\xF3n"),le(),ae(11,"button",9),ut("click",function(){return s.mostrarModal=!0}),Ye(12,"i",10),le()(),On(13,KB,1,0,"app-header",11),ae(14,"form",12),ut("ngSubmit",function(){return s.onSubmit()}),ae(15,"div")(16,"label",13),ke(17,"Preguntas:"),le(),Ye(18,"textarea",14),le(),ae(19,"button",15),ke(20," Guardar Preguntas "),le()(),ae(21,"div",16)(22,"div")(23,"label",17),ke(24,"Cantidad de evaluaciones a crear:"),le(),ae(25,"input",18),gn("ngModelChange",function(o){return mn(s.cantidadExamenes,o)||(s.cantidadExamenes=o),o}),le()(),On(26,XB,4,1,"div",19),le(),On(27,YB,4,1,"div",20),ae(28,"div",21)(29,"button",22),ut("click",function(){return s.downloadExcel()}),Ye(30,"i",23),le(),ae(31,"button",24),Ye(32,"i",25),le(),ae(33,"input",26),ut("change",function(o){return s.onFileChange(o)}),le(),ae(34,"button",27),ut("click",function(){return s.generarPDF()}),On(35,QB,1,0,"i",28)(36,JB,1,0,"div",29),le()()()()(),On(37,ZB,1,0,"app-loading-print",30),Ye(38,"app-toast")),i&2&&(Je(6),ur("ngForOf",s.preguntasList),Je(7),ur("ngIf",s.mostrarModal),Je(),ur("formGroup",s.questionForm),Je(11),pn("ngModel",s.cantidadExamenes),Je(),ur("ngIf",s.criterioSeleccionado==="questionsPerExam"),Je(),ur("ngIf",s.criterioSeleccionado==="puntajeTotal"),Je(8),ur("ngIf",!s.cargandoPDF),Je(),ur("ngIf",s.cargandoPDF),Je(),ur("ngIf",s.loading))},dependencies:[ca,Ey,kh,gf,Po,As,Kp,Do,Ro,ma,Nl,Ml,bw,Ny,Fo,Ol,Bb,Hb,Jf],encapsulation:2});let t=e;return t})();var FI=function(t){let e=[],r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},eU=function(t){let e=[],r=0,n=0;for(;r<t.length;){let i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{let s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},OI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){let s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4,d=(o&15)<<2|l>>6,p=l&63;c||(p=64,a||(d=64)),n.push(r[h],r[f],r[d],r[p])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(FI(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):eU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){let s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;let l=i<t.length?r[t.charAt(i)]:64;++i;let f=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||l==null||f==null)throw new Xg;let d=s<<2|o>>4;if(n.push(d),l!==64){let p=o<<4&240|l>>2;if(n.push(p),f!==64){let v=l<<6&192|f;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},Xg=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},tU=function(t){let e=FI(t);return OI.encodeByteArray(e,!0)},ku=function(t){return tU(t).replace(/\./g,"")},Qg=function(t){try{return OI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function rU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var nU=()=>rU().__FIREBASE_DEFAULTS__,iU=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},sU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&Qg(t[1]);return e&&JSON.parse(e)},dd=()=>{try{return nU()||iU()||sU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},NI=t=>{var e,r;return(r=(e=dd())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},MI=t=>{let e=NI(t);if(!e)return;let r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},Jg=()=>{var t;return(t=dd())===null||t===void 0?void 0:t.config},LI=t=>{var e;return(e=dd())===null||e===void 0?void 0:e[`_${t}`]};var fd=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}};function VI(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ku(JSON.stringify(r)),ku(JSON.stringify(a)),""].join(".")}function In(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function BI(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(In())}function aU(){var t;let e=(t=dd())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function UI(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function jI(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function WI(){return!aU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Zg(){try{return typeof indexedDB=="object"}catch{return!1}}function $I(){return new Promise((t,e)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}var oU="FirebaseError",Kn=class t extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=oU,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,is.prototype.create)}},is=class{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){let n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?cU(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Kn(i,o,n)}};function cU(t,e){return t.replace(lU,(r,n)=>{let i=e[n];return i!=null?String(i):`<${n}?>`})}var lU=/\{\$([^}]+)}/g;function hc(t,e){if(t===e)return!0;let r=Object.keys(t),n=Object.keys(e);for(let i of r){if(!n.includes(i))return!1;let s=t[i],a=e[i];if(PI(s)&&PI(a)){if(!hc(s,a))return!1}else if(s!==a)return!1}for(let i of n)if(!r.includes(i))return!1;return!0}function PI(t){return t!==null&&typeof t=="object"}function ev(t){let e=[];for(let[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function HI(t,e){let r=new Yg(t,e);return r.subscribe.bind(r)}var Yg=class{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");uU(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=Kg),i.error===void 0&&(i.error=Kg),i.complete===void 0&&(i.complete=Kg);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function uU(t,e){if(typeof t!="object"||t===null)return!1;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function Kg(){}var SG=4*60*60*1e3;function fi(t){return t&&t._delegate?t._delegate:t}var Xn=class{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var Ha="[DEFAULT]";var tv=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let n=new fd;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;let n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(fU(e))try{this.getOrInitializeService({instanceIdentifier:Ha})}catch{}for(let[r,n]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(r);try{let s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Ha){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return Z(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=Ha){return this.instances.has(e)}getOptions(e=Ha){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(let[s,a]of this.instancesDeferred.entries()){let o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;let i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){let n=this.onInitCallbacks.get(r);if(n)for(let i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:hU(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Ha){return this.component?this.component.multipleInstances?e:Ha:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function hU(t){return t===Ha?void 0:t}function fU(t){return t.instantiationMode==="EAGER"}var pd=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new tv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}};var dU=[],et=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(et||{}),pU={debug:et.DEBUG,verbose:et.VERBOSE,info:et.INFO,warn:et.WARN,error:et.ERROR,silent:et.SILENT},mU=et.INFO,gU={[et.DEBUG]:"log",[et.VERBOSE]:"log",[et.INFO]:"info",[et.WARN]:"warn",[et.ERROR]:"error"},vU=(t,e,...r)=>{if(e<t.logLevel)return;let n=new Date().toISOString(),i=gU[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Ws=class{constructor(e){this.name=e,this._logLevel=mU,this._logHandler=vU,this._userLogHandler=null,dU.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in et))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?pU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,et.DEBUG,...e),this._logHandler(this,et.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,et.VERBOSE,...e),this._logHandler(this,et.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,et.INFO,...e),this._logHandler(this,et.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,et.WARN,...e),this._logHandler(this,et.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,et.ERROR,...e),this._logHandler(this,et.ERROR,...e)}};var _U=(t,e)=>e.some(r=>t instanceof r),zI,GI;function yU(){return zI||(zI=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function xU(){return GI||(GI=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var qI=new WeakMap,nv=new WeakMap,KI=new WeakMap,rv=new WeakMap,sv=new WeakMap;function wU(t){let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Ri(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&qI.set(r,t)}).catch(()=>{}),sv.set(e,t),e}function EU(t){if(nv.has(t))return;let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});nv.set(t,e)}var iv={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return nv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||KI.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Ri(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function XI(t){iv=t(iv)}function TU(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){let n=t.call(md(this),e,...r);return KI.set(n,e.sort?e.sort():[e]),Ri(n)}:xU().includes(t)?function(...e){return t.apply(md(this),e),Ri(qI.get(this))}:function(...e){return Ri(t.apply(md(this),e))}}function bU(t){return typeof t=="function"?TU(t):(t instanceof IDBTransaction&&EU(t),_U(t,yU())?new Proxy(t,iv):t)}function Ri(t){if(t instanceof IDBRequest)return wU(t);if(rv.has(t))return rv.get(t);let e=bU(t);return e!==t&&(rv.set(t,e),sv.set(e,t)),e}var md=t=>sv.get(t);function QI(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(t,e),o=Ri(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Ri(a.result),c.oldVersion,c.newVersion,Ri(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}var IU=["get","getKey","getAll","getAllKeys","count"],AU=["put","add","delete","clear"],av=new Map;function YI(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(av.get(e))return av.get(e);let r=e.replace(/FromIndex$/,""),n=e!==r,i=AU.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||IU.includes(r)))return;let s=function(a,...o){return Z(this,null,function*(){let c=this.transaction(a,i?"readwrite":"readonly"),l=c.store;return n&&(l=l.index(o.shift())),(yield Promise.all([l[r](...o),i&&c.done]))[0]})};return av.set(e,s),s}XI(t=>pt(be({},t),{get:(e,r,n)=>YI(e,r)||t.get(e,r,n),has:(e,r)=>!!YI(e,r)||t.has(e,r)}));var cv=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(SU(r)){let n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}};function SU(t){let e=t.getComponent();return e?.type==="VERSION"}var lv="@firebase/app",JI="0.10.8";var za=new Ws("@firebase/app"),CU="@firebase/app-compat",kU="@firebase/analytics-compat",DU="@firebase/analytics",RU="@firebase/app-check-compat",PU="@firebase/app-check",FU="@firebase/auth",OU="@firebase/auth-compat",NU="@firebase/database",MU="@firebase/database-compat",LU="@firebase/functions",VU="@firebase/functions-compat",BU="@firebase/installations",UU="@firebase/installations-compat",jU="@firebase/messaging",WU="@firebase/messaging-compat",$U="@firebase/performance",HU="@firebase/performance-compat",zU="@firebase/remote-config",GU="@firebase/remote-config-compat",qU="@firebase/storage",KU="@firebase/storage-compat",XU="@firebase/firestore",YU="@firebase/vertexai-preview",QU="@firebase/firestore-compat",JU="firebase",ZU="10.12.5";var uv="[DEFAULT]",e9={[lv]:"fire-core",[CU]:"fire-core-compat",[DU]:"fire-analytics",[kU]:"fire-analytics-compat",[PU]:"fire-app-check",[RU]:"fire-app-check-compat",[FU]:"fire-auth",[OU]:"fire-auth-compat",[NU]:"fire-rtdb",[MU]:"fire-rtdb-compat",[LU]:"fire-fn",[VU]:"fire-fn-compat",[BU]:"fire-iid",[UU]:"fire-iid-compat",[jU]:"fire-fcm",[WU]:"fire-fcm-compat",[$U]:"fire-perf",[HU]:"fire-perf-compat",[zU]:"fire-rc",[GU]:"fire-rc-compat",[qU]:"fire-gcs",[KU]:"fire-gcs-compat",[XU]:"fire-fst",[QU]:"fire-fst-compat",[YU]:"fire-vertex","fire-js":"fire-js",[JU]:"fire-js-all"};var Du=new Map,t9=new Map,hv=new Map;function ZI(t,e){try{t.container.addComponent(e)}catch(r){za.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Hs(t){let e=t.name;if(hv.has(e))return za.debug(`There were multiple attempts to register component ${e}.`),!1;hv.set(e,t);for(let r of Du.values())ZI(r,t);for(let r of t9.values())ZI(r,t);return!0}function mv(t,e){let r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function fc(t){return t.settings!==void 0}var r9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},$s=new is("app","Firebase",r9);var fv=class{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Xn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw $s.create("app-deleted",{appName:this._name})}};var dc=ZU;function gv(t,e={}){let r=t;typeof e!="object"&&(e={name:e});let n=Object.assign({name:uv,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw $s.create("bad-app-name",{appName:String(i)});if(r||(r=Jg()),!r)throw $s.create("no-options");let s=Du.get(i);if(s){if(hc(r,s.options)&&hc(n,s.config))return s;throw $s.create("duplicate-app",{appName:i})}let a=new pd(i);for(let c of hv.values())a.addComponent(c);let o=new fv(r,n,a);return Du.set(i,o),o}function Pu(t=uv){let e=Du.get(t);if(!e&&t===uv&&Jg())return gv();if(!e)throw $s.create("no-app",{appName:t});return e}function gd(){return Array.from(Du.values())}function Tr(t,e,r){var n;let i=(n=e9[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),za.warn(o.join(" "));return}Hs(new Xn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var n9="firebase-heartbeat-database",i9=1,Ru="firebase-heartbeat-store",ov=null;function nA(){return ov||(ov=QI(n9,i9,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ru)}catch(r){console.warn(r)}}}}).catch(t=>{throw $s.create("idb-open",{originalErrorMessage:t.message})})),ov}function s9(t){return Z(this,null,function*(){try{let r=(yield nA()).transaction(Ru),n=yield r.objectStore(Ru).get(iA(t));return yield r.done,n}catch(e){if(e instanceof Kn)za.warn(e.message);else{let r=$s.create("idb-get",{originalErrorMessage:e?.message});za.warn(r.message)}}})}function eA(t,e){return Z(this,null,function*(){try{let n=(yield nA()).transaction(Ru,"readwrite");yield n.objectStore(Ru).put(e,iA(t)),yield n.done}catch(r){if(r instanceof Kn)za.warn(r.message);else{let n=$s.create("idb-set",{originalErrorMessage:r?.message});za.warn(n.message)}}})}function iA(t){return`${t.name}!${t.options.appId}`}var a9=1024,o9=30*24*60*60*1e3,dv=class{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new pv(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){return Z(this,null,function*(){var e,r;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=tA();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let o=new Date(a.date).valueOf();return Date.now()-o<=o9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return Z(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let r=tA(),{heartbeatsToSend:n,unsentEntries:i}=c9(this._heartbeatsCache.heartbeats),s=ku(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function tA(){return new Date().toISOString().substring(0,10)}function c9(t,e=a9){let r=[],n=t.slice();for(let i of t){let s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),rA(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),rA(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}var pv=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return Z(this,null,function*(){return Zg()?$I().then(()=>!0).catch(()=>!1):!1})}read(){return Z(this,null,function*(){if(yield this._canUseIndexedDBPromise){let r=yield s9(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return Z(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return eA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return Z(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return eA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function rA(t){return ku(JSON.stringify({version:2,heartbeats:t})).length}function l9(t){Hs(new Xn("platform-logger",e=>new cv(e),"PRIVATE")),Hs(new Xn("heartbeat",e=>new dv(e),"PRIVATE")),Tr(lv,JI,t),Tr(lv,JI,"esm2017"),Tr("fire-js","")}l9("");var u9="firebase",h9="10.12.5";Tr(u9,h9,"app");var mc=new vo("ANGULARFIRE2_VERSION");function _v(t,e,r){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===r);if(s.length===1)return s[0]}return r.container.getProvider(t).getImmediate({optional:!0})}var Ou=(t,e)=>{let r=e?[e]:gd(),n=[];return r.forEach(i=>{i.container.getProvider(t).instances.forEach(a=>{n.includes(a)||n.push(a)})}),n},Fu=class{constructor(){return Ou(f9)}},f9="app-check";function pc(){}var vd=class{zone;delegate;constructor(e,r=ey){this.zone=e,this.delegate=r}now(){return this.delegate.now()}schedule(e,r,n){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,r,n)}},vv=class{zone;task=null;constructor(e){this.zone=e}call(e,r){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",pc,{},pc,pc)),r.pipe(lr({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Nu=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(r){this.ngZone=r,this.outsideAngular=r.runOutsideAngular(()=>new vd(Zone.current)),this.insideAngular=r.run(()=>new vd(Zone.current,Z1)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||t)(je(Vt))};static \u0275prov=Fe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function _d(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function d9(t){return _d().ngZone.runOutsideAngular(()=>t())}function Ga(t){return _d().ngZone.run(()=>t())}function p9(t){return m9(_d())(t)}function m9(t){return function(r){return r=r.lift(new vv(t.ngZone)),r.pipe(T0(t.outsideAngular),E0(t.insideAngular))}}var g9=(t,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Ga(()=>t.apply(void 0,n))},Mu=(t,e)=>function(){let r,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(r||=Ga(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",pc,{},pc,pc))),n[s]=g9(n[s],r));let i=d9(()=>t.apply(this,n));if(!e)if(i instanceof ji){let s=_d();return i.pipe(T0(s.outsideAngular),E0(s.insideAngular))}else return Ga(()=>i);return i instanceof ji?i.pipe(p9):i instanceof Promise?Ga(()=>new Promise((s,a)=>i.then(o=>Ga(()=>s(o)),o=>Ga(()=>a(o))))):typeof i=="function"&&r?function(){return setTimeout(()=>{r&&r.state==="scheduled"&&r.invoke()},10),i.apply(this,arguments)}:Ga(()=>i)};var qa=class{constructor(e){return e}},Lu=class{constructor(){return gd()}};function v9(t){return t&&t.length===1?t[0]:new qa(Pu())}var yv=new nt("angularfire2._apps"),_9={provide:qa,useFactory:v9,deps:[[new gi,yv]]},y9={provide:Lu,deps:[[new gi,yv]]};function x9(t){return(e,r)=>{let n=r.get(ni);Tr("angularfire",mc.full,"core"),Tr("angularfire",mc.full,"app"),Tr("angular",_y.full,n.toString());let i=e.runOutsideAngular(()=>t(r));return new qa(i)}}function sA(t,...e){return Qn([_9,y9,{provide:yv,useFactory:x9(t),multi:!0,deps:[Vt,aa,Nu,...e]}])}var aA=Mu(gv,!0);function pA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var mA=pA,gA=new is("auth","Firebase",pA());var Ed=new Ws("@firebase/auth");function E9(t,...e){Ed.logLevel<=et.WARN&&Ed.warn(`Auth (${dc}): ${t}`,...e)}function xd(t,...e){Ed.logLevel<=et.ERROR&&Ed.error(`Auth (${dc}): ${t}`,...e)}function oA(t,...e){throw Rv(t,...e)}function Dv(t,...e){return Rv(t,...e)}function vA(t,e,r){let n=Object.assign(Object.assign({},mA()),{[e]:r});return new is("auth","Firebase",n).create(e,{appName:t.name})}function wd(t){return vA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Rv(t,...e){if(typeof t!="string"){let r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return gA.create(t,...e)}function dt(t,e,...r){if(!t)throw Rv(e,...r)}function Vu(t){let e="INTERNAL ASSERTION FAILED: "+t;throw xd(e),new Error(e)}function Td(t,e){t||Vu(e)}function T9(){return cA()==="http:"||cA()==="https:"}function cA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function b9(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(T9()||UI()||"connection"in navigator)?navigator.onLine:!0}function I9(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var Xa=class{constructor(e,r){this.shortDelay=e,this.longDelay=r,Td(r>e,"Short delay should be less than long delay!"),this.isMobile=BI()||jI()}get(){return b9()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function A9(t,e){Td(t.emulator,"Emulator should always be set here");let{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}var bd=class{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Vu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Vu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Vu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var S9={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var C9=new Xa(3e4,6e4);function _A(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Cd(s,a,o,c){return Z(this,arguments,function*(t,e,r,n,i={}){return yA(t,i,()=>Z(this,null,function*(){let l={},h={};n&&(e==="GET"?h=n:l={body:JSON.stringify(n)});let f=ev(Object.assign({key:t.config.apiKey},h)).slice(1),d=yield t._getAdditionalHeaders();return d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode),bd.fetch()(xA(t,t.config.apiHost,r,f),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},l))}))})}function yA(t,e,r){return Z(this,null,function*(){t._canInitEmulator=!1;let n=Object.assign(Object.assign({},S9),e);try{let i=new Ev(t),s=yield Promise.race([r(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw yd(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let o=s.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw yd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw yd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw yd(t,"user-disabled",a);let h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw vA(t,h,l);oA(t,h)}}catch(i){if(i instanceof Kn)throw i;oA(t,"network-request-failed",{message:String(i)})}})}function xA(t,e,r,n){let i=`${e}${r}?${n}`;return t.config.emulator?A9(t.config,i):`${t.config.apiScheme}://${i}`}var Ev=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n(Dv(this.auth,"network-request-failed")),C9.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function yd(t,e,r){let n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=Dv(t,e,n);return i.customData._tokenResponse=r,i}function k9(t,e){return Z(this,null,function*(){return Cd(t,"POST","/v1/accounts:delete",e)})}function wA(t,e){return Z(this,null,function*(){return Cd(t,"POST","/v1/accounts:lookup",e)})}function Bu(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Pv(t,e=!1){return Z(this,null,function*(){let r=fi(t),n=yield r.getIdToken(e),i=EA(n);dt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:n,authTime:Bu(xv(i.auth_time)),issuedAtTime:Bu(xv(i.iat)),expirationTime:Bu(xv(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function xv(t){return Number(t)*1e3}function EA(t){let[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return xd("JWT malformed, contained fewer than 3 sections"),null;try{let i=Qg(r);return i?JSON.parse(i):(xd("Failed to decode base64 JWT payload"),null)}catch(i){return xd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function lA(t){let e=EA(t);return dt(e,"internal-error"),dt(typeof e.exp<"u","internal-error"),dt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Tv(t,e,r=!1){return Z(this,null,function*(){if(r)return e;try{return yield e}catch(n){throw n instanceof Kn&&D9(n)&&t.auth.currentUser===t&&(yield t.auth.signOut()),n}})}function D9({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var bv=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){let n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;let i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(()=>Z(this,null,function*(){yield this.iteration()}),r)}iteration(){return Z(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var ju=class{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bu(this.lastLoginAt),this.creationTime=Bu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Id(t){return Z(this,null,function*(){var e;let r=t.auth,n=yield t.getIdToken(),i=yield Tv(t,wA(r,{idToken:n}));dt(i?.users.length,r,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?TA(s.providerUserInfo):[],o=R9(t.providerData,a),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!o?.length,h=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ju(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)})}function Fv(t){return Z(this,null,function*(){let e=fi(t);yield Id(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function R9(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function TA(t){return t.map(e=>{var{providerId:r}=e,n=w0(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function P9(t,e){return Z(this,null,function*(){let r=yield yA(t,{},()=>Z(this,null,function*(){let n=ev({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=xA(t,i,"/v1/token",`key=${s}`),o=yield t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",bd.fetch()(a,{method:"POST",headers:o,body:n})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}})}function F9(t,e){return Z(this,null,function*(){return Cd(t,"POST","/v2/accounts:revokeToken",_A(t,e))})}var Uu=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){dt(e.idToken,"internal-error"),dt(typeof e.idToken<"u","internal-error"),dt(typeof e.refreshToken<"u","internal-error");let r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):lA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){dt(e.length!==0,"internal-error");let r=lA(e);this.updateTokensAndExpiration(e,null,r)}getToken(e,r=!1){return Z(this,null,function*(){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(dt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,r){return Z(this,null,function*(){let{accessToken:n,refreshToken:i,expiresIn:s}=yield P9(e,r);this.updateTokensAndExpiration(n,i,Number(s))})}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){let{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new t;return n&&(dt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(dt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(dt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Vu("not implemented")}};function zs(t,e){dt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var Wu=class t{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=w0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new bv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new ju(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return Z(this,null,function*(){let r=yield Tv(this,this.stsTokenManager.getToken(this.auth,e));return dt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r})}getIdTokenResult(e){return Pv(this,e)}reload(){return Fv(this)}_assign(e){this!==e&&(dt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){dt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,r=!1){return Z(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&(yield Id(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return Z(this,null,function*(){if(fc(this.auth.app))return Promise.reject(wd(this.auth));let e=yield this.getIdToken();return yield Tv(this,k9(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,c,l,h;let f=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,p=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,m=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,T=(l=r.createdAt)!==null&&l!==void 0?l:void 0,A=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:b,emailVerified:N,isAnonymous:B,providerData:M,stsTokenManager:x}=r;dt(b&&x,e,"internal-error");let w=Uu.fromJSON(this.name,x);dt(typeof b=="string",e,"internal-error"),zs(f,e.name),zs(d,e.name),dt(typeof N=="boolean",e,"internal-error"),dt(typeof B=="boolean",e,"internal-error"),zs(p,e.name),zs(v,e.name),zs(m,e.name),zs(_,e.name),zs(T,e.name),zs(A,e.name);let E=new t({uid:b,auth:e,email:d,emailVerified:N,displayName:f,isAnonymous:B,photoURL:v,phoneNumber:p,tenantId:m,stsTokenManager:w,createdAt:T,lastLoginAt:A});return M&&Array.isArray(M)&&(E.providerData=M.map(C=>Object.assign({},C))),_&&(E._redirectEventId=_),E}static _fromIdTokenResponse(e,r,n=!1){return Z(this,null,function*(){let i=new Uu;i.updateFromServerResponse(r);let s=new t({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield Id(s),s})}static _fromGetAccountInfoResponse(e,r,n){return Z(this,null,function*(){let i=r.users[0];dt(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?TA(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Uu;o.updateFromIdToken(n);let c=new t({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new ju(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var uA=new Map;function Ka(t){Td(t instanceof Function,"Expected a class definition");let e=uA.get(t);return e?(Td(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,uA.set(t,e),e)}var O9=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return Z(this,null,function*(){return!0})}_set(r,n){return Z(this,null,function*(){this.storage[r]=n})}_get(r){return Z(this,null,function*(){let n=this.storage[r];return n===void 0?null:n})}_remove(r){return Z(this,null,function*(){delete this.storage[r]})}_addListener(r,n){}_removeListener(r,n){}}return t.type="NONE",t})(),Iv=O9;function wv(t,e,r){return`firebase:${t}:${e}:${r}`}var Ad=class t{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;let{config:i,name:s}=this.auth;this.fullUserKey=wv(this.userKey,i.apiKey,s),this.fullPersistenceKey=wv("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return Z(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?Wu._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return Z(this,null,function*(){if(this.persistence===e)return;let r=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,r,n="authUser"){return Z(this,null,function*(){if(!r.length)return new t(Ka(Iv),e,n);let i=(yield Promise.all(r.map(l=>Z(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||Ka(Iv),a=wv(n,e.config.apiKey,e.name),o=null;for(let l of r)try{let h=yield l._get(a);if(h){let f=Wu._fromJSON(e,h);l!==s&&(o=f),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,n):(s=c[0],o&&(yield s._set(a,o.toJSON())),yield Promise.all(r.map(l=>Z(this,null,function*(){if(l!==s)try{yield l._remove(a)}catch{}}))),new t(s,e,n))})}};function hA(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(V9(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(N9(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(U9(e))return"Blackberry";if(j9(e))return"Webos";if(M9(e))return"Safari";if((e.includes("chrome/")||L9(e))&&!e.includes("edge/"))return"Chrome";if(B9(e))return"Android";{let r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function N9(t=In()){return/firefox\//i.test(t)}function M9(t=In()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function L9(t=In()){return/crios\//i.test(t)}function V9(t=In()){return/iemobile/i.test(t)}function B9(t=In()){return/android/i.test(t)}function U9(t=In()){return/blackberry/i.test(t)}function j9(t=In()){return/webos/i.test(t)}function bA(t,e=[]){let r;switch(t){case"Browser":r=hA(In());break;case"Worker":r=`${hA(In())}-${t}`;break;default:r=t}let n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${dc}/${n}`}var Av=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let n=s=>new Promise((a,o)=>{try{let c=e(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return Z(this,null,function*(){if(this.auth.currentUser===e)return;let r=[];try{for(let n of this.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(let i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}})}};function W9(r){return Z(this,arguments,function*(t,e={}){return Cd(t,"GET","/v2/passwordPolicy",_A(t,e))})}var $9=6,Sv=class{constructor(e){var r,n,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:$9,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,r){let n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var Cv=class{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Sd(this),this.idTokenSubscription=new Sd(this),this.beforeStateQueue=new Av(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Ka(r)),this._initializationPromise=this.queue(()=>Z(this,null,function*(){var n,i;if(!this._deleted&&(this.persistenceManager=yield Ad.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return Z(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return Z(this,null,function*(){try{let r=yield wA(this,{idToken:e}),n=yield Wu._fromGetAccountInfoResponse(this,r,e);yield this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return Z(this,null,function*(){var r;if(fc(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}let n=yield this.assertedPersistence.getCurrentUser(),i=n,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return dt(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return Z(this,null,function*(){let r=null;try{r=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return r})}reloadAndSetCurrentUserOrClear(e){return Z(this,null,function*(){try{yield Id(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=I9()}_delete(){return Z(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return Z(this,null,function*(){if(fc(this.app))return Promise.reject(wd(this));let r=e?fi(e):null;return r&&dt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))})}_updateCurrentUser(e,r=!1){return Z(this,null,function*(){if(!this._deleted)return e&&dt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>Z(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return Z(this,null,function*(){return fc(this.app)?Promise.reject(wd(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return fc(this.app)?Promise.reject(wd(this)):this.queue(()=>Z(this,null,function*(){yield this.assertedPersistence.setPersistence(Ka(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return Z(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return Z(this,null,function*(){let e=yield W9(this),r=new Sv(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new is("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},r)}})}revokeAccessToken(e){return Z(this,null,function*(){if(this.currentUser){let r=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),yield F9(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,r){return Z(this,null,function*(){let n=yield this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return Z(this,null,function*(){if(!this.redirectPersistenceManager){let r=e&&Ka(e)||this._popupRedirectResolver;dt(r,this,"argument-error"),this.redirectPersistenceManager=yield Ad.create(this,[Ka(r._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return Z(this,null,function*(){var r,n;return this._isInitialized&&(yield this.queue(()=>Z(this,null,function*(){}))),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return Z(this,null,function*(){if(e===this.currentUser)return this.queue(()=>Z(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};let s=typeof r=="function"?r:r.next.bind(r),a=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(dt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){let c=e.addObserver(r,n,i);return()=>{a=!0,c()}}else{let c=e.addObserver(r);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return Z(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return dt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=bA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return Z(this,null,function*(){var e;let r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);let n=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();n&&(r["X-Firebase-Client"]=n);let i=yield this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r})}_getAppCheckToken(){return Z(this,null,function*(){var e;let r=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return r?.error&&E9(`Error while retrieving App Check token: ${r.error}`),r?.token})}};function H9(t){return fi(t)}var Sd=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=HI(r=>this.observer=r)}get next(){return dt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var z9={loadJS(){return Z(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function G9(t){z9=t}function q9(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function K9(t,e){let r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(Ka);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}var bq=q9("rcb"),Iq=new Xa(3e4,6e4);var Aq=new Xa(2e3,1e4);var Sq=10*60*1e3;var Cq=new Xa(3e4,6e4);var kq=new Xa(5e3,15e3);var Dq=encodeURIComponent("fac");var fA="@firebase/auth",dA="1.7.6";var kv=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return Z(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){dt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function X9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Y9(t){Hs(new Xn("auth",(e,{options:r})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;dt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});let c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:bA(t)},l=new Cv(n,i,s,c);return K9(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),Hs(new Xn("auth-internal",e=>{let r=H9(e.getProvider("auth").getImmediate());return(n=>new kv(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Tr(fA,dA,X9(t)),Tr(fA,dA,"esm2017")}var Q9=5*60,Rq=LI("authIdTokenMaxAge")||Q9;function J9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}G9({loadJS(t){return new Promise((e,r)=>{let n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{let s=Dv("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",J9().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Y9("Browser");var Q7="auth";var kd=class{constructor(){return Ou(Q7)}};var IA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},AA={};var Ov,SA;(function(){var t;function e(x,w){function E(){}E.prototype=w.prototype,x.D=w.prototype,x.prototype=new E,x.prototype.constructor=x,x.C=function(C,D,S){for(var R=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)R[oe-2]=arguments[oe];return w.prototype[D].apply(C,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,w,E){E||(E=0);var C=Array(16);if(typeof w=="string")for(var D=0;16>D;++D)C[D]=w.charCodeAt(E++)|w.charCodeAt(E++)<<8|w.charCodeAt(E++)<<16|w.charCodeAt(E++)<<24;else for(D=0;16>D;++D)C[D]=w[E++]|w[E++]<<8|w[E++]<<16|w[E++]<<24;w=x.g[0],E=x.g[1],D=x.g[2];var S=x.g[3],R=w+(S^E&(D^S))+C[0]+3614090360&4294967295;w=E+(R<<7&4294967295|R>>>25),R=S+(D^w&(E^D))+C[1]+3905402710&4294967295,S=w+(R<<12&4294967295|R>>>20),R=D+(E^S&(w^E))+C[2]+606105819&4294967295,D=S+(R<<17&4294967295|R>>>15),R=E+(w^D&(S^w))+C[3]+3250441966&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(S^E&(D^S))+C[4]+4118548399&4294967295,w=E+(R<<7&4294967295|R>>>25),R=S+(D^w&(E^D))+C[5]+1200080426&4294967295,S=w+(R<<12&4294967295|R>>>20),R=D+(E^S&(w^E))+C[6]+2821735955&4294967295,D=S+(R<<17&4294967295|R>>>15),R=E+(w^D&(S^w))+C[7]+4249261313&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(S^E&(D^S))+C[8]+1770035416&4294967295,w=E+(R<<7&4294967295|R>>>25),R=S+(D^w&(E^D))+C[9]+2336552879&4294967295,S=w+(R<<12&4294967295|R>>>20),R=D+(E^S&(w^E))+C[10]+4294925233&4294967295,D=S+(R<<17&4294967295|R>>>15),R=E+(w^D&(S^w))+C[11]+2304563134&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(S^E&(D^S))+C[12]+1804603682&4294967295,w=E+(R<<7&4294967295|R>>>25),R=S+(D^w&(E^D))+C[13]+4254626195&4294967295,S=w+(R<<12&4294967295|R>>>20),R=D+(E^S&(w^E))+C[14]+2792965006&4294967295,D=S+(R<<17&4294967295|R>>>15),R=E+(w^D&(S^w))+C[15]+1236535329&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(D^S&(E^D))+C[1]+4129170786&4294967295,w=E+(R<<5&4294967295|R>>>27),R=S+(E^D&(w^E))+C[6]+3225465664&4294967295,S=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(S^w))+C[11]+643717713&4294967295,D=S+(R<<14&4294967295|R>>>18),R=E+(S^w&(D^S))+C[0]+3921069994&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^S&(E^D))+C[5]+3593408605&4294967295,w=E+(R<<5&4294967295|R>>>27),R=S+(E^D&(w^E))+C[10]+38016083&4294967295,S=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(S^w))+C[15]+3634488961&4294967295,D=S+(R<<14&4294967295|R>>>18),R=E+(S^w&(D^S))+C[4]+3889429448&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^S&(E^D))+C[9]+568446438&4294967295,w=E+(R<<5&4294967295|R>>>27),R=S+(E^D&(w^E))+C[14]+3275163606&4294967295,S=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(S^w))+C[3]+4107603335&4294967295,D=S+(R<<14&4294967295|R>>>18),R=E+(S^w&(D^S))+C[8]+1163531501&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^S&(E^D))+C[13]+2850285829&4294967295,w=E+(R<<5&4294967295|R>>>27),R=S+(E^D&(w^E))+C[2]+4243563512&4294967295,S=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(S^w))+C[7]+1735328473&4294967295,D=S+(R<<14&4294967295|R>>>18),R=E+(S^w&(D^S))+C[12]+2368359562&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(E^D^S)+C[5]+4294588738&4294967295,w=E+(R<<4&4294967295|R>>>28),R=S+(w^E^D)+C[8]+2272392833&4294967295,S=w+(R<<11&4294967295|R>>>21),R=D+(S^w^E)+C[11]+1839030562&4294967295,D=S+(R<<16&4294967295|R>>>16),R=E+(D^S^w)+C[14]+4259657740&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^S)+C[1]+2763975236&4294967295,w=E+(R<<4&4294967295|R>>>28),R=S+(w^E^D)+C[4]+1272893353&4294967295,S=w+(R<<11&4294967295|R>>>21),R=D+(S^w^E)+C[7]+4139469664&4294967295,D=S+(R<<16&4294967295|R>>>16),R=E+(D^S^w)+C[10]+3200236656&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^S)+C[13]+681279174&4294967295,w=E+(R<<4&4294967295|R>>>28),R=S+(w^E^D)+C[0]+3936430074&4294967295,S=w+(R<<11&4294967295|R>>>21),R=D+(S^w^E)+C[3]+3572445317&4294967295,D=S+(R<<16&4294967295|R>>>16),R=E+(D^S^w)+C[6]+76029189&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^S)+C[9]+3654602809&4294967295,w=E+(R<<4&4294967295|R>>>28),R=S+(w^E^D)+C[12]+3873151461&4294967295,S=w+(R<<11&4294967295|R>>>21),R=D+(S^w^E)+C[15]+530742520&4294967295,D=S+(R<<16&4294967295|R>>>16),R=E+(D^S^w)+C[2]+3299628645&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(D^(E|~S))+C[0]+4096336452&4294967295,w=E+(R<<6&4294967295|R>>>26),R=S+(E^(w|~D))+C[7]+1126891415&4294967295,S=w+(R<<10&4294967295|R>>>22),R=D+(w^(S|~E))+C[14]+2878612391&4294967295,D=S+(R<<15&4294967295|R>>>17),R=E+(S^(D|~w))+C[5]+4237533241&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~S))+C[12]+1700485571&4294967295,w=E+(R<<6&4294967295|R>>>26),R=S+(E^(w|~D))+C[3]+2399980690&4294967295,S=w+(R<<10&4294967295|R>>>22),R=D+(w^(S|~E))+C[10]+4293915773&4294967295,D=S+(R<<15&4294967295|R>>>17),R=E+(S^(D|~w))+C[1]+2240044497&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~S))+C[8]+1873313359&4294967295,w=E+(R<<6&4294967295|R>>>26),R=S+(E^(w|~D))+C[15]+4264355552&4294967295,S=w+(R<<10&4294967295|R>>>22),R=D+(w^(S|~E))+C[6]+2734768916&4294967295,D=S+(R<<15&4294967295|R>>>17),R=E+(S^(D|~w))+C[13]+1309151649&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~S))+C[4]+4149444226&4294967295,w=E+(R<<6&4294967295|R>>>26),R=S+(E^(w|~D))+C[11]+3174756917&4294967295,S=w+(R<<10&4294967295|R>>>22),R=D+(w^(S|~E))+C[2]+718787259&4294967295,D=S+(R<<15&4294967295|R>>>17),R=E+(S^(D|~w))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+w&4294967295,x.g[1]=x.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+S&4294967295}n.prototype.u=function(x,w){w===void 0&&(w=x.length);for(var E=w-this.blockSize,C=this.B,D=this.h,S=0;S<w;){if(D==0)for(;S<=E;)i(this,x,S),S+=this.blockSize;if(typeof x=="string"){for(;S<w;)if(C[D++]=x.charCodeAt(S++),D==this.blockSize){i(this,C),D=0;break}}else for(;S<w;)if(C[D++]=x[S++],D==this.blockSize){i(this,C),D=0;break}}this.h=D,this.o+=w},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var w=1;w<x.length-8;++w)x[w]=0;var E=8*this.o;for(w=x.length-8;w<x.length;++w)x[w]=E&255,E/=256;for(this.u(x),x=Array(16),w=E=0;4>w;++w)for(var C=0;32>C;C+=8)x[E++]=this.g[w]>>>C&255;return x};function s(x,w){var E=o;return Object.prototype.hasOwnProperty.call(E,x)?E[x]:E[x]=w(x)}function a(x,w){this.h=w;for(var E=[],C=!0,D=x.length-1;0<=D;D--){var S=x[D]|0;C&&S==w||(E[D]=S,C=!1)}this.g=E}var o={};function c(x){return-128<=x&&128>x?s(x,function(w){return new a([w|0],0>w?-1:0)}):new a([x|0],0>x?-1:0)}function l(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return _(l(-x));for(var w=[],E=1,C=0;x>=E;C++)w[C]=x/E|0,E*=4294967296;return new a(w,0)}function h(x,w){if(x.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(x.charAt(0)=="-")return _(h(x.substring(1),w));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(w,8)),C=f,D=0;D<x.length;D+=8){var S=Math.min(8,x.length-D),R=parseInt(x.substring(D,D+S),w);8>S?(S=l(Math.pow(w,S)),C=C.j(S).add(l(R))):(C=C.j(E),C=C.add(l(R)))}return C}var f=c(0),d=c(1),p=c(16777216);t=a.prototype,t.m=function(){if(m(this))return-_(this).m();for(var x=0,w=1,E=0;E<this.g.length;E++){var C=this.i(E);x+=(0<=C?C:4294967296+C)*w,w*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(v(this))return"0";if(m(this))return"-"+_(this).toString(x);for(var w=l(Math.pow(x,6)),E=this,C="";;){var D=N(E,w).g;E=T(E,D.j(w));var S=((0<E.g.length?E.g[0]:E.h)>>>0).toString(x);if(E=D,v(E))return S+C;for(;6>S.length;)S="0"+S;C=S+C}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function v(x){if(x.h!=0)return!1;for(var w=0;w<x.g.length;w++)if(x.g[w]!=0)return!1;return!0}function m(x){return x.h==-1}t.l=function(x){return x=T(this,x),m(x)?-1:v(x)?0:1};function _(x){for(var w=x.g.length,E=[],C=0;C<w;C++)E[C]=~x.g[C];return new a(E,~x.h).add(d)}t.abs=function(){return m(this)?_(this):this},t.add=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0,D=0;D<=w;D++){var S=C+(this.i(D)&65535)+(x.i(D)&65535),R=(S>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);C=R>>>16,S&=65535,R&=65535,E[D]=R<<16|S}return new a(E,E[E.length-1]&-2147483648?-1:0)};function T(x,w){return x.add(_(w))}t.j=function(x){if(v(this)||v(x))return f;if(m(this))return m(x)?_(this).j(_(x)):_(_(this).j(x));if(m(x))return _(this.j(_(x)));if(0>this.l(p)&&0>x.l(p))return l(this.m()*x.m());for(var w=this.g.length+x.g.length,E=[],C=0;C<2*w;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var D=0;D<x.g.length;D++){var S=this.i(C)>>>16,R=this.i(C)&65535,oe=x.i(D)>>>16,se=x.i(D)&65535;E[2*C+2*D]+=R*se,A(E,2*C+2*D),E[2*C+2*D+1]+=S*se,A(E,2*C+2*D+1),E[2*C+2*D+1]+=R*oe,A(E,2*C+2*D+1),E[2*C+2*D+2]+=S*oe,A(E,2*C+2*D+2)}for(C=0;C<w;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=w;C<2*w;C++)E[C]=0;return new a(E,0)};function A(x,w){for(;(x[w]&65535)!=x[w];)x[w+1]+=x[w]>>>16,x[w]&=65535,w++}function b(x,w){this.g=x,this.h=w}function N(x,w){if(v(w))throw Error("division by zero");if(v(x))return new b(f,f);if(m(x))return w=N(_(x),w),new b(_(w.g),_(w.h));if(m(w))return w=N(x,_(w)),new b(_(w.g),w.h);if(30<x.g.length){if(m(x)||m(w))throw Error("slowDivide_ only works with positive integers.");for(var E=d,C=w;0>=C.l(x);)E=B(E),C=B(C);var D=M(E,1),S=M(C,1);for(C=M(C,2),E=M(E,2);!v(C);){var R=S.add(C);0>=R.l(x)&&(D=D.add(E),S=R),C=M(C,1),E=M(E,1)}return w=T(x,D.j(w)),new b(D,w)}for(D=f;0<=x.l(w);){for(E=Math.max(1,Math.floor(x.m()/w.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),S=l(E),R=S.j(w);m(R)||0<R.l(x);)E-=C,S=l(E),R=S.j(w);v(S)&&(S=d),D=D.add(S),x=T(x,R)}return new b(D,x)}t.A=function(x){return N(this,x).h},t.and=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)&x.i(C);return new a(E,this.h&x.h)},t.or=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)|x.i(C);return new a(E,this.h|x.h)},t.xor=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)^x.i(C);return new a(E,this.h^x.h)};function B(x){for(var w=x.g.length+1,E=[],C=0;C<w;C++)E[C]=x.i(C)<<1|x.i(C-1)>>>31;return new a(E,x.h)}function M(x,w){var E=w>>5;w%=32;for(var C=x.g.length-E,D=[],S=0;S<C;S++)D[S]=0<w?x.i(S+E)>>>w|x.i(S+E+1)<<32-w:x.i(S+E);return new a(D,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,SA=AA.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=h,Ov=AA.Integer=a}).apply(typeof IA<"u"?IA:typeof self<"u"?self:typeof window<"u"?window:{});var Dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ss={};var Nv,Mv,gc,Lv,$u,Rd,Vv,Bv,Uv;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,y){return u==Array.prototype||u==Object.prototype||(u[g]=y.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Dd=="object"&&Dd];for(var g=0;g<u.length;++g){var y=u[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=r(this);function i(u,g){if(g)e:{var y=n;u=u.split(".");for(var k=0;k<u.length-1;k++){var z=u[k];if(!(z in y))break e;y=y[z]}u=u[u.length-1],k=y[u],g=g(k),g!=k&&g!=null&&e(y,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var y=0,k=!1,z={next:function(){if(!k&&y<u.length){var Q=y++;return{value:g(Q,u[Q]),done:!1}}return k=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,y){return y})}});var a=a||{},o=this||self;function c(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function l(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function h(u,g,y){return u.call.apply(u.bind,arguments)}function f(u,g,y){if(!u)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,k),u.apply(g,z)}}return function(){return u.apply(g,arguments)}}function d(u,g,y){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,d.apply(null,arguments)}function p(u,g){var y=Array.prototype.slice.call(arguments,1);return function(){var k=y.slice();return k.push.apply(k,arguments),u.apply(this,k)}}function v(u,g){function y(){}y.prototype=g.prototype,u.aa=g.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(k,z,Q){for(var we=Array(arguments.length-2),Tt=2;Tt<arguments.length;Tt++)we[Tt-2]=arguments[Tt];return g.prototype[z].apply(k,we)}}function m(u){let g=u.length;if(0<g){let y=Array(g);for(let k=0;k<g;k++)y[k]=u[k];return y}return[]}function _(u,g){for(let y=1;y<arguments.length;y++){let k=arguments[y];if(c(k)){let z=u.length||0,Q=k.length||0;u.length=z+Q;for(let we=0;we<Q;we++)u[z+we]=k[we]}else u.push(k)}}class T{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function A(u){return/^[\s\xa0]*$/.test(u)}function b(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function N(u){return N[" "](u),u}N[" "]=function(){};var B=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function M(u,g,y){for(let k in u)g.call(y,u[k],k,u)}function x(u,g){for(let y in u)g.call(void 0,u[y],y,u)}function w(u){let g={};for(let y in u)g[y]=u[y];return g}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,g){let y,k;for(let z=1;z<arguments.length;z++){k=arguments[z];for(y in k)u[y]=k[y];for(let Q=0;Q<E.length;Q++)y=E[Q],Object.prototype.hasOwnProperty.call(k,y)&&(u[y]=k[y])}}function D(u){var g=1;u=u.split(":");let y=[];for(;0<g&&u.length;)y.push(u.shift()),g--;return u.length&&y.push(u.join(":")),y}function S(u){o.setTimeout(()=>{throw u},0)}function R(){var u=de;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class oe{constructor(){this.h=this.g=null}add(g,y){let k=se.get();k.set(g,y),this.h?this.h.next=k:this.g=k,this.h=k}}var se=new T(()=>new Ie,u=>u.reset());class Ie{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let xe,Pe=!1,de=new oe,Ae=()=>{let u=o.Promise.resolve(void 0);xe=()=>{u.then(re)}};var re=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(y){S(y)}var g=se;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}Pe=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return u}();function W(u,g){if(G.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,k=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(B){e:{try{N(g.nodeName);var z=!0;break e}catch{}z=!1}z||(g=null)}}else y=="mouseover"?g=u.fromElement:y=="mouseout"&&(g=u.toElement);this.relatedTarget=g,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:te[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&W.aa.h.call(this)}}v(W,G);var te={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),ue=0;function fe(u,g,y,k,z){this.listener=u,this.proxy=null,this.src=g,this.type=y,this.capture=!!k,this.ha=z,this.key=++ue,this.da=this.fa=!1}function ne(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Be(u){this.src=u,this.g={},this.h=0}Be.prototype.add=function(u,g,y,k,z){var Q=u.toString();u=this.g[Q],u||(u=this.g[Q]=[],this.h++);var we=st(u,g,k,z);return-1<we?(g=u[we],y||(g.fa=!1)):(g=new fe(g,this.src,Q,!!k,z),g.fa=y,u.push(g)),g};function U(u,g){var y=g.type;if(y in u.g){var k=u.g[y],z=Array.prototype.indexOf.call(k,g,void 0),Q;(Q=0<=z)&&Array.prototype.splice.call(k,z,1),Q&&(ne(g),u.g[y].length==0&&(delete u.g[y],u.h--))}}function st(u,g,y,k){for(var z=0;z<u.length;++z){var Q=u[z];if(!Q.da&&Q.listener==g&&Q.capture==!!y&&Q.ha==k)return z}return-1}var He="closure_lm_"+(1e6*Math.random()|0),at={};function Xe(u,g,y,k,z){if(k&&k.once)return Qr(u,g,y,k,z);if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Xe(u,g[Q],y,k,z);return null}return y=Cn(y),u&&u[me]?u.K(g,y,l(k)?!!k.capture:!!k,z):Te(u,g,y,!1,k,z)}function Te(u,g,y,k,z,Q){if(!g)throw Error("Invalid event type");var we=l(z)?!!z.capture:!!z,Tt=Ar(u);if(Tt||(u[He]=Tt=new Be(u)),y=Tt.add(g,y,k,we,Q),y.proxy)return y;if(k=Lt(),y.proxy=k,k.src=u,k.listener=y,u.addEventListener)H||(z=we),z===void 0&&(z=!1),u.addEventListener(g.toString(),k,z);else if(u.attachEvent)u.attachEvent(us(g.toString()),k);else if(u.addListener&&u.removeListener)u.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return y}function Lt(){function u(y){return g.call(u.src,u.listener,y)}let g=di;return u}function Qr(u,g,y,k,z){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Qr(u,g[Q],y,k,z);return null}return y=Cn(y),u&&u[me]?u.L(g,y,l(k)?!!k.capture:!!k,z):Te(u,g,y,!0,k,z)}function un(u,g,y,k,z){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)un(u,g[Q],y,k,z);else k=l(k)?!!k.capture:!!k,y=Cn(y),u&&u[me]?(u=u.i,g=String(g).toString(),g in u.g&&(Q=u.g[g],y=st(Q,y,k,z),-1<y&&(ne(Q[y]),Array.prototype.splice.call(Q,y,1),Q.length==0&&(delete u.g[g],u.h--)))):u&&(u=Ar(u))&&(g=u.g[g.toString()],u=-1,g&&(u=st(g,y,k,z)),(y=-1<u?g[u]:null)&&hn(y))}function hn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[me])U(g.i,u);else{var y=u.type,k=u.proxy;g.removeEventListener?g.removeEventListener(y,k,u.capture):g.detachEvent?g.detachEvent(us(y),k):g.addListener&&g.removeListener&&g.removeListener(k),(y=Ar(g))?(U(y,u),y.h==0&&(y.src=null,g[He]=null)):ne(u)}}}function us(u){return u in at?at[u]:at[u]="on"+u}function di(u,g){if(u.da)u=!0;else{g=new W(g,this);var y=u.listener,k=u.ha||u.src;u.fa&&hn(u),u=y.call(k,g)}return u}function Ar(u){return u=u[He],u instanceof Be?u:null}var fn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Cn(u){return typeof u=="function"?u:(u[fn]||(u[fn]=function(g){return u.handleEvent(g)}),u[fn])}function jt(){j.call(this),this.i=new Be(this),this.M=this,this.F=null}v(jt,j),jt.prototype[me]=!0,jt.prototype.removeEventListener=function(u,g,y,k){un(this,u,g,y,k)};function ft(u,g){var y,k=u.F;if(k)for(y=[];k;k=k.F)y.push(k);if(u=u.M,k=g.type||g,typeof g=="string")g=new G(g,u);else if(g instanceof G)g.target=g.target||u;else{var z=g;g=new G(k,u),C(g,z)}if(z=!0,y)for(var Q=y.length-1;0<=Q;Q--){var we=g.g=y[Q];z=Jr(we,k,!0,g)&&z}if(we=g.g=u,z=Jr(we,k,!0,g)&&z,z=Jr(we,k,!1,g)&&z,y)for(Q=0;Q<y.length;Q++)we=g.g=y[Q],z=Jr(we,k,!1,g)&&z}jt.prototype.N=function(){if(jt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var y=u.g[g],k=0;k<y.length;k++)ne(y[k]);delete u.g[g],u.h--}}this.F=null},jt.prototype.K=function(u,g,y,k){return this.i.add(String(u),g,!1,y,k)},jt.prototype.L=function(u,g,y,k){return this.i.add(String(u),g,!0,y,k)};function Jr(u,g,y,k){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var z=!0,Q=0;Q<g.length;++Q){var we=g[Q];if(we&&!we.da&&we.capture==y){var Tt=we.listener,Cr=we.ha||we.src;we.fa&&U(u.i,we),z=Tt.call(Cr,k)!==!1&&z}}return z&&!k.defaultPrevented}function ze(u,g,y){if(typeof u=="function")y&&(u=d(u,y));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:o.setTimeout(u,g||0)}function Nt(u){u.g=ze(()=>{u.g=null,u.i&&(u.i=!1,Nt(u))},u.l);let g=u.h;u.h=null,u.m.apply(null,g)}class nn extends j{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Nt(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Dt(u){j.call(this),this.h=u,this.g={}}v(Dt,j);var pi=[];function Nc(u){M(u.g,function(g,y){this.g.hasOwnProperty(y)&&hn(g)},u),u.g={}}Dt.prototype.N=function(){Dt.aa.N.call(this),Nc(this)},Dt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Mc=o.JSON.stringify,u0=o.JSON.parse,nh=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function ao(){}ao.prototype.h=null;function Lc(u){return u.h||(u.h=u.i())}function ih(){}var Qs={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function hs(){G.call(this,"d")}v(hs,G);function Vc(){G.call(this,"c")}v(Vc,G);var Li={},sh=null;function oo(){return sh=sh||new jt}Li.La="serverreachability";function ah(u){G.call(this,Li.La,u)}v(ah,G);function Js(u){let g=oo();ft(g,new ah(g))}Li.STAT_EVENT="statevent";function oh(u,g){G.call(this,Li.STAT_EVENT,u),this.stat=g}v(oh,G);function Sr(u){let g=oo();ft(g,new oh(g,u))}Li.Ma="timingevent";function co(u,g){G.call(this,Li.Ma,u),this.size=g}v(co,G);function Zs(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function ea(){this.g=!0}ea.prototype.xa=function(){this.g=!1};function h0(u,g,y,k,z,Q){u.info(function(){if(u.g)if(Q)for(var we="",Tt=Q.split("&"),Cr=0;Cr<Tt.length;Cr++){var lt=Tt[Cr].split("=");if(1<lt.length){var Or=lt[0];lt=lt[1];var Nr=Or.split("_");we=2<=Nr.length&&Nr[1]=="type"?we+(Or+"="+lt+"&"):we+(Or+"=redacted&")}}else we=null;else we=Q;return"XMLHTTP REQ ("+k+") [attempt "+z+"]: "+g+`
`+y+`
`+we})}function I(u,g,y,k,z,Q,we){u.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+z+"]: "+g+`
`+y+`
`+Q+" "+we})}function O(u,g,y,k){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+F(u,y)+(k?" "+k:"")})}function P(u,g){u.info(function(){return"TIMEOUT: "+g})}ea.prototype.info=function(){};function F(u,g){if(!u.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var k=y[u];if(!(2>k.length)){var z=k[1];if(Array.isArray(z)&&!(1>z.length)){var Q=z[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var we=1;we<z.length;we++)z[we]=""}}}}return Mc(y)}catch{return g}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},V={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function J(){}v(J,ao),J.prototype.g=function(){return new XMLHttpRequest},J.prototype.i=function(){return{}},K=new J;function q(u,g,y,k){this.j=u,this.i=g,this.l=y,this.R=k||1,this.U=new Dt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},ce={};function pe(u,g,y){u.L=1,u.v=uh(Bi(g)),u.m=y,u.P=!0,Se(u,null)}function Se(u,g){u.F=Date.now(),Me(u),u.A=Bi(u.v);var y=u.A,k=u.R;Array.isArray(k)||(k=[String(k)]),k1(y.i,"t",k),u.C=0,y=u.j.J,u.h=new X,u.g=q1(u.j,y?g:null,!u.m),0<u.O&&(u.M=new nn(d(u.Y,u,u.g),u.O)),g=u.U,y=u.g,k=u.ca;var z="readystatechange";Array.isArray(z)||(z&&(pi[0]=z.toString()),z=pi);for(var Q=0;Q<z.length;Q++){var we=Xe(y,z[Q],k||g.handleEvent,!1,g.h||g);if(!we)break;g.g[we.key]=we}g=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),Js(),h0(u.i,u.u,u.A,u.l,u.R,u.m)}q.prototype.ca=function(u){u=u.target;let g=this.M;g&&Ui(u)==3?g.j():this.Y(u)},q.prototype.Y=function(u){try{if(u==this.g)e:{let Nr=Ui(this.g);var g=this.g.Ba();let fo=this.g.Z();if(!(3>Nr)&&(Nr!=3||this.g&&(this.h.h||this.g.oa()||M1(this.g)))){this.J||Nr!=4||g==7||(g==8||0>=fo?Js(3):Js(2)),mr(this);var y=this.g.Z();this.X=y;t:if(ge(this)){var k=M1(this.g);u="";var z=k.length,Q=Ui(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Xt(this),bt(this);var we="";break t}this.h.i=new o.TextDecoder}for(g=0;g<z;g++)this.h.h=!0,u+=this.h.i.decode(k[g],{stream:!(Q&&g==z-1)});k.length=0,this.h.g+=u,this.C=0,we=this.h.g}else we=this.g.oa();if(this.o=y==200,I(this.i,this.u,this.A,this.l,this.R,Nr,y),this.o){if(this.T&&!this.K){t:{if(this.g){var Tt,Cr=this.g;if((Tt=Cr.g?Cr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!A(Tt)){var lt=Tt;break t}}lt=null}if(y=lt)O(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Vi(this,y);else{this.o=!1,this.s=3,Sr(12),Xt(this),bt(this);break e}}if(this.P){y=!0;let Yn;for(;!this.J&&this.C<we.length;)if(Yn=Ee(this,we),Yn==ce){Nr==4&&(this.s=4,Sr(14),y=!1),O(this.i,this.l,null,"[Incomplete Response]");break}else if(Yn==Y){this.s=4,Sr(15),O(this.i,this.l,we,"[Invalid Chunk]"),y=!1;break}else O(this.i,this.l,Yn,null),Vi(this,Yn);if(ge(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Nr!=4||we.length!=0||this.h.h||(this.s=1,Sr(16),y=!1),this.o=this.o&&y,!y)O(this.i,this.l,we,"[Invalid Chunked Response]"),Xt(this),bt(this);else if(0<we.length&&!this.W){this.W=!0;var Or=this.j;Or.g==this&&Or.ba&&!Or.M&&(Or.j.info("Great, no buffering proxy detected. Bytes received: "+we.length),v0(Or),Or.M=!0,Sr(11))}}else O(this.i,this.l,we,null),Vi(this,we);Nr==4&&Xt(this),this.o&&!this.J&&(Nr==4?$1(this.j,this):(this.o=!1,Me(this)))}else f2(this.g),y==400&&0<we.indexOf("Unknown SID")?(this.s=3,Sr(12)):(this.s=0,Sr(13)),Xt(this),bt(this)}}}catch{}finally{}};function ge(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Ee(u,g){var y=u.C,k=g.indexOf(`
`,y);return k==-1?ce:(y=Number(g.substring(y,k)),isNaN(y)?Y:(k+=1,k+y>g.length?ce:(g=g.slice(k,k+y),u.C=k+y,g)))}q.prototype.cancel=function(){this.J=!0,Xt(this)};function Me(u){u.S=Date.now()+u.I,wt(u,u.I)}function wt(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Zs(d(u.ba,u),g)}function mr(u){u.B&&(o.clearTimeout(u.B),u.B=null)}q.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(P(this.i,this.A),this.L!=2&&(Js(),Sr(17)),Xt(this),this.s=2,bt(this)):wt(this,this.S-u)};function bt(u){u.j.G==0||u.J||$1(u.j,u)}function Xt(u){mr(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Nc(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Vi(u,g){try{var y=u.j;if(y.G!=0&&(y.g==u||f0(y.h,u))){if(!u.K&&f0(y.h,u)&&y.G==3){try{var k=y.Da.g.parse(g)}catch{k=null}if(Array.isArray(k)&&k.length==3){var z=k;if(z[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)mh(y),dh(y);else break e;g0(y),Sr(18)}}else y.za=z[1],0<y.za-y.T&&37500>z[2]&&y.F&&y.v==0&&!y.C&&(y.C=Zs(d(y.Za,y),6e3));if(1>=kn(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else na(y,11)}else if((u.K||y.g==u)&&mh(y),!A(g))for(z=y.Da.g.parse(g),g=0;g<z.length;g++){let lt=z[g];if(y.T=lt[0],lt=lt[1],y.G==2)if(lt[0]=="c"){y.K=lt[1],y.ia=lt[2];let Or=lt[3];Or!=null&&(y.la=Or,y.j.info("VER="+y.la));let Nr=lt[4];Nr!=null&&(y.Aa=Nr,y.j.info("SVER="+y.Aa));let fo=lt[5];fo!=null&&typeof fo=="number"&&0<fo&&(k=1.5*fo,y.L=k,y.j.info("backChannelRequestTimeoutMs_="+k)),k=y;let Yn=u.g;if(Yn){let vh=Yn.g?Yn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(vh){var Q=k.h;Q.g||vh.indexOf("spdy")==-1&&vh.indexOf("quic")==-1&&vh.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(d0(Q,Q.h),Q.h=null))}if(k.D){let _0=Yn.g?Yn.g.getResponseHeader("X-HTTP-Session-Id"):null;_0&&(k.ya=_0,Rt(k.I,k.D,_0))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),k=y;var we=u;if(k.qa=G1(k,k.J?k.ia:null,k.W),we.K){w1(k.h,we);var Tt=we,Cr=k.L;Cr&&(Tt.I=Cr),Tt.B&&(mr(Tt),Me(Tt)),k.g=we}else j1(k);0<y.i.length&&ph(y)}else lt[0]!="stop"&&lt[0]!="close"||na(y,7);else y.G==3&&(lt[0]=="stop"||lt[0]=="close"?lt[0]=="stop"?na(y,7):m0(y):lt[0]!="noop"&&y.l&&y.l.ta(lt),y.v=0)}}Js(4)}catch{}}var ta=class{constructor(u,g){this.g=u,this.map=g}};function mi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function lo(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function kn(u){return u.h?1:u.g?u.g.size:0}function f0(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function d0(u,g){u.g?u.g.add(g):u.h=g}function w1(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}mi.prototype.cancel=function(){if(this.i=E1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function E1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(let y of u.g.values())g=g.concat(y.D);return g}return m(u.i)}function QS(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var g=[],y=u.length,k=0;k<y;k++)g.push(u[k]);return g}g=[],y=0;for(k in u)g[y++]=u[k];return g}function JS(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var g=[];u=u.length;for(var y=0;y<u;y++)g.push(y);return g}g=[],y=0;for(let k in u)g[y++]=k;return g}}}function T1(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var y=JS(u),k=QS(u),z=k.length,Q=0;Q<z;Q++)g.call(void 0,k[Q],y&&y[Q],u)}var b1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ZS(u,g){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var k=u[y].indexOf("="),z=null;if(0<=k){var Q=u[y].substring(0,k);z=u[y].substring(k+1)}else Q=u[y];g(Q,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function ra(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ra){this.h=u.h,ch(this,u.j),this.o=u.o,this.g=u.g,lh(this,u.s),this.l=u.l;var g=u.i,y=new jc;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),I1(this,y),this.m=u.m}else u&&(g=String(u).match(b1))?(this.h=!1,ch(this,g[1]||"",!0),this.o=Bc(g[2]||""),this.g=Bc(g[3]||"",!0),lh(this,g[4]),this.l=Bc(g[5]||"",!0),I1(this,g[6]||"",!0),this.m=Bc(g[7]||"")):(this.h=!1,this.i=new jc(null,this.h))}ra.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Uc(g,A1,!0),":");var y=this.g;return(y||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Uc(g,A1,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(Uc(y,y.charAt(0)=="/"?r2:t2,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",Uc(y,i2)),u.join("")};function Bi(u){return new ra(u)}function ch(u,g,y){u.j=y?Bc(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function lh(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function I1(u,g,y){g instanceof jc?(u.i=g,s2(u.i,u.h)):(y||(g=Uc(g,n2)),u.i=new jc(g,u.h))}function Rt(u,g,y){u.i.set(g,y)}function uh(u){return Rt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Bc(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Uc(u,g,y){return typeof u=="string"?(u=encodeURI(u).replace(g,e2),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function e2(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var A1=/[#\/\?@]/g,t2=/[#\?:]/g,r2=/[#\?]/g,n2=/[#\?@]/g,i2=/#/g;function jc(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function fs(u){u.g||(u.g=new Map,u.h=0,u.i&&ZS(u.i,function(g,y){u.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=jc.prototype,t.add=function(u,g){fs(this),this.i=null,u=uo(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(g),this.h+=1,this};function S1(u,g){fs(u),g=uo(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function C1(u,g){return fs(u),g=uo(u,g),u.g.has(g)}t.forEach=function(u,g){fs(this),this.g.forEach(function(y,k){y.forEach(function(z){u.call(g,z,k,this)},this)},this)},t.na=function(){fs(this);let u=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let k=0;k<g.length;k++){let z=u[k];for(let Q=0;Q<z.length;Q++)y.push(g[k])}return y},t.V=function(u){fs(this);let g=[];if(typeof u=="string")C1(this,u)&&(g=g.concat(this.g.get(uo(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)g=g.concat(u[y])}return g},t.set=function(u,g){return fs(this),this.i=null,u=uo(this,u),C1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function k1(u,g,y){S1(u,g),0<y.length&&(u.i=null,u.g.set(uo(u,g),m(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var k=g[y];let Q=encodeURIComponent(String(k)),we=this.V(k);for(k=0;k<we.length;k++){var z=Q;we[k]!==""&&(z+="="+encodeURIComponent(String(we[k]))),u.push(z)}}return this.i=u.join("&")};function uo(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function s2(u,g){g&&!u.j&&(fs(u),u.i=null,u.g.forEach(function(y,k){var z=k.toLowerCase();k!=z&&(S1(this,k),k1(this,z,y))},u)),u.j=g}function a2(u,g){let y=new ea;if(o.Image){let k=new Image;k.onload=p(ds,y,"TestLoadImage: loaded",!0,g,k),k.onerror=p(ds,y,"TestLoadImage: error",!1,g,k),k.onabort=p(ds,y,"TestLoadImage: abort",!1,g,k),k.ontimeout=p(ds,y,"TestLoadImage: timeout",!1,g,k),o.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=u}else g(!1)}function o2(u,g){let y=new ea,k=new AbortController,z=setTimeout(()=>{k.abort(),ds(y,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:k.signal}).then(Q=>{clearTimeout(z),Q.ok?ds(y,"TestPingServer: ok",!0,g):ds(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(z),ds(y,"TestPingServer: error",!1,g)})}function ds(u,g,y,k,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),k(y)}catch{}}function c2(){this.g=new nh}function l2(u,g,y){let k=y||"";try{T1(u,function(z,Q){let we=z;l(z)&&(we=Mc(z)),g.push(k+Q+"="+encodeURIComponent(we))})}catch(z){throw g.push(k+"type="+encodeURIComponent("_badmap")),z}}function Wc(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Wc,ao),Wc.prototype.g=function(){return new hh(this.l,this.j)},Wc.prototype.i=function(u){return function(){return u}}({});function hh(u,g){jt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(hh,jt),t=hh.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Hc(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||o).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$c(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Hc(this)),this.g&&(this.readyState=3,Hc(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;D1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function D1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?$c(this):Hc(this),this.readyState==3&&D1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,$c(this))},t.Qa=function(u){this.g&&(this.response=u,$c(this))},t.ga=function(){this.g&&$c(this)};function $c(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Hc(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=g.next();return u.join(`\r
`)};function Hc(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(hh.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function R1(u){let g="";return M(u,function(y,k){g+=k,g+=":",g+=y,g+=`\r
`}),g}function p0(u,g,y){e:{for(k in y){var k=!1;break e}k=!0}k||(y=R1(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):Rt(u,g,y))}function Wt(u){jt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Wt,jt);var u2=/^https?$/i,h2=["POST","PUT"];t=Wt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,y,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?Lc(this.o):Lc(K),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(Q){P1(this,Q);return}if(u=y||"",y=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var z in k)y.set(z,k[z]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(let Q of k.keys())y.set(Q,k.get(Q));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(y.keys()).find(Q=>Q.toLowerCase()=="content-type"),z=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(h2,g,void 0))||k||z||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[Q,we]of y)this.g.setRequestHeader(Q,we);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{N1(this),this.u=!0,this.g.send(u),this.u=!1}catch(Q){P1(this,Q)}};function P1(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,F1(u),fh(u)}function F1(u){u.A||(u.A=!0,ft(u,"complete"),ft(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ft(this,"complete"),ft(this,"abort"),fh(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fh(this,!0)),Wt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?O1(this):this.bb())},t.bb=function(){O1(this)};function O1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||Ui(u)!=4||u.Z()!=2)){if(u.u&&Ui(u)==4)ze(u.Ea,0,u);else if(ft(u,"readystatechange"),Ui(u)==4){u.h=!1;try{let we=u.Z();e:switch(we){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var k;if(k=we===0){var z=String(u.D).match(b1)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),k=!u2.test(z?z.toLowerCase():"")}y=k}if(y)ft(u,"complete"),ft(u,"success");else{u.m=6;try{var Q=2<Ui(u)?u.g.statusText:""}catch{Q=""}u.l=Q+" ["+u.Z()+"]",F1(u)}}finally{fh(u)}}}}function fh(u,g){if(u.g){N1(u);let y=u.g,k=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||ft(u,"ready");try{y.onreadystatechange=k}catch{}}}function N1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Ui(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Ui(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),u0(g)}};function M1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function f2(u){let g={};u=(u.g&&2<=Ui(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<u.length;k++){if(A(u[k]))continue;var y=D(u[k]);let z=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();let Q=g[z]||[];g[z]=Q,Q.push(y)}x(g,function(k){return k.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zc(u,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||g}function L1(u){this.Aa=0,this.i=[],this.j=new ea,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zc("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zc("baseRetryDelayMs",5e3,u),this.cb=zc("retryDelaySeedMs",1e4,u),this.Wa=zc("forwardChannelMaxRetries",2,u),this.wa=zc("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new mi(u&&u.concurrentRequestLimit),this.Da=new c2,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=L1.prototype,t.la=8,t.G=1,t.connect=function(u,g,y,k){Sr(0),this.W=u,this.H=g||{},y&&k!==void 0&&(this.H.OSID=y,this.H.OAID=k),this.F=this.X,this.I=G1(this,null,this.W),ph(this)};function m0(u){if(V1(u),u.G==3){var g=u.U++,y=Bi(u.I);if(Rt(y,"SID",u.K),Rt(y,"RID",g),Rt(y,"TYPE","terminate"),Gc(u,y),g=new q(u,u.j,g),g.L=2,g.v=uh(Bi(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.v,y=!0),y||(g.g=q1(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Me(g)}z1(u)}function dh(u){u.g&&(v0(u),u.g.cancel(),u.g=null)}function V1(u){dh(u),u.u&&(o.clearTimeout(u.u),u.u=null),mh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function ph(u){if(!lo(u.h)&&!u.s){u.s=!0;var g=u.Ga;xe||Ae(),Pe||(xe(),Pe=!0),de.add(g,u),u.B=0}}function d2(u,g){return kn(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Zs(d(u.Ga,u,g),H1(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let z=new q(this,this.j,u),Q=this.o;if(this.S&&(Q?(Q=w(Q),C(Q,this.S)):Q=this.S),this.m!==null||this.O||(z.H=Q,Q=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var k=this.i[y];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(g+=k,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=U1(this,z,g),y=Bi(this.I),Rt(y,"RID",u),Rt(y,"CVER",22),this.D&&Rt(y,"X-HTTP-Session-Id",this.D),Gc(this,y),Q&&(this.O?g="headers="+encodeURIComponent(String(R1(Q)))+"&"+g:this.m&&p0(y,this.m,Q)),d0(this.h,z),this.Ua&&Rt(y,"TYPE","init"),this.P?(Rt(y,"$req",g),Rt(y,"SID","null"),z.T=!0,pe(z,y,null)):pe(z,y,g),this.G=2}}else this.G==3&&(u?B1(this,u):this.i.length==0||lo(this.h)||B1(this))};function B1(u,g){var y;g?y=g.l:y=u.U++;let k=Bi(u.I);Rt(k,"SID",u.K),Rt(k,"RID",y),Rt(k,"AID",u.T),Gc(u,k),u.m&&u.o&&p0(k,u.m,u.o),y=new q(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),g&&(u.i=g.D.concat(u.i)),g=U1(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),d0(u.h,y),pe(y,k,g)}function Gc(u,g){u.H&&M(u.H,function(y,k){Rt(g,k,y)}),u.l&&T1({},function(y,k){Rt(g,k,y)})}function U1(u,g,y){y=Math.min(u.i.length,y);var k=u.l?d(u.l.Na,u.l,u):null;e:{var z=u.i;let Q=-1;for(;;){let we=["count="+y];Q==-1?0<y?(Q=z[0].g,we.push("ofs="+Q)):Q=0:we.push("ofs="+Q);let Tt=!0;for(let Cr=0;Cr<y;Cr++){let lt=z[Cr].g,Or=z[Cr].map;if(lt-=Q,0>lt)Q=Math.max(0,z[Cr].g-100),Tt=!1;else try{l2(Or,we,"req"+lt+"_")}catch{k&&k(Or)}}if(Tt){k=we.join("&");break e}}}return u=u.i.splice(0,y),g.D=u,k}function j1(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;xe||Ae(),Pe||(xe(),Pe=!0),de.add(g,u),u.v=0}}function g0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Zs(d(u.Fa,u),H1(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,W1(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Zs(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Sr(10),dh(this),W1(this))};function v0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function W1(u){u.g=new q(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Bi(u.qa);Rt(g,"RID","rpc"),Rt(g,"SID",u.K),Rt(g,"AID",u.T),Rt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Rt(g,"TO",u.ja),Rt(g,"TYPE","xmlhttp"),Gc(u,g),u.m&&u.o&&p0(g,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=uh(Bi(g)),y.m=null,y.P=!0,Se(y,u)}t.Za=function(){this.C!=null&&(this.C=null,dh(this),g0(this),Sr(19))};function mh(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function $1(u,g){var y=null;if(u.g==g){mh(u),v0(u),u.g=null;var k=2}else if(f0(u.h,g))y=g.D,w1(u.h,g),k=1;else return;if(u.G!=0){if(g.o)if(k==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var z=u.B;k=oo(),ft(k,new co(k,y)),ph(u)}else j1(u);else if(z=g.s,z==3||z==0&&0<g.X||!(k==1&&d2(u,g)||k==2&&g0(u)))switch(y&&0<y.length&&(g=u.h,g.i=g.i.concat(y)),z){case 1:na(u,5);break;case 4:na(u,10);break;case 3:na(u,6);break;default:na(u,2)}}}function H1(u,g){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*g}function na(u,g){if(u.j.info("Error code "+g),g==2){var y=d(u.fb,u),k=u.Xa;let z=!k;k=new ra(k||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||ch(k,"https"),uh(k),z?a2(k.toString(),y):o2(k.toString(),y)}else Sr(2);u.G=0,u.l&&u.l.sa(g),z1(u),V1(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Sr(2)):(this.j.info("Failed to ping google.com"),Sr(1))};function z1(u){if(u.G=0,u.ka=[],u.l){let g=E1(u.h);(g.length!=0||u.i.length!=0)&&(_(u.ka,g),_(u.ka,u.i),u.h.i.length=0,m(u.i),u.i.length=0),u.l.ra()}}function G1(u,g,y){var k=y instanceof ra?Bi(y):new ra(y);if(k.g!="")g&&(k.g=g+"."+k.g),lh(k,k.s);else{var z=o.location;k=z.protocol,g=g?g+"."+z.hostname:z.hostname,z=+z.port;var Q=new ra(null);k&&ch(Q,k),g&&(Q.g=g),z&&lh(Q,z),y&&(Q.l=y),k=Q}return y=u.D,g=u.ya,y&&g&&Rt(k,y,g),Rt(k,"VER",u.la),Gc(u,k),k}function q1(u,g,y){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Wt(new Wc({eb:y})):new Wt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function K1(){}t=K1.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function gh(){}gh.prototype.g=function(u,g){return new dn(u,g)};function dn(u,g){jt.call(this),this.g=new L1(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!A(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!A(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ho(this)}v(dn,jt),dn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},dn.prototype.close=function(){m0(this.g)},dn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=Mc(u),u=y);g.i.push(new ta(g.Ya++,u)),g.G==3&&ph(g)},dn.prototype.N=function(){this.g.l=null,delete this.j,m0(this.g),delete this.g,dn.aa.N.call(this)};function X1(u){hs.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(let y in g){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(X1,hs);function Y1(){Vc.call(this),this.status=1}v(Y1,Vc);function ho(u){this.g=u}v(ho,K1),ho.prototype.ua=function(){ft(this.g,"a")},ho.prototype.ta=function(u){ft(this.g,new X1(u))},ho.prototype.sa=function(u){ft(this.g,new Y1)},ho.prototype.ra=function(){ft(this.g,"b")},gh.prototype.createWebChannel=gh.prototype.g,dn.prototype.send=dn.prototype.o,dn.prototype.open=dn.prototype.m,dn.prototype.close=dn.prototype.close,Uv=ss.createWebChannelTransport=function(){return new gh},Bv=ss.getStatEventTarget=function(){return oo()},Vv=ss.Event=Li,Rd=ss.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,$u=ss.ErrorCode=L,V.COMPLETE="complete",Lv=ss.EventType=V,ih.EventType=Qs,Qs.OPEN="a",Qs.CLOSE="b",Qs.ERROR="c",Qs.MESSAGE="d",jt.prototype.listen=jt.prototype.K,gc=ss.WebChannel=ih,Mv=ss.FetchXmlHttpFactory=Wc,Wt.prototype.listenOnce=Wt.prototype.L,Wt.prototype.getLastError=Wt.prototype.Ka,Wt.prototype.getLastErrorCode=Wt.prototype.Ba,Wt.prototype.getStatus=Wt.prototype.Z,Wt.prototype.getResponseJson=Wt.prototype.Oa,Wt.prototype.getResponseText=Wt.prototype.oa,Wt.prototype.send=Wt.prototype.ea,Wt.prototype.setWithCredentials=Wt.prototype.Ha,Nv=ss.XhrIo=Wt}).apply(typeof Dd<"u"?Dd:typeof self<"u"?self:typeof window<"u"?window:{});var CA="@firebase/firestore";var br=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};br.UNAUTHENTICATED=new br(null),br.GOOGLE_CREDENTIALS=new br("google-credentials-uid"),br.FIRST_PARTY=new br("first-party-uid"),br.MOCK_USER=new br("mock-user");var Oc="10.12.5";var Za=new Ws("@firebase/firestore");function Hu(){return Za.logLevel}function Re(t,...e){if(Za.logLevel<=et.DEBUG){let r=e.map(c1);Za.debug(`Firestore (${Oc}): ${t}`,...r)}}function eo(t,...e){if(Za.logLevel<=et.ERROR){let r=e.map(c1);Za.error(`Firestore (${Oc}): ${t}`,...r)}}function Ld(t,...e){if(Za.logLevel<=et.WARN){let r=e.map(c1);Za.warn(`Firestore (${Oc}): ${t}`,...r)}}function c1(t){if(typeof t=="string")return t;try{return function(r){return JSON.stringify(r)}(t)}catch{return t}}function tt(t="Unexpected state"){let e=`FIRESTORE (${Oc}) INTERNAL ASSERTION FAILED: `+t;throw eo(e),new Error(e)}function pr(t,e){t||tt()}function kt(t,e){return t}var he={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ne=class extends Kn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var as=class{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}};var Vd=class{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Hv=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(br.UNAUTHENTICATED))}shutdown(){}},zv=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}},Gv=class{constructor(e){this.t=e,this.currentUser=br.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){let n=this.i,i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve(),s=new as;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new as,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let c=s;e.enqueueRetryable(()=>Z(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},o=c=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?o(c):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new as)}},0),a()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(pr(typeof n.accessToken=="string"),new Vd(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return pr(e===null||typeof e=="string"),new br(e)}},qv=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=br.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Kv=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new qv(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(br.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Xv=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Yv=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){let n=s=>{s.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,Re("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(pr(typeof r.token=="string"),this.R=r.token,new Xv(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function J7(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}var Bd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=J7(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}};function Ct(t,e){return t<e?-1:t>e?1:0}function xc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}var Yr=class t{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ne(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ne(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ne(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ne(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new t(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Ct(this.nanoseconds,e.nanoseconds):Ct(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var rr=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Yr(0,0))}static max(){return new t(new Yr(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ud=class t{constructor(e,r,n){r===void 0?r=0:r>e.length&&tt(),n===void 0?n=e.length-r:n>e.length-r&&tt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let n=Math.min(e.length,r.length);for(let i=0;i<n;i++){let s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}},cr=class t extends Ud{construct(e,r,n){return new t(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let n of e){if(n.indexOf("//")>=0)throw new Ne(he.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new t(r)}static emptyPath(){return new t([])}},Z7=/^[_a-zA-Z][_a-zA-Z0-9]*$/,An=class t extends Ud{construct(e,r,n){return new t(e,r,n)}static isValidIdentifier(e){return Z7.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let r=[],n="",i=0,s=()=>{if(n.length===0)throw new Ne(he.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""},a=!1;for(;i<e.length;){let o=e[i];if(o==="\\"){if(i+1===e.length)throw new Ne(he.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ne(he.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Ne(he.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(r)}static emptyPath(){return new t([])}};var Ze=class t{constructor(e){this.path=e}static fromPath(e){return new t(cr.fromString(e))}static fromName(e){return new t(cr.fromString(e).popFirst(5))}static empty(){return new t(cr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&cr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return cr.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new cr(e.slice()))}};var Qv=class{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}};Qv.UNKNOWN_ID=-1;function ej(t,e){let r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=rr.fromTimestamp(n===1e9?new Yr(r+1,0):new Yr(r,n));return new to(i,Ze.empty(),e)}function tj(t){return new to(t.readTime,t.key,-1)}var to=class t{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new t(rr.min(),Ze.empty(),-1)}static max(){return new t(rr.max(),Ze.empty(),-1)}};function rj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=Ze.comparator(t.documentKey,e.documentKey),r!==0?r:Ct(t.largestBatchId,e.largestBatchId))}var nj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Jv=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function XA(t){return Z(this,null,function*(){if(t.code!==he.FAILED_PRECONDITION||t.message!==nj)throw t;Re("LocalStore","Unexpectedly lost primary lease")})}var ye=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&tt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new t((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof t?r:t.resolve(r)}catch(r){return t.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):t.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):t.reject(r)}static resolve(e){return new t((r,n)=>{r(e)})}static reject(e){return new t((r,n)=>{n(e)})}static waitFor(e){return new t((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=t.resolve(!1);for(let n of e)r=r.next(i=>i?t.resolve(i):n());return r}static forEach(e,r){let n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new t((n,i)=>{let s=e.length,a=new Array(s),o=0;for(let c=0;c<s;c++){let l=c;r(e[l]).next(h=>{a[l]=h,++o,o===s&&n(a)},h=>i(h))}})}static doWhile(e,r){return new t((n,i)=>{let s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}};function ij(t){let e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function i0(t){return t.name==="IndexedDbTransactionError"}var sj=(()=>{class t{constructor(r,n){this.previousValue=r,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(r){return this.previousValue=Math.max(r,this.previousValue),this.previousValue}next(){let r=++this.previousValue;return this.se&&this.se(r),r}}return t.oe=-1,t})();function l1(t){return t==null}function Yu(t){return t===0&&1/t==-1/0}function aj(t){return typeof t=="number"&&Number.isInteger(t)&&!Yu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var oj=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],PK=[...oj,"documentOverlays"],cj=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],lj=cj,uj=[...lj,"indexConfiguration","indexState","indexEntries"];var FK=[...uj,"globals"];function kA(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function eh(t,e){for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function YA(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Sn=class t{constructor(e,r){this.comparator=e,this.root=r||Ni.EMPTY}insert(e,r){return new t(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ni.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ni.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){let e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new _c(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new _c(this.root,e,this.comparator,!1)}getReverseIterator(){return new _c(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new _c(this.root,e,this.comparator,!0)}},_c=class{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ni=class t{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new t(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw tt();let e=this.left.check();if(e!==this.right.check())throw tt();return e+(this.isRed()?0:1)}};Ni.EMPTY=null,Ni.RED=!0,Ni.BLACK=!1;Ni.EMPTY=new class{constructor(){this.size=0}get key(){throw tt()}get value(){throw tt()}get color(){throw tt()}get left(){throw tt()}get right(){throw tt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Ni(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var rn=class t{constructor(e){this.comparator=e,this.data=new Sn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new jd(this.data.getIterator())}getIteratorFrom(e){return new jd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){let i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new t(this.comparator);return r.data=e,r}},jd=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Oi=class t{constructor(e){this.fields=e,e.sort(An.comparator)}static empty(){return new t([])}unionWith(e){let r=new rn(An.comparator);for(let n of this.fields)r=r.add(n);for(let n of e)r=r.add(n);return new t(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return xc(this.fields,e.fields,(r,n)=>r.isEqual(n))}};var Zv=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var cs=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Zv("Invalid base64 string: "+s):s}}(e);return new t(r)}static fromUint8Array(e){let r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new t(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){let n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Ct(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};cs.EMPTY_BYTE_STRING=new cs("");var hj=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function qs(t){if(pr(!!t),typeof t=="string"){let e=0,r=hj.exec(t);if(pr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:dr(t.seconds),nanos:dr(t.nanos)}}function dr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function wc(t){return typeof t=="string"?cs.fromBase64String(t):cs.fromUint8Array(t)}function u1(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function QA(t){let e=t.mapValue.fields.__previous_value__;return u1(e)?QA(e):e}function Wd(t){let e=qs(t.mapValue.fields.__local_write_time__.timestampValue);return new Yr(e.seconds,e.nanos)}var e_=class{constructor(e,r,n,i,s,a,o,c,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}},t_=class t{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Pd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ec(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?u1(t)?4:JA(t)?9007199254740991:10:tt()}function Mi(t,e){if(t===e)return!0;let r=Ec(t);if(r!==Ec(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wd(t).isEqual(Wd(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=qs(i.timestampValue),o=qs(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return wc(i.bytesValue).isEqual(wc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return dr(i.geoPointValue.latitude)===dr(s.geoPointValue.latitude)&&dr(i.geoPointValue.longitude)===dr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return dr(i.integerValue)===dr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=dr(i.doubleValue),o=dr(s.doubleValue);return a===o?Yu(a)===Yu(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return xc(t.arrayValue.values||[],e.arrayValue.values||[],Mi);case 10:return function(i,s){let a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(kA(a)!==kA(o))return!1;for(let c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!Mi(a[c],o[c])))return!1;return!0}(t,e);default:return tt()}}function Qu(t,e){return(t.values||[]).find(r=>Mi(r,e))!==void 0}function Tc(t,e){if(t===e)return 0;let r=Ec(t),n=Ec(e);if(r!==n)return Ct(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Ct(t.booleanValue,e.booleanValue);case 2:return function(s,a){let o=dr(s.integerValue||s.doubleValue),c=dr(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return DA(t.timestampValue,e.timestampValue);case 4:return DA(Wd(t),Wd(e));case 5:return Ct(t.stringValue,e.stringValue);case 6:return function(s,a){let o=wc(s),c=wc(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){let o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){let h=Ct(o[l],c[l]);if(h!==0)return h}return Ct(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){let o=Ct(dr(s.latitude),dr(a.latitude));return o!==0?o:Ct(dr(s.longitude),dr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){let o=s.values||[],c=a.values||[];for(let l=0;l<o.length&&l<c.length;++l){let h=Tc(o[l],c[l]);if(h)return h}return Ct(o.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Pd.mapValue&&a===Pd.mapValue)return 0;if(s===Pd.mapValue)return 1;if(a===Pd.mapValue)return-1;let o=s.fields||{},c=Object.keys(o),l=a.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){let d=Ct(c[f],h[f]);if(d!==0)return d;let p=Tc(o[c[f]],l[h[f]]);if(p!==0)return p}return Ct(c.length,h.length)}(t.mapValue,e.mapValue);default:throw tt()}}function DA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Ct(t,e);let r=qs(t),n=qs(e),i=Ct(r.seconds,n.seconds);return i!==0?i:Ct(r.nanos,n.nanos)}function bc(t){return r_(t)}function r_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){let n=qs(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return wc(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return Ze.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(let s of r.values||[])i?i=!1:n+=",",n+=r_(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){let n=Object.keys(r.fields||{}).sort(),i="{",s=!0;for(let a of n)s?s=!1:i+=",",i+=`${a}:${r_(r.fields[a])}`;return i+"}"}(t.mapValue):tt()}function n_(t){return!!t&&"integerValue"in t}function h1(t){return!!t&&"arrayValue"in t}function Nd(t){return!!t&&"mapValue"in t}function Gu(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return eh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=Gu(n)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=Gu(t.arrayValue.values[r]);return e}return Object.assign({},t)}function JA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Fi=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!Nd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=Gu(r)}setAll(e){let r=An.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){let c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=Gu(a):i.push(o.lastSegment())});let s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){let r=this.field(e.popLast());Nd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return Mi(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];Nd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){eh(r,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new t(Gu(this.value))}};function ZA(t){let e=[];return eh(t.fields,(r,n)=>{let i=new An([r]);if(Nd(n)){let s=ZA(n.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Oi(e)}var Ic=class t{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new t(e,0,rr.min(),rr.min(),rr.min(),Fi.empty(),0)}static newFoundDocument(e,r,n,i){return new t(e,1,r,rr.min(),n,i,0)}static newNoDocument(e,r){return new t(e,2,r,rr.min(),rr.min(),Fi.empty(),0)}static newUnknownDocument(e,r){return new t(e,3,r,rr.min(),rr.min(),Fi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(rr.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Fi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Fi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rr.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Ac=class{constructor(e,r){this.position=e,this.inclusive=r}};function RA(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){let s=e[i],a=t.position[i];if(s.field.isKeyField()?n=Ze.comparator(Ze.fromName(a.referenceValue),r.key):n=Tc(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function PA(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!Mi(t.position[r],e.position[r]))return!1;return!0}var Sc=class{constructor(e,r="asc"){this.field=e,this.dir=r}};function fj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var $d=class{},Ir=class t extends $d{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new s_(e,r,n):r==="array-contains"?new c_(e,n):r==="in"?new l_(e,n):r==="not-in"?new u_(e,n):r==="array-contains-any"?new h_(e,n):new t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new a_(e,n):new o_(e,n)}matches(e){let r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison(Tc(r,this.value)):r!==null&&Ec(this.value)===Ec(r)&&this.matchesComparison(Tc(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return tt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Ks=class t extends $d{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new t(e,r)}matches(e){return eS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function eS(t){return t.op==="and"}function tS(t){return dj(t)&&eS(t)}function dj(t){for(let e of t.filters)if(e instanceof Ks)return!1;return!0}function i_(t){if(t instanceof Ir)return t.field.canonicalString()+t.op.toString()+bc(t.value);if(tS(t))return t.filters.map(e=>i_(e)).join(",");{let e=t.filters.map(r=>i_(r)).join(",");return`${t.op}(${e})`}}function rS(t,e){return t instanceof Ir?function(n,i){return i instanceof Ir&&n.op===i.op&&n.field.isEqual(i.field)&&Mi(n.value,i.value)}(t,e):t instanceof Ks?function(n,i){return i instanceof Ks&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&rS(a,i.filters[o]),!0):!1}(t,e):void tt()}function nS(t){return t instanceof Ir?function(r){return`${r.field.canonicalString()} ${r.op} ${bc(r.value)}`}(t):t instanceof Ks?function(r){return r.op.toString()+" {"+r.getFilters().map(nS).join(" ,")+"}"}(t):"Filter"}var s_=class extends Ir{constructor(e,r,n){super(e,r,n),this.key=Ze.fromName(n.referenceValue)}matches(e){let r=Ze.comparator(e.key,this.key);return this.matchesComparison(r)}},a_=class extends Ir{constructor(e,r){super(e,"in",r),this.keys=iS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}},o_=class extends Ir{constructor(e,r){super(e,"not-in",r),this.keys=iS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}};function iS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>Ze.fromName(n.referenceValue))}var c_=class extends Ir{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return h1(r)&&Qu(r.arrayValue,this.value)}},l_=class extends Ir{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return r!==null&&Qu(this.value.arrayValue,r)}},u_=class extends Ir{constructor(e,r){super(e,"not-in",r)}matches(e){if(Qu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return r!==null&&!Qu(this.value.arrayValue,r)}},h_=class extends Ir{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!h1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>Qu(this.value.arrayValue,n))}};var f_=class{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}};function FA(t,e=null,r=[],n=[],i=null,s=null,a=null){return new f_(t,e,r,n,i,s,a)}function f1(t){let e=kt(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>i_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),l1(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>bc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>bc(n)).join(",")),e.ue=r}return e.ue}function d1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!fj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!rS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!PA(t.startAt,e.startAt)&&PA(t.endAt,e.endAt)}var Cc=class{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function pj(t,e,r,n,i,s,a,o){return new Cc(t,e,r,n,i,s,a,o)}function mj(t){return new Cc(t)}function OA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function gj(t){return t.collectionGroup!==null}function qu(t){let e=kt(t);if(e.ce===null){e.ce=[];let r=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new rn(An.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Sc(s,n))}),r.has(An.keyField().canonicalString())||e.ce.push(new Sc(An.keyField(),n))}return e.ce}function Qa(t){let e=kt(t);return e.le||(e.le=vj(e,qu(t))),e.le}function vj(t,e){if(t.limitType==="F")return FA(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Sc(i.field,s)});let r=t.endAt?new Ac(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Ac(t.startAt.position,t.startAt.inclusive):null;return FA(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function d_(t,e,r){return new Cc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function sS(t,e){return d1(Qa(t),Qa(e))&&t.limitType===e.limitType}function aS(t){return`${f1(Qa(t))}|lt:${t.limitType}`}function zu(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>nS(i)).join(", ")}]`),l1(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>bc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>bc(i)).join(",")),`Target(${n})`}(Qa(t))}; limitType=${t.limitType})`}function p1(t,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):Ze.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(let s of qu(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){let l=RA(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,qu(n),i)||n.endAt&&!function(a,o,c){let l=RA(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,qu(n),i))}(t,e)}function _j(t){return(e,r)=>{let n=!1;for(let i of qu(t)){let s=yj(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function yj(t,e,r){let n=t.field.isKeyField()?Ze.comparator(e.key,r.key):function(s,a,o){let c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?Tc(c,l):tt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return tt()}}var Xs=class{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){eh(this.inner,(r,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return YA(this.inner)}size(){return this.innerSize}};var xj=new Sn(Ze.comparator);function Hd(){return xj}var oS=new Sn(Ze.comparator);function Fd(...t){let e=oS;for(let r of t)e=e.insert(r.key,r);return e}function cS(t){let e=oS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function Ya(){return Ku()}function lS(){return Ku()}function Ku(){return new Xs(t=>t.toString(),(t,e)=>t.isEqual(e))}var wj=new Sn(Ze.comparator),Ej=new rn(Ze.comparator);function Xr(...t){let e=Ej;for(let r of t)e=e.add(r);return e}var Tj=new rn(Ct);function bj(){return Tj}function uS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yu(e)?"-0":e}}function hS(t){return{integerValue:""+t}}function Ij(t,e){return aj(e)?hS(e):uS(t,e)}var kc=class{constructor(){this._=void 0}};function Aj(t,e,r){return t instanceof Dc?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&u1(s)&&(s=QA(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof ro?dS(t,e):t instanceof no?pS(t,e):function(i,s){let a=fS(i,s),o=NA(a)+NA(i.Pe);return n_(a)&&n_(i.Pe)?hS(o):uS(i.serializer,o)}(t,e)}function Sj(t,e,r){return t instanceof ro?dS(t,e):t instanceof no?pS(t,e):r}function fS(t,e){return t instanceof Rc?function(n){return n_(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var Dc=class extends kc{},ro=class extends kc{constructor(e){super(),this.elements=e}};function dS(t,e){let r=mS(e);for(let n of t.elements)r.some(i=>Mi(i,n))||r.push(n);return{arrayValue:{values:r}}}var no=class extends kc{constructor(e){super(),this.elements=e}};function pS(t,e){let r=mS(e);for(let n of t.elements)r=r.filter(i=>!Mi(i,n));return{arrayValue:{values:r}}}var Rc=class extends kc{constructor(e,r){super(),this.serializer=e,this.Pe=r}};function NA(t){return dr(t.integerValue||t.doubleValue)}function mS(t){return h1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function Cj(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof ro&&i instanceof ro||n instanceof no&&i instanceof no?xc(n.elements,i.elements,Mi):n instanceof Rc&&i instanceof Rc?Mi(n.Pe,i.Pe):n instanceof Dc&&i instanceof Dc}(t.transform,e.transform)}var p_=class{constructor(e,r){this.version=e,this.transformResults=r}},Ja=class t{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Md(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Pc=class{};function gS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new zd(t.key,Ja.none()):new io(t.key,t.data,Ja.none());{let r=t.data,n=Fi.empty(),i=new rn(An.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new ls(t.key,n,new Oi(i.toArray()),Ja.none())}}function kj(t,e,r){t instanceof io?function(i,s,a){let o=i.value.clone(),c=LA(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof ls?function(i,s,a){if(!Md(i.precondition,s))return void s.convertToUnknownDocument(a.version);let o=LA(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(vS(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function Xu(t,e,r,n){return t instanceof io?function(s,a,o,c){if(!Md(s.precondition,a))return o;let l=s.value.clone(),h=VA(s.fieldTransforms,c,a);return l.setAll(h),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof ls?function(s,a,o,c){if(!Md(s.precondition,a))return o;let l=VA(s.fieldTransforms,c,a),h=a.data;return h.setAll(vS(s)),h.setAll(l),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,a,o){return Md(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function Dj(t,e){let r=null;for(let n of t.fieldTransforms){let i=e.data.field(n.field),s=fS(n.transform,i||null);s!=null&&(r===null&&(r=Fi.empty()),r.set(n.field,s))}return r||null}function MA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&xc(n,i,(s,a)=>Cj(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var io=class extends Pc{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},ls=class extends Pc{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function vS(t){let e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=t.data.field(r);e.set(r,n)}}),e}function LA(t,e,r){let n=new Map;pr(t.length===r.length);for(let i=0;i<r.length;i++){let s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,Sj(a,o,r[i]))}return n}function VA(t,e,r){let n=new Map;for(let i of t){let s=i.transform,a=r.data.field(i.field);n.set(i.field,Aj(s,a,e))}return n}var zd=class extends Pc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},m_=class extends Pc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var g_=class{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){let n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&kj(s,e,n[i])}}applyToLocalView(e,r){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(r=Xu(n,e,r,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(r=Xu(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let n=lS();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;let c=gS(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(rr.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Xr())}isEqual(e){return this.batchId===e.batchId&&xc(this.mutations,e.mutations,(r,n)=>MA(r,n))&&xc(this.baseMutations,e.baseMutations,(r,n)=>MA(r,n))}},v_=class t{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){pr(e.mutations.length===n.length);let i=function(){return wj}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new t(e,r,n,i)}};var __=class{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ar,it;function Rj(t){switch(t){default:return tt();case he.CANCELLED:case he.UNKNOWN:case he.DEADLINE_EXCEEDED:case he.RESOURCE_EXHAUSTED:case he.INTERNAL:case he.UNAVAILABLE:case he.UNAUTHENTICATED:return!1;case he.INVALID_ARGUMENT:case he.NOT_FOUND:case he.ALREADY_EXISTS:case he.PERMISSION_DENIED:case he.FAILED_PRECONDITION:case he.ABORTED:case he.OUT_OF_RANGE:case he.UNIMPLEMENTED:case he.DATA_LOSS:return!0}}function Pj(t){if(t===void 0)return eo("GRPC error has no .code"),he.UNKNOWN;switch(t){case ar.OK:return he.OK;case ar.CANCELLED:return he.CANCELLED;case ar.UNKNOWN:return he.UNKNOWN;case ar.DEADLINE_EXCEEDED:return he.DEADLINE_EXCEEDED;case ar.RESOURCE_EXHAUSTED:return he.RESOURCE_EXHAUSTED;case ar.INTERNAL:return he.INTERNAL;case ar.UNAVAILABLE:return he.UNAVAILABLE;case ar.UNAUTHENTICATED:return he.UNAUTHENTICATED;case ar.INVALID_ARGUMENT:return he.INVALID_ARGUMENT;case ar.NOT_FOUND:return he.NOT_FOUND;case ar.ALREADY_EXISTS:return he.ALREADY_EXISTS;case ar.PERMISSION_DENIED:return he.PERMISSION_DENIED;case ar.FAILED_PRECONDITION:return he.FAILED_PRECONDITION;case ar.ABORTED:return he.ABORTED;case ar.OUT_OF_RANGE:return he.OUT_OF_RANGE;case ar.UNIMPLEMENTED:return he.UNIMPLEMENTED;case ar.DATA_LOSS:return he.DATA_LOSS;default:return tt()}}(it=ar||(ar={}))[it.OK=0]="OK",it[it.CANCELLED=1]="CANCELLED",it[it.UNKNOWN=2]="UNKNOWN",it[it.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",it[it.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",it[it.NOT_FOUND=5]="NOT_FOUND",it[it.ALREADY_EXISTS=6]="ALREADY_EXISTS",it[it.PERMISSION_DENIED=7]="PERMISSION_DENIED",it[it.UNAUTHENTICATED=16]="UNAUTHENTICATED",it[it.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",it[it.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",it[it.ABORTED=10]="ABORTED",it[it.OUT_OF_RANGE=11]="OUT_OF_RANGE",it[it.UNIMPLEMENTED=12]="UNIMPLEMENTED",it[it.INTERNAL=13]="INTERNAL",it[it.UNAVAILABLE=14]="UNAVAILABLE",it[it.DATA_LOSS=15]="DATA_LOSS";var NK=new Ov([4294967295,4294967295],0);var y_=class{constructor(e,r){this.databaseId=e,this.useProto3Json=r}};function x_(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Fj(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Oj(t,e){return x_(t,e.toTimestamp())}function yc(t){return pr(!!t),rr.fromTimestamp(function(r){let n=qs(r);return new Yr(n.seconds,n.nanos)}(t))}function _S(t,e){return w_(t,e).canonicalString()}function w_(t,e){let r=function(i){return new cr(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function Nj(t){let e=cr.fromString(t);return pr($j(e)),e}function E_(t,e){return _S(t.databaseId,e.path)}function Mj(t){let e=Nj(t);return e.length===4?cr.emptyPath():Vj(e)}function Lj(t){return new cr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Vj(t){return pr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function BA(t,e,r){return{name:E_(t,e),fields:r.value.mapValue.fields}}function Bj(t,e){let r;if(e instanceof io)r={update:BA(t,e.key,e.value)};else if(e instanceof zd)r={delete:E_(t,e.key)};else if(e instanceof ls)r={update:BA(t,e.key,e.data),updateMask:Wj(e.fieldMask)};else{if(!(e instanceof m_))return tt();r={verify:E_(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){let o=a.transform;if(o instanceof Dc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof ro)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof no)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Rc)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw tt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:Oj(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:tt()}(t,e.precondition)),r}function Uj(t,e){return t&&t.length>0?(pr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?yc(i.updateTime):yc(s);return a.isEqual(rr.min())&&(a=yc(s)),new p_(a,i.transformResults||[])}(r,e))):[]}function jj(t){let e=Mj(t.parent),r=t.structuredQuery,n=r.from?r.from.length:0,i=null;if(n>0){pr(n===1);let h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];r.where&&(s=function(f){let d=yS(f);return d instanceof Ks&&tS(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(d=>function(v){return new Sc(vc(v.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(f){let d;return d=typeof f=="object"?f.value:f,l1(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(f){let d=!!f.before,p=f.values||[];return new Ac(p,d)}(r.startAt));let l=null;return r.endAt&&(l=function(f){let d=!f.before,p=f.values||[];return new Ac(p,d)}(r.endAt)),pj(e,i,a,s,o,"F",c,l)}function yS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":let n=vc(r.unaryFilter.field);return Ir.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=vc(r.unaryFilter.field);return Ir.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=vc(r.unaryFilter.field);return Ir.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=vc(r.unaryFilter.field);return Ir.create(a,"!=",{nullValue:"NULL_VALUE"});default:return tt()}}(t):t.fieldFilter!==void 0?function(r){return Ir.create(vc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return tt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return Ks.create(r.compositeFilter.filters.map(n=>yS(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return tt()}}(r.compositeFilter.op))}(t):tt()}function vc(t){return An.fromServerFormat(t.fieldPath)}function Wj(t){let e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function $j(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var T_=class{constructor(e){this.ct=e}};function Hj(t){let e=jj({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?d_(e,e.limit,"L"):e}var Gd=class{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(dr(e.integerValue));else if("doubleValue"in e){let n=dr(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),Yu(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=qs(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(wc(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){let n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?JA(e)?this.dt(r,Number.MAX_SAFE_INTEGER):(this.wt(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.St(e.arrayValue,r),this.ft(r)):tt()}Vt(e,r){this.dt(r,25),this.bt(e,r)}bt(e,r){r.Rt(e)}wt(e,r){let n=e.fields||{};this.dt(r,55);for(let i of Object.keys(n))this.Vt(i,r),this.Tt(n[i],r)}St(e,r){let n=e.values||[];this.dt(r,50);for(let i of n)this.Tt(i,r)}yt(e,r){this.dt(r,37),Ze.fromName(e).path.forEach(n=>{this.dt(r,60),this.bt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}};Gd.Dt=new Gd;var b_=class{constructor(){this.an=new I_}addToCollectionParentIndex(e,r){return this.an.add(r),ye.resolve()}getCollectionParents(e,r){return ye.resolve(this.an.getEntries(r))}addFieldIndex(e,r){return ye.resolve()}deleteFieldIndex(e,r){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,r){return ye.resolve()}getDocumentsMatchingTarget(e,r){return ye.resolve(null)}getIndexType(e,r){return ye.resolve(0)}getFieldIndexes(e,r){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,r){return ye.resolve(to.min())}getMinOffsetFromCollectionGroup(e,r){return ye.resolve(to.min())}updateCollectionGroup(e,r,n){return ye.resolve()}updateIndexEntries(e,r){return ye.resolve()}},I_=class{constructor(){this.index={}}add(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new rn(cr.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new rn(cr.comparator)).toArray()}};var MK=new Uint8Array(0);var Pi=class t{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Pi.DEFAULT_COLLECTION_PERCENTILE=10,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Pi.DEFAULT=new Pi(41943040,Pi.DEFAULT_COLLECTION_PERCENTILE,Pi.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Pi.DISABLED=new Pi(-1,0,0);var Ju=class t{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new t(0)}static Bn(){return new t(-1)}};var A_=class{constructor(){this.changes=new Xs(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,Ic.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let n=this.changes.get(r);return n!==void 0?ye.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var S_=class{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}};var C_=class{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&Xu(n.mutation,i,Oi.empty(),Yr.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Xr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Xr()){let i=Ya();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=Fd();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){let n=Ya();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Xr()))}populateOverlays(e,r,n){let i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=Hd(),a=Ku(),o=function(){return Ku()}();return r.forEach((c,l)=>{let h=n.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof ls)?s=s.insert(l.key,l):h!==void 0?(a.set(l.key,h.mutation.getFieldMask()),Xu(h.mutation,l,h.mutation.getFieldMask(),Yr.now())):a.set(l.key,Oi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,h)=>a.set(l,h)),r.forEach((l,h)=>{var f;return o.set(l,new S_(h,(f=a.get(l))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){let n=Ku(),i=new Sn((a,o)=>a-o),s=Xr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(let o of a)o.keys().forEach(c=>{let l=r.get(c);if(l===null)return;let h=n.get(c)||Oi.empty();h=o.applyToLocalView(l,h),n.set(c,h);let f=(i.get(o.batchId)||Xr()).add(c);i=i.insert(o.batchId,f)})}).next(()=>{let a=[],o=i.getReverseIterator();for(;o.hasNext();){let c=o.getNext(),l=c.key,h=c.value,f=lS();h.forEach(d=>{if(!s.has(d)){let p=gS(r.get(d),n.get(d));p!==null&&f.set(d,p),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,f))}return ye.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return Ze.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):gj(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):ye.resolve(Ya()),o=-1,c=s;return a.next(l=>ye.forEach(l,(h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?ye.resolve():this.remoteDocumentCache.getEntry(e,h).next(d=>{c=c.insert(h,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Xr())).next(h=>({batchId:o,changes:cS(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new Ze(r)).next(n=>{let i=Fd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){let s=r.collectionGroup,a=Fd();return this.indexManager.getCollectionParents(e,s).next(o=>ye.forEach(o,c=>{let l=function(f,d){return new Cc(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(h=>{h.forEach((f,d)=>{a=a.insert(f,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,l)=>{let h=l.getKey();a.get(h)===null&&(a=a.insert(h,Ic.newInvalidDocument(h)))});let o=Fd();return a.forEach((c,l)=>{let h=s.get(c);h!==void 0&&Xu(h.mutation,l,Oi.empty(),Yr.now()),p1(r,l)&&(o=o.insert(c,l))}),o})}};var k_=class{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,r){return ye.resolve(this.lr.get(r))}saveBundleMetadata(e,r){return this.lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:yc(i.createTime)}}(r)),ye.resolve()}getNamedQuery(e,r){return ye.resolve(this.hr.get(r))}saveNamedQuery(e,r){return this.hr.set(r.name,function(i){return{name:i.name,query:Hj(i.bundledQuery),readTime:yc(i.readTime)}}(r)),ye.resolve()}};var D_=class{constructor(){this.overlays=new Sn(Ze.comparator),this.Pr=new Map}getOverlay(e,r){return ye.resolve(this.overlays.get(r))}getOverlays(e,r){let n=Ya();return ye.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),ye.resolve()}removeOverlaysForBatchId(e,r,n){let i=this.Pr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Pr.delete(n)),ye.resolve()}getOverlaysForCollection(e,r,n){let i=Ya(),s=r.length+1,a=new Ze(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return ye.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Sn((l,h)=>l-h),a=this.overlays.getIterator();for(;a.hasNext();){let l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let h=s.get(l.largestBatchId);h===null&&(h=Ya(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let o=Ya(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>o.set(l,h)),!(o.size()>=i)););return ye.resolve(o)}ht(e,r,n){let i=this.overlays.get(n.key);if(i!==null){let a=this.Pr.get(i.largestBatchId).delete(n.key);this.Pr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new __(r,n));let s=this.Pr.get(r);s===void 0&&(s=Xr(),this.Pr.set(r,s)),this.Pr.set(r,s.add(n.key))}};var R_=class{constructor(){this.sessionToken=cs.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,ye.resolve()}};var Zu=class{constructor(){this.Ir=new rn(or.Tr),this.Er=new rn(or.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,r){let n=new or(e,r);this.Ir=this.Ir.add(n),this.Er=this.Er.add(n)}Ar(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Rr(new or(e,r))}Vr(e,r){e.forEach(n=>this.removeReference(n,r))}mr(e){let r=new Ze(new cr([])),n=new or(r,e),i=new or(r,e+1),s=[];return this.Er.forEachInRange([n,i],a=>{this.Rr(a),s.push(a.key)}),s}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){let r=new Ze(new cr([])),n=new or(r,e),i=new or(r,e+1),s=Xr();return this.Er.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){let r=new or(e,0),n=this.Ir.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}},or=class{constructor(e,r){this.key=e,this.yr=r}static Tr(e,r){return Ze.comparator(e.key,r.key)||Ct(e.yr,r.yr)}static dr(e,r){return Ct(e.yr,r.yr)||Ze.comparator(e.key,r.key)}};var P_=class{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.wr=1,this.Sr=new rn(or.Tr)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){let s=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new g_(s,r,n,i);this.mutationQueue.push(a);for(let o of i)this.Sr=this.Sr.add(new or(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ye.resolve(a)}lookupMutationBatch(e,r){return ye.resolve(this.br(r))}getNextMutationBatchAfterBatchId(e,r){let n=r+1,i=this.Dr(n),s=i<0?0:i;return ye.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?-1:this.wr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let n=new or(r,0),i=new or(r,Number.POSITIVE_INFINITY),s=[];return this.Sr.forEachInRange([n,i],a=>{let o=this.br(a.yr);s.push(o)}),ye.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new rn(Ct);return r.forEach(i=>{let s=new or(i,0),a=new or(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([s,a],o=>{n=n.add(o.yr)})}),ye.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){let n=r.path,i=n.length+1,s=n;Ze.isDocumentKey(s)||(s=s.child(""));let a=new or(new Ze(s),0),o=new rn(Ct);return this.Sr.forEachWhile(c=>{let l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.yr)),!0)},a),ye.resolve(this.Cr(o))}Cr(e){let r=[];return e.forEach(n=>{let i=this.br(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){pr(this.vr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Sr;return ye.forEach(r.mutations,i=>{let s=new or(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=n})}xn(e){}containsKey(e,r){let n=new or(r,0),i=this.Sr.firstAfterOrEqual(n);return ye.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}vr(e,r){return this.Dr(e)}Dr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}br(e){let r=this.Dr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}};var F_=class{constructor(e){this.Fr=e,this.docs=function(){return new Sn(Ze.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Fr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let n=this.docs.get(r);return ye.resolve(n?n.document.mutableCopy():Ic.newInvalidDocument(r))}getEntries(e,r){let n=Hd();return r.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Ic.newInvalidDocument(i))}),ye.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=Hd(),a=r.path,o=new Ze(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||rj(tj(h),n)<=0||(i.has(h.key)||p1(r,h))&&(s=s.insert(h.key,h.mutableCopy()))}return ye.resolve(s)}getAllFromCollectionGroup(e,r,n,i){tt()}Mr(e,r){return ye.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new O_(this)}getSize(e){return ye.resolve(this.size)}},O_=class extends A_{constructor(e){super(),this.ur=e}applyChanges(e){let r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.ur.addEntry(e,i)):this.ur.removeEntry(n)}),ye.waitFor(r)}getFromCache(e,r){return this.ur.getEntry(e,r)}getAllFromCache(e,r){return this.ur.getEntries(e,r)}};var N_=class{constructor(e){this.persistence=e,this.Or=new Xs(r=>f1(r),d1),this.lastRemoteSnapshotVersion=rr.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new Zu,this.targetCount=0,this.Br=Ju.Ln()}forEachTarget(e,r){return this.Or.forEach((n,i)=>r(i)),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Nr&&(this.Nr=r),ye.resolve()}Qn(e){this.Or.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this.Br=new Ju(r),this.highestTargetId=r),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,r){return this.Qn(r),this.targetCount+=1,ye.resolve()}updateTargetData(e,r){return this.Qn(r),ye.resolve()}removeTargetData(e,r){return this.Or.delete(r.target),this.Lr.mr(r.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,r,n){let i=0,s=[];return this.Or.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Or.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),ye.waitFor(s).next(()=>i)}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,r){let n=this.Or.get(r)||null;return ye.resolve(n)}addMatchingKeys(e,r,n){return this.Lr.Ar(r,n),ye.resolve()}removeMatchingKeys(e,r,n){this.Lr.Vr(r,n);let i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),ye.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Lr.mr(r),ye.resolve()}getMatchingKeysForTargetId(e,r){let n=this.Lr.pr(r);return ye.resolve(n)}containsKey(e,r){return ye.resolve(this.Lr.containsKey(r))}};var M_=class{constructor(e,r){this.kr={},this.overlays={},this.qr=new sj(0),this.Qr=!1,this.Qr=!0,this.Kr=new R_,this.referenceDelegate=e(this),this.$r=new N_(this),this.indexManager=new b_,this.remoteDocumentCache=function(i){return new F_(i)}(n=>this.referenceDelegate.Ur(n)),this.serializer=new T_(r),this.Wr=new k_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new D_,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.kr[e.toKey()];return n||(n=new P_(r,this.referenceDelegate),this.kr[e.toKey()]=n),n}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,r,n){Re("MemoryPersistence","Starting transaction:",e);let i=new L_(this.qr.next());return this.referenceDelegate.Gr(),n(i).next(s=>this.referenceDelegate.zr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}jr(e,r){return ye.or(Object.values(this.kr).map(n=>()=>n.containsKey(e,r)))}},L_=class extends Jv{constructor(e){super(),this.currentSequenceNumber=e}},V_=class t{constructor(e){this.persistence=e,this.Hr=new Zu,this.Jr=null}static Yr(e){return new t(e)}get Zr(){if(this.Jr)return this.Jr;throw tt()}addReference(e,r,n){return this.Hr.addReference(n,r),this.Zr.delete(n.toString()),ye.resolve()}removeReference(e,r,n){return this.Hr.removeReference(n,r),this.Zr.add(n.toString()),ye.resolve()}markPotentiallyOrphaned(e,r){return this.Zr.add(r.toString()),ye.resolve()}removeTarget(e,r){this.Hr.mr(r.targetId).forEach(i=>this.Zr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Zr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Gr(){this.Jr=new Set}zr(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.Zr,n=>{let i=Ze.fromPath(n);return this.Xr(e,i).next(s=>{s||r.removeEntry(i,rr.min())})}).next(()=>(this.Jr=null,r.apply(e)))}updateLimboDocument(e,r){return this.Xr(e,r).next(n=>{n?this.Zr.delete(r.toString()):this.Zr.add(r.toString())})}Ur(e){return 0}Xr(e,r){return ye.or([()=>ye.resolve(this.Hr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.jr(e,r)])}};var B_=class t{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Ki=n,this.$i=i}static Ui(e,r){let n=Xr(),i=Xr();for(let s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,r.fromCache,n,i)}};var U_=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var j_=class{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=function(){return WI()?8:ij(In())>0?6:4}()}initialize(e,r){this.Hi=e,this.indexManager=r,this.Wi=!0}getDocumentsMatchingQuery(e,r,n,i){let s={result:null};return this.Ji(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Yi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new U_;return this.Zi(e,r,a).next(o=>{if(s.result=o,this.Gi)return this.Xi(e,r,a,o.size)})}).next(()=>s.result)}Xi(e,r,n,i){return n.documentReadCount<this.zi?(Hu()<=et.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",zu(r),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),ye.resolve()):(Hu()<=et.DEBUG&&Re("QueryEngine","Query:",zu(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ji*i?(Hu()<=et.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",zu(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qa(r))):ye.resolve())}Ji(e,r){if(OA(r))return ye.resolve(null);let n=Qa(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=d_(r,null,"F"),n=Qa(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=Xr(...s);return this.Hi.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{let l=this.es(r,o);return this.ts(r,l,a,c.readTime)?this.Ji(e,d_(r,null,"F")):this.ns(e,l,r,c)}))})))}Yi(e,r,n,i){return OA(r)||i.isEqual(rr.min())?ye.resolve(null):this.Hi.getDocuments(e,n).next(s=>{let a=this.es(r,s);return this.ts(r,a,n,i)?ye.resolve(null):(Hu()<=et.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),zu(r)),this.ns(e,a,r,ej(i,-1)).next(o=>o))})}es(e,r){let n=new rn(_j(e));return r.forEach((i,s)=>{p1(e,s)&&(n=n.add(s))}),n}ts(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;let s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Zi(e,r,n){return Hu()<=et.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",zu(r)),this.Hi.getDocumentsMatchingQuery(e,r,to.min(),n)}ns(e,r,n,i){return this.Hi.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}};var W_=class{constructor(e,r,n,i){this.persistence=e,this.rs=r,this.serializer=i,this.ss=new Sn(Ct),this.os=new Xs(s=>f1(s),d1),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(n)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new C_(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.ss))}};function zj(t,e,r,n){return new W_(t,e,r,n)}function xS(t,e){return Z(this,null,function*(){let r=kt(t);return yield r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.cs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{let a=[],o=[],c=Xr();for(let l of i){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of s){o.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(l=>({ls:l,removedBatchIds:a,addedBatchIds:o}))})})})}function Gj(t,e){let r=kt(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=r.us.newChangeBuffer({trackRemovals:!0});return function(o,c,l,h){let f=l.batch,d=f.keys(),p=ye.resolve();return d.forEach(v=>{p=p.next(()=>h.getEntry(c,v)).next(m=>{let _=l.docVersions.get(v);pr(_!==null),m.version.compareTo(_)<0&&(f.applyToRemoteDocument(m,l),m.isValidDocument()&&(m.setReadTime(l.commitVersion),h.addEntry(m)))})}),p.next(()=>o.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Xr();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function qj(t){let e=kt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.$r.getLastRemoteSnapshotVersion(r))}function Kj(t,e){let r=kt(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}var qd=class{constructor(){this.activeTargetIds=bj()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var $_=class{constructor(){this.io=new qd,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,r,n){this.so[e]=r}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new qd,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var H_=class{oo(e){}shutdown(){}};var Kd=class{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){Re("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.lo)e(0)}co(){Re("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.lo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Od=null;function jv(){return Od===null?Od=function(){return 268435456+Math.round(2147483648*Math.random())}():Od++,"0x"+Od.toString(16)}var Xj={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var z_=class{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}};var Kr="WebChannelConnection",G_=class extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;let n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.bo=n+"://"+r.host,this.Do=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get vo(){return!1}Fo(r,n,i,s,a){let o=jv(),c=this.Mo(r,n.toUriEncodedString());Re("RestConnection",`Sending RPC '${r}' ${o}:`,c,i);let l={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(l,s,a),this.Oo(r,c,l,i).then(h=>(Re("RestConnection",`Received RPC '${r}' ${o}: `,h),h),h=>{throw Ld("RestConnection",`RPC '${r}' ${o} failed with error: `,h,"url: ",c,"request:",i),h})}No(r,n,i,s,a,o){return this.Fo(r,n,i,s,a)}xo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oc}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}Mo(r,n){let i=Xj[r];return`${this.bo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,r,n,i){let s=jv();return new Promise((a,o)=>{let c=new Nv;c.setWithCredentials(!0),c.listenOnce(Lv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case $u.NO_ERROR:let h=c.getResponseJson();Re(Kr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case $u.TIMEOUT:Re(Kr,`RPC '${e}' ${s} timed out`),o(new Ne(he.DEADLINE_EXCEEDED,"Request time out"));break;case $u.HTTP_ERROR:let f=c.getStatus();if(Re(Kr,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let p=d?.error;if(p&&p.status&&p.message){let v=function(_){let T=_.toLowerCase().replace(/_/g,"-");return Object.values(he).indexOf(T)>=0?T:he.UNKNOWN}(p.status);o(new Ne(v,p.message))}else o(new Ne(he.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Ne(he.UNAVAILABLE,"Connection failed."));break;default:tt()}}finally{Re(Kr,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);Re(Kr,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",l,n,15)})}Lo(e,r,n){let i=jv(),s=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Uv(),o=Bv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Mv({})),this.xo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;let h=s.join("");Re(Kr,`Creating RPC '${e}' stream ${i}: ${h}`,c);let f=a.createWebChannel(h,c),d=!1,p=!1,v=new z_({Po:_=>{p?Re(Kr,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(Re(Kr,`Opening RPC '${e}' stream ${i} transport.`),f.open(),d=!0),Re(Kr,`RPC '${e}' stream ${i} sending:`,_),f.send(_))},Io:()=>f.close()}),m=(_,T,A)=>{_.listen(T,b=>{try{A(b)}catch(N){setTimeout(()=>{throw N},0)}})};return m(f,gc.EventType.OPEN,()=>{p||(Re(Kr,`RPC '${e}' stream ${i} transport opened.`),v.po())}),m(f,gc.EventType.CLOSE,()=>{p||(p=!0,Re(Kr,`RPC '${e}' stream ${i} transport closed`),v.wo())}),m(f,gc.EventType.ERROR,_=>{p||(p=!0,Ld(Kr,`RPC '${e}' stream ${i} transport errored:`,_),v.wo(new Ne(he.UNAVAILABLE,"The operation could not be completed")))}),m(f,gc.EventType.MESSAGE,_=>{var T;if(!p){let A=_.data[0];pr(!!A);let b=A,N=b.error||((T=b[0])===null||T===void 0?void 0:T.error);if(N){Re(Kr,`RPC '${e}' stream ${i} received error:`,N);let B=N.status,M=function(E){let C=ar[E];if(C!==void 0)return Pj(C)}(B),x=N.message;M===void 0&&(M=he.INTERNAL,x="Unknown error status: "+B+" with message "+N.message),p=!0,v.wo(new Ne(M,x)),f.close()}else Re(Kr,`RPC '${e}' stream ${i} received:`,A),v.So(A)}}),m(o,Vv.STAT_EVENT,_=>{_.stat===Rd.PROXY?Re(Kr,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===Rd.NOPROXY&&Re(Kr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.yo()},0),v}};function Wv(){return typeof document<"u"?document:null}function s0(t){return new y_(t,!0)}var Xd=class{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ai=e,this.timerId=r,this.Bo=n,this.ko=i,this.qo=s,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();let r=Math.floor(this.Qo+this.Go()),n=Math.max(0,Date.now()-this.$o),i=Math.max(0,r-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){this.Ko!==null&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){this.Ko!==null&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}};var q_=class{constructor(e,r,n,i,s,a,o,c){this.ai=e,this.jo=n,this.Ho=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new Xd(e,r)}t_(){return this.state===1||this.state===5||this.n_()}n_(){return this.state===2||this.state===3}start(){this.Xo=0,this.state!==4?this.auth():this.r_()}stop(){return Z(this,null,function*(){this.t_()&&(yield this.close(0))})}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&this.Yo===null&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}o_(){return Z(this,null,function*(){if(this.n_())return this.close(0)})}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}close(e,r){return Z(this,null,function*(){this.a_(),this.u_(),this.e_.cancel(),this.Jo++,e!==4?this.e_.reset():r&&r.code===he.RESOURCE_EXHAUSTED?(eo(r.toString()),eo("Using maximum backoff delay to prevent overloading the backend."),this.e_.Uo()):r&&r.code===he.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.c_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Vo(r)})}c_(){}auth(){this.state=1;let e=this.l_(this.Jo),r=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Jo===r&&this.h_(n,i)},n=>{e(()=>{let i=new Ne(he.UNKNOWN,"Fetching auth token failed: "+n.message);return this.P_(i)})})}h_(e,r){let n=this.l_(this.Jo);this.stream=this.I_(e,r),this.stream.To(()=>{n(()=>this.listener.To())}),this.stream.Ao(()=>{n(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{n(()=>this.P_(i))}),this.stream.onMessage(i=>{n(()=>++this.Xo==1?this.T_(i):this.onNext(i))})}r_(){this.state=5,this.e_.Wo(()=>Z(this,null,function*(){this.state=0,this.start()}))}P_(e){return Re("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return r=>{this.ai.enqueueAndForget(()=>this.Jo===e?r():(Re("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var K_=class extends q_{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,r){return this.connection.Lo("Write",e,r)}T_(e){return pr(!!e.streamToken),this.lastStreamToken=e.streamToken,pr(!e.writeResults||e.writeResults.length===0),this.listener.m_()}onNext(e){pr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();let r=Uj(e.writeResults,e.commitTime),n=yc(e.commitTime);return this.listener.f_(n,r)}g_(){let e={};e.database=Lj(this.serializer),this.__(e)}V_(e){let r={streamToken:this.lastStreamToken,writes:e.map(n=>Bj(this.serializer,n))};this.__(r)}};var X_=class extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new Ne(he.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,r,n,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Fo(e,w_(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ne(he.UNKNOWN,s.toString())})}No(e,r,n,i,s){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.No(e,w_(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ne(he.UNKNOWN,a.toString())})}terminate(){this.p_=!0,this.connection.terminate()}},Y_=class{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){this.w_===0&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){this.state==="Online"?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,e==="Online"&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(eo(r),this.b_=!1):Re("OnlineStateTracker",r)}M_(){this.S_!==null&&(this.S_.cancel(),this.S_=null)}};var Q_=class{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=s,this.B_.oo(a=>{n.enqueueAndForget(()=>Z(this,null,function*(){rh(this)&&(Re("RemoteStore","Restarting streams for network reachability change."),yield function(c){return Z(this,null,function*(){let l=kt(c);l.N_.add(4),yield th(l),l.k_.set("Unknown"),l.N_.delete(4),yield a0(l)})}(this))}))}),this.k_=new Y_(n,i)}};function a0(t){return Z(this,null,function*(){if(rh(t))for(let e of t.L_)yield e(!0)})}function th(t){return Z(this,null,function*(){for(let e of t.L_)yield e(!1)})}function rh(t){return kt(t).N_.size===0}function wS(t,e,r){return Z(this,null,function*(){if(!i0(e))throw e;t.N_.add(1),yield th(t),t.k_.set("Offline"),r||(r=()=>qj(t.localStore)),t.asyncQueue.enqueueRetryable(()=>Z(this,null,function*(){Re("RemoteStore","Retrying IndexedDB access"),yield r(),t.N_.delete(1),yield a0(t)}))})}function ES(t,e){return e().catch(r=>wS(t,r,e))}function o0(t){return Z(this,null,function*(){let e=kt(t),r=Ys(e),n=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;Yj(e);)try{let i=yield Kj(e.localStore,n);if(i===null){e.x_.length===0&&r.s_();break}n=i.batchId,Qj(e,i)}catch(i){yield wS(e,i)}TS(e)&&bS(e)})}function Yj(t){return rh(t)&&t.x_.length<10}function Qj(t,e){t.x_.push(e);let r=Ys(t);r.n_()&&r.R_&&r.V_(e.mutations)}function TS(t){return rh(t)&&!Ys(t).t_()&&t.x_.length>0}function bS(t){Ys(t).start()}function Jj(t){return Z(this,null,function*(){Ys(t).g_()})}function Zj(t){return Z(this,null,function*(){let e=Ys(t);for(let r of t.x_)e.V_(r.mutations)})}function eW(t,e,r){return Z(this,null,function*(){let n=t.x_.shift(),i=v_.from(n,e,r);yield ES(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield o0(t)})}function tW(t,e){return Z(this,null,function*(){e&&Ys(t).R_&&(yield function(n,i){return Z(this,null,function*(){if(function(a){return Rj(a)&&a!==he.ABORTED}(i.code)){let s=n.x_.shift();Ys(n).i_(),yield ES(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield o0(n)}})}(t,e)),TS(t)&&bS(t)})}function UA(t,e){return Z(this,null,function*(){let r=kt(t);r.asyncQueue.verifyOperationInProgress(),Re("RemoteStore","RemoteStore received new credentials");let n=rh(r);r.N_.add(3),yield th(r),n&&r.k_.set("Unknown"),yield r.remoteSyncer.handleCredentialChange(e),r.N_.delete(3),yield a0(r)})}function rW(t,e){return Z(this,null,function*(){let r=kt(t);e?(r.N_.delete(2),yield a0(r)):e||(r.N_.add(2),yield th(r),r.k_.set("Unknown"))})}function Ys(t){return t.K_||(t.K_=function(r,n,i){let s=kt(r);return s.y_(),new K_(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{To:()=>Promise.resolve(),Ao:Jj.bind(null,t),Vo:tW.bind(null,t),m_:Zj.bind(null,t),f_:eW.bind(null,t)}),t.L_.push(e=>Z(this,null,function*(){e?(t.K_.i_(),yield o0(t)):(yield t.K_.stop(),t.x_.length>0&&(Re("RemoteStore",`Stopping write stream with ${t.x_.length} pending writes`),t.x_=[]))}))),t.K_}var J_=class t{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new as,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){let a=Date.now()+n,o=new t(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ne(he.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function IS(t,e){if(eo("AsyncQueue",`${e}: ${t}`),i0(t))return new Ne(he.UNAVAILABLE,`${e}: ${t}`);throw t}var Z_=class{constructor(){this.queries=jA(),this.onlineState="Unknown",this.J_=new Set}terminate(){(function(r,n){let i=kt(r),s=i.queries;i.queries=jA(),s.forEach((a,o)=>{for(let c of o.z_)c.onError(n)})})(this,new Ne(he.ABORTED,"Firestore shutting down"))}};function jA(){return new Xs(t=>aS(t),sS)}function nW(t){t.J_.forEach(e=>{e.next()})}var WA,$A;($A=WA||(WA={})).X_="default",$A.Cache="cache";var e1=class{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.va=new Xs(o=>aS(o),sS),this.Fa=new Map,this.Ma=new Set,this.xa=new Sn(Ze.comparator),this.Oa=new Map,this.Na=new Zu,this.La={},this.Ba=new Map,this.ka=Ju.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return this.qa===!0}};function iW(t,e,r){return Z(this,null,function*(){let n=cW(t);try{let i=yield function(a,o){let c=kt(a),l=Yr.now(),h=o.reduce((p,v)=>p.add(v.key),Xr()),f,d;return c.persistence.runTransaction("Locally write mutations","readwrite",p=>{let v=Hd(),m=Xr();return c.us.getEntries(p,h).next(_=>{v=_,v.forEach((T,A)=>{A.isValidDocument()||(m=m.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(p,v)).next(_=>{f=_;let T=[];for(let A of o){let b=Dj(A,f.get(A.key).overlayedDocument);b!=null&&T.push(new ls(A.key,b,ZA(b.value.mapValue),Ja.exists(!0)))}return c.mutationQueue.addMutationBatch(p,l,T,o)}).next(_=>{d=_;let T=_.applyToLocalDocumentSet(f,m);return c.documentOverlayCache.saveOverlays(p,_.batchId,T)})}).then(()=>({batchId:d.batchId,changes:cS(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.La[a.currentUser.toKey()];l||(l=new Sn(Ct)),l=l.insert(o,c),a.La[a.currentUser.toKey()]=l}(n,i.batchId,r),yield c0(n,i.changes),yield o0(n.remoteStore)}catch(i){let s=IS(i,"Failed to persist write");r.reject(s)}})}function HA(t,e,r){let n=kt(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){let i=[];n.va.forEach((s,a)=>{let o=a.view.Y_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){let c=kt(a);c.onlineState=o;let l=!1;c.queries.forEach((h,f)=>{for(let d of f.z_)d.Y_(o)&&(l=!0)}),l&&nW(c)}(n.eventManager,e),i.length&&n.Ca.E_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function sW(t,e){return Z(this,null,function*(){let r=kt(t),n=e.batch.batchId;try{let i=yield Gj(r.localStore,e);SS(r,n,null),AS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),yield c0(r,i)}catch(i){yield XA(i)}})}function aW(t,e,r){return Z(this,null,function*(){let n=kt(t);try{let i=yield function(a,o){let c=kt(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,o).next(f=>(pr(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(n.localStore,e);SS(n,e,r),AS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),yield c0(n,i)}catch(i){yield XA(i)}})}function AS(t,e){(t.Ba.get(e)||[]).forEach(r=>{r.resolve()}),t.Ba.delete(e)}function SS(t,e,r){let n=kt(t),i=n.La[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.La[n.currentUser.toKey()]=i}}function c0(t,e,r){return Z(this,null,function*(){let n=kt(t),i=[],s=[],a=[];n.va.isEmpty()||(n.va.forEach((o,c)=>{a.push(n.Qa(c,e,r).then(l=>{var h;if((l||r)&&n.isPrimaryClient){let f=l?!l.fromCache:(h=r?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(l){i.push(l);let f=B_.Ui(c.targetId,l);s.push(f)}}))}),yield Promise.all(a),n.Ca.E_(i),yield function(c,l){return Z(this,null,function*(){let h=kt(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>ye.forEach(l,d=>ye.forEach(d.Ki,p=>h.persistence.referenceDelegate.addReference(f,d.targetId,p)).next(()=>ye.forEach(d.$i,p=>h.persistence.referenceDelegate.removeReference(f,d.targetId,p)))))}catch(f){if(!i0(f))throw f;Re("LocalStore","Failed to update sequence numbers: "+f)}for(let f of l){let d=f.targetId;if(!f.fromCache){let p=h.ss.get(d),v=p.snapshotVersion,m=p.withLastLimboFreeSnapshotVersion(v);h.ss=h.ss.insert(d,m)}}})}(n.localStore,s))})}function oW(t,e){return Z(this,null,function*(){let r=kt(t);if(!r.currentUser.isEqual(e)){Re("SyncEngine","User change. New user:",e.toKey());let n=yield xS(r.localStore,e);r.currentUser=e,function(s,a){s.Ba.forEach(o=>{o.forEach(c=>{c.reject(new Ne(he.CANCELLED,a))})}),s.Ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield c0(r,n.ls)}})}function cW(t){let e=kt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=sW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aW.bind(null,e),e}var Yd=class{constructor(){this.synchronizeTabs=!1}initialize(e){return Z(this,null,function*(){this.serializer=s0(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,r){return null}createIndexBackfillerScheduler(e,r){return null}createLocalStore(e){return zj(this.persistence,new j_,e.initialUser,this.serializer)}createPersistence(e){return new M_(V_.Yr,this.serializer)}createSharedClientState(e){return new $_}terminate(){return Z(this,null,function*(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var t1=class{initialize(e,r){return Z(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>HA(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=oW.bind(null,this.syncEngine),yield rW(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new Z_}()}createDatastore(e){let r=s0(e.databaseInfo.databaseId),n=function(s){return new G_(s)}(e.databaseInfo);return function(s,a,o,c){return new X_(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new Q_(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>HA(this.syncEngine,r,0),function(){return Kd.D()?new Kd:new H_}())}createSyncEngine(e,r){return function(i,s,a,o,c,l,h){let f=new e1(i,s,a,o,c,l);return h&&(f.qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}terminate(){return Z(this,null,function*(){var e,r;yield function(i){return Z(this,null,function*(){let s=kt(i);Re("RemoteStore","RemoteStore shutting down."),s.N_.add(5),yield th(s),s.B_.shutdown(),s.k_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}};var r1=class{constructor(e,r,n,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=br.UNAUTHENTICATED,this.clientId=Bd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>Z(this,null,function*(){Re("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(Re("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ne(he.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new as;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>Z(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let n=IS(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function $v(t,e){return Z(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),Re("FirestoreClient","Initializing OfflineComponentProvider");let r=t.configuration;yield e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(i=>Z(this,null,function*(){n.isEqual(i)||(yield xS(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function zA(t,e){return Z(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let r=yield uW(t);Re("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>UA(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>UA(e.remoteStore,i)),t._onlineComponents=e})}function lW(t){return t.name==="FirebaseError"?t.code===he.FAILED_PRECONDITION||t.code===he.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function uW(t){return Z(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Re("FirestoreClient","Using user provided OfflineComponentProvider");try{yield $v(t,t._uninitializedComponentsProvider._offline)}catch(e){let r=e;if(!lW(r))throw r;Ld("Error using user provided cache. Falling back to memory cache: "+r),yield $v(t,new Yd)}}else Re("FirestoreClient","Using default OfflineComponentProvider"),yield $v(t,new Yd);return t._offlineComponents})}function hW(t){return Z(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(Re("FirestoreClient","Using user provided OnlineComponentProvider"),yield zA(t,t._uninitializedComponentsProvider._online)):(Re("FirestoreClient","Using default OnlineComponentProvider"),yield zA(t,new t1))),t._onlineComponents})}function fW(t){return hW(t).then(e=>e.syncEngine)}function CS(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var GA=new Map;function kS(t,e,r){if(!r)throw new Ne(he.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function dW(t,e,r,n){if(e===!0&&n===!0)throw new Ne(he.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function qA(t){if(!Ze.isDocumentKey(t))throw new Ne(he.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function KA(t){if(Ze.isDocumentKey(t))throw new Ne(he.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function m1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":tt()}function DS(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ne(he.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=m1(t);throw new Ne(he.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}var Qd=class{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ne(he.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ne(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}dW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ne(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ne(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ne(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Fc=class{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qd({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ne(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Ne(he.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qd(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new Hv;switch(n.type){case"firstParty":return new Kv(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ne(he.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){let n=GA.get(r);n&&(Re("ComponentProvider","Removing Datastore"),GA.delete(r),n.terminate())}(this),Promise.resolve()}};function RS(t,e,r,n={}){var i;let s=(t=DS(t,Fc))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Ld("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=br.MOCK_USER;else{o=VI(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Ne(he.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new br(l)}t._authCredentials=new zv(new Vd(o,c))}}var n1=class t{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},os=class t{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},Gs=class t extends n1{constructor(e,r,n){super(e,r,mj(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new os(this.firestore,null,new Ze(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function g1(t,e,...r){if(t=fi(t),kS("collection","path",e),t instanceof Fc){let n=cr.fromString(e,...r);return KA(n),new Gs(t,null,n)}{if(!(t instanceof os||t instanceof Gs))throw new Ne(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(cr.fromString(e,...r));return KA(n),new Gs(t.firestore,null,n)}}function PS(t,e,...r){if(t=fi(t),arguments.length===1&&(e=Bd.newId()),kS("doc","path",e),t instanceof Fc){let n=cr.fromString(e,...r);return qA(n),new os(t,null,new Ze(n))}{if(!(t instanceof os||t instanceof Gs))throw new Ne(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(cr.fromString(e,...r));return qA(n),new os(t.firestore,t instanceof Gs?t.converter:null,new Ze(n))}}var i1=class{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new Xd(this,"async_queue_retry"),this.Tu=()=>{let r=Wv();r&&Re("AsyncQueue","Visibility state changed to "+r.visibilityState),this.e_.zo()};let e=Wv();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;let r=Wv();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});let r=new as;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}Au(){return Z(this,null,function*(){if(this.au.length!==0){try{yield this.au[0](),this.au.shift(),this.e_.reset()}catch(e){if(!i0(e))throw e;Re("AsyncQueue","Operation failed with retryable error: "+e)}this.au.length>0&&this.e_.Wo(()=>this.Au())}})}du(e){let r=this._u.then(()=>(this.hu=!0,e().catch(n=>{this.lu=n,this.hu=!1;let i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw eo("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.hu=!1,n))));return this._u=r,r}enqueueAfterDelay(e,r,n){this.Eu(),this.Iu.indexOf(e)>-1&&(r=0);let i=J_.createAndSchedule(this,e,r,n,s=>this.Ru(s));return this.cu.push(i),i}Eu(){this.lu&&tt()}verifyOperationInProgress(){}Vu(){return Z(this,null,function*(){let e;do e=this._u,yield e;while(e!==this._u)})}mu(e){for(let r of this.cu)if(r.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(let r of this.cu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){let r=this.cu.indexOf(e);this.cu.splice(r,1)}};var Jd=class extends Fc{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=function(){return new i1}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||OS(this),this._firestoreClient.terminate()}};function FS(t,e){let r=typeof t=="object"?t:Pu(),n=typeof t=="string"?t:e||"(default)",i=mv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=MI("firestore");s&&RS(i,...s)}return i}function pW(t){return t._firestoreClient||OS(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function OS(t){var e,r,n;let i=t._freezeSettings(),s=function(o,c,l,h){return new e_(o,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,CS(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new r1(t._authCredentials,t._appCheckCredentials,t._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var Zd=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(cs.fromBase64String(e))}catch(r){throw new Ne(he.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new t(cs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var e0=class{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ne(he.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new An(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var t0=class{constructor(e){this._methodName=e}};var r0=class{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ne(he.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ne(he.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Ct(this._lat,e._lat)||Ct(this._long,e._long)}};var mW=/^__.*__$/,s1=class{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new ls(e,this.data,this.fieldMask,r,this.fieldTransforms):new io(e,this.data,r,this.fieldTransforms)}};function NS(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tt()}}var a1=class t{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.Du(e),i}Cu(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return n0(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(e.length===0)throw this.Fu("Document fields must not be empty");if(NS(this.yu)&&mW.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}},o1=class{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||s0(e)}Ou(e,r,n,i=!1){return new a1({yu:e,methodName:r,xu:n,path:An.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function gW(t){let e=t._freezeSettings(),r=s0(t._databaseId);return new o1(t._databaseId,!!e.ignoreUndefinedProperties,r)}function vW(t,e,r,n,i,s={}){let a=t.Ou(s.merge||s.mergeFields?2:0,e,r,i);BS("Data must be an object, but it was:",a,n);let o=LS(n,a),c,l;if(s.merge)c=new Oi(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){let h=[];for(let f of s.mergeFields){let d=_W(e,f,r);if(!a.contains(d))throw new Ne(he.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);wW(h,d)||h.push(d)}c=new Oi(h),l=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=a.fieldTransforms;return new s1(new Fi(o),c,l)}function MS(t,e){if(VS(t=fi(t)))return BS("Unsupported field value:",e,t),LS(t,e);if(t instanceof t0)return function(n,i){if(!NS(i.yu))throw i.Fu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.bu&&e.yu!==4)throw e.Fu("Nested arrays are not supported");return function(n,i){let s=[],a=0;for(let o of n){let c=MS(o,i.vu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=fi(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return Ij(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=Yr.fromDate(n);return{timestampValue:x_(i.serializer,s)}}if(n instanceof Yr){let s=new Yr(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:x_(i.serializer,s)}}if(n instanceof r0)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Zd)return{bytesValue:Fj(i.serializer,n._byteString)};if(n instanceof os){let s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Fu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:_S(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Fu(`Unsupported field value: ${m1(n)}`)}(t,e)}function LS(t,e){let r={};return YA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):eh(t,(n,i)=>{let s=MS(i,e.Su(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function VS(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Yr||t instanceof r0||t instanceof Zd||t instanceof os||t instanceof t0)}function BS(t,e,r){if(!VS(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){let n=m1(r);throw n==="an object"?e.Fu(t+" a custom object"):e.Fu(t+" "+n)}}function _W(t,e,r){if((e=fi(e))instanceof e0)return e._internalPath;if(typeof e=="string")return xW(t,e);throw n0("Field path arguments must be of type string or ",t,!1,void 0,r)}var yW=new RegExp("[~\\*/\\[\\]]");function xW(t,e,r){if(e.search(yW)>=0)throw n0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new e0(...e.split("."))._internalPath}catch{throw n0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function n0(t,e,r,n,i){let s=n&&!n.isEmpty(),a=i!==void 0,o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Ne(he.INVALID_ARGUMENT,o+t+c)}function wW(t,e){return t.some(r=>r.isEqual(e))}function EW(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}function v1(t,e){let r=DS(t.firestore,Jd),n=PS(t),i=EW(t.converter,e);return TW(r,[vW(gW(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,Ja.exists(!1))]).then(()=>n)}function TW(t,e){return function(n,i){let s=new as;return n.asyncQueue.enqueueAndForget(()=>Z(this,null,function*(){return iW(yield fW(n),i,s)})),s.promise}(pW(t),e)}(function(e,r=!0){(function(i){Oc=i})(dc),Hs(new Xn("firestore",(n,{instanceIdentifier:i,options:s})=>{let a=n.getProvider("app").getImmediate(),o=new Jd(new Gv(n.getProvider("auth-internal")),new Yv(n.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ne(he.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new t_(l.options.projectId,h)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),Tr(CA,"4.6.5",e),Tr(CA,"4.6.5","esm2017")})();var so=class{constructor(e){return e}},US="firestore",_1=class{constructor(){return Ou(US)}};var y1=new nt("angularfire2.firestore-instances");function bW(t,e){let r=_v(US,t,e);return r&&new so(r)}function IW(t){return(e,r)=>{let n=e.runOutsideAngular(()=>t(r));return new so(n)}}var AW={provide:_1,deps:[[new gi,y1]]},SW={provide:so,useFactory:bW,deps:[[new gi,y1],qa]};function jS(t,...e){return Tr("angularfire",mc.full,"fst"),Qn([SW,AW,{provide:y1,useFactory:IW(t),multi:!0,deps:[Vt,aa,Nu,Lu,[new gi,kd],[new gi,Fu],...e]}])}var WS=Mu(FS,!0);var l0=(()=>{let e=class e{constructor(){this.firestore=Ce(so),this.toastService=Ce(Zo),this.toast={message:"",type:"",active:!1},this.sugerenciaForm=new Is({nombre:new wi(""),email:new wi(""),mensaje:new wi(""),fecha:new wi(new Date)})}enviarSugerencia(){let n=this.sugerenciaForm.value,i=g1(this.firestore,"sugerencias");v1(i,n).then(()=>{this.toastService.showToast({type:"success",message:"\xA1La sugerencia se ha enviado con \xE9xito! Gracias por tu aporte.",active:!0}),this.sugerenciaForm.reset()}).catch(()=>{this.toastService.showToast({type:"error",message:"No se pudo enviar la sugerencia, int\xE9ntalo nuevamente.",active:!0})}),this.sugerenciaForm.reset()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-contacto"]],standalone:!0,features:[Ht],decls:27,vars:1,consts:[["id","contacto",1,"bg-white"],[1,"bg-white","py-8","lg:py-16","px-4","mx-auto","max-w-screen-xl"],[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"flex-1","flex","flex-col","justify-center","p-4","sm:items-start","sm:text-left","items-center","text-center"],[1,"mb-4","text-4xl","font-extrabold","text-gray-900"],[1,"mb-8","text-gray-500","sm:text-lg","max-w-lg"],[1,"text-gray-700","max-w-lg"],[1,"flex-1","bg-gray-50","p-6","rounded-lg","shadow-md"],["action","#",1,"space-y-6",3,"formGroup"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","email","type","email","id","email","placeholder","mail@mail.com","required","",1,"shadow-sm","bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500","block","w-full","p-2.5"],["for","subject",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","nombre","type","text","id","subject","placeholder","Coloc\xE1 tu nombre para poder ayudarte","required","",1,"block","p-3","w-full","text-sm","text-gray-900","bg-white","rounded-lg","border","border-gray-300","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["for","message",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","mensaje","id","message","rows","6","placeholder","Escrib\xED tu mensaje o sugerencia...",1,"block","p-2.5","w-full","text-sm","text-gray-900","bg-white","rounded-lg","shadow-sm","border","border-gray-300","focus:ring-indigo-500","focus:border-indigo-500"],["type","submit",1,"py-3","px-5","text-sm","font-medium","text-center","text-white","rounded-lg","bg-indigo-600","hover:bg-indigo-500",3,"click"]],template:function(i,s){i&1&&(ae(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"h2",4),ke(5,"Contacto"),le(),ae(6,"p",5),ke(7," \xBFTenes un problema t\xE9cnico? \xBFQueres sugerir nuevas funcionalidades? \xBFNecesitas informaci\xF3n sobre nuestras herramientas? Escribinos. "),le(),ae(8,"p",6),ke(9," Estamos aqu\xED para ayudarte. Envia tus comentarios, errores o sugerencias para poder mejorar juntos el portal. "),le()(),ae(10,"div",7)(11,"form",8)(12,"div")(13,"label",9),ke(14,"Mail"),le(),Ye(15,"input",10),le(),ae(16,"div")(17,"label",11),ke(18,"Nombre"),le(),Ye(19,"input",12),le(),ae(20,"div")(21,"label",13),ke(22,"Mensaje"),le(),Ye(23,"textarea",14),le(),ae(24,"button",15),ut("click",function(){return s.enviarSugerencia()}),ke(25,"Enviar"),le()()()()()(),Ye(26,"app-toast")),i&2&&(Je(11),ur("formGroup",s.sugerenciaForm))},dependencies:[Fo,Po,As,Do,Ro,ma,gf,Nl,Ml,Jf],encapsulation:2});let t=e;return t})();var $S=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-home"]],standalone:!0,features:[Ht],decls:16,vars:0,consts:[[1,"bg-[#f5f5fa]","py-8","h-full","px-4"],[1,"text-2xl","sm:text-3xl","md:text-4xl","lg:text-5xl","font-bold","text-center","text-gray-800"],[1,"text-center","text-sm","sm:text-base","md:text-lg","lg:text-xl","text-gray-600","mb-12","max-w-[22rem]","md:max-w-[38rem]","lg:max-w-2xl","mx-auto","mt-2"],[1,"flex","flex-wrap","gap-4","justify-center"],["routerLink","/evaluaciones",1,"flex","flex-col","items-center","cursor-pointer","bg-white","shadow-md","rounded-lg","p-6","text-center","relative","hover:shadow-lg","transition-shadow","duration-300","w-full","sm:w-1/2","md:w-1/3","lg:w-1/4","xl:w-1/6","max-h-64"],[1,"mb-4"],["width","48","height","48","src","https://img.icons8.com/fluency/48/untested--v1.png"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-center","text-sm","text-wrap","tracking-tight","text-gray-600","mt-2"],[1,"absolute","top-2","right-2","text-white","text-xs","font-bold","py-1","px-2","rounded-full","shadow-md","bg-cyan-600"]],template:function(i,s){i&1&&(ae(0,"section",0)(1,"h2",1),ke(2," Herramientas Automatizadas para Docentes "),le(),ae(3,"p",2),ke(4," Nuestras herramientas online son completamente gratuitas y est\xE1n dise\xF1adas para facilitar las tareas diarias de los docentes. \xA1Simplifica tu trabajo con un par de clics! "),le(),ae(5,"div",3)(6,"div",4)(7,"div",5),Ye(8,"img",6),le(),ae(9,"h3",7),ke(10,"Evaluaciones"),le(),ae(11,"p",8),ke(12,"Defin\xED las preguntas y nosotros las ordenamos de forma \xFAnica para cada estudiante."),le(),ae(13,"div",9),ke(14," \xA1Nuevo! "),le()()()(),Ye(15,"app-contacto"))},dependencies:[Ix,l0],encapsulation:2});let t=e;return t})();var HS=[{path:"",component:$S,pathMatch:"full"},{path:"evaluaciones",component:RI},{path:"contacto",component:l0}];var CW="@",kW=(()=>{let e=class e{constructor(n,i,s,a,o){this.doc=n,this.delegate=i,this.zone=s,this.animationType=a,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Ce(py,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-P4BIM45E.js")).catch(i=>{throw new It(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:s})=>{this._engine=i(this.animationType,this.doc,this.scheduler);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(n,i){let s=this.delegate.createRenderer(n,i);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let a=new x1(s);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(n,i);a.use(c)}).catch(o=>{a.use(s)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(i){R0()},e.\u0275prov=Fe({token:e,factory:e.\u0275fac});let t=e;return t})(),x1=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let r of this.replay)r(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,r){return this.delegate.createElement(e,r)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,r){this.delegate.appendChild(e,r)}insertBefore(e,r,n,i){this.delegate.insertBefore(e,r,n,i)}removeChild(e,r,n){this.delegate.removeChild(e,r,n)}selectRootElement(e,r){return this.delegate.selectRootElement(e,r)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,r,n,i){this.delegate.setAttribute(e,r,n,i)}removeAttribute(e,r,n){this.delegate.removeAttribute(e,r,n)}addClass(e,r){this.delegate.addClass(e,r)}removeClass(e,r){this.delegate.removeClass(e,r)}setStyle(e,r,n,i){this.delegate.setStyle(e,r,n,i)}removeStyle(e,r,n){this.delegate.removeStyle(e,r,n)}setProperty(e,r,n){this.shouldReplay(r)&&this.replay.push(i=>i.setProperty(e,r,n)),this.delegate.setProperty(e,r,n)}setValue(e,r){this.delegate.setValue(e,r)}listen(e,r,n){return this.shouldReplay(r)&&this.replay.push(i=>i.listen(e,r,n)),this.delegate.listen(e,r,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(CW)}};function zS(t="animations"){return P0("NgAsyncAnimations"),Qn([{provide:Eh,useFactory:(e,r,n)=>new kW(e,r,n,t),deps:[_r,Uh,Vt]},{provide:D0,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var GS={firebaseConfig:{apiKey:"AIzaSyAkCAXhb0PSyTe55CW-yKEH9xcmQC_JcZc",authDomain:"examenapp-a4984.firebaseapp.com",projectId:"examenapp-a4984",storageBucket:"examenapp-a4984.appspot.com",messagingSenderId:"112556396178",appId:"1:112556396178:web:7f8fd791bcd43218bae04b"}};var qS={providers:[Ax(HS),zS(),sA(()=>aA(GS.firebaseConfig)),jS(()=>WS())]};var KS=(()=>{let e=class e{constructor(n,i){this.router=n,this.viewportScroller=i}scrollTo(n){this.router.navigate(["/"]).then(()=>{this.viewportScroller.scrollToAnchor(n)})}};e.\u0275fac=function(i){return new(i||e)(Ue(Al),Ue(M0))},e.\u0275cmp=$t({type:e,selectors:[["app-navbar"]],standalone:!0,features:[Ht],decls:14,vars:0,consts:[[1,"flex","items-center","justify-between","p-5","bg-white","shadow-lg","sticky","top-0","z-10"],[1,"container","mx-auto","flex","items-center","justify-between"],["href","#",1,"flex","items-center","text-2xl","font-semibold","text-gray-900"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"mr-2","h-8","w-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"flex","items-center","gap-5"],["href","#",1,"text-lg","text-gray-700","hover:text-blue-500"],["fragment","contacto",1,"text-lg","text-gray-700","hover:text-blue-500","cursor-pointer",3,"click"]],template:function(i,s){i&1&&(ae(0,"header",0)(1,"div",1)(2,"a",2),Mr(),ae(3,"svg",3),Ye(4,"circle",4)(5,"circle",5)(6,"circle",6),le(),ti(),ae(7,"span"),ke(8,"EvaluAr"),le()(),ae(9,"nav",7)(10,"a",8),ke(11,"Inicio"),le(),ae(12,"a",9),ut("click",function(){return s.scrollTo("contacto")}),ke(13,"Contacto"),le()()()())},encapsulation:2});let t=e;return t})();var XS=(()=>{let e=class e{constructor(){this.anio=new Date().getFullYear()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-footer"]],standalone:!0,features:[Ht],decls:17,vars:1,consts:[[1,"p-4","bg-[f5f5fa]","md:p-8","lg:p-10","border-t-2","border-white","shadow-lg"],[1,"mx-auto","max-w-screen-xl","text-center"],["href","#",1,"flex","justify-center","items-center","text-2xl","font-semibold","text-gray-900"],["width","32","height","32","xmlns","http://www.w3.org/2000/svg",1,"mr-2","h-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"my-6","text-gray-500"],[1,"bg-gray-100","py-4"],[1,"text-sm","text-gray-500","sm:text-center"],["href","https://www.linkedin.com/in/alejandrojorba/",1,"text-blue-500","hover:text-blue-700"]],template:function(i,s){i&1&&(ae(0,"footer",0)(1,"div",1)(2,"a",2),Mr(),ae(3,"svg",3),Ye(4,"circle",4)(5,"circle",5)(6,"circle",6),le(),ke(7," EvaluAr "),le(),ti(),ae(8,"p",7),ke(9,"Este sitio web ha sido desarrollado con el prop\xF3sito de automatizar tareas repetitivas o complejas para los docentes. "),Ye(10,"br"),ke(11," Cabe destacar que este proyecto no tiene ninguna relaci\xF3n con el gobierno."),le(),ae(12,"div",8)(13,"span",9),ke(14),ae(15,"a",10),ke(16,"Alejandro Jorba"),le()()()()()),i&2&&(Je(14),rl("\xA9 ",s.anio," - Desarrollado por "))},encapsulation:2});let t=e;return t})();var YS=(()=>{let e=class e{constructor(){this.title="examenes-app"}runPerformanceTest(){let n=performance.now();for(let a=0;a<1e6;a++);let s=performance.now()-n;return alert(s),s}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=$t({type:e,selectors:[["app-root"]],standalone:!0,features:[Ht],decls:3,vars:0,consts:[[1,"no-print"],[1,"no-print",3,"click"]],template:function(i,s){i&1&&(Ye(0,"app-navbar",0)(1,"router-outlet"),ae(2,"app-footer",1),ut("click",function(){return s.runPerformanceTest()}),le())},dependencies:[ca,Dp,KS,XS]});let t=e;return t})();Wy(YS,qS).catch(t=>console.error(t));
