import{$ as $e,$a as ba,A as V0,Aa as H0,Ab as yr,B as yy,Ba as ml,Bb as X0,C as Ts,Ca as Dy,Cb as Bh,D as bs,Da as Ry,Db as Uh,E as ya,Ea as gl,Eb as jh,F as xy,Fa as De,Fb as Bo,G as B0,Ga as Pe,Gb as wi,H as Is,Ha as z0,Hb as Uy,I as wy,Ia as Fy,Ib as jy,J as xa,Ja as Oh,Jb as ii,K as As,Ka as Ea,Kb as Wy,L as U0,La as G0,Lb as $y,M as Ey,Ma as Wt,Mb as Wh,N as Ty,Na as Nh,Nb as Y0,O as by,Oa as Fr,Ob as $h,P as Iy,Pa as Mo,Q as Rh,Qa as Py,R as Ln,Ra as Oy,S as Fh,Sa as vl,T as hr,Ta as gt,U as kt,Ua as Ss,V as Vn,Va as Me,W as Oe,Wa as Cs,X as Jt,Xa as Z,Y as Ay,Ya as J,Z as it,Za as ze,_ as j0,_a as Ta,a as Ie,aa as Ce,ab as Ki,b as mt,ba as vi,bb as ct,ca as pl,cb as _r,d as te,da as vr,db as ve,e as dy,ea as Dt,eb as _l,f as py,fa as Zt,fb as ks,g as Gi,ga as yt,gb as Ny,h as P0,ha as ti,hb as _n,i as O0,ia as Sy,ib as yn,j as On,ja as No,jb as xn,k as Nn,ka as qi,kb as Pr,l as my,la as ri,lb as Rt,m as gy,ma as _i,mb as yl,n as ws,na as yi,nb as Lo,o as N0,oa as Dr,ob as My,p as M0,pa as xi,pb as Mh,q as L0,qa as gn,qb as Lh,r as nn,ra as W0,rb as q0,s as He,sa as wa,sb as Vh,t as Es,ta as $0,tb as K0,u as vy,ua as vn,ub as Ds,v as _y,va as Rr,vb as Ly,w as nt,wa as Cy,wb as Xi,x as dl,xa as Ph,xb as Vo,y as Mn,ya as ky,yb as Vy,z as Dh,za as ni,zb as By}from"./chunk-TK3U7K4J.js";var wl=class{},zh=class{},Yi=class t{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(r=>{let n=r.indexOf(":");if(n>0){let i=r.slice(0,n),s=i.toLowerCase(),a=r.slice(n+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((r,n)=>{this.setHeaderEntries(n,r)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([r,n])=>{this.setHeaderEntries(r,n)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let r=this.headers.get(e.toLowerCase());return r&&r.length>0?r[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,r){return this.clone({name:e,value:r,op:"a"})}set(e,r){return this.clone({name:e,value:r,op:"s"})}delete(e,r){return this.clone({name:e,value:r,op:"d"})}maybeSetNormalizedName(e,r){this.normalizedNames.has(r)||this.normalizedNames.set(r,e)}init(){this.lazyInit&&(this.lazyInit instanceof t?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(r=>{this.headers.set(r,e.headers.get(r)),this.normalizedNames.set(r,e.normalizedNames.get(r))})}clone(e){let r=new t;return r.lazyInit=this.lazyInit&&this.lazyInit instanceof t?this.lazyInit:this,r.lazyUpdate=(this.lazyUpdate||[]).concat([e]),r}applyUpdate(e){let r=e.name.toLowerCase();switch(e.op){case"a":case"s":let n=e.value;if(typeof n=="string"&&(n=[n]),n.length===0)return;this.maybeSetNormalizedName(e.name,r);let i=(e.op==="a"?this.headers.get(r):void 0)||[];i.push(...n),this.headers.set(r,i);break;case"d":let s=e.value;if(!s)this.headers.delete(r),this.normalizedNames.delete(r);else{let a=this.headers.get(r);if(!a)return;a=a.filter(o=>s.indexOf(o)===-1),a.length===0?(this.headers.delete(r),this.normalizedNames.delete(r)):this.headers.set(r,a)}break}}setHeaderEntries(e,r){let n=(Array.isArray(r)?r:[r]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,n),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(r=>e(this.normalizedNames.get(r),this.headers.get(r)))}};var J0=class{encodeKey(e){return Hy(e)}encodeValue(e){return Hy(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function q2(t,e){let r=new Map;return t.length>0&&t.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,o]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=r.get(a)||[];c.push(o),r.set(a,c)}),r}var K2=/%(\d[a-f0-9])/gi,X2={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Hy(t){return encodeURIComponent(t).replace(K2,(e,r)=>X2[r]??e)}function Hh(t){return`${t}`}var Rs=class t{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new J0,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=q2(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(r=>{let n=e.fromObject[r],i=Array.isArray(n)?n.map(Hh):[Hh(n)];this.map.set(r,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let r=this.map.get(e);return r?r[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,r){return this.clone({param:e,value:r,op:"a"})}appendAll(e){let r=[];return Object.keys(e).forEach(n=>{let i=e[n];Array.isArray(i)?i.forEach(s=>{r.push({param:n,value:s,op:"a"})}):r.push({param:n,value:i,op:"a"})}),this.clone(r)}set(e,r){return this.clone({param:e,value:r,op:"s"})}delete(e,r){return this.clone({param:e,value:r,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let r=this.encoder.encodeKey(e);return this.map.get(e).map(n=>r+"="+this.encoder.encodeValue(n)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let r=new t({encoder:this.encoder});return r.cloneFrom=this.cloneFrom||this,r.updates=(this.updates||[]).concat(e),r}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let r=(e.op==="a"?this.map.get(e.param):void 0)||[];r.push(Hh(e.value)),this.map.set(e.param,r);break;case"d":if(e.value!==void 0){let n=this.map.get(e.param)||[],i=n.indexOf(Hh(e.value));i!==-1&&n.splice(i,1),n.length>0?this.map.set(e.param,n):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Z0=class{constructor(){this.map=new Map}set(e,r){return this.map.set(e,r),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function Y2(t){switch(t){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function zy(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer}function Gy(t){return typeof Blob<"u"&&t instanceof Blob}function qy(t){return typeof FormData<"u"&&t instanceof FormData}function Q2(t){return typeof URLSearchParams<"u"&&t instanceof URLSearchParams}var xl=class t{constructor(e,r,n,i){this.url=r,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(Y2(this.method)||i?(this.body=n!==void 0?n:null,s=i):s=n,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new Yi,this.context??=new Z0,!this.params)this.params=new Rs,this.urlWithParams=r;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=r;else{let o=r.indexOf("?"),c=o===-1?"?":o<r.length-1?"&":"";this.urlWithParams=r+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||zy(this.body)||Gy(this.body)||qy(this.body)||Q2(this.body)?this.body:this.body instanceof Rs?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||qy(this.body)?null:Gy(this.body)?this.body.type||null:zy(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Rs?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let r=e.method||this.method,n=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,o=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,l=e.headers||this.headers,h=e.params||this.params,f=e.context??this.context;return e.setHeaders!==void 0&&(l=Object.keys(e.setHeaders).reduce((d,m)=>d.set(m,e.setHeaders[m]),l)),e.setParams&&(h=Object.keys(e.setParams).reduce((d,m)=>d.set(m,e.setParams[m]),h)),new t(r,n,a,{params:h,headers:l,context:f,reportProgress:c,responseType:i,withCredentials:o,transferCache:s})}},Uo=function(t){return t[t.Sent=0]="Sent",t[t.UploadProgress=1]="UploadProgress",t[t.ResponseHeader=2]="ResponseHeader",t[t.DownloadProgress=3]="DownloadProgress",t[t.Response=4]="Response",t[t.User=5]="User",t}(Uo||{}),El=class{constructor(e,r=Kh.Ok,n="OK"){this.headers=e.headers||new Yi,this.status=e.status!==void 0?e.status:r,this.statusText=e.statusText||n,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},ep=class t extends El{constructor(e={}){super(e),this.type=Uo.ResponseHeader}clone(e={}){return new t({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Gh=class t extends El{constructor(e={}){super(e),this.type=Uo.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new t({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},qh=class extends El{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},Kh=function(t){return t[t.Continue=100]="Continue",t[t.SwitchingProtocols=101]="SwitchingProtocols",t[t.Processing=102]="Processing",t[t.EarlyHints=103]="EarlyHints",t[t.Ok=200]="Ok",t[t.Created=201]="Created",t[t.Accepted=202]="Accepted",t[t.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",t[t.NoContent=204]="NoContent",t[t.ResetContent=205]="ResetContent",t[t.PartialContent=206]="PartialContent",t[t.MultiStatus=207]="MultiStatus",t[t.AlreadyReported=208]="AlreadyReported",t[t.ImUsed=226]="ImUsed",t[t.MultipleChoices=300]="MultipleChoices",t[t.MovedPermanently=301]="MovedPermanently",t[t.Found=302]="Found",t[t.SeeOther=303]="SeeOther",t[t.NotModified=304]="NotModified",t[t.UseProxy=305]="UseProxy",t[t.Unused=306]="Unused",t[t.TemporaryRedirect=307]="TemporaryRedirect",t[t.PermanentRedirect=308]="PermanentRedirect",t[t.BadRequest=400]="BadRequest",t[t.Unauthorized=401]="Unauthorized",t[t.PaymentRequired=402]="PaymentRequired",t[t.Forbidden=403]="Forbidden",t[t.NotFound=404]="NotFound",t[t.MethodNotAllowed=405]="MethodNotAllowed",t[t.NotAcceptable=406]="NotAcceptable",t[t.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",t[t.RequestTimeout=408]="RequestTimeout",t[t.Conflict=409]="Conflict",t[t.Gone=410]="Gone",t[t.LengthRequired=411]="LengthRequired",t[t.PreconditionFailed=412]="PreconditionFailed",t[t.PayloadTooLarge=413]="PayloadTooLarge",t[t.UriTooLong=414]="UriTooLong",t[t.UnsupportedMediaType=415]="UnsupportedMediaType",t[t.RangeNotSatisfiable=416]="RangeNotSatisfiable",t[t.ExpectationFailed=417]="ExpectationFailed",t[t.ImATeapot=418]="ImATeapot",t[t.MisdirectedRequest=421]="MisdirectedRequest",t[t.UnprocessableEntity=422]="UnprocessableEntity",t[t.Locked=423]="Locked",t[t.FailedDependency=424]="FailedDependency",t[t.TooEarly=425]="TooEarly",t[t.UpgradeRequired=426]="UpgradeRequired",t[t.PreconditionRequired=428]="PreconditionRequired",t[t.TooManyRequests=429]="TooManyRequests",t[t.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",t[t.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",t[t.InternalServerError=500]="InternalServerError",t[t.NotImplemented=501]="NotImplemented",t[t.BadGateway=502]="BadGateway",t[t.ServiceUnavailable=503]="ServiceUnavailable",t[t.GatewayTimeout=504]="GatewayTimeout",t[t.HttpVersionNotSupported=505]="HttpVersionNotSupported",t[t.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",t[t.InsufficientStorage=507]="InsufficientStorage",t[t.LoopDetected=508]="LoopDetected",t[t.NotExtended=510]="NotExtended",t[t.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",t}(Kh||{});function Q0(t,e){return{body:e,headers:t.headers,context:t.context,observe:t.observe,params:t.params,reportProgress:t.reportProgress,responseType:t.responseType,withCredentials:t.withCredentials,transferCache:t.transferCache}}var Tl=(()=>{let e=class e{constructor(n){this.handler=n}request(n,i,s={}){let a;if(n instanceof xl)a=n;else{let l;s.headers instanceof Yi?l=s.headers:l=new Yi(s.headers);let h;s.params&&(s.params instanceof Rs?h=s.params:h=new Rs({fromObject:s.params})),a=new xl(n,i,s.body!==void 0?s.body:null,{headers:l,context:s.context,params:h,reportProgress:s.reportProgress,responseType:s.responseType||"json",withCredentials:s.withCredentials,transferCache:s.transferCache})}let o=He(a).pipe(ya(l=>this.handler.handle(l)));if(n instanceof xl||s.observe==="events")return o;let c=o.pipe(Ts(l=>l instanceof Gh));switch(s.observe||"body"){case"body":switch(a.responseType){case"arraybuffer":return c.pipe(nt(l=>{if(l.body!==null&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return c.pipe(nt(l=>{if(l.body!==null&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return c.pipe(nt(l=>{if(l.body!==null&&typeof l.body!="string")throw new Error("Response is not a string.");return l.body}));case"json":default:return c.pipe(nt(l=>l.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${s.observe}}`)}}delete(n,i={}){return this.request("DELETE",n,i)}get(n,i={}){return this.request("GET",n,i)}head(n,i={}){return this.request("HEAD",n,i)}jsonp(n,i){return this.request("JSONP",n,{params:new Rs().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(n,i={}){return this.request("OPTIONS",n,i)}patch(n,i,s={}){return this.request("PATCH",n,Q0(s,i))}post(n,i,s={}){return this.request("POST",n,Q0(s,i))}put(n,i,s={}){return this.request("PUT",n,Q0(s,i))}};e.\u0275fac=function(i){return new(i||e)($e(wl))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})();function Qy(t,e){return e(t)}function J2(t,e){return(r,n)=>e.intercept(r,{handle:i=>t(i,n)})}function Z2(t,e,r){return(n,i)=>qi(r,()=>e(n,s=>t(s,i)))}var eC=new it(""),tp=new it(""),tC=new it(""),rC=new it("");function nC(){let t=null;return(e,r)=>{t===null&&(t=(Ce(eC,{optional:!0})??[]).reduceRight(J2,Qy));let n=Ce(vl),i=n.add();return t(e,r).pipe(xa(()=>n.remove(i)))}}var Ky=(()=>{let e=class e extends wl{constructor(n,i){super(),this.backend=n,this.injector=i,this.chain=null,this.pendingTasks=Ce(vl);let s=Ce(rC,{optional:!0});this.backend=s??n}handle(n){if(this.chain===null){let s=Array.from(new Set([...this.injector.get(tp),...this.injector.get(tC,[])]));this.chain=s.reduceRight((a,o)=>Z2(a,o,this.injector),Qy)}let i=this.pendingTasks.add();return this.chain(n,s=>this.backend.handle(s)).pipe(xa(()=>this.pendingTasks.remove(i)))}};e.\u0275fac=function(i){return new(i||e)($e(zh),$e(No))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})();var iC=/^\)\]\}',?\n/;function sC(t){return"responseURL"in t&&t.responseURL?t.responseURL:/^X-Request-URL:/m.test(t.getAllResponseHeaders())?t.getResponseHeader("X-Request-URL"):null}var Xy=(()=>{let e=class e{constructor(n){this.xhrFactory=n}handle(n){if(n.method==="JSONP")throw new kt(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?nn(i.\u0275loadImpl()):He(null)).pipe(Ln(()=>new Gi(a=>{let o=i.build();if(o.open(n.method,n.urlWithParams),n.withCredentials&&(o.withCredentials=!0),n.headers.forEach((_,T)=>o.setRequestHeader(_,T.join(","))),n.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!n.headers.has("Content-Type")){let _=n.detectContentTypeHeader();_!==null&&o.setRequestHeader("Content-Type",_)}if(n.responseType){let _=n.responseType.toLowerCase();o.responseType=_!=="json"?_:"text"}let c=n.serializeBody(),l=null,h=()=>{if(l!==null)return l;let _=o.statusText||"OK",T=new Yi(o.getAllResponseHeaders()),S=sC(o)||n.url;return l=new ep({headers:T,status:o.status,statusText:_,url:S}),l},f=()=>{let{headers:_,status:T,statusText:S,url:b}=h(),O=null;T!==Kh.NoContent&&(O=typeof o.response>"u"?o.responseText:o.response),T===0&&(T=O?Kh.Ok:0);let V=T>=200&&T<300;if(n.responseType==="json"&&typeof O=="string"){let B=O;O=O.replace(iC,"");try{O=O!==""?JSON.parse(O):null}catch(x){O=B,V&&(V=!1,O={error:x,text:O})}}V?(a.next(new Gh({body:O,headers:_,status:T,statusText:S,url:b||void 0})),a.complete()):a.error(new qh({error:O,headers:_,status:T,statusText:S,url:b||void 0}))},d=_=>{let{url:T}=h(),S=new qh({error:_,status:o.status||0,statusText:o.statusText||"Unknown Error",url:T||void 0});a.error(S)},m=!1,v=_=>{m||(a.next(h()),m=!0);let T={type:Uo.DownloadProgress,loaded:_.loaded};_.lengthComputable&&(T.total=_.total),n.responseType==="text"&&o.responseText&&(T.partialText=o.responseText),a.next(T)},p=_=>{let T={type:Uo.UploadProgress,loaded:_.loaded};_.lengthComputable&&(T.total=_.total),a.next(T)};return o.addEventListener("load",f),o.addEventListener("error",d),o.addEventListener("timeout",d),o.addEventListener("abort",d),n.reportProgress&&(o.addEventListener("progress",v),c!==null&&o.upload&&o.upload.addEventListener("progress",p)),o.send(c),a.next({type:Uo.Sent}),()=>{o.removeEventListener("error",d),o.removeEventListener("abort",d),o.removeEventListener("load",f),o.removeEventListener("timeout",d),n.reportProgress&&(o.removeEventListener("progress",v),c!==null&&o.upload&&o.upload.removeEventListener("progress",p)),o.readyState!==o.DONE&&o.abort()}})))}};e.\u0275fac=function(i){return new(i||e)($e($h))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),Jy=new it(""),aC="XSRF-TOKEN",oC=new it("",{providedIn:"root",factory:()=>aC}),cC="X-XSRF-TOKEN",lC=new it("",{providedIn:"root",factory:()=>cC}),Xh=class{},uC=(()=>{let e=class e{constructor(n,i,s){this.doc=n,this.platform=i,this.cookieName=s,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let n=this.doc.cookie||"";return n!==this.lastCookieString&&(this.parseCount++,this.lastToken=Uh(n,this.cookieName),this.lastCookieString=n),this.lastToken}};e.\u0275fac=function(i){return new(i||e)($e(yr),$e(ni),$e(oC))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})();function hC(t,e){let r=t.url.toLowerCase();if(!Ce(Jy)||t.method==="GET"||t.method==="HEAD"||r.startsWith("http://")||r.startsWith("https://"))return e(t);let n=Ce(Xh).getToken(),i=Ce(lC);return n!=null&&!t.headers.has(i)&&(t=t.clone({headers:t.headers.set(i,n)})),e(t)}var Zy=function(t){return t[t.Interceptors=0]="Interceptors",t[t.LegacyInterceptors=1]="LegacyInterceptors",t[t.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",t[t.NoXsrfProtection=3]="NoXsrfProtection",t[t.JsonpSupport=4]="JsonpSupport",t[t.RequestsMadeViaParent=5]="RequestsMadeViaParent",t[t.Fetch=6]="Fetch",t}(Zy||{});function fC(t,e){return{\u0275kind:t,\u0275providers:e}}function rp(...t){let e=[Tl,Xy,Ky,{provide:wl,useExisting:Ky},{provide:zh,useExisting:Xy},{provide:tp,useValue:hC,multi:!0},{provide:Jy,useValue:!0},{provide:Xh,useClass:uC}];for(let r of t)e.push(...r.\u0275providers);return ti(e)}var Yy=new it("");function dC(){return fC(Zy.LegacyInterceptors,[{provide:Yy,useFactory:nC},{provide:tp,useExisting:Yy,multi:!0}])}var Yh=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({providers:[rp(dC())]});let t=e;return t})();var sp=class extends By{constructor(){super(...arguments),this.supportsDOMEvents=!0}},ap=class t extends sp{static makeCurrent(){Vy(new t)}onAndCancel(e,r,n){return e.addEventListener(r,n),()=>{e.removeEventListener(r,n)}}dispatchEvent(e,r){e.dispatchEvent(r)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,r){return r=r||this.getDefaultDocument(),r.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,r){return r==="window"?window:r==="document"?e:r==="body"?e.body:null}getBaseHref(e){let r=gC();return r==null?null:vC(r)}resetBaseElement(){bl=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Uh(document.cookie,e)}},bl=null;function gC(){return bl=bl||document.querySelector("base"),bl?bl.getAttribute("href"):null}function vC(t){return new URL(t,document.baseURI).pathname}var _C=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),op=new it(""),rx=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(s=>{s.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,s){return this._findPluginFor(i).addEventListener(n,i,s)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(a=>a.supports(n)),!i)throw new kt(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)($e(op),$e(Wt))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),Qh=class{constructor(e){this._doc=e}},np="ng-app-id",nx=(()=>{let e=class e{constructor(n,i,s,a={}){this.doc=n,this.appId=i,this.nonce=s,this.platformId=a,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Wh(a),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(s=>s.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${np}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(n,i){let s=this.styleRef;if(s.has(n)){let a=s.get(n);return a.usage+=i,a.usage}return s.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let s=this.styleNodesInDOM,a=s?.get(i);if(a?.parentNode===n)return s.delete(i),a.removeAttribute(np),a;{let o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=i,this.platformIsServer&&o.setAttribute(np,this.appId),n.appendChild(o),o}}addStyleToHost(n,i){let s=this.getStyleElement(n,i),a=this.styleRef,o=a.get(i)?.elements;o?o.push(s):a.set(i,{elements:[s],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)($e(yr),$e(Ph),$e(ml,8),$e(ni))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),ip={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},lp=/%COMP%/g,ix="%COMP%",yC=`_nghost-${ix}`,xC=`_ngcontent-${ix}`,wC=!0,EC=new it("",{providedIn:"root",factory:()=>wC});function TC(t){return xC.replace(lp,t)}function bC(t){return yC.replace(lp,t)}function sx(t,e){return e.map(r=>r.replace(lp,t))}var Jh=(()=>{let e=class e{constructor(n,i,s,a,o,c,l,h=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=a,this.doc=o,this.platformId=c,this.ngZone=l,this.nonce=h,this.rendererByCompId=new Map,this.platformIsServer=Wh(c),this.defaultRenderer=new Il(n,o,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===pl.ShadowDom&&(i=mt(Ie({},i),{encapsulation:pl.Emulated}));let s=this.getOrCreateRenderer(n,i);return s instanceof Zh?s.applyToHost(n):s instanceof Al&&s.applyStyles(),s}getOrCreateRenderer(n,i){let s=this.rendererByCompId,a=s.get(i.id);if(!a){let o=this.doc,c=this.ngZone,l=this.eventManager,h=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,d=this.platformIsServer;switch(i.encapsulation){case pl.Emulated:a=new Zh(l,h,i,this.appId,f,o,c,d);break;case pl.ShadowDom:return new cp(l,h,n,i,o,c,this.nonce,d);default:a=new Al(l,h,i,f,o,c,d);break}s.set(i.id,a)}return a}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)($e(rx),$e(nx),$e(Ph),$e(EC),$e(yr),$e(ni),$e(Wt),$e(ml))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),Il=class{constructor(e,r,n,i){this.eventManager=e,this.doc=r,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,r){return r?this.doc.createElementNS(ip[r]||r,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,r){(ex(e)?e.content:e).appendChild(r)}insertBefore(e,r,n){e&&(ex(e)?e.content:e).insertBefore(r,n)}removeChild(e,r){e&&e.removeChild(r)}selectRootElement(e,r){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new kt(-5104,!1);return r||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,r,n,i){if(i){r=i+":"+r;let s=ip[i];s?e.setAttributeNS(s,r,n):e.setAttribute(r,n)}else e.setAttribute(r,n)}removeAttribute(e,r,n){if(n){let i=ip[n];i?e.removeAttributeNS(i,r):e.removeAttribute(`${n}:${r}`)}else e.removeAttribute(r)}addClass(e,r){e.classList.add(r)}removeClass(e,r){e.classList.remove(r)}setStyle(e,r,n,i){i&(gl.DashCase|gl.Important)?e.style.setProperty(r,n,i&gl.Important?"important":""):e.style[r]=n}removeStyle(e,r,n){n&gl.DashCase?e.style.removeProperty(r):e.style[r]=""}setProperty(e,r,n){e!=null&&(e[r]=n)}setValue(e,r){e.nodeValue=r}listen(e,r,n){if(typeof e=="string"&&(e=Vo().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${r}`);return this.eventManager.addEventListener(e,r,this.decoratePreventDefault(n))}decoratePreventDefault(e){return r=>{if(r==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(r)):e(r))===!1&&r.preventDefault()}}};function ex(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var cp=class extends Il{constructor(e,r,n,i,s,a,o,c){super(e,s,a,c),this.sharedStylesHost=r,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=sx(i.id,i.styles);for(let h of l){let f=document.createElement("style");o&&f.setAttribute("nonce",o),f.textContent=h,this.shadowRoot.appendChild(f)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,r){return super.appendChild(this.nodeOrShadowRoot(e),r)}insertBefore(e,r,n){return super.insertBefore(this.nodeOrShadowRoot(e),r,n)}removeChild(e,r){return super.removeChild(this.nodeOrShadowRoot(e),r)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Al=class extends Il{constructor(e,r,n,i,s,a,o,c){super(e,s,a,o),this.sharedStylesHost=r,this.removeStylesOnCompDestroy=i,this.styles=c?sx(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Zh=class extends Al{constructor(e,r,n,i,s,a,o,c){let l=i+"-"+n.id;super(e,r,n,s,a,o,c,l),this.contentAttr=TC(l),this.hostAttr=bC(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,r){let n=super.createElement(e,r);return super.setAttribute(n,this.contentAttr,""),n}},IC=(()=>{let e=class e extends Qh{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,s){return n.addEventListener(i,s,!1),()=>this.removeEventListener(n,i,s)}removeEventListener(n,i,s){return n.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)($e(yr))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),tx=["alt","control","meta","shift"],AC={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},SC={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},CC=(()=>{let e=class e extends Qh{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,s){let a=e.parseEventName(i),o=e.eventCallback(a.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Vo().onAndCancel(n,a.domEventName,o))}static parseEventName(n){let i=n.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let a=e._normalizeKey(i.pop()),o="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),o="code."),tx.forEach(h=>{let f=i.indexOf(h);f>-1&&(i.splice(f,1),o+=h+".")}),o+=a,i.length!=0||a.length===0)return null;let l={};return l.domEventName=s,l.fullKey=o,l}static matchEventFullKeyCode(n,i){let s=AC[n.key]||n.key,a="";return i.indexOf("code.")>-1&&(s=n.code,a="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),tx.forEach(o=>{if(o!==s){let c=SC[o];c(n)&&(a+=o+".")}}),a+=s,a===i)}static eventCallback(n,i,s){return a=>{e.matchEventFullKeyCode(a,n)&&s.runGuarded(()=>i(a))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)($e(yr))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})();function ax(t,e){return Ly(Ie({rootComponent:t},kC(e)))}function kC(t){return{appProviders:[...OC,...t?.providers??[]],platformProviders:PC}}function DC(){ap.makeCurrent()}function RC(){return new $0}function FC(){return Cy(document),document}var PC=[{provide:ni,useValue:Wy},{provide:ky,useValue:DC,multi:!0},{provide:yr,useFactory:FC,deps:[]}];var OC=[{provide:Sy,useValue:"root"},{provide:$0,useFactory:RC,deps:[]},{provide:op,useClass:IC,multi:!0,deps:[yr,Wt,ni]},{provide:op,useClass:CC,multi:!0,deps:[yr]},Jh,nx,rx,{provide:Oh,useExisting:Jh},{provide:$h,useClass:_C,deps:[]},[]];var ox=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)($e(yr))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Xe="primary",jl=Symbol("RouteTitle"),pp=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r[0]:r}return null}getAll(e){if(this.has(e)){let r=this.params[e];return Array.isArray(r)?r:[r]}return[]}get keys(){return Object.keys(this.params)}};function zo(t){return new pp(t)}function LC(t,e,r){let n=r.path.split("/");if(n.length>t.length||r.pathMatch==="full"&&(e.hasChildren()||n.length<t.length))return null;let i={};for(let s=0;s<n.length;s++){let a=n[s],o=t[s];if(a.startsWith(":"))i[a.substring(1)]=o;else if(a!==o.path)return null}return{consumed:t.slice(0,n.length),posParams:i}}function VC(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;++r)if(!Ei(t[r],e[r]))return!1;return!0}function Ei(t,e){let r=t?mp(t):void 0,n=e?mp(e):void 0;if(!r||!n||r.length!=n.length)return!1;let i;for(let s=0;s<r.length;s++)if(i=r[s],!mx(t[i],e[i]))return!1;return!0}function mp(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function mx(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let r=[...t].sort(),n=[...e].sort();return r.every((i,s)=>n[s]===i)}else return t===e}function gx(t){return t.length>0?t[t.length-1]:null}function Ns(t){return vy(t)?t:Lh(t)?nn(Promise.resolve(t)):He(t)}var BC={exact:_x,subset:yx},vx={exact:UC,subset:jC,ignored:()=>!0};function cx(t,e,r){return BC[r.paths](t.root,e.root,r.matrixParams)&&vx[r.queryParams](t.queryParams,e.queryParams)&&!(r.fragment==="exact"&&t.fragment!==e.fragment)}function UC(t,e){return Ei(t,e)}function _x(t,e,r){if(!Sa(t.segments,e.segments)||!rf(t.segments,e.segments,r)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!t.children[n]||!_x(t.children[n],e.children[n],r))return!1;return!0}function jC(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(r=>mx(t[r],e[r]))}function yx(t,e,r){return xx(t,e,e.segments,r)}function xx(t,e,r,n){if(t.segments.length>r.length){let i=t.segments.slice(0,r.length);return!(!Sa(i,r)||e.hasChildren()||!rf(i,r,n))}else if(t.segments.length===r.length){if(!Sa(t.segments,r)||!rf(t.segments,r,n))return!1;for(let i in e.children)if(!t.children[i]||!yx(t.children[i],e.children[i],n))return!1;return!0}else{let i=r.slice(0,t.segments.length),s=r.slice(t.segments.length);return!Sa(t.segments,i)||!rf(t.segments,i,n)||!t.children[Xe]?!1:xx(t.children[Xe],e,s,n)}}function rf(t,e,r){return e.every((n,i)=>vx[r](t[i].parameters,n.parameters))}var Fs=class{constructor(e=new vt([],{}),r={},n=null){this.root=e,this.queryParams=r,this.fragment=n}get queryParamMap(){return this._queryParamMap??=zo(this.queryParams),this._queryParamMap}toString(){return HC.serialize(this)}},vt=class{constructor(e,r){this.segments=e,this.children=r,this.parent=null,Object.values(r).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return nf(this)}},Aa=class{constructor(e,r){this.path=e,this.parameters=r}get parameterMap(){return this._parameterMap??=zo(this.parameters),this._parameterMap}toString(){return Ex(this)}};function WC(t,e){return Sa(t,e)&&t.every((r,n)=>Ei(r.parameters,e[n].parameters))}function Sa(t,e){return t.length!==e.length?!1:t.every((r,n)=>r.path===e[n].path)}function $C(t,e){let r=[];return Object.entries(t.children).forEach(([n,i])=>{n===Xe&&(r=r.concat(e(i,n)))}),Object.entries(t.children).forEach(([n,i])=>{n!==Xe&&(r=r.concat(e(i,n)))}),r}var jp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:()=>new af,providedIn:"root"});let t=e;return t})(),af=class{parse(e){let r=new vp(e);return new Fs(r.parseRootSegment(),r.parseQueryParams(),r.parseFragment())}serialize(e){let r=`/${Sl(e.root,!0)}`,n=qC(e.queryParams),i=typeof e.fragment=="string"?`#${zC(e.fragment)}`:"";return`${r}${n}${i}`}},HC=new af;function nf(t){return t.segments.map(e=>Ex(e)).join("/")}function Sl(t,e){if(!t.hasChildren())return nf(t);if(e){let r=t.children[Xe]?Sl(t.children[Xe],!1):"",n=[];return Object.entries(t.children).forEach(([i,s])=>{i!==Xe&&n.push(`${i}:${Sl(s,!1)}`)}),n.length>0?`${r}(${n.join("//")})`:r}else{let r=$C(t,(n,i)=>i===Xe?[Sl(t.children[Xe],!1)]:[`${i}:${Sl(n,!1)}`]);return Object.keys(t.children).length===1&&t.children[Xe]!=null?`${nf(t)}/${r[0]}`:`${nf(t)}/(${r.join("//")})`}}function wx(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ef(t){return wx(t).replace(/%3B/gi,";")}function zC(t){return encodeURI(t)}function gp(t){return wx(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function sf(t){return decodeURIComponent(t)}function lx(t){return sf(t.replace(/\+/g,"%20"))}function Ex(t){return`${gp(t.path)}${GC(t.parameters)}`}function GC(t){return Object.entries(t).map(([e,r])=>`;${gp(e)}=${gp(r)}`).join("")}function qC(t){let e=Object.entries(t).map(([r,n])=>Array.isArray(n)?n.map(i=>`${ef(r)}=${ef(i)}`).join("&"):`${ef(r)}=${ef(n)}`).filter(r=>r);return e.length?`?${e.join("&")}`:""}var KC=/^[^\/()?;#]+/;function up(t){let e=t.match(KC);return e?e[0]:""}var XC=/^[^\/()?;=#]+/;function YC(t){let e=t.match(XC);return e?e[0]:""}var QC=/^[^=?&#]+/;function JC(t){let e=t.match(QC);return e?e[0]:""}var ZC=/^[^&#]+/;function ek(t){let e=t.match(ZC);return e?e[0]:""}var vp=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new vt([],{}):new vt([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let r={};this.peekStartsWith("/(")&&(this.capture("/"),r=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(r).length>0)&&(n[Xe]=new vt(e,r)),n}parseSegment(){let e=up(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new kt(4009,!1);return this.capture(e),new Aa(sf(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let r=YC(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let i=up(this.remaining);i&&(n=i,this.capture(n))}e[sf(r)]=sf(n)}parseQueryParam(e){let r=JC(this.remaining);if(!r)return;this.capture(r);let n="";if(this.consumeOptional("=")){let a=ek(this.remaining);a&&(n=a,this.capture(n))}let i=lx(r),s=lx(n);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let r={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=up(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new kt(4010,!1);let s;n.indexOf(":")>-1?(s=n.slice(0,n.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Xe);let a=this.parseChildren();r[s]=Object.keys(a).length===1?a[Xe]:new vt([],a),this.consumeOptional("//")}return r}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new kt(4011,!1)}};function Tx(t){return t.segments.length>0?new vt([],{[Xe]:t}):t}function bx(t){let e={};for(let[n,i]of Object.entries(t.children)){let s=bx(i);if(n===Xe&&s.segments.length===0&&s.hasChildren())for(let[a,o]of Object.entries(s.children))e[a]=o;else(s.segments.length>0||s.hasChildren())&&(e[n]=s)}let r=new vt(t.segments,e);return tk(r)}function tk(t){if(t.numberOfChildren===1&&t.children[Xe]){let e=t.children[Xe];return new vt(t.segments.concat(e.segments),e.children)}return t}function Go(t){return t instanceof Fs}function rk(t,e,r=null,n=null){let i=Ix(t);return Ax(i,e,r,n)}function Ix(t){let e;function r(s){let a={};for(let c of s.children){let l=r(c);a[c.outlet]=l}let o=new vt(s.url,a);return s===t&&(e=o),o}let n=r(t.root),i=Tx(n);return e??i}function Ax(t,e,r,n){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return hp(i,i,i,r,n);let s=nk(e);if(s.toRoot())return hp(i,i,new vt([],{}),r,n);let a=ik(s,i,t),o=a.processChildren?Dl(a.segmentGroup,a.index,s.commands):Cx(a.segmentGroup,a.index,s.commands);return hp(i,a.segmentGroup,o,r,n)}function of(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Pl(t){return typeof t=="object"&&t!=null&&t.outlets}function hp(t,e,r,n,i){let s={};n&&Object.entries(n).forEach(([c,l])=>{s[c]=Array.isArray(l)?l.map(h=>`${h}`):`${l}`});let a;t===e?a=r:a=Sx(t,e,r);let o=Tx(bx(a));return new Fs(o,s,i)}function Sx(t,e,r){let n={};return Object.entries(t.children).forEach(([i,s])=>{s===e?n[i]=r:n[i]=Sx(s,e,r)}),new vt(t.segments,n)}var cf=class{constructor(e,r,n){if(this.isAbsolute=e,this.numberOfDoubleDots=r,this.commands=n,e&&n.length>0&&of(n[0]))throw new kt(4003,!1);let i=n.find(Pl);if(i&&i!==gx(n))throw new kt(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function nk(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new cf(!0,0,t);let e=0,r=!1,n=t.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let o={};return Object.entries(s.outlets).forEach(([c,l])=>{o[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:o}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((o,c)=>{c==0&&o==="."||(c==0&&o===""?r=!0:o===".."?e++:o!=""&&i.push(o))}),i):[...i,s]},[]);return new cf(r,e,n)}var $o=class{constructor(e,r,n){this.segmentGroup=e,this.processChildren=r,this.index=n}};function ik(t,e,r){if(t.isAbsolute)return new $o(e,!0,0);if(!r)return new $o(e,!1,NaN);if(r.parent===null)return new $o(r,!0,0);let n=of(t.commands[0])?0:1,i=r.segments.length-1+n;return sk(r,i,t.numberOfDoubleDots)}function sk(t,e,r){let n=t,i=e,s=r;for(;s>i;){if(s-=i,n=n.parent,!n)throw new kt(4005,!1);i=n.segments.length}return new $o(n,!1,i-s)}function ak(t){return Pl(t[0])?t[0].outlets:{[Xe]:t}}function Cx(t,e,r){if(t??=new vt([],{}),t.segments.length===0&&t.hasChildren())return Dl(t,e,r);let n=ok(t,e,r),i=r.slice(n.commandIndex);if(n.match&&n.pathIndex<t.segments.length){let s=new vt(t.segments.slice(0,n.pathIndex),{});return s.children[Xe]=new vt(t.segments.slice(n.pathIndex),t.children),Dl(s,0,i)}else return n.match&&i.length===0?new vt(t.segments,{}):n.match&&!t.hasChildren()?_p(t,e,r):n.match?Dl(t,0,i):_p(t,e,r)}function Dl(t,e,r){if(r.length===0)return new vt(t.segments,{});{let n=ak(r),i={};if(Object.keys(n).some(s=>s!==Xe)&&t.children[Xe]&&t.numberOfChildren===1&&t.children[Xe].segments.length===0){let s=Dl(t.children[Xe],e,r);return new vt(t.segments,s.children)}return Object.entries(n).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Cx(t.children[s],e,a))}),Object.entries(t.children).forEach(([s,a])=>{n[s]===void 0&&(i[s]=a)}),new vt(t.segments,i)}}function ok(t,e,r){let n=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(n>=r.length)return s;let a=t.segments[i],o=r[n];if(Pl(o))break;let c=`${o}`,l=n<r.length-1?r[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!hx(c,l,a))return s;n+=2}else{if(!hx(c,{},a))return s;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function _p(t,e,r){let n=t.segments.slice(0,e),i=0;for(;i<r.length;){let s=r[i];if(Pl(s)){let c=ck(s.outlets);return new vt(n,c)}if(i===0&&of(r[0])){let c=t.segments[e];n.push(new Aa(c.path,ux(r[0]))),i++;continue}let a=Pl(s)?s.outlets[Xe]:`${s}`,o=i<r.length-1?r[i+1]:null;a&&o&&of(o)?(n.push(new Aa(a,ux(o))),i+=2):(n.push(new Aa(a,{})),i++)}return new vt(n,{})}function ck(t){let e={};return Object.entries(t).forEach(([r,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[r]=_p(new vt([],{}),0,n))}),e}function ux(t){let e={};return Object.entries(t).forEach(([r,n])=>e[r]=`${n}`),e}function hx(t,e,r){return t==r.path&&Ei(e,r.parameters)}var Rl="imperative",Or=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(Or||{}),Bn=class{constructor(e,r){this.id=e,this.url=r}},Ol=class extends Bn{constructor(e,r,n="imperative",i=null){super(e,r),this.type=Or.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ps=class extends Bn{constructor(e,r,n){super(e,r),this.urlAfterRedirects=n,this.type=Or.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},En=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(En||{}),yp=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(yp||{}),Os=class extends Bn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Or.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Ca=class extends Bn{constructor(e,r,n,i){super(e,r),this.reason=n,this.code=i,this.type=Or.NavigationSkipped}},Nl=class extends Bn{constructor(e,r,n,i){super(e,r),this.error=n,this.target=i,this.type=Or.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},lf=class extends Bn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Or.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},xp=class extends Bn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Or.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wp=class extends Bn{constructor(e,r,n,i,s){super(e,r),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=s,this.type=Or.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Ep=class extends Bn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Or.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Tp=class extends Bn{constructor(e,r,n,i){super(e,r),this.urlAfterRedirects=n,this.state=i,this.type=Or.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},bp=class{constructor(e){this.route=e,this.type=Or.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Ip=class{constructor(e){this.route=e,this.type=Or.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ap=class{constructor(e){this.snapshot=e,this.type=Or.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Sp=class{constructor(e){this.snapshot=e,this.type=Or.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Cp=class{constructor(e){this.snapshot=e,this.type=Or.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},kp=class{constructor(e){this.snapshot=e,this.type=Or.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Ml=class{},Ll=class{constructor(e){this.url=e}};var Dp=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mf,this.attachRef=null}},mf=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(n,i){let s=this.getOrCreateContext(n);s.outlet=i,this.contexts.set(n,s)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new Dp,this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uf=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let r=this.pathFromRoot(e);return r.length>1?r[r.length-2]:null}children(e){let r=Rp(e,this._root);return r?r.children.map(n=>n.value):[]}firstChild(e){let r=Rp(e,this._root);return r&&r.children.length>0?r.children[0].value:null}siblings(e){let r=Fp(e,this._root);return r.length<2?[]:r[r.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Fp(e,this._root).map(r=>r.value)}};function Rp(t,e){if(t===e.value)return e;for(let r of e.children){let n=Rp(t,r);if(n)return n}return null}function Fp(t,e){if(t===e.value)return[e];for(let r of e.children){let n=Fp(t,r);if(n.length)return n.unshift(e),n}return[]}var wn=class{constructor(e,r){this.value=e,this.children=r}toString(){return`TreeNode(${this.value})`}};function Wo(t){let e={};return t&&t.children.forEach(r=>e[r.value.outlet]=r),e}var hf=class extends uf{constructor(e,r){super(e),this.snapshot=r,$p(this,e)}toString(){return this.snapshot.toString()}};function kx(t){let e=lk(t),r=new Nn([new Aa("",{})]),n=new Nn({}),i=new Nn({}),s=new Nn({}),a=new Nn(""),o=new Qi(r,n,s,a,i,Xe,t,e.root);return o.snapshot=e.root,new hf(new wn(o,[]),e)}function lk(t){let e={},r={},n={},i="",s=new Vl([],e,n,i,r,Xe,t,null,{});return new ff("",new wn(s,[]))}var Qi=class{constructor(e,r,n,i,s,a,o,c){this.urlSubject=e,this.paramsSubject=r,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=o,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(nt(l=>l[jl]))??He(void 0),this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(nt(e=>zo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(nt(e=>zo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Wp(t,e,r="emptyOnly"){let n,{routeConfig:i}=t;return e!==null&&(r==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:Ie(Ie({},e.params),t.params),data:Ie(Ie({},e.data),t.data),resolve:Ie(Ie(Ie(Ie({},t.data),e.data),i?.data),t._resolvedData)}:n={params:Ie({},t.params),data:Ie({},t.data),resolve:Ie(Ie({},t.data),t._resolvedData??{})},i&&Rx(i)&&(n.resolve[jl]=i.title),n}var Vl=class{get title(){return this.data?.[jl]}constructor(e,r,n,i,s,a,o,c,l){this.url=e,this.params=r,this.queryParams=n,this.fragment=i,this.data=s,this.outlet=a,this.component=o,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=zo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=zo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),r=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${r}')`}},ff=class extends uf{constructor(e,r){super(r),this.url=e,$p(this,r)}toString(){return Dx(this._root)}};function $p(t,e){e.value._routerState=t,e.children.forEach(r=>$p(t,r))}function Dx(t){let e=t.children.length>0?` { ${t.children.map(Dx).join(", ")} } `:"";return`${t.value}${e}`}function fp(t){if(t.snapshot){let e=t.snapshot,r=t._futureSnapshot;t.snapshot=r,Ei(e.queryParams,r.queryParams)||t.queryParamsSubject.next(r.queryParams),e.fragment!==r.fragment&&t.fragmentSubject.next(r.fragment),Ei(e.params,r.params)||t.paramsSubject.next(r.params),VC(e.url,r.url)||t.urlSubject.next(r.url),Ei(e.data,r.data)||t.dataSubject.next(r.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function Pp(t,e){let r=Ei(t.params,e.params)&&WC(t.url,e.url),n=!t.parent!=!e.parent;return r&&!n&&(!t.parent||Pp(t.parent,e.parent))}function Rx(t){return typeof t.title=="string"||t.title===null}var Hp=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Xe,this.activateEvents=new Rr,this.deactivateEvents=new Rr,this.attachEvents=new Rr,this.detachEvents=new Rr,this.parentContexts=Ce(mf),this.location=Ce(Nh),this.changeDetector=Ce(Ds),this.environmentInjector=Ce(No),this.inputBinder=Ce(zp,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:s}=n.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new kt(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new kt(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new kt(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new kt(4013,!1);this._activatedRoute=n;let s=this.location,o=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new Op(n,c,s.injector);this.activated=s.createComponent(o,{index:s.length,injector:l,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=yt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ri]});let t=e;return t})(),Op=class t{__ngOutletInjector(e){return new t(this.route,this.childContexts,e)}constructor(e,r,n){this.route=e,this.childContexts=r,this.parent=n}get(e,r){return e===Qi?this.route:e===mf?this.childContexts:this.parent.get(e,r)}},zp=new it("");function uk(t,e,r){let n=Bl(t,e._root,r?r._root:void 0);return new hf(n,e)}function Bl(t,e,r){if(r&&t.shouldReuseRoute(e.value,r.value.snapshot)){let n=r.value;n._futureSnapshot=e.value;let i=hk(t,e,r);return new wn(n,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(o=>Bl(t,o)),a}}let n=fk(e.value),i=e.children.map(s=>Bl(t,s));return new wn(n,i)}}function hk(t,e,r){return e.children.map(n=>{for(let i of r.children)if(t.shouldReuseRoute(n.value,i.value.snapshot))return Bl(t,n,i);return Bl(t,n)})}function fk(t){return new Qi(new Nn(t.url),new Nn(t.params),new Nn(t.queryParams),new Nn(t.fragment),new Nn(t.data),t.outlet,t.component,t)}var Fx="ngNavigationCancelingError";function Px(t,e){let{redirectTo:r,navigationBehaviorOptions:n}=Go(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Ox(!1,En.Redirect);return i.url=r,i.navigationBehaviorOptions=n,i}function Ox(t,e){let r=new Error(`NavigationCancelingError: ${t||""}`);return r[Fx]=!0,r.cancellationCode=e,r}function dk(t){return Nx(t)&&Go(t.url)}function Nx(t){return!!t&&t[Fx]}var pk=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["ng-component"]],standalone:!0,features:[Rt],decls:1,vars:0,template:function(i,s){i&1&&ze(0,"router-outlet")},dependencies:[Hp],encapsulation:2});let t=e;return t})();function mk(t,e){return t.providers&&!t._injector&&(t._injector=Oy(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Gp(t){let e=t.children&&t.children.map(Gp),r=e?mt(Ie({},t),{children:e}):Ie({},t);return!r.component&&!r.loadComponent&&(e||r.loadChildren)&&r.outlet&&r.outlet!==Xe&&(r.component=pk),r}function Ti(t){return t.outlet||Xe}function gk(t,e){let r=t.filter(n=>Ti(n)===e);return r.push(...t.filter(n=>Ti(n)!==e)),r}function Wl(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let r=e.routeConfig;if(r?._loadedInjector)return r._loadedInjector;if(r?._injector)return r._injector}return null}var vk=(t,e,r,n)=>nt(i=>(new Np(e,i.targetRouterState,i.currentRouterState,r,n).activate(t),i)),Np=class{constructor(e,r,n,i,s){this.routeReuseStrategy=e,this.futureState=r,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let r=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(r,n,e),fp(this.futureState.root),this.activateChildRoutes(r,n,e)}deactivateChildRoutes(e,r,n){let i=Wo(r);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],n),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,n)})}deactivateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(i===s)if(i.component){let a=n.getContext(i.outlet);a&&this.deactivateChildRoutes(e,r,a.children)}else this.deactivateChildRoutes(e,r,n);else s&&this.deactivateRouteAndItsChildren(r,n)}deactivateRouteAndItsChildren(e,r){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,r):this.deactivateRouteAndOutlet(e,r)}detachAndStoreRouteSubtree(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=Wo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(n&&n.outlet){let a=n.outlet.detach(),o=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:o})}}deactivateRouteAndOutlet(e,r){let n=r.getContext(e.value.outlet),i=n&&e.value.component?n.children:r,s=Wo(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,r,n){let i=Wo(r);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],n),this.forwardEvent(new kp(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Sp(e.value.snapshot))}activateRoutes(e,r,n){let i=e.value,s=r?r.value:null;if(fp(i),i===s)if(i.component){let a=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,r,a.children)}else this.activateChildRoutes(e,r,n);else if(i.component){let a=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let o=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(o.contexts),a.attachRef=o.componentRef,a.route=o.route.value,a.outlet&&a.outlet.attach(o.componentRef,o.route.value),fp(o.route.value),this.activateChildRoutes(e,null,a.children)}else{let o=Wl(i.snapshot);a.attachRef=null,a.route=i,a.injector=o,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}}else this.activateChildRoutes(e,null,n)}},df=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Ho=class{constructor(e,r){this.component=e,this.route=r}};function _k(t,e,r){let n=t._root,i=e?e._root:null;return Cl(n,i,r,[n.value])}function yk(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function Ko(t,e){let r=Symbol(),n=e.get(t,r);return n===r?typeof t=="function"&&!Ay(t)?t:e.get(t):n}function Cl(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Wo(e);return t.children.forEach(a=>{xk(a,s[a.value.outlet],r,n.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,o])=>Fl(o,r.getContext(a),i)),i}function xk(t,e,r,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,a=e?e.value:null,o=r?r.getContext(t.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let c=wk(a,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new df(n)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Cl(t,e,o?o.children:null,n,i):Cl(t,e,r,n,i),c&&o&&o.outlet&&o.outlet.isActivated&&i.canDeactivateChecks.push(new Ho(o.outlet.component,a))}else a&&Fl(e,o,i),i.canActivateChecks.push(new df(n)),s.component?Cl(t,null,o?o.children:null,n,i):Cl(t,null,r,n,i);return i}function wk(t,e,r){if(typeof r=="function")return r(t,e);switch(r){case"pathParamsChange":return!Sa(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Sa(t.url,e.url)||!Ei(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Pp(t,e)||!Ei(t.queryParams,e.queryParams);case"paramsChange":default:return!Pp(t,e)}}function Fl(t,e,r){let n=Wo(t),i=t.value;Object.entries(n).forEach(([s,a])=>{i.component?e?Fl(a,e.children.getContext(s),r):Fl(a,null,r):Fl(a,e,r)}),i.component?e&&e.outlet&&e.outlet.isActivated?r.canDeactivateChecks.push(new Ho(e.outlet.component,i)):r.canDeactivateChecks.push(new Ho(null,i)):r.canDeactivateChecks.push(new Ho(null,i))}function $l(t){return typeof t=="function"}function Ek(t){return typeof t=="boolean"}function Tk(t){return t&&$l(t.canLoad)}function bk(t){return t&&$l(t.canActivate)}function Ik(t){return t&&$l(t.canActivateChild)}function Ak(t){return t&&$l(t.canDeactivate)}function Sk(t){return t&&$l(t.canMatch)}function Mx(t){return t instanceof _y||t?.name==="EmptyError"}var tf=Symbol("INITIAL_VALUE");function qo(){return Ln(t=>dl(t.map(e=>e.pipe(Is(1),Rh(tf)))).pipe(nt(e=>{for(let r of e)if(r!==!0){if(r===tf)return tf;if(r===!1||r instanceof Fs)return r}return!0}),Ts(e=>e!==tf),Is(1)))}function Ck(t,e){return Mn(r=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=r;return a.length===0&&s.length===0?He(mt(Ie({},r),{guardsResult:!0})):kk(a,n,i,t).pipe(Mn(o=>o&&Ek(o)?Dk(n,s,t,e):He(o)),nt(o=>mt(Ie({},r),{guardsResult:o})))})}function kk(t,e,r,n){return nn(t).pipe(Mn(i=>Nk(i.component,i.route,r,e,n)),As(i=>i!==!0,!0))}function Dk(t,e,r,n){return nn(e).pipe(ya(i=>Dh(Fk(i.route.parent,n),Rk(i.route,n),Ok(t,i.path,r),Pk(t,i.route,r))),As(i=>i!==!0,!0))}function Rk(t,e){return t!==null&&e&&e(new Cp(t)),He(!0)}function Fk(t,e){return t!==null&&e&&e(new Ap(t)),He(!0)}function Pk(t,e,r){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return He(!0);let i=n.map(s=>V0(()=>{let a=Wl(e)??r,o=Ko(s,a),c=bk(o)?o.canActivate(e,t):qi(a,()=>o(e,t));return Ns(c).pipe(As())}));return He(i).pipe(qo())}function Ok(t,e,r){let n=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>yk(a)).filter(a=>a!==null).map(a=>V0(()=>{let o=a.guards.map(c=>{let l=Wl(a.node)??r,h=Ko(c,l),f=Ik(h)?h.canActivateChild(n,t):qi(l,()=>h(n,t));return Ns(f).pipe(As())});return He(o).pipe(qo())}));return He(s).pipe(qo())}function Nk(t,e,r,n,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return He(!0);let a=s.map(o=>{let c=Wl(e)??i,l=Ko(o,c),h=Ak(l)?l.canDeactivate(t,e,r,n):qi(c,()=>l(t,e,r,n));return Ns(h).pipe(As())});return He(a).pipe(qo())}function Mk(t,e,r,n){let i=e.canLoad;if(i===void 0||i.length===0)return He(!0);let s=i.map(a=>{let o=Ko(a,t),c=Tk(o)?o.canLoad(e,r):qi(t,()=>o(e,r));return Ns(c)});return He(s).pipe(qo(),Lx(n))}function Lx(t){return py(hr(e=>{if(Go(e))throw Px(t,e)}),nt(e=>e===!0))}function Lk(t,e,r,n){let i=e.canMatch;if(!i||i.length===0)return He(!0);let s=i.map(a=>{let o=Ko(a,t),c=Sk(o)?o.canMatch(e,r):qi(t,()=>o(e,r));return Ns(c)});return He(s).pipe(qo(),Lx(n))}var Ul=class{constructor(e){this.segmentGroup=e||null}},pf=class extends Error{constructor(e){super(),this.urlTree=e}};function jo(t){return Es(new Ul(t))}function Vk(t){return Es(new kt(4e3,!1))}function Bk(t){return Es(Ox(!1,En.GuardRejected))}var Mp=class{constructor(e,r){this.urlSerializer=e,this.urlTree=r}lineralizeSegments(e,r){let n=[],i=r.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return He(n);if(i.numberOfChildren>1||!i.children[Xe])return Vk(e.redirectTo);i=i.children[Xe]}}applyRedirectCommands(e,r,n){let i=this.applyRedirectCreateUrlTree(r,this.urlSerializer.parse(r),e,n);if(r.startsWith("/"))throw new pf(i);return i}applyRedirectCreateUrlTree(e,r,n,i){let s=this.createSegmentGroup(e,r.root,n,i);return new Fs(s,this.createQueryParams(r.queryParams,this.urlTree.queryParams),r.fragment)}createQueryParams(e,r){let n={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let o=s.substring(1);n[i]=r[o]}else n[i]=s}),n}createSegmentGroup(e,r,n,i){let s=this.createSegments(e,r.segments,n,i),a={};return Object.entries(r.children).forEach(([o,c])=>{a[o]=this.createSegmentGroup(e,c,n,i)}),new vt(s,a)}createSegments(e,r,n,i){return r.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,n))}findPosParam(e,r,n){let i=n[r.path.substring(1)];if(!i)throw new kt(4001,!1);return i}findOrReturn(e,r){let n=0;for(let i of r){if(i.path===e.path)return r.splice(n),i;n++}return e}},Lp={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Uk(t,e,r,n,i){let s=qp(t,e,r);return s.matched?(n=mk(e,n),Lk(n,e,r,i).pipe(nt(a=>a===!0?s:Ie({},Lp)))):He(s)}function qp(t,e,r){if(e.path==="**")return jk(r);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||r.length>0)?Ie({},Lp):{matched:!0,consumedSegments:[],remainingSegments:r,parameters:{},positionalParamSegments:{}};let i=(e.matcher||LC)(r,t,e);if(!i)return Ie({},Lp);let s={};Object.entries(i.posParams??{}).forEach(([o,c])=>{s[o]=c.path});let a=i.consumed.length>0?Ie(Ie({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:r.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function jk(t){return{matched:!0,parameters:t.length>0?gx(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function fx(t,e,r,n){return r.length>0&&Hk(t,r,n)?{segmentGroup:new vt(e,$k(n,new vt(r,t.children))),slicedSegments:[]}:r.length===0&&zk(t,r,n)?{segmentGroup:new vt(t.segments,Wk(t,r,n,t.children)),slicedSegments:r}:{segmentGroup:new vt(t.segments,t.children),slicedSegments:r}}function Wk(t,e,r,n){let i={};for(let s of r)if(gf(t,e,s)&&!n[Ti(s)]){let a=new vt([],{});i[Ti(s)]=a}return Ie(Ie({},n),i)}function $k(t,e){let r={};r[Xe]=e;for(let n of t)if(n.path===""&&Ti(n)!==Xe){let i=new vt([],{});r[Ti(n)]=i}return r}function Hk(t,e,r){return r.some(n=>gf(t,e,n)&&Ti(n)!==Xe)}function zk(t,e,r){return r.some(n=>gf(t,e,n))}function gf(t,e,r){return(t.hasChildren()||e.length>0)&&r.pathMatch==="full"?!1:r.path===""}function Gk(t,e,r,n){return Ti(t)!==n&&(n===Xe||!gf(e,r,t))?!1:qp(e,t,r).matched}function qk(t,e,r){return e.length===0&&!t.children[r]}var Vp=class{};function Kk(t,e,r,n,i,s,a="emptyOnly"){return new Bp(t,e,r,n,i,a,s).recognize()}var Xk=31,Bp=class{constructor(e,r,n,i,s,a,o){this.injector=e,this.configLoader=r,this.rootComponentType=n,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=o,this.applyRedirects=new Mp(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new kt(4002,`'${e.segmentGroup}'`)}recognize(){let e=fx(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(nt(r=>{let n=new Vl([],Object.freeze({}),Object.freeze(Ie({},this.urlTree.queryParams)),this.urlTree.fragment,{},Xe,this.rootComponentType,null,{}),i=new wn(n,r),s=new ff("",i),a=rk(n,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),this.inheritParamsAndData(s._root,null),{state:s,tree:a}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,Xe).pipe(bs(n=>{if(n instanceof pf)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof Ul?this.noMatchError(n):n}))}inheritParamsAndData(e,r){let n=e.value,i=Wp(n,r,this.paramsInheritanceStrategy);n.params=Object.freeze(i.params),n.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,n))}processSegmentGroup(e,r,n,i){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,r,n):this.processSegment(e,r,n,n.segments,i,!0).pipe(nt(s=>s instanceof wn?[s]:[]))}processChildren(e,r,n){let i=[];for(let s of Object.keys(n.children))s==="primary"?i.unshift(s):i.push(s);return nn(i).pipe(ya(s=>{let a=n.children[s],o=gk(r,s);return this.processSegmentGroup(e,o,a,s)}),by((s,a)=>(s.push(...a),s)),B0(null),Ey(),Mn(s=>{if(s===null)return jo(n);let a=Vx(s);return Yk(a),He(a)}))}processSegment(e,r,n,i,s,a){return nn(r).pipe(ya(o=>this.processSegmentAgainstRoute(o._injector??e,r,o,n,i,s,a).pipe(bs(c=>{if(c instanceof Ul)return He(null);throw c}))),As(o=>!!o),bs(o=>{if(Mx(o))return qk(n,i,s)?He(new Vp):jo(n);throw o}))}processSegmentAgainstRoute(e,r,n,i,s,a,o){return Gk(n,i,s,a)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,s,a):this.allowRedirects&&o?this.expandSegmentAgainstRouteUsingRedirect(e,i,r,n,s,a):jo(i):jo(i)}expandSegmentAgainstRouteUsingRedirect(e,r,n,i,s,a){let{matched:o,consumedSegments:c,positionalParamSegments:l,remainingSegments:h}=qp(r,i,s);if(!o)return jo(r);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>Xk&&(this.allowRedirects=!1));let f=this.applyRedirects.applyRedirectCommands(c,i.redirectTo,l);return this.applyRedirects.lineralizeSegments(i,f).pipe(Mn(d=>this.processSegment(e,n,r,d.concat(h),a,!1)))}matchSegmentAgainstRoute(e,r,n,i,s){let a=Uk(r,n,i,e,this.urlSerializer);return n.path==="**"&&(r.children={}),a.pipe(Ln(o=>o.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Ln(({routes:c})=>{let l=n._loadedInjector??e,{consumedSegments:h,remainingSegments:f,parameters:d}=o,m=new Vl(h,d,Object.freeze(Ie({},this.urlTree.queryParams)),this.urlTree.fragment,Jk(n),Ti(n),n.component??n._loadedComponent??null,n,Zk(n)),{segmentGroup:v,slicedSegments:p}=fx(r,h,f,c);if(p.length===0&&v.hasChildren())return this.processChildren(l,c,v).pipe(nt(T=>T===null?null:new wn(m,T)));if(c.length===0&&p.length===0)return He(new wn(m,[]));let _=Ti(n)===s;return this.processSegment(l,c,v,p,_?Xe:s,!0).pipe(nt(T=>new wn(m,T instanceof wn?[T]:[])))}))):jo(r)))}getChildConfig(e,r,n){return r.children?He({routes:r.children,injector:e}):r.loadChildren?r._loadedRoutes!==void 0?He({routes:r._loadedRoutes,injector:r._loadedInjector}):Mk(e,r,n,this.urlSerializer).pipe(Mn(i=>i?this.configLoader.loadChildren(e,r).pipe(hr(s=>{r._loadedRoutes=s.routes,r._loadedInjector=s.injector})):Bk(r))):He({routes:[],injector:e})}};function Yk(t){t.sort((e,r)=>e.value.outlet===Xe?-1:r.value.outlet===Xe?1:e.value.outlet.localeCompare(r.value.outlet))}function Qk(t){let e=t.value.routeConfig;return e&&e.path===""}function Vx(t){let e=[],r=new Set;for(let n of t){if(!Qk(n)){e.push(n);continue}let i=e.find(s=>n.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...n.children),r.add(i)):e.push(n)}for(let n of r){let i=Vx(n.children);e.push(new wn(n.value,i))}return e.filter(n=>!r.has(n))}function Jk(t){return t.data||{}}function Zk(t){return t.resolve||{}}function eD(t,e,r,n,i,s){return Mn(a=>Kk(t,e,r,n,a.extractedUrl,i,s).pipe(nt(({state:o,tree:c})=>mt(Ie({},a),{targetSnapshot:o,urlAfterRedirects:c}))))}function tD(t,e){return Mn(r=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=r;if(!i.length)return He(r);let s=new Set(i.map(c=>c.route)),a=new Set;for(let c of s)if(!a.has(c))for(let l of Bx(c))a.add(l);let o=0;return nn(a).pipe(ya(c=>s.has(c)?rD(c,n,t,e):(c.data=Wp(c,c.parent,t).resolve,He(void 0))),hr(()=>o++),U0(1),Mn(c=>o===a.size?He(r):ws))})}function Bx(t){let e=t.children.map(r=>Bx(r)).flat();return[t,...e]}function rD(t,e,r,n){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!Rx(i)&&(s[jl]=i.title),nD(s,t,e,n).pipe(nt(a=>(t._resolvedData=a,t.data=Wp(t,t.parent,r).resolve,null)))}function nD(t,e,r,n){let i=mp(t);if(i.length===0)return He({});let s={};return nn(i).pipe(Mn(a=>iD(t[a],e,r,n).pipe(As(),hr(o=>{s[a]=o}))),U0(1),wy(s),bs(a=>Mx(a)?ws:Es(a)))}function iD(t,e,r,n){let i=Wl(e)??n,s=Ko(t,i),a=s.resolve?s.resolve(e,r):qi(i,()=>s(e,r));return Ns(a)}function dp(t){return Ln(e=>{let r=t(e);return r?nn(r).pipe(nt(()=>e)):He(e)})}var Ux=(()=>{let e=class e{buildTitle(n){let i,s=n.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(a=>a.outlet===Xe);return i}getResolvedTitleForRoute(n){return n.data[jl]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:()=>Ce(sD),providedIn:"root"});let t=e;return t})(),sD=(()=>{let e=class e extends Ux{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)($e(ox))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Kp=new it("",{providedIn:"root",factory:()=>({})}),Xp=new it(""),aD=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Ce(K0)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return He(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=Ns(n.loadComponent()).pipe(nt(jx),hr(a=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=a}),xa(()=>{this.componentLoaders.delete(n)})),s=new O0(i,()=>new On).pipe(P0());return this.componentLoaders.set(n,s),s}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return He({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let a=oD(i,this.compiler,n,this.onLoadEndListener).pipe(xa(()=>{this.childrenLoaders.delete(i)})),o=new O0(a,()=>new On).pipe(P0());return this.childrenLoaders.set(i,o),o}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function oD(t,e,r,n){return Ns(t.loadChildren()).pipe(nt(jx),Mn(i=>i instanceof Py||Array.isArray(i)?He(i):nn(e.compileModuleAsync(i))),nt(i=>{n&&n(t);let s,a,o=!1;return Array.isArray(i)?(a=i,o=!0):(s=i.create(r).injector,a=s.get(Xp,[],{optional:!0,self:!0}).flat()),{routes:a.map(Gp),injector:s}}))}function cD(t){return t&&typeof t=="object"&&"default"in t}function jx(t){return cD(t)?t.default:t}var Yp=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:()=>Ce(lD),providedIn:"root"});let t=e;return t})(),lD=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),uD=new it("");var hD=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new On,this.transitionAbortSubject=new On,this.configLoader=Ce(aD),this.environmentInjector=Ce(No),this.urlSerializer=Ce(jp),this.rootContexts=Ce(mf),this.location=Ce(Bh),this.inputBindingEnabled=Ce(zp,{optional:!0})!==null,this.titleStrategy=Ce(Ux),this.options=Ce(Kp,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=Ce(Yp),this.createViewTransition=Ce(uD,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>He(void 0),this.rootComponentType=null;let n=s=>this.events.next(new bp(s)),i=s=>this.events.next(new Ip(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(mt(Ie(Ie({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,s){return this.transitions=new Nn({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Rl,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ts(a=>a.id!==0),nt(a=>mt(Ie({},a),{extractedUrl:this.urlHandlingStrategy.extract(a.rawUrl)})),Ln(a=>{let o=!1,c=!1;return He(a).pipe(Ln(l=>{if(this.navigationId>a.id)return this.cancelNavigationTransition(a,"",En.SupersededByNewNavigation),ws;this.currentTransition=a,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?mt(Ie({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let h=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!h&&f!=="reload"){let d="";return this.events.next(new Ca(l.id,this.urlSerializer.serialize(l.rawUrl),d,yp.IgnoredSameUrlNavigation)),l.resolve(null),ws}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return He(l).pipe(Ln(d=>{let m=this.transitions?.getValue();return this.events.next(new Ol(d.id,this.urlSerializer.serialize(d.extractedUrl),d.source,d.restoredState)),m!==this.transitions?.getValue()?ws:Promise.resolve(d)}),eD(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),hr(d=>{a.targetSnapshot=d.targetSnapshot,a.urlAfterRedirects=d.urlAfterRedirects,this.currentNavigation=mt(Ie({},this.currentNavigation),{finalUrl:d.urlAfterRedirects});let m=new lf(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(m)}));if(h&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:d,extractedUrl:m,source:v,restoredState:p,extras:_}=l,T=new Ol(d,this.urlSerializer.serialize(m),v,p);this.events.next(T);let S=kx(this.rootComponentType).snapshot;return this.currentTransition=a=mt(Ie({},l),{targetSnapshot:S,urlAfterRedirects:m,extras:mt(Ie({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=m,He(a)}else{let d="";return this.events.next(new Ca(l.id,this.urlSerializer.serialize(l.extractedUrl),d,yp.IgnoredByUrlHandlingStrategy)),l.resolve(null),ws}}),hr(l=>{let h=new xp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(h)}),nt(l=>(this.currentTransition=a=mt(Ie({},l),{guards:_k(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),a)),Ck(this.environmentInjector,l=>this.events.next(l)),hr(l=>{if(a.guardsResult=l.guardsResult,Go(l.guardsResult))throw Px(this.urlSerializer,l.guardsResult);let h=new wp(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(h)}),Ts(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",En.GuardRejected),!1)),dp(l=>{if(l.guards.canActivateChecks.length)return He(l).pipe(hr(h=>{let f=new Ep(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}),Ln(h=>{let f=!1;return He(h).pipe(tD(this.paramsInheritanceStrategy,this.environmentInjector),hr({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(h,"",En.NoDataFromResolver)}}))}),hr(h=>{let f=new Tp(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}))}),dp(l=>{let h=f=>{let d=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&d.push(this.configLoader.loadComponent(f.routeConfig).pipe(hr(m=>{f.component=m}),nt(()=>{})));for(let m of f.children)d.push(...h(m));return d};return dl(h(l.targetSnapshot.root)).pipe(B0(null),Is(1))}),dp(()=>this.afterPreactivation()),Ln(()=>{let{currentSnapshot:l,targetSnapshot:h}=a,f=this.createViewTransition?.(this.environmentInjector,l.root,h.root);return f?nn(f).pipe(nt(()=>a)):He(a)}),nt(l=>{let h=uk(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=a=mt(Ie({},l),{targetRouterState:h}),this.currentNavigation.targetRouterState=h,a}),hr(()=>{this.events.next(new Ml)}),vk(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Is(1),hr({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ps(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),Fh(this.transitionAbortSubject.pipe(hr(l=>{throw l}))),xa(()=>{!o&&!c&&this.cancelNavigationTransition(a,"",En.SupersededByNewNavigation),this.currentTransition?.id===a.id&&(this.currentNavigation=null,this.currentTransition=null)}),bs(l=>{if(c=!0,Nx(l))this.events.next(new Os(a.id,this.urlSerializer.serialize(a.extractedUrl),l.message,l.cancellationCode)),dk(l)?this.events.next(new Ll(l.url)):a.resolve(!1);else{this.events.next(new Nl(a.id,this.urlSerializer.serialize(a.extractedUrl),l,a.targetSnapshot??void 0));try{a.resolve(n.errorHandler(l))}catch(h){this.options.resolveNavigationPromiseOnError?a.resolve(!1):a.reject(h)}}return ws}))}))}cancelNavigationTransition(n,i,s){let a=new Os(n.id,this.urlSerializer.serialize(n.extractedUrl),i,s);this.events.next(a),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function fD(t){return t!==Rl}var dD=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:()=>Ce(pD),providedIn:"root"});let t=e;return t})(),Up=class{shouldDetach(e){return!1}store(e,r){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,r){return e.routeConfig===r.routeConfig}},pD=(()=>{let e=class e extends Up{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:()=>Ce(mD),providedIn:"root"});let t=e;return t})(),mD=(()=>{let e=class e extends Wx{constructor(){super(...arguments),this.location=Ce(Bh),this.urlSerializer=Ce(jp),this.options=Ce(Kp,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=Ce(Yp),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fs,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=kx(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof Ol)this.stateMemento=this.createStateMemento();else if(n instanceof Ca)this.rawUrlTree=i.initialUrl;else if(n instanceof lf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else n instanceof Ml?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):n instanceof Os&&(n.code===En.GuardRejected||n.code===En.NoDataFromResolver)?this.restoreHistory(i):n instanceof Nl?this.restoreHistory(i,!0):n instanceof Ps&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let s=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let a=this.browserPageId,o=Ie(Ie({},i.extras.state),this.generateNgRouterState(i.id,a));this.location.replaceState(s,"",o)}else{let a=Ie(Ie({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",a)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,a=this.currentPageId-s;a!==0?this.location.historyGo(a):this.currentUrlTree===n.finalUrl&&a===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),kl=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(kl||{});function gD(t,e){t.events.pipe(Ts(r=>r instanceof Ps||r instanceof Os||r instanceof Nl||r instanceof Ca),nt(r=>r instanceof Ps||r instanceof Ca?kl.COMPLETE:(r instanceof Os?r.code===En.Redirect||r.code===En.SupersededByNewNavigation:!1)?kl.REDIRECTING:kl.FAILED),Ts(r=>r!==kl.REDIRECTING),Is(1)).subscribe(()=>{e()})}function vD(t){throw t}var _D={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},yD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ka=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=Ce(Mh),this.stateManager=Ce(Wx),this.options=Ce(Kp,{optional:!0})||{},this.pendingTasks=Ce(vl),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=Ce(hD),this.urlSerializer=Ce(jp),this.location=Ce(Bh),this.urlHandlingStrategy=Ce(Yp),this._events=new On,this.errorHandler=this.options.errorHandler||vD,this.navigated=!1,this.routeReuseStrategy=Ce(dD),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=Ce(Xp,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!Ce(zp,{optional:!0}),this.eventsSubscription=new dy,this.isNgZoneEnabled=Ce(Wt)instanceof Wt&&Wt.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,a=this.navigationTransitions.currentNavigation;if(s!==null&&a!==null){if(this.stateManager.handleRouterEvent(i,a),i instanceof Os&&i.code!==En.Redirect&&i.code!==En.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ps)this.navigated=!0;else if(i instanceof Ll){let o=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),c={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||fD(s.source)};this.scheduleNavigation(o,Rl,null,c,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}wD(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Rl,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,s){let a={replaceUrl:!0},o=s?.navigationId?s:null;if(s){let l=Ie({},s);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(a.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,o,a)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Gp),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:s,queryParams:a,fragment:o,queryParamsHandling:c,preserveFragment:l}=i,h=l?this.currentUrlTree.fragment:o,f=null;switch(c){case"merge":f=Ie(Ie({},this.currentUrlTree.queryParams),a);break;case"preserve":f=this.currentUrlTree.queryParams;break;default:f=a||null}f!==null&&(f=this.removeEmptyProps(f));let d;try{let m=s?s.snapshot:this.routerState.snapshot.root;d=Ix(m)}catch{(typeof n[0]!="string"||!n[0].startsWith("/"))&&(n=[]),d=this.currentUrlTree.root}return Ax(d,n,f,h??null)}navigateByUrl(n,i={skipLocationChange:!1}){let s=Go(n)?n:this.parseUrl(n),a=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(a,Rl,null,i)}navigate(n,i={skipLocationChange:!1}){return xD(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let s;if(i===!0?s=Ie({},_D):i===!1?s=Ie({},yD):s=i,Go(n))return cx(this.currentUrlTree,n,s);let a=this.parseUrl(n);return cx(this.currentUrlTree,a,s)}removeEmptyProps(n){return Object.entries(n).reduce((i,[s,a])=>(a!=null&&(i[s]=a),i),{})}scheduleNavigation(n,i,s,a,o){if(this.disposed)return Promise.resolve(!1);let c,l,h;o?(c=o.resolve,l=o.reject,h=o.promise):h=new Promise((d,m)=>{c=d,l=m});let f=this.pendingTasks.add();return gD(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(f))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:a,resolve:c,reject:l,promise:h,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),h.catch(d=>Promise.reject(d))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function xD(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new kt(4008,!1)}function wD(t){return!(t instanceof Ml)&&!(t instanceof Ll)}var $x=(()=>{let e=class e{constructor(n,i,s,a,o,c){this.router=n,this.route=i,this.tabIndexAttribute=s,this.renderer=a,this.el=o,this.locationStrategy=c,this.href=null,this.commands=null,this.onChanges=new On,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;let l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(h=>{h instanceof Ps&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n!=null?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,i,s,a,o){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||s||a||o||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:Ry(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let s=this.renderer,a=this.el.nativeElement;i!==null?s.setAttribute(a,n,i):s.removeAttribute(a,n)}get urlTree(){return this.commands===null?null:this.router.createUrlTree(this.commands,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(Pe(ka),Pe(Qi),W0("tabindex"),Pe(Ea),Pe(vn),Pe(X0))},e.\u0275dir=yt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,s){i&1&&ct("click",function(o){return s.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),i&2&&Ss("target",s.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[vr.HasDecoratorInputTransform,"preserveFragment","preserveFragment",Xi],skipLocationChange:[vr.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",Xi],replaceUrl:[vr.HasDecoratorInputTransform,"replaceUrl","replaceUrl",Xi],routerLink:"routerLink"},standalone:!0,features:[Mo,ri]});let t=e;return t})();var ED=new it("");function Hx(t,...e){return ti([{provide:Xp,multi:!0,useValue:t},[],{provide:Qi,useFactory:TD,deps:[ka]},{provide:q0,multi:!0,useFactory:bD},e.map(r=>r.\u0275providers)])}function TD(t){return t.routerState.root}function bD(){let t=Ce(wa);return e=>{let r=t.get(Vh);if(e!==r.components[0])return;let n=t.get(ka),i=t.get(ID);t.get(AD)===1&&n.initialNavigation(),t.get(SD,null,j0.Optional)?.setUpPreloading(),t.get(ED,null,j0.Optional)?.init(),n.resetRootComponentType(r.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var ID=new it("",{factory:()=>new On}),AD=new it("",{providedIn:"root",factory:()=>1});var SD=new it("");var ew=(()=>{let e=class e{constructor(n,i){this._renderer=n,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(n,i){this._renderer.setProperty(this._elementRef.nativeElement,n,i)}registerOnTouched(n){this.onTouched=n}registerOnChange(n){this.onChange=n}setDisabledState(n){this.setProperty("disabled",n)}};e.\u0275fac=function(i){return new(i||e)(Pe(Ea),Pe(vn))},e.\u0275dir=yt({type:e});let t=e;return t})(),ql=(()=>{let e=class e extends ew{};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,features:[Fr]});let t=e;return t})(),Ra=new it(""),kD={provide:Ra,useExisting:Vn(()=>em),multi:!0},em=(()=>{let e=class e extends ql{writeValue(n){this.setProperty("checked",n)}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,s){i&1&&ct("change",function(o){return s.onChange(o.target.checked)})("blur",function(){return s.onTouched()})},features:[Pr([kD]),Fr]});let t=e;return t})(),DD={provide:Ra,useExisting:Vn(()=>Ii),multi:!0};function RD(){let t=Vo()?Vo().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var FD=new it(""),Ii=(()=>{let e=class e extends ew{constructor(n,i,s){super(n,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!RD())}writeValue(n){let i=n??"";this.setProperty("value",i)}_handleInput(n){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(n)}_compositionStart(){this._composing=!0}_compositionEnd(n){this._composing=!1,this._compositionMode&&this.onChange(n)}};e.\u0275fac=function(i){return new(i||e)(Pe(Ea),Pe(vn),Pe(FD,8))},e.\u0275dir=yt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&ct("input",function(o){return s._handleInput(o.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(o){return s._compositionEnd(o.target.value)})},features:[Pr([DD]),Fr]});let t=e;return t})();function Ms(t){return t==null||(typeof t=="string"||Array.isArray(t))&&t.length===0}function tw(t){return t!=null&&typeof t.length=="number"}var Qo=new it(""),If=new it(""),PD=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,si=class{static min(e){return rw(e)}static max(e){return OD(e)}static required(e){return nw(e)}static requiredTrue(e){return ND(e)}static email(e){return MD(e)}static minLength(e){return LD(e)}static maxLength(e){return VD(e)}static pattern(e){return BD(e)}static nullValidator(e){return _f(e)}static compose(e){return lw(e)}static composeAsync(e){return uw(e)}};function rw(t){return e=>{if(Ms(e.value)||Ms(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r<t?{min:{min:t,actual:e.value}}:null}}function OD(t){return e=>{if(Ms(e.value)||Ms(t))return null;let r=parseFloat(e.value);return!isNaN(r)&&r>t?{max:{max:t,actual:e.value}}:null}}function nw(t){return Ms(t.value)?{required:!0}:null}function ND(t){return t.value===!0?null:{required:!0}}function MD(t){return Ms(t.value)||PD.test(t.value)?null:{email:!0}}function LD(t){return e=>Ms(e.value)||!tw(e.value)?null:e.value.length<t?{minlength:{requiredLength:t,actualLength:e.value.length}}:null}function VD(t){return e=>tw(e.value)&&e.value.length>t?{maxlength:{requiredLength:t,actualLength:e.value.length}}:null}function BD(t){if(!t)return _f;let e,r;return typeof t=="string"?(r="",t.charAt(0)!=="^"&&(r+="^"),r+=t,t.charAt(t.length-1)!=="$"&&(r+="$"),e=new RegExp(r)):(r=t.toString(),e=t),n=>{if(Ms(n.value))return null;let i=n.value;return e.test(i)?null:{pattern:{requiredPattern:r,actualValue:i}}}}function _f(t){return null}function iw(t){return t!=null}function sw(t){return Lh(t)?nn(t):t}function aw(t){let e={};return t.forEach(r=>{e=r!=null?Ie(Ie({},e),r):e}),Object.keys(e).length===0?null:e}function ow(t,e){return e.map(r=>r(t))}function UD(t){return!t.validate}function cw(t){return t.map(e=>UD(e)?e:r=>e.validate(r))}function lw(t){if(!t)return null;let e=t.filter(iw);return e.length==0?null:function(r){return aw(ow(r,e))}}function tm(t){return t!=null?lw(cw(t)):null}function uw(t){if(!t)return null;let e=t.filter(iw);return e.length==0?null:function(r){let n=ow(r,e).map(sw);return yy(n).pipe(nt(aw))}}function rm(t){return t!=null?uw(cw(t)):null}function zx(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function hw(t){return t._rawValidators}function fw(t){return t._rawAsyncValidators}function Qp(t){return t?Array.isArray(t)?t:[t]:[]}function yf(t,e){return Array.isArray(t)?t.includes(e):t===e}function Gx(t,e){let r=Qp(e);return Qp(t).forEach(i=>{yf(r,i)||r.push(i)}),r}function qx(t,e){return Qp(e).filter(r=>!yf(t,r))}var xf=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=tm(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=rm(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,r){return this.control?this.control.hasError(e,r):!1}getError(e,r){return this.control?this.control.getError(e,r):null}},Ji=class extends xf{get formDirective(){return null}get path(){return null}},Da=class extends xf{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},wf=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},jD={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},sz=mt(Ie({},jD),{"[class.ng-submitted]":"isSubmitted"}),Vs=(()=>{let e=class e extends wf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Pe(Da,2))},e.\u0275dir=yt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&Cs("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[Fr]});let t=e;return t})(),Bs=(()=>{let e=class e extends wf{constructor(n){super(n)}};e.\u0275fac=function(i){return new(i||e)(Pe(Ji,10))},e.\u0275dir=yt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,s){i&2&&Cs("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)("ng-submitted",s.isSubmitted)},features:[Fr]});let t=e;return t})();var Hl="VALID",vf="INVALID",Xo="PENDING",zl="DISABLED";function nm(t){return(Af(t)?t.validators:t)||null}function WD(t){return Array.isArray(t)?tm(t):t||null}function im(t,e){return(Af(e)?e.asyncValidators:t)||null}function $D(t){return Array.isArray(t)?rm(t):t||null}function Af(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}function dw(t,e,r){let n=t.controls;if(!(e?Object.keys(n):n).length)throw new kt(1e3,"");if(!n[r])throw new kt(1001,"")}function pw(t,e,r){t._forEachChild((n,i)=>{if(r[i]===void 0)throw new kt(1002,"")})}var Yo=class{constructor(e,r){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(r)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Hl}get invalid(){return this.status===vf}get pending(){return this.status==Xo}get disabled(){return this.status===zl}get enabled(){return this.status!==zl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(Gx(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(Gx(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(qx(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(qx(e,this._rawAsyncValidators))}hasValidator(e){return yf(this._rawValidators,e)}hasAsyncValidator(e){return yf(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(r=>{r.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Xo,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=zl,this.errors=null,this._forEachChild(n=>{n.disable(mt(Ie({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(mt(Ie({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!0))}enable(e={}){let r=this._parentMarkedDirty(e.onlySelf);this.status=Hl,this._forEachChild(n=>{n.enable(mt(Ie({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(mt(Ie({},e),{skipPristineCheck:r})),this._onDisabledChange.forEach(n=>n(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Hl||this.status===Xo)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(r=>r._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?zl:Hl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Xo,this._hasOwnPendingAsyncValidator=!0;let r=sw(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(n=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(n,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,r={}){this.errors=e,this._updateControlsErrors(r.emitEvent!==!1)}get(e){let r=e;return r==null||(Array.isArray(r)||(r=r.split(".")),r.length===0)?null:r.reduce((n,i)=>n&&n._find(i),this)}getError(e,r){let n=r?this.get(r):this;return n&&n.errors?n.errors[e]:null}hasError(e,r){return!!this.getError(e,r)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new Rr,this.statusChanges=new Rr}_calculateStatus(){return this._allControlsDisabled()?zl:this.errors?vf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Xo)?Xo:this._anyControlsHaveStatus(vf)?vf:Hl}_anyControlsHaveStatus(e){return this._anyControls(r=>r.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){Af(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let r=this._parent&&this._parent.dirty;return!e&&!!r&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=WD(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=$D(this._rawAsyncValidators)}},Ls=class extends Yo{constructor(e,r,n){super(nm(r),im(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,r){return this.controls[e]?this.controls[e]:(this.controls[e]=r,r.setParent(this),r._registerOnCollectionChange(this._onCollectionChange),r)}addControl(e,r,n={}){this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}removeControl(e,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}setControl(e,r,n={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],r&&this.registerControl(e,r),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,r={}){pw(this,!0,e),Object.keys(e).forEach(n=>{dw(this,!0,n),this.controls[n].setValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(Object.keys(e).forEach(n=>{let i=this.controls[n];i&&i.patchValue(e[n],{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e={},r={}){this._forEachChild((n,i)=>{n.reset(e?e[i]:null,{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this._reduceChildren({},(e,r,n)=>(e[n]=r.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(r,n)=>n._syncPendingControls()?!0:r);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(r=>{let n=this.controls[r];n&&e(n,r)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(let[r,n]of Object.entries(this.controls))if(this.contains(r)&&e(n))return!0;return!1}_reduceValue(){let e={};return this._reduceChildren(e,(r,n,i)=>((n.enabled||this.disabled)&&(r[i]=n.value),r))}_reduceChildren(e,r){let n=e;return this._forEachChild((i,s)=>{n=r(n,i,s)}),n}_allControlsDisabled(){for(let e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}};var Jp=class extends Ls{};var Kl=new it("CallSetDisabledState",{providedIn:"root",factory:()=>Sf}),Sf="always";function mw(t,e){return[...e.path,t]}function Ef(t,e,r=Sf){sm(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||r==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),zD(t,e),qD(t,e),GD(t,e),HD(t,e)}function Kx(t,e,r=!0){let n=()=>{};e.valueAccessor&&(e.valueAccessor.registerOnChange(n),e.valueAccessor.registerOnTouched(n)),bf(t,e),t&&(e._invokeOnDestroyCallbacks(),t._registerOnCollectionChange(()=>{}))}function Tf(t,e){t.forEach(r=>{r.registerOnValidatorChange&&r.registerOnValidatorChange(e)})}function HD(t,e){if(e.valueAccessor.setDisabledState){let r=n=>{e.valueAccessor.setDisabledState(n)};t.registerOnDisabledChange(r),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(r)})}}function sm(t,e){let r=hw(t);e.validator!==null?t.setValidators(zx(r,e.validator)):typeof r=="function"&&t.setValidators([r]);let n=fw(t);e.asyncValidator!==null?t.setAsyncValidators(zx(n,e.asyncValidator)):typeof n=="function"&&t.setAsyncValidators([n]);let i=()=>t.updateValueAndValidity();Tf(e._rawValidators,i),Tf(e._rawAsyncValidators,i)}function bf(t,e){let r=!1;if(t!==null){if(e.validator!==null){let i=hw(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.validator);s.length!==i.length&&(r=!0,t.setValidators(s))}}if(e.asyncValidator!==null){let i=fw(t);if(Array.isArray(i)&&i.length>0){let s=i.filter(a=>a!==e.asyncValidator);s.length!==i.length&&(r=!0,t.setAsyncValidators(s))}}}let n=()=>{};return Tf(e._rawValidators,n),Tf(e._rawAsyncValidators,n),r}function zD(t,e){e.valueAccessor.registerOnChange(r=>{t._pendingValue=r,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&gw(t,e)})}function GD(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&gw(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function gw(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function qD(t,e){let r=(n,i)=>{e.valueAccessor.writeValue(n),i&&e.viewToModelUpdate(n)};t.registerOnChange(r),e._registerOnDestroy(()=>{t._unregisterOnChange(r)})}function vw(t,e){t==null,sm(t,e)}function KD(t,e){return bf(t,e)}function _w(t,e){if(!t.hasOwnProperty("model"))return!1;let r=t.model;return r.isFirstChange()?!0:!Object.is(e,r.currentValue)}function XD(t){return Object.getPrototypeOf(t.constructor)===ql}function yw(t,e){t._syncPendingControls(),e.forEach(r=>{let n=r.control;n.updateOn==="submit"&&n._pendingChange&&(r.viewToModelUpdate(n._pendingValue),n._pendingChange=!1)})}function xw(t,e){if(!e)return null;Array.isArray(e);let r,n,i;return e.forEach(s=>{s.constructor===Ii?r=s:XD(s)?n=s:i=s}),i||n||r||null}function YD(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}var QD={provide:Ji,useExisting:Vn(()=>am)},Gl=Promise.resolve(),am=(()=>{let e=class e extends Ji{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Rr,this.form=new Ls({},tm(n),rm(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(n){Gl.then(()=>{let i=this._findContainer(n.path);n.control=i.registerControl(n.name,n.control),Ef(n.control,n,this.callSetDisabledState),n.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(n)})}getControl(n){return this.form.get(n.path)}removeControl(n){Gl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name),this._directives.delete(n)})}addFormGroup(n){Gl.then(()=>{let i=this._findContainer(n.path),s=new Ls({});vw(s,n),i.registerControl(n.name,s),s.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(n){Gl.then(()=>{let i=this._findContainer(n.path);i&&i.removeControl(n.name)})}getFormGroup(n){return this.form.get(n.path)}updateModel(n,i){Gl.then(()=>{this.form.get(n.path).setValue(i)})}setValue(n){this.control.setValue(n)}onSubmit(n){return this.submitted=!0,yw(this.form,this._directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(n){return n.pop(),n.length?this.form.get(n):this.form}};e.\u0275fac=function(i){return new(i||e)(Pe(Qo,10),Pe(If,10),Pe(Kl,8))},e.\u0275dir=yt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,s){i&1&&ct("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{options:[vr.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Pr([QD]),Fr]});let t=e;return t})();function Xx(t,e){let r=t.indexOf(e);r>-1&&t.splice(r,1)}function Yx(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var bi=class extends Yo{constructor(e=null,r,n){super(nm(r),im(n,r)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(r),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Af(r)&&(r.nonNullable||r.initialValueIsDefault)&&(Yx(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,r={}){this.value=this._pendingValue=e,this._onChange.length&&r.emitModelToViewChange!==!1&&this._onChange.forEach(n=>n(this.value,r.emitViewToModelChange!==!1)),this.updateValueAndValidity(r)}patchValue(e,r={}){this.setValue(e,r)}reset(e=this.defaultValue,r={}){this._applyFormState(e),this.markAsPristine(r),this.markAsUntouched(r),this.setValue(this.value,r),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Xx(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Xx(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){Yx(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var JD=t=>t instanceof bi;var ZD={provide:Da,useExisting:Vn(()=>Xl)},Qx=Promise.resolve(),Xl=(()=>{let e=class e extends Da{constructor(n,i,s,a,o,c){super(),this._changeDetectorRef=o,this.callSetDisabledState=c,this.control=new bi,this._registered=!1,this.name="",this.update=new Rr,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=xw(this,a)}ngOnChanges(n){if(this._checkForErrors(),!this._registered||"name"in n){if(this._registered&&(this._checkName(),this.formDirective)){let i=n.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in n&&this._updateDisabled(n),_w(n,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Ef(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(n){Qx.then(()=>{this.control.setValue(n,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(n){let i=n.isDisabled.currentValue,s=i!==0&&Xi(i);Qx.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(n){return this._parent?mw(n,this._parent):[n]}};e.\u0275fac=function(i){return new(i||e)(Pe(Ji,9),Pe(Qo,10),Pe(If,10),Pe(Ra,10),Pe(Ds,8),Pe(Kl,8))},e.\u0275dir=yt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[vr.None,"disabled","isDisabled"],model:[vr.None,"ngModel","model"],options:[vr.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Pr([ZD]),Fr,ri]});let t=e;return t})(),Us=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=yt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]});let t=e;return t})(),eR={provide:Ra,useExisting:Vn(()=>om),multi:!0},om=(()=>{let e=class e extends ql{writeValue(n){let i=n??"";this.setProperty("value",i)}registerOnChange(n){this.onChange=i=>{n(i==""?null:parseFloat(i))}}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,s){i&1&&ct("input",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},features:[Pr([eR]),Fr]});let t=e;return t})();var ww=new it("");var tR={provide:Ji,useExisting:Vn(()=>Fa)},Fa=(()=>{let e=class e extends Ji{constructor(n,i,s){super(),this.callSetDisabledState=s,this.submitted=!1,this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Rr,this._setValidators(n),this._setAsyncValidators(i)}ngOnChanges(n){this._checkFormPresent(),n.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(bf(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(n){let i=this.form.get(n.path);return Ef(i,n,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(n),i}getControl(n){return this.form.get(n.path)}removeControl(n){Kx(n.control||null,n,!1),YD(this.directives,n)}addFormGroup(n){this._setUpFormContainer(n)}removeFormGroup(n){this._cleanUpFormContainer(n)}getFormGroup(n){return this.form.get(n.path)}addFormArray(n){this._setUpFormContainer(n)}removeFormArray(n){this._cleanUpFormContainer(n)}getFormArray(n){return this.form.get(n.path)}updateModel(n,i){this.form.get(n.path).setValue(i)}onSubmit(n){return this.submitted=!0,yw(this.form,this.directives),this.ngSubmit.emit(n),n?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(n=void 0){this.form.reset(n),this.submitted=!1}_updateDomValue(){this.directives.forEach(n=>{let i=n.control,s=this.form.get(n.path);i!==s&&(Kx(i||null,n),JD(s)&&(Ef(s,n,this.callSetDisabledState),n.control=s))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(n){let i=this.form.get(n.path);vw(i,n),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(n){if(this.form){let i=this.form.get(n.path);i&&KD(i,n)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){sm(this.form,this),this._oldForm&&bf(this._oldForm,this)}_checkFormPresent(){this.form}};e.\u0275fac=function(i){return new(i||e)(Pe(Qo,10),Pe(If,10),Pe(Kl,8))},e.\u0275dir=yt({type:e,selectors:[["","formGroup",""]],hostBindings:function(i,s){i&1&&ct("submit",function(o){return s.onSubmit(o)})("reset",function(){return s.onReset()})},inputs:{form:[vr.None,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Pr([tR]),Fr,ri]});let t=e;return t})();var rR={provide:Da,useExisting:Vn(()=>Pa)},Pa=(()=>{let e=class e extends Da{set isDisabled(n){}constructor(n,i,s,a,o){super(),this._ngModelWarningConfig=o,this._added=!1,this.name=null,this.update=new Rr,this._ngModelWarningSent=!1,this._parent=n,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=xw(this,a)}ngOnChanges(n){this._added||this._setUpControl(),_w(n,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(n){this.viewModel=n,this.update.emit(n)}get path(){return mw(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}};e._ngModelWarningSentOnce=!1,e.\u0275fac=function(i){return new(i||e)(Pe(Ji,13),Pe(Qo,10),Pe(If,10),Pe(Ra,10),Pe(ww,8))},e.\u0275dir=yt({type:e,selectors:[["","formControlName",""]],inputs:{name:[vr.None,"formControlName","name"],isDisabled:[vr.None,"disabled","isDisabled"],model:[vr.None,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[Pr([rR]),Fr,ri]});let t=e;return t})(),nR={provide:Ra,useExisting:Vn(()=>Cf),multi:!0};function Ew(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function iR(t){return t.split(":")[0]}var Cf=(()=>{let e=class e extends ql{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i=this._getOptionId(n),s=Ew(i,n);this.setProperty("value",s)}registerOnChange(n){this.onChange=i=>{this.value=this._getOptionValue(i),n(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),n))return i;return null}_getOptionValue(n){let i=iR(n);return this._optionMap.has(i)?this._optionMap.get(i):n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&ct("change",function(o){return s.onChange(o.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Pr([nR]),Fr]});let t=e;return t})(),Tw=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(n){this._select!=null&&(this._select._optionMap.set(this.id,n),this._setElementValue(Ew(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._setElementValue(n),this._select&&this._select.writeValue(this._select.value)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(Pe(vn),Pe(Ea),Pe(Cf,9))},e.\u0275dir=yt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),sR={provide:Ra,useExisting:Vn(()=>bw),multi:!0};function Jx(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function aR(t){return t.split(":")[0]}var bw=(()=>{let e=class e extends ql{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(n){this._compareWith=n}writeValue(n){this.value=n;let i;if(Array.isArray(n)){let s=n.map(a=>this._getOptionId(a));i=(a,o)=>{a._setSelected(s.indexOf(o.toString())>-1)}}else i=(s,a)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(n){this.onChange=i=>{let s=[],a=i.selectedOptions;if(a!==void 0){let o=a;for(let c=0;c<o.length;c++){let l=o[c],h=this._getOptionValue(l.value);s.push(h)}}else{let o=i.options;for(let c=0;c<o.length;c++){let l=o[c];if(l.selected){let h=this._getOptionValue(l.value);s.push(h)}}}this.value=s,n(s)}}_registerOption(n){let i=(this._idCounter++).toString();return this._optionMap.set(i,n),i}_getOptionId(n){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,n))return i;return null}_getOptionValue(n){let i=aR(n);return this._optionMap.has(i)?this._optionMap.get(i)._value:n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&ct("change",function(o){return s.onChange(o.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Pr([sR]),Fr]});let t=e;return t})(),Iw=(()=>{let e=class e{constructor(n,i,s){this._element=n,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(n){this._select!=null&&(this._value=n,this._setElementValue(Jx(this.id,n)),this._select.writeValue(this._select.value))}set value(n){this._select?(this._value=n,this._setElementValue(Jx(this.id,n)),this._select.writeValue(this._select.value)):this._setElementValue(n)}_setElementValue(n){this._renderer.setProperty(this._element.nativeElement,"value",n)}_setSelected(n){this._renderer.setProperty(this._element.nativeElement,"selected",n)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(Pe(vn),Pe(Ea),Pe(bw,9))},e.\u0275dir=yt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();function oR(t){return typeof t=="number"?t:parseFloat(t)}var Aw=(()=>{let e=class e{constructor(){this._validator=_f}ngOnChanges(n){if(this.inputName in n){let i=this.normalizeInput(n[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):_f,this._onChange&&this._onChange()}}validate(n){return this._validator(n)}registerOnValidatorChange(n){this._onChange=n}enabled(n){return n!=null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=yt({type:e,features:[ri]});let t=e;return t})();var cR={provide:Qo,useExisting:Vn(()=>cm),multi:!0},cm=(()=>{let e=class e extends Aw{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=n=>oR(n),this.createValidator=n=>rw(n)}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,s){i&2&&Ss("min",s._enabled?s.min:null)},inputs:{min:"min"},features:[Pr([cR]),Fr]});let t=e;return t})(),lR={provide:Qo,useExisting:Vn(()=>Oa),multi:!0};var Oa=(()=>{let e=class e extends Aw{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=Xi,this.createValidator=n=>nw}enabled(n){return n}};e.\u0275fac=(()=>{let n;return function(s){return(n||(n=gn(e)))(s||e)}})(),e.\u0275dir=yt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,s){i&2&&Ss("required",s._enabled?"":null)},inputs:{required:"required"},features:[Pr([lR]),Fr]});let t=e;return t})();var Sw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({});let t=e;return t})(),Zp=class extends Yo{constructor(e,r,n){super(nm(r),im(n,r)),this.controls=e,this._initObservables(),this._setUpdateStrategy(r),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(e){return this.controls[this._adjustIndex(e)]}push(e,r={}){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}insert(e,r,n={}){this.controls.splice(e,0,r),this._registerControl(r),this.updateValueAndValidity({emitEvent:n.emitEvent})}removeAt(e,r={}){let n=this._adjustIndex(e);n<0&&(n=0),this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:r.emitEvent})}setControl(e,r,n={}){let i=this._adjustIndex(e);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),r&&(this.controls.splice(i,0,r),this._registerControl(r)),this.updateValueAndValidity({emitEvent:n.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(e,r={}){pw(this,!1,e),e.forEach((n,i)=>{dw(this,!1,i),this.at(i).setValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r)}patchValue(e,r={}){e!=null&&(e.forEach((n,i)=>{this.at(i)&&this.at(i).patchValue(n,{onlySelf:!0,emitEvent:r.emitEvent})}),this.updateValueAndValidity(r))}reset(e=[],r={}){this._forEachChild((n,i)=>{n.reset(e[i],{onlySelf:!0,emitEvent:r.emitEvent})}),this._updatePristine(r),this._updateTouched(r),this.updateValueAndValidity(r)}getRawValue(){return this.controls.map(e=>e.getRawValue())}clear(e={}){this.controls.length<1||(this._forEachChild(r=>r._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:e.emitEvent}))}_adjustIndex(e){return e<0?e+this.length:e}_syncPendingControls(){let e=this.controls.reduce((r,n)=>n._syncPendingControls()?!0:r,!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){this.controls.forEach((r,n)=>{e(r,n)})}_updateValue(){this.value=this.controls.filter(e=>e.enabled||this.disabled).map(e=>e.value)}_anyControls(e){return this.controls.some(r=>r.enabled&&e(r))}_setUpControls(){this._forEachChild(e=>this._registerControl(e))}_allControlsDisabled(){for(let e of this.controls)if(e.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}_find(e){return this.at(e)??null}};function Zx(t){return!!t&&(t.asyncValidators!==void 0||t.validators!==void 0||t.updateOn!==void 0)}var kf=(()=>{let e=class e{constructor(){this.useNonNullable=!1}get nonNullable(){let n=new e;return n.useNonNullable=!0,n}group(n,i=null){let s=this._reduceControls(n),a={};return Zx(i)?a=i:i!==null&&(a.validators=i.validator,a.asyncValidators=i.asyncValidator),new Ls(s,a)}record(n,i=null){let s=this._reduceControls(n);return new Jp(s,i)}control(n,i,s){let a={};return this.useNonNullable?(Zx(i)?a=i:(a.validators=i,a.asyncValidators=s),new bi(n,mt(Ie({},a),{nonNullable:!0}))):new bi(n,i,s)}array(n,i,s){let a=n.map(o=>this._createControl(o));return new Zp(a,i,s)}_reduceControls(n){let i={};return Object.keys(n).forEach(s=>{i[s]=this._createControl(n[s])}),i}_createControl(n){if(n instanceof bi)return n;if(n instanceof Yo)return n;if(Array.isArray(n)){let i=n[0],s=n.length>1?n[1]:null,a=n.length>2?n[2]:null;return this.control(i,s,a)}else return this.control(n)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Jo=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:Kl,useValue:n.callSetDisabledState??Sf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({imports:[Sw]});let t=e;return t})(),Zo=(()=>{let e=class e{static withConfig(n){return{ngModule:e,providers:[{provide:ww,useValue:n.warnOnNgModelWithFormControl??"always"},{provide:Kl,useValue:n.callSetDisabledState??Sf}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({imports:[Sw]});let t=e;return t})();var Cw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({});let t=e;return t})();var kw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({});let t=e;return t})();var lm;try{lm=typeof Intl<"u"&&Intl.v8BreakIterator}catch{lm=!1}var Ql=(()=>{let e=class e{constructor(n){this._platformId=n,this.isBrowser=this._platformId?$y(this._platformId):typeof document=="object"&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!!(window.chrome||lm)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}};e.\u0275fac=function(i){return new(i||e)($e(ni))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Yl;function hR(){if(Yl==null&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Yl=!0}))}finally{Yl=Yl||!1}return Yl}function um(t){return hR()?t:!!t.capture}function Dw(t){return t.composedPath?t.composedPath()[0]:t.target}function Rw(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}function hm(t){return Array.isArray(t)?t:[t]}function fm(t){return t instanceof vn?t.nativeElement:t}var Pw=new Set,Na,fR=(()=>{let e=class e{constructor(n,i){this._platform=n,this._nonce=i,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):pR}matchMedia(n){return(this._platform.WEBKIT||this._platform.BLINK)&&dR(n,this._nonce),this._matchMedia(n)}};e.\u0275fac=function(i){return new(i||e)($e(Ql),$e(ml,8))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function dR(t,e){if(!Pw.has(t))try{Na||(Na=document.createElement("style"),e&&Na.setAttribute("nonce",e),Na.setAttribute("type","text/css"),document.head.appendChild(Na)),Na.sheet&&(Na.sheet.insertRule(`@media ${t} {body{ }}`,0),Pw.add(t))}catch(r){console.error(r)}}function pR(t){return{matches:t==="all"||t==="",media:t,addListener:()=>{},removeListener:()=>{}}}var Nw=(()=>{let e=class e{constructor(n,i){this._mediaMatcher=n,this._zone=i,this._queries=new Map,this._destroySubject=new On}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(n){return Ow(hm(n)).some(s=>this._registerQuery(s).mql.matches)}observe(n){let s=Ow(hm(n)).map(o=>this._registerQuery(o).observable),a=dl(s);return a=Dh(a.pipe(Is(1)),a.pipe(Iy(1),xy(0))),a.pipe(nt(o=>{let c={matches:!1,breakpoints:{}};return o.forEach(({matches:l,query:h})=>{c.matches=c.matches||l,c.breakpoints[h]=l}),c}))}_registerQuery(n){if(this._queries.has(n))return this._queries.get(n);let i=this._mediaMatcher.matchMedia(n),a={observable:new Gi(o=>{let c=l=>this._zone.run(()=>o.next(l));return i.addListener(c),()=>{i.removeListener(c)}}).pipe(Rh(i),nt(({matches:o})=>({query:n,matches:o})),Fh(this._destroySubject)),mql:i};return this._queries.set(n,a),a}};e.\u0275fac=function(i){return new(i||e)($e(fR),$e(Wt))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function Ow(t){return t.map(e=>e.split(",")).reduce((e,r)=>e.concat(r)).map(e=>e.trim())}function Vw(t){return t.buttons===0||t.detail===0}function Bw(t){let e=t.touches&&t.touches[0]||t.changedTouches&&t.changedTouches[0];return!!e&&e.identifier===-1&&(e.radiusX==null||e.radiusX===1)&&(e.radiusY==null||e.radiusY===1)}var Ma=function(t){return t[t.NONE=0]="NONE",t[t.BLACK_ON_WHITE=1]="BLACK_ON_WHITE",t[t.WHITE_ON_BLACK=2]="WHITE_ON_BLACK",t}(Ma||{}),Mw="cdk-high-contrast-black-on-white",Lw="cdk-high-contrast-white-on-black",dm="cdk-high-contrast-active",Uw=(()=>{let e=class e{constructor(n,i){this._platform=n,this._document=i,this._breakpointSubscription=Ce(Nw).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return Ma.NONE;let n=this._document.createElement("div");n.style.backgroundColor="rgb(1,2,3)",n.style.position="absolute",this._document.body.appendChild(n);let i=this._document.defaultView||window,s=i&&i.getComputedStyle?i.getComputedStyle(n):null,a=(s&&s.backgroundColor||"").replace(/ /g,"");switch(n.remove(),a){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return Ma.WHITE_ON_BLACK;case"rgb(255,255,255)":case"rgb(255,250,239)":return Ma.BLACK_ON_WHITE}return Ma.NONE}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){let n=this._document.body.classList;n.remove(dm,Mw,Lw),this._hasCheckedHighContrastMode=!0;let i=this.getHighContrastMode();i===Ma.BLACK_ON_WHITE?n.add(dm,Mw):i===Ma.WHITE_ON_BLACK&&n.add(dm,Lw)}}};e.\u0275fac=function(i){return new(i||e)($e(Ql),$e(yr))},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var pm=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({});let t=e;return t})();function xR(){return!0}var wR=new it("mat-sanity-checks",{providedIn:"root",factory:xR}),qw=(()=>{let e=class e{constructor(n,i,s){this._sanityChecks=i,this._document=s,this._hasDoneGlobalChecks=!1,n._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(n){return Rw()?!1:typeof this._sanityChecks=="boolean"?this._sanityChecks:!!this._sanityChecks[n]}};e.\u0275fac=function(i){return new(i||e)($e(Uw),$e(wR,8),$e(yr))},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({imports:[pm,pm]});let t=e;return t})();var Un=function(t){return t[t.FADING_IN=0]="FADING_IN",t[t.VISIBLE=1]="VISIBLE",t[t.FADING_OUT=2]="FADING_OUT",t[t.HIDDEN=3]="HIDDEN",t}(Un||{}),mm=class{constructor(e,r,n,i=!1){this._renderer=e,this.element=r,this.config=n,this._animationForciblyDisabledThroughCss=i,this.state=Un.HIDDEN}fadeOut(){this._renderer.fadeOutRipple(this)}},jw=um({passive:!0,capture:!0}),gm=class{constructor(){this._events=new Map,this._delegateEventHandler=e=>{let r=Dw(e);r&&this._events.get(e.type)?.forEach((n,i)=>{(i===r||i.contains(r))&&n.forEach(s=>s.handleEvent(e))})}}addHandler(e,r,n,i){let s=this._events.get(r);if(s){let a=s.get(n);a?a.add(i):s.set(n,new Set([i]))}else this._events.set(r,new Map([[n,new Set([i])]])),e.runOutsideAngular(()=>{document.addEventListener(r,this._delegateEventHandler,jw)})}removeHandler(e,r,n){let i=this._events.get(e);if(!i)return;let s=i.get(r);s&&(s.delete(n),s.size===0&&i.delete(r),i.size===0&&(this._events.delete(e),document.removeEventListener(e,this._delegateEventHandler,jw)))}},Ww={enterDuration:225,exitDuration:150},ER=800,$w=um({passive:!0,capture:!0}),Hw=["mousedown","touchstart"],zw=["mouseup","mouseleave","touchend","touchcancel"],Jl=class Jl{constructor(e,r,n,i){this._target=e,this._ngZone=r,this._platform=i,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,i.isBrowser&&(this._containerElement=fm(n))}fadeInRipple(e,r,n={}){let i=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),s=Ie(Ie({},Ww),n.animation);n.centered&&(e=i.left+i.width/2,r=i.top+i.height/2);let a=n.radius||TR(e,r,i),o=e-i.left,c=r-i.top,l=s.enterDuration,h=document.createElement("div");h.classList.add("mat-ripple-element"),h.style.left=`${o-a}px`,h.style.top=`${c-a}px`,h.style.height=`${a*2}px`,h.style.width=`${a*2}px`,n.color!=null&&(h.style.backgroundColor=n.color),h.style.transitionDuration=`${l}ms`,this._containerElement.appendChild(h);let f=window.getComputedStyle(h),d=f.transitionProperty,m=f.transitionDuration,v=d==="none"||m==="0s"||m==="0s, 0s"||i.width===0&&i.height===0,p=new mm(this,h,n,v);h.style.transform="scale3d(1, 1, 1)",p.state=Un.FADING_IN,n.persistent||(this._mostRecentTransientRipple=p);let _=null;return!v&&(l||s.exitDuration)&&this._ngZone.runOutsideAngular(()=>{let T=()=>this._finishRippleTransition(p),S=()=>this._destroyRipple(p);h.addEventListener("transitionend",T),h.addEventListener("transitioncancel",S),_={onTransitionEnd:T,onTransitionCancel:S}}),this._activeRipples.set(p,_),(v||!l)&&this._finishRippleTransition(p),p}fadeOutRipple(e){if(e.state===Un.FADING_OUT||e.state===Un.HIDDEN)return;let r=e.element,n=Ie(Ie({},Ww),e.config.animation);r.style.transitionDuration=`${n.exitDuration}ms`,r.style.opacity="0",e.state=Un.FADING_OUT,(e._animationForciblyDisabledThroughCss||!n.exitDuration)&&this._finishRippleTransition(e)}fadeOutAll(){this._getActiveRipples().forEach(e=>e.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(e=>{e.config.persistent||e.fadeOut()})}setupTriggerEvents(e){let r=fm(e);!this._platform.isBrowser||!r||r===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=r,Hw.forEach(n=>{Jl._eventManager.addHandler(this._ngZone,n,r,this)}))}handleEvent(e){e.type==="mousedown"?this._onMousedown(e):e.type==="touchstart"?this._onTouchStart(e):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{zw.forEach(r=>{this._triggerElement.addEventListener(r,this,$w)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(e){e.state===Un.FADING_IN?this._startFadeOutTransition(e):e.state===Un.FADING_OUT&&this._destroyRipple(e)}_startFadeOutTransition(e){let r=e===this._mostRecentTransientRipple,{persistent:n}=e.config;e.state=Un.VISIBLE,!n&&(!r||!this._isPointerDown)&&e.fadeOut()}_destroyRipple(e){let r=this._activeRipples.get(e)??null;this._activeRipples.delete(e),this._activeRipples.size||(this._containerRect=null),e===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),e.state=Un.HIDDEN,r!==null&&(e.element.removeEventListener("transitionend",r.onTransitionEnd),e.element.removeEventListener("transitioncancel",r.onTransitionCancel)),e.element.remove()}_onMousedown(e){let r=Vw(e),n=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+ER;!this._target.rippleDisabled&&!r&&!n&&(this._isPointerDown=!0,this.fadeInRipple(e.clientX,e.clientY,this._target.rippleConfig))}_onTouchStart(e){if(!this._target.rippleDisabled&&!Bw(e)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;let r=e.changedTouches;if(r)for(let n=0;n<r.length;n++)this.fadeInRipple(r[n].clientX,r[n].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(e=>{let r=e.state===Un.VISIBLE||e.config.terminateOnPointerUp&&e.state===Un.FADING_IN;!e.config.persistent&&r&&e.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){let e=this._triggerElement;e&&(Hw.forEach(r=>Jl._eventManager.removeHandler(r,e,this)),this._pointerUpEventsRegistered&&(zw.forEach(r=>e.removeEventListener(r,this,$w)),this._pointerUpEventsRegistered=!1))}};Jl._eventManager=new gm;var Gw=Jl;function TR(t,e,r){let n=Math.max(Math.abs(t-r.left),Math.abs(t-r.right)),i=Math.max(Math.abs(e-r.top),Math.abs(e-r.bottom));return Math.sqrt(n*n+i*i)}var Kw=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Zt({type:e}),e.\u0275inj=Jt({imports:[qw,Cw,kw]});let t=e;return t})();var fu={};fu.version="0.18.5";var Di=1200,uc=1252,bR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],$m={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Hm=function(t){bR.indexOf(t)!=-1&&(uc=$m[0]=t)};function IR(){Hm(1252)}var oi=function(t){Di=t,Hm(t)};function zm(){oi(1200),IR()}function Rm(t){for(var e=[],r=0,n=t.length;r<n;++r)e[r]=t.charCodeAt(r);return e}function AR(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r)+(t.charCodeAt(2*r+1)<<8));return e.join("")}function nT(t){for(var e=[],r=0;r<t.length>>1;++r)e[r]=String.fromCharCode(t.charCodeAt(2*r+1)+(t.charCodeAt(2*r)<<8));return e.join("")}var tu=function(t){var e=t.charCodeAt(0),r=t.charCodeAt(1);return e==255&&r==254?AR(t.slice(2)):e==254&&r==255?nT(t.slice(2)):e==65279?t.slice(1):t},Rf=function(e){return String.fromCharCode(e)},Xw=function(e){return String.fromCharCode(e)},_t;var Xt=null,Zl=!0,Ws="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function du(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0,l=0;l<t.length;)r=t.charCodeAt(l++),s=r>>2,n=t.charCodeAt(l++),a=(r&3)<<4|n>>4,i=t.charCodeAt(l++),o=(n&15)<<2|i>>6,c=i&63,isNaN(n)?o=c=64:isNaN(i)&&(c=64),e+=Ws.charAt(s)+Ws.charAt(a)+Ws.charAt(o)+Ws.charAt(c);return e}function An(t){var e="",r=0,n=0,i=0,s=0,a=0,o=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<t.length;)s=Ws.indexOf(t.charAt(l++)),a=Ws.indexOf(t.charAt(l++)),r=s<<2|a>>4,e+=String.fromCharCode(r),o=Ws.indexOf(t.charAt(l++)),n=(a&15)<<4|o>>2,o!==64&&(e+=String.fromCharCode(n)),c=Ws.indexOf(t.charAt(l++)),i=(o&3)<<6|c,c!==64&&(e+=String.fromCharCode(i));return e}var Ze=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),is=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Hs(t){return Ze?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function Yw(t){return Ze?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var bn=function(e){return Ze?is(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function ed(t){if(typeof ArrayBuffer>"u")return bn(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function Ks(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function SR(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}function Gm(t){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(t instanceof ArrayBuffer)return Gm(new Uint8Array(t));for(var e=new Array(t.length),r=0;r<t.length;++r)e[r]=t[r];return e}var Er=Ze?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:is(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function CR(t){for(var e=[],r=0,n=t.length+250,i=Hs(t.length+255),s=0;s<t.length;++s){var a=t.charCodeAt(s);if(a<128)i[r++]=a;else if(a<2048)i[r++]=192|a>>6&31,i[r++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=t.charCodeAt(++s)&1023;i[r++]=240|a>>8&7,i[r++]=128|a>>2&63,i[r++]=128|o>>6&15|(a&3)<<4,i[r++]=128|o&63}else i[r++]=224|a>>12&15,i[r++]=128|a>>6&63,i[r++]=128|a&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Hs(65535),n=65530)}return e.push(i.slice(0,r)),Er(e)}var Gr=/\u0000/g,ru=/[\u0001-\u0006]/g;function ac(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function ci(t,e){var r=""+t;return r.length>=e?r:qt("0",e-r.length)+r}function qm(t,e){var r=""+t;return r.length>=e?r:qt(" ",e-r.length)+r}function Wf(t,e){var r=""+t;return r.length>=e?r:r+qt(" ",e-r.length)}function kR(t,e){var r=""+Math.round(t);return r.length>=e?r:qt("0",e-r.length)+r}function DR(t,e){var r=""+t;return r.length>=e?r:qt("0",e-r.length)+r}var Qw=Math.pow(2,32);function ec(t,e){if(t>Qw||t<-Qw)return kR(t,e);var r=Math.round(t);return DR(r,e)}function $f(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var Jw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],vm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function RR(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',t}var Le={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Zw={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},FR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hf(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,a=1,o=0,c=1,l=0,h=0,f=Math.floor(i);l<e&&(f=Math.floor(i),o=f*a+s,h=f*l+c,!(i-f<5e-8));)i=1/(i-f),s=a,a=o,c=l,l=h;if(h>e&&(l>e?(h=c,o=s):(h=l,o=a)),!r)return[0,n*o,h];var d=Math.floor(n*o/h);return[d,n*o-d*h,h]}function Va(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,a=[],o={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),e&&e.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)a=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)a=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),a=[c.getFullYear(),c.getMonth()+1,c.getDate()],s=c.getDay(),n<60&&(s=(s+6)%7),r&&(s=VR(c,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var iT=new Date(1899,11,31,0,0,0),PR=iT.getTime(),OR=new Date(1900,2,1,0,0,0);function sT(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=OR&&(r+=24*60*60*1e3),(r-(PR+(t.getTimezoneOffset()-iT.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Km(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function NR(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function MR(t){var e=t<0?12:11,r=Km(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function LR(t){var e=Km(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function pu(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=MR(t):e===10?r=t.toFixed(10).substr(0,12):r=LR(t),Km(NR(r.toUpperCase()))}function $a(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):pu(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Kn(14,sT(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function VR(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function BR(t,e,r,n){var i="",s=0,a=0,o=r.y,c,l=0;switch(t){case 98:o=r.y+543;case 121:switch(e.length){case 1:case 2:c=o%100,l=2;break;default:c=o%1e4,l=4;break}break;case 109:switch(e.length){case 1:case 2:c=r.m,l=e.length;break;case 3:return vm[r.m-1][1];case 5:return vm[r.m-1][0];default:return vm[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:c=r.d,l=e.length;break;case 3:return Jw[r.q][0];default:return Jw[r.q][1]}break;case 104:switch(e.length){case 1:case 2:c=1+(r.H+11)%12,l=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:c=r.H,l=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:c=r.M,l=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?ci(r.S,e.length):(n>=2?a=n===3?1e3:100:a=n===1?10:1,s=Math.round(a*(r.S+r.u)),s>=60*a&&(s=0),e==="s"?s===0?"0":""+s/a:(i=ci(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}l=e.length===3?1:2;break;case 101:c=o,l=1;break}var h=l>0?ci(c,l):"";return h}function $s(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var aT=/%/g;function UR(t,e,r){var n=e.replace(aT,""),i=e.length-n.length;return es(t,n,r*Math.pow(10,2*i))+qt("%",i)}function jR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return es(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function oT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+oT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var a=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var cT=/# (\?+)( ?)\/( ?)(\d+)/;function WR(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),a=i-s*n,o=n;return r+(s===0?"":""+s)+" "+(a===0?qt(" ",t[1].length+1+t[4].length):qm(a,t[1].length)+t[2]+"/"+t[3]+ci(o,t[4].length))}function $R(t,e,r){return r+(e===0?"":""+e)+qt(" ",t[1].length+2+t[4].length)}var lT=/^#*0*\.([0#]+)/,uT=/\).*[0#]/,hT=/\(###\) ###\\?-####/;function sn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function eE(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function tE(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function HR(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function zR(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Wn(t,e,r){if(t.charCodeAt(0)===40&&!e.match(uT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Wn("n",n,r):"("+Wn("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return jR(t,e,r);if(e.indexOf("%")!==-1)return UR(t,e,r);if(e.indexOf("E")!==-1)return oT(e,r);if(e.charCodeAt(0)===36)return"$"+Wn(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+ec(c,e.length);if(e.match(/^[#?]+$/))return i=ec(r,0),i==="0"&&(i=""),i.length>e.length?i:sn(e.substr(0,e.length-i.length))+i;if(s=e.match(cT))return WR(s,c,l);if(e.match(/^#+0+$/))return l+ec(c,e.length-e.indexOf("0"));if(s=e.match(lT))return i=eE(r,s[1].length).replace(/^([^\.]+)$/,"$1."+sn(s[1])).replace(/\.$/,"."+sn(s[1])).replace(/\.(\d*)$/,function(v,p){return"."+p+qt("0",sn(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+eE(c,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+$s(ec(c,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Wn(t,e,-r):$s(""+(Math.floor(r)+HR(r,s[1].length)))+"."+ci(tE(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Wn(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ac(Wn(t,e.replace(/[\\-]/g,""),r)),a=0,ac(ac(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(hT))return i=Wn(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Hf(c,Math.pow(10,a)-1,!1),i=""+l,h=es("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Wf(o[2],a),h.length<s[4].length&&(h=sn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Hf(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qm(o[1],a)+s[2]+"/"+s[3]+Wf(o[2],a):qt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=ec(r,0),e.length<=i.length?i:sn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return sn(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return a=tE(r,s[1].length),r<0?"-"+Wn(t,e,-r):$s(zR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ci(0,3-v.length):"")+v})+"."+ci(a,s[1].length);switch(e){case"###,##0.00":return Wn(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var m=$s(ec(c,0));return m!=="0"?l+m:"";case"###,###.00":return Wn(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Wn(t,"#,##0.00",r).replace(/^0\./,".");default:}throw new Error("unsupported format |"+e+"|")}function GR(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return es(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function qR(t,e,r){var n=e.replace(aT,""),i=e.length-n.length;return es(t,n,r*Math.pow(10,2*i))+qt("%",i)}function fT(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+fT(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var a=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(a-r.length+s):r+="E+"+(a-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,l,h){return c+l+h.substr(0,(i+s)%i)+"."+h.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Si(t,e,r){if(t.charCodeAt(0)===40&&!e.match(uT)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Si("n",n,r):"("+Si("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return GR(t,e,r);if(e.indexOf("%")!==-1)return qR(t,e,r);if(e.indexOf("E")!==-1)return fT(e,r);if(e.charCodeAt(0)===36)return"$"+Si(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,a,o,c=Math.abs(r),l=r<0?"-":"";if(e.match(/^00+$/))return l+ci(c,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:sn(e.substr(0,e.length-i.length))+i;if(s=e.match(cT))return $R(s,c,l);if(e.match(/^#+0+$/))return l+ci(c,e.length-e.indexOf("0"));if(s=e.match(lT))return i=(""+r).replace(/^([^\.]+)$/,"$1."+sn(s[1])).replace(/\.$/,"."+sn(s[1])),i=i.replace(/\.(\d*)$/,function(v,p){return"."+p+qt("0",sn(s[1]).length-p.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return l+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return l+$s(""+c);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Si(t,e,-r):$s(""+r)+"."+qt("0",s[1].length);if(s=e.match(/^#,#*,#0/))return Si(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=ac(Si(t,e.replace(/[\\-]/g,""),r)),a=0,ac(ac(e.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(e.match(hT))return i=Si(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=Hf(c,Math.pow(10,a)-1,!1),i=""+l,h=es("n",s[1],o[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+s[2]+"/"+s[3],h=Wf(o[2],a),h.length<s[4].length&&(h=sn(s[4].substr(s[4].length-h.length))+h),i+=h,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=Hf(c,Math.pow(10,a)-1,!0),l+(o[0]||(o[1]?"":"0"))+" "+(o[1]?qm(o[1],a)+s[2]+"/"+s[3]+Wf(o[2],a):qt(" ",2*a+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:sn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var f=e.indexOf(".")-a,d=e.length-i.length-f;return sn(e.substr(0,f)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Si(t,e,-r):$s(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?ci(0,3-v.length):"")+v})+"."+ci(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var m=$s(""+c);return m!=="0"?l+m:"";default:if(e.match(/\.[0#?]*$/))return Si(t,e.slice(0,e.lastIndexOf(".")),r)+sn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function es(t,e,r){return(r|0)===r?Si(t,e,r):Wn(t,e,r)}function KR(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var dT=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function mc(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":$f(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(dT))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function XR(t,e,r,n){for(var i=[],s="",a=0,o="",c="t",l,h,f,d="H";a<t.length;)switch(o=t.charAt(a)){case"G":if(!$f(t,a))throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(f=t.charCodeAt(++a))!==34&&a<t.length;)s+=String.fromCharCode(f);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=t.charAt(++a),v=m==="("||m===")"?m:"t";i[i.length]={t:v,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:e},++a;break;case"B":case"b":if(t.charAt(a+1)==="1"||t.charAt(a+1)==="2"){if(l==null&&(l=Va(e,r,t.charAt(a+1)==="2"),l==null))return"";i[i.length]={t:"X",v:t.substr(a,2)},c=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||l==null&&(l=Va(e,r),l==null))return"";for(s=o;++a<t.length&&t.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=d),i[i.length]={t:o,v:s},c=o;break;case"A":case"a":case"\u4E0A":var p={t:o,v:o};if(l==null&&(l=Va(e,r)),t.substr(a,3).toUpperCase()==="A/P"?(l!=null&&(p.v=l.H>=12?"P":"A"),p.t="T",d="h",a+=3):t.substr(a,5).toUpperCase()==="AM/PM"?(l!=null&&(p.v=l.H>=12?"PM":"AM"),p.t="T",a+=5,d="h"):t.substr(a,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(l!=null&&(p.v=l.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),p.t="T",a+=5,d="h"):(p.t="t",++a),l==null&&p.t==="T")return"";i[i.length]=p,c=o;break;case"[":for(s=o;t.charAt(a++)!=="]"&&a<t.length;)s+=t.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(dT)){if(l==null&&(l=Va(e,r),l==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},c=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",mc(t)||(i[i.length]={t:"t",v:s}));break;case".":if(l!=null){for(s=o;++a<t.length&&(o=t.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<t.length&&"0#?.,E+-%".indexOf(o=t.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;t.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},c=o;break;case"*":++a,(t.charAt(a)==" "||t.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<t.length&&"0123456789".indexOf(t.charAt(++a))>-1;)s+=t.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+t);i[i.length]={t:"t",v:o},++a;break}var _=0,T=0,S;for(a=i.length-1,c="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=d,c="h",_<1&&(_=1);break;case"s":(S=i[a].v.match(/\.0+$/))&&(T=Math.max(T,S[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[a].t;break;case"m":c==="s"&&(i[a].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[a].v.match(/[Hh]/)&&(_=1),_<2&&i[a].v.match(/[Mm]/)&&(_=2),_<3&&i[a].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M),l.M>=60&&(l.M=0,++l.H);break;case 2:l.u>=.5&&(l.u=0,++l.S),l.S>=60&&(l.S=0,++l.M);break}var b="",O;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=BR(i[a].t.charCodeAt(0),i[a].v,l,T),i[a].t="t";break;case"n":case"?":for(O=a+1;i[O]!=null&&((o=i[O].t)==="?"||o==="D"||(o===" "||o==="t")&&i[O+1]!=null&&(i[O+1].t==="?"||i[O+1].t==="t"&&i[O+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[O].v==="/"||i[O].v===" "&&i[O+1]!=null&&i[O+1].t=="?"));)i[a].v+=i[O].v,i[O]={v:"",t:";"},++O;b+=i[a].v,a=O-1;break;case"G":i[a].t="t",i[a].v=$a(e,r);break}var V="",B,x;if(b.length>0){b.charCodeAt(0)==40?(B=e<0&&b.charCodeAt(0)===45?-e:e,x=es("n",b,B)):(B=e<0&&n>1?-e:e,x=es("n",b,B),B<0&&i[0]&&i[0].t=="t"&&(x=x.substr(1),i[0].v="-"+i[0].v)),O=x.length-1;var w=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){w=a;break}var E=i.length;if(w===i.length&&x.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(O>=i[a].v.length-1?(O-=i[a].v.length,i[a].v=x.substr(O+1,i[a].v.length)):O<0?i[a].v="":(i[a].v=x.substr(0,O+1),O=-1),i[a].t="t",E=a);O>=0&&E<i.length&&(i[E].v=x.substr(0,O+1)+i[E].v)}else if(w!==i.length&&x.indexOf("E")===-1){for(O=x.indexOf(".")-1,a=w;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")-1:i[a].v.length-1,V=i[a].v.substr(h+1);h>=0;--h)O>=0&&(i[a].v.charAt(h)==="0"||i[a].v.charAt(h)==="#")&&(V=x.charAt(O--)+V);i[a].v=V,i[a].t="t",E=a}for(O>=0&&E<i.length&&(i[E].v=x.substr(0,O+1)+i[E].v),O=x.indexOf(".")+1,a=w;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==w)){for(h=i[a].v.indexOf(".")>-1&&a===w?i[a].v.indexOf(".")+1:0,V=i[a].v.substr(0,h);h<i[a].v.length;++h)O<x.length&&(V+=x.charAt(O++));i[a].v=V,i[a].t="t",E=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(B=n>1&&e<0&&a>0&&i[a-1].v==="-"?-e:e,i[a].v=es(i[a].t,i[a].v,B),i[a].t="t");var C="";for(a=0;a!==i.length;++a)i[a]!=null&&(C+=i[a].v);return C}var rE=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function nE(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function YR(t,e){var r=KR(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break;case 4:break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var a=r[0].match(rE),o=r[1].match(rE);return nE(e,a)?[n,r[0]]:nE(e,o)?[n,r[1]]:[n,r[a!=null&&o!=null?2:1]]}return[n,s]}function Kn(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Le)[t],n==null&&(n=r.table&&r.table[Zw[t]]||Le[Zw[t]]),n==null&&(n=FR[t]||"General");break}if($f(n,0))return $a(e,r);e instanceof Date&&(e=sT(e,r.date1904));var i=YR(n,e);if($f(i[1]))return $a(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return XR(i[1],e,r,i[0])}function ts(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Le[r]==null){e<0&&(e=r);continue}if(Le[r]==t){e=r;break}}e<0&&(e=391)}return Le[e]=t,e}function td(t){for(var e=0;e!=392;++e)t[e]!==void 0&&ts(t[e],e)}function gc(){Le=RR()}var QR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},pT=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function JR(t){var e=typeof t=="number"?Le[t]:t;return e=e.replace(pT,"(\\d+)"),new RegExp("^"+e+"$")}function ZR(t,e,r){var n=-1,i=-1,s=-1,a=-1,o=-1,c=-1;(e.match(pT)||[]).forEach(function(f,d){var m=parseInt(r[d+1],10);switch(f.toLowerCase().charAt(0)){case"y":n=m;break;case"d":s=m;break;case"h":a=m;break;case"s":c=m;break;case"m":a>=0?o=m:i=m;break}}),c>=0&&o==-1&&i>=0&&(o=i,i=-1);var l=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);l.length==7&&(l="0"+l),l.length==8&&(l="20"+l);var h=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return a==-1&&o==-1&&c==-1?l:n==-1&&i==-1&&s==-1?h:l+"T"+h}var eF=function(){var t={};t.version="1.2.0";function e(){for(var x=0,w=new Array(256),E=0;E!=256;++E)x=E,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,x=x&1?-306674912^x>>>1:x>>>1,w[E]=x;return typeof Int32Array<"u"?new Int32Array(w):w}var r=e();function n(x){var w=0,E=0,C=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)D[C]=x[C];for(C=0;C!=256;++C)for(E=x[C],w=256+C;w<4096;w+=256)E=D[w]=E>>>8^x[E&255];var A=[];for(C=1;C!=16;++C)A[C-1]=typeof Int32Array<"u"?D.subarray(C*256,C*256+256):D.slice(C*256,C*256+256);return A}var i=n(r),s=i[0],a=i[1],o=i[2],c=i[3],l=i[4],h=i[5],f=i[6],d=i[7],m=i[8],v=i[9],p=i[10],_=i[11],T=i[12],S=i[13],b=i[14];function O(x,w){for(var E=w^-1,C=0,D=x.length;C<D;)E=E>>>8^r[(E^x.charCodeAt(C++))&255];return~E}function V(x,w){for(var E=w^-1,C=x.length-15,D=0;D<C;)E=b[x[D++]^E&255]^S[x[D++]^E>>8&255]^T[x[D++]^E>>16&255]^_[x[D++]^E>>>24]^p[x[D++]]^v[x[D++]]^m[x[D++]]^d[x[D++]]^f[x[D++]]^h[x[D++]]^l[x[D++]]^c[x[D++]]^o[x[D++]]^a[x[D++]]^s[x[D++]]^r[x[D++]];for(C+=15;D<C;)E=E>>>8^r[(E^x[D++])&255];return~E}function B(x,w){for(var E=w^-1,C=0,D=x.length,A=0,R=0;C<D;)A=x.charCodeAt(C++),A<128?E=E>>>8^r[(E^A)&255]:A<2048?(E=E>>>8^r[(E^(192|A>>6&31))&255],E=E>>>8^r[(E^(128|A&63))&255]):A>=55296&&A<57344?(A=(A&1023)+64,R=x.charCodeAt(C++)&1023,E=E>>>8^r[(E^(240|A>>8&7))&255],E=E>>>8^r[(E^(128|A>>2&63))&255],E=E>>>8^r[(E^(128|R>>6&15|(A&3)<<4))&255],E=E>>>8^r[(E^(128|R&63))&255]):(E=E>>>8^r[(E^(224|A>>12&15))&255],E=E>>>8^r[(E^(128|A>>6&63))&255],E=E>>>8^r[(E^(128|A&63))&255]);return~E}return t.table=r,t.bstr=O,t.buf=V,t.str=B,t}(),Re=function(){var e={};e.version="1.2.1";function r(I,N){for(var F=I.split("/"),P=N.split("/"),M=0,L=0,K=Math.min(F.length,P.length);M<K;++M){if(L=F[M].length-P[M].length)return L;if(F[M]!=P[M])return F[M]<P[M]?-1:1}return F.length-P.length}function n(I){if(I.charAt(I.length-1)=="/")return I.slice(0,-1).indexOf("/")===-1?I:n(I.slice(0,-1));var N=I.lastIndexOf("/");return N===-1?I:I.slice(0,N+1)}function i(I){if(I.charAt(I.length-1)=="/")return i(I.slice(0,-1));var N=I.lastIndexOf("/");return N===-1?I:I.slice(N+1)}function s(I,N){typeof N=="string"&&(N=new Date(N));var F=N.getHours();F=F<<6|N.getMinutes(),F=F<<5|N.getSeconds()>>>1,I.write_shift(2,F);var P=N.getFullYear()-1980;P=P<<4|N.getMonth()+1,P=P<<5|N.getDate(),I.write_shift(2,P)}function a(I){var N=I.read_shift(2)&65535,F=I.read_shift(2)&65535,P=new Date,M=F&31;F>>>=5;var L=F&15;F>>>=4,P.setMilliseconds(0),P.setFullYear(F+1980),P.setMonth(L-1),P.setDate(M);var K=N&31;N>>>=5;var ee=N&63;return N>>>=6,P.setHours(N),P.setMinutes(ee),P.setSeconds(K<<1),P}function o(I){Mr(I,0);for(var N={},F=0;I.l<=I.length-4;){var P=I.read_shift(2),M=I.read_shift(2),L=I.l+M,K={};switch(P){case 21589:F=I.read_shift(1),F&1&&(K.mtime=I.read_shift(4)),M>5&&(F&2&&(K.atime=I.read_shift(4)),F&4&&(K.ctime=I.read_shift(4))),K.mtime&&(K.mt=new Date(K.mtime*1e3));break}I.l=L,N[P]=K}return N}var c;function l(){return c||(c={})}function h(I,N){if(I[0]==80&&I[1]==75)return nl(I,N);if((I[0]|32)==109&&(I[1]|32)==105)return da(I,N);if(I.length<512)throw new Error("CFB file size "+I.length+" < 512");var F=3,P=512,M=0,L=0,K=0,ee=0,q=0,X=[],Y=I.slice(0,512);Mr(Y,0);var le=f(Y);switch(F=le[0],F){case 3:P=512;break;case 4:P=4096;break;case 0:if(le[1]==0)return nl(I,N);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}P!==512&&(Y=I.slice(0,P),Mr(Y,28));var pe=I.slice(0,P);d(Y,F);var Se=Y.read_shift(4,"i");if(F===3&&Se!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Se);Y.l+=4,K=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),ee=Y.read_shift(4,"i"),M=Y.read_shift(4,"i"),q=Y.read_shift(4,"i"),L=Y.read_shift(4,"i");for(var ge=-1,Te=0;Te<109&&(ge=Y.read_shift(4,"i"),!(ge<0));++Te)X[Te]=ge;var Be=m(I,P);_(q,L,Be,P,X);var It=S(Be,K,X,P);It[K].name="!Directory",M>0&&ee!==R&&(It[ee].name="!MiniFAT"),It[X[0]].name="!FAT",It.fat_addrs=X,It.ssz=P;var gr={},Ct=[],Qt=[],$i=[];b(K,It,Be,Ct,M,gr,Qt,ee),v(Qt,$i,Ct),Ct.shift();var ga={FileIndex:Qt,FullPaths:$i};return N&&N.raw&&(ga.raw={header:pe,sectors:Be}),ga}function f(I){if(I[I.l]==80&&I[I.l+1]==75)return[0,0];I.chk(oe,"Header Signature: "),I.l+=16;var N=I.read_shift(2,"u");return[I.read_shift(2,"u"),N]}function d(I,N){var F=9;switch(I.l+=2,F=I.read_shift(2)){case 9:if(N!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(N!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}I.chk("0600","Mini Sector Shift: "),I.chk("000000000000","Reserved: ")}function m(I,N){for(var F=Math.ceil(I.length/N)-1,P=[],M=1;M<F;++M)P[M-1]=I.slice(M*N,(M+1)*N);return P[F-1]=I.slice(F*N),P}function v(I,N,F){for(var P=0,M=0,L=0,K=0,ee=0,q=F.length,X=[],Y=[];P<q;++P)X[P]=Y[P]=P,N[P]=F[P];for(;ee<Y.length;++ee)P=Y[ee],M=I[P].L,L=I[P].R,K=I[P].C,X[P]===P&&(M!==-1&&X[M]!==M&&(X[P]=X[M]),L!==-1&&X[L]!==L&&(X[P]=X[L])),K!==-1&&(X[K]=P),M!==-1&&P!=X[P]&&(X[M]=X[P],Y.lastIndexOf(M)<ee&&Y.push(M)),L!==-1&&P!=X[P]&&(X[L]=X[P],Y.lastIndexOf(L)<ee&&Y.push(L));for(P=1;P<q;++P)X[P]===P&&(L!==-1&&X[L]!==L?X[P]=X[L]:M!==-1&&X[M]!==M&&(X[P]=X[M]));for(P=1;P<q;++P)if(I[P].type!==0){if(ee=P,ee!=X[ee])do ee=X[ee],N[P]=N[ee]+"/"+N[P];while(ee!==0&&X[ee]!==-1&&ee!=X[ee]);X[P]=-1}for(N[0]+="/",P=1;P<q;++P)I[P].type!==2&&(N[P]+="/")}function p(I,N,F){for(var P=I.start,M=I.size,L=[],K=P;F&&M>0&&K>=0;)L.push(N.slice(K*A,K*A+A)),M-=A,K=La(F,K*4);return L.length===0?re(0):Er(L).slice(0,I.size)}function _(I,N,F,P,M){var L=R;if(I===R){if(N!==0)throw new Error("DIFAT chain shorter than expected")}else if(I!==-1){var K=F[I],ee=(P>>>2)-1;if(!K)return;for(var q=0;q<ee&&(L=La(K,q*4))!==R;++q)M.push(L);_(La(K,P-4),N-1,F,P,M)}}function T(I,N,F,P,M){var L=[],K=[];M||(M=[]);var ee=P-1,q=0,X=0;for(q=N;q>=0;){M[q]=!0,L[L.length]=q,K.push(I[q]);var Y=F[Math.floor(q*4/P)];if(X=q*4&ee,P<4+X)throw new Error("FAT boundary crossed: "+q+" 4 "+P);if(!I[Y])break;q=La(I[Y],X)}return{nodes:L,data:mE([K])}}function S(I,N,F,P){var M=I.length,L=[],K=[],ee=[],q=[],X=P-1,Y=0,le=0,pe=0,Se=0;for(Y=0;Y<M;++Y)if(ee=[],pe=Y+N,pe>=M&&(pe-=M),!K[pe]){q=[];var ge=[];for(le=pe;le>=0;){ge[le]=!0,K[le]=!0,ee[ee.length]=le,q.push(I[le]);var Te=F[Math.floor(le*4/P)];if(Se=le*4&X,P<4+Se)throw new Error("FAT boundary crossed: "+le+" 4 "+P);if(!I[Te]||(le=La(I[Te],Se),ge[le]))break}L[pe]={nodes:ee,data:mE([q])}}return L}function b(I,N,F,P,M,L,K,ee){for(var q=0,X=P.length?2:0,Y=N[I].data,le=0,pe=0,Se;le<Y.length;le+=128){var ge=Y.slice(le,le+128);Mr(ge,64),pe=ge.read_shift(2),Se=sd(ge,0,pe-X),P.push(Se);var Te={name:Se,type:ge.read_shift(1),color:ge.read_shift(1),L:ge.read_shift(4,"i"),R:ge.read_shift(4,"i"),C:ge.read_shift(4,"i"),clsid:ge.read_shift(16),state:ge.read_shift(4,"i"),start:0,size:0},Be=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);Be!==0&&(Te.ct=O(ge,ge.l-8));var It=ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2)+ge.read_shift(2);It!==0&&(Te.mt=O(ge,ge.l-8)),Te.start=ge.read_shift(4,"i"),Te.size=ge.read_shift(4,"i"),Te.size<0&&Te.start<0&&(Te.size=Te.type=0,Te.start=R,Te.name=""),Te.type===5?(q=Te.start,M>0&&q!==R&&(N[q].name="!StreamData")):Te.size>=4096?(Te.storage="fat",N[Te.start]===void 0&&(N[Te.start]=T(F,Te.start,N.fat_addrs,N.ssz)),N[Te.start].name=Te.name,Te.content=N[Te.start].data.slice(0,Te.size)):(Te.storage="minifat",Te.size<0?Te.size=0:q!==R&&Te.start!==R&&N[q]&&(Te.content=p(Te,N[q].data,(N[ee]||{}).data))),Te.content&&Mr(Te.content,0),L[Se]=Te,K.push(Te)}}function O(I,N){return new Date((wr(I,N+4)/1e7*Math.pow(2,32)+wr(I,N)/1e7-11644473600)*1e3)}function V(I,N){return l(),h(c.readFileSync(I),N)}function B(I,N){var F=N&&N.type;switch(F||Ze&&Buffer.isBuffer(I)&&(F="buffer"),F||"base64"){case"file":return V(I,N);case"base64":return h(bn(An(I)),N);case"binary":return h(bn(I),N)}return h(I,N)}function x(I,N){var F=N||{},P=F.root||"Root Entry";if(I.FullPaths||(I.FullPaths=[]),I.FileIndex||(I.FileIndex=[]),I.FullPaths.length!==I.FileIndex.length)throw new Error("inconsistent CFB structure");I.FullPaths.length===0&&(I.FullPaths[0]=P+"/",I.FileIndex[0]={name:P,type:5}),F.CLSID&&(I.FileIndex[0].clsid=F.CLSID),w(I)}function w(I){var N="Sh33tJ5";if(!Re.find(I,"/"+N)){var F=re(4);F[0]=55,F[1]=F[3]=50,F[2]=54,I.FileIndex.push({name:N,type:2,content:F,size:4,L:69,R:69,C:69}),I.FullPaths.push(I.FullPaths[0]+N),E(I)}}function E(I,N){x(I);for(var F=!1,P=!1,M=I.FullPaths.length-1;M>=0;--M){var L=I.FileIndex[M];switch(L.type){case 0:P?F=!0:(I.FileIndex.pop(),I.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(L.R*L.L*L.C)&&(F=!0),L.R>-1&&L.L>-1&&L.R==L.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!N)){var K=new Date(1987,1,19),ee=0,q=Object.create?Object.create(null):{},X=[];for(M=0;M<I.FullPaths.length;++M)q[I.FullPaths[M]]=!0,I.FileIndex[M].type!==0&&X.push([I.FullPaths[M],I.FileIndex[M]]);for(M=0;M<X.length;++M){var Y=n(X[M][0]);P=q[Y],P||(X.push([Y,{name:i(Y).replace("/",""),type:1,clsid:ke,ct:K,mt:K,content:null}]),q[Y]=!0)}for(X.sort(function(Se,ge){return r(Se[0],ge[0])}),I.FullPaths=[],I.FileIndex=[],M=0;M<X.length;++M)I.FullPaths[M]=X[M][0],I.FileIndex[M]=X[M][1];for(M=0;M<X.length;++M){var le=I.FileIndex[M],pe=I.FullPaths[M];if(le.name=i(pe).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||ke,M===0)le.C=X.length>1?1:-1,le.size=0,le.type=5;else if(pe.slice(-1)=="/"){for(ee=M+1;ee<X.length&&n(I.FullPaths[ee])!=pe;++ee);for(le.C=ee>=X.length?-1:ee,ee=M+1;ee<X.length&&n(I.FullPaths[ee])!=n(pe);++ee);le.R=ee>=X.length?-1:ee,le.type=1}else n(I.FullPaths[M+1]||"")==n(pe)&&(le.R=M+1),le.type=2}}}function C(I,N){var F=N||{};if(F.fileType=="mad")return yh(I,F);switch(E(I),F.fileType){case"zip":return fa(I,F)}var P=function(Se){for(var ge=0,Te=0,Be=0;Be<Se.FileIndex.length;++Be){var It=Se.FileIndex[Be];if(It.content){var gr=It.content.length;gr>0&&(gr<4096?ge+=gr+63>>6:Te+=gr+511>>9)}}for(var Ct=Se.FullPaths.length+3>>2,Qt=ge+7>>3,$i=ge+127>>7,ga=Qt+Te+Ct+$i,gi=ga+127>>7,Ro=gi<=109?0:Math.ceil((gi-109)/127);ga+gi+Ro+127>>7>gi;)Ro=++gi<=109?0:Math.ceil((gi-109)/127);var Pn=[1,Ro,gi,$i,Ct,Te,ge,0];return Se.FileIndex[0].size=ge<<6,Pn[7]=(Se.FileIndex[0].start=Pn[0]+Pn[1]+Pn[2]+Pn[3]+Pn[4]+Pn[5])+(Pn[6]+7>>3),Pn}(I),M=re(P[7]<<9),L=0,K=0;{for(L=0;L<8;++L)M.write_shift(1,ce[L]);for(L=0;L<8;++L)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),L=0;L<3;++L)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,P[2]),M.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:R),M.write_shift(4,P[3]),M.write_shift(-4,P[1]?P[0]-1:R),M.write_shift(4,P[1]),L=0;L<109;++L)M.write_shift(-4,L<P[2]?P[1]+L:-1)}if(P[1])for(K=0;K<P[1];++K){for(;L<236+K*127;++L)M.write_shift(-4,L<P[2]?P[1]+L:-1);M.write_shift(-4,K===P[1]-1?R:K+1)}var ee=function(Se){for(K+=Se;L<K-1;++L)M.write_shift(-4,L+1);Se&&(++L,M.write_shift(-4,R))};for(K=L=0,K+=P[1];L<K;++L)M.write_shift(-4,we.DIFSECT);for(K+=P[2];L<K;++L)M.write_shift(-4,we.FATSECT);ee(P[3]),ee(P[4]);for(var q=0,X=0,Y=I.FileIndex[0];q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(X<4096)&&(Y.start=K,ee(X+511>>9)));for(ee(P[6]+7>>3);M.l&511;)M.write_shift(-4,we.ENDOFCHAIN);for(K=L=0,q=0;q<I.FileIndex.length;++q)Y=I.FileIndex[q],Y.content&&(X=Y.content.length,!(!X||X>=4096)&&(Y.start=K,ee(X+63>>6)));for(;M.l&511;)M.write_shift(-4,we.ENDOFCHAIN);for(L=0;L<P[4]<<2;++L){var le=I.FullPaths[L];if(!le||le.length===0){for(q=0;q<17;++q)M.write_shift(4,0);for(q=0;q<3;++q)M.write_shift(4,-1);for(q=0;q<12;++q)M.write_shift(4,0);continue}Y=I.FileIndex[L],L===0&&(Y.start=Y.size?Y.start-1:R);var pe=L===0&&F.root||Y.name;if(X=2*(pe.length+1),M.write_shift(64,pe,"utf16le"),M.write_shift(2,X),M.write_shift(1,Y.type),M.write_shift(1,Y.color),M.write_shift(-4,Y.L),M.write_shift(-4,Y.R),M.write_shift(-4,Y.C),Y.clsid)M.write_shift(16,Y.clsid,"hex");else for(q=0;q<4;++q)M.write_shift(4,0);M.write_shift(4,Y.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,Y.start),M.write_shift(4,Y.size),M.write_shift(4,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>=4096)if(M.l=Y.start+1<<9,Ze&&Buffer.isBuffer(Y.content))Y.content.copy(M,M.l,0,Y.size),M.l+=Y.size+511&-512;else{for(q=0;q<Y.size;++q)M.write_shift(1,Y.content[q]);for(;q&511;++q)M.write_shift(1,0)}for(L=1;L<I.FileIndex.length;++L)if(Y=I.FileIndex[L],Y.size>0&&Y.size<4096)if(Ze&&Buffer.isBuffer(Y.content))Y.content.copy(M,M.l,0,Y.size),M.l+=Y.size+63&-64;else{for(q=0;q<Y.size;++q)M.write_shift(1,Y.content[q]);for(;q&63;++q)M.write_shift(1,0)}if(Ze)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function D(I,N){var F=I.FullPaths.map(function(q){return q.toUpperCase()}),P=F.map(function(q){var X=q.split("/");return X[X.length-(q.slice(-1)=="/"?2:1)]}),M=!1;N.charCodeAt(0)===47?(M=!0,N=F[0].slice(0,-1)+N):M=N.indexOf("/")!==-1;var L=N.toUpperCase(),K=M===!0?F.indexOf(L):P.indexOf(L);if(K!==-1)return I.FileIndex[K];var ee=!L.match(ru);for(L=L.replace(Gr,""),ee&&(L=L.replace(ru,"!")),K=0;K<F.length;++K)if((ee?F[K].replace(ru,"!"):F[K]).replace(Gr,"")==L||(ee?P[K].replace(ru,"!"):P[K]).replace(Gr,"")==L)return I.FileIndex[K];return null}var A=64,R=-2,oe="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],ke="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:R,FREESECT:-1,HEADER_SIGNATURE:oe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ke,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ne(I,N,F){l();var P=C(I,F);c.writeFileSync(N,P)}function de(I){for(var N=new Array(I.length),F=0;F<I.length;++F)N[F]=String.fromCharCode(I[F]);return N.join("")}function Ae(I,N){var F=C(I,N);switch(N&&N.type||"buffer"){case"file":return l(),c.writeFileSync(N.filename,F),F;case"binary":return typeof F=="string"?F:de(F);case"base64":return du(typeof F=="string"?F:de(F));case"buffer":if(Ze)return Buffer.isBuffer(F)?F:is(F);case"array":return typeof F=="string"?bn(F):F}return F}var ie;function j(I){try{var N=I.InflateRaw,F=new N;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)ie=I;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function G(I,N){if(!ie)return mh(I,N);var F=ie.InflateRaw,P=new F,M=P._processChunk(I.slice(I.l),P._finishFlushFlag);return I.l+=P.bytesRead,M}function H(I){return ie?ie.deflateRawSync(I):Ke(I)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],me=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ue(I){var N=(I<<1|I<<11)&139536|(I<<5|I<<15)&558144;return(N>>16|N>>8|N)&255}for(var fe=typeof Uint8Array<"u",se=fe?new Uint8Array(256):[],We=0;We<256;++We)se[We]=ue(We);function U(I,N){var F=se[I&255];return N<=8?F>>>8-N:(F=F<<8|se[I>>8&255],N<=16?F>>>16-N:(F=F<<8|se[I>>16&255],F>>>24-N))}function at(I,N){var F=N&7,P=N>>>3;return(I[P]|(F<=6?0:I[P+1]<<8))>>>F&3}function qe(I,N){var F=N&7,P=N>>>3;return(I[P]|(F<=5?0:I[P+1]<<8))>>>F&7}function ot(I,N){var F=N&7,P=N>>>3;return(I[P]|(F<=4?0:I[P+1]<<8))>>>F&15}function Je(I,N){var F=N&7,P=N>>>3;return(I[P]|(F<=3?0:I[P+1]<<8))>>>F&31}function be(I,N){var F=N&7,P=N>>>3;return(I[P]|(F<=1?0:I[P+1]<<8))>>>F&127}function jt(I,N,F){var P=N&7,M=N>>>3,L=(1<<F)-1,K=I[M]>>>P;return F<8-P||(K|=I[M+1]<<8-P,F<16-P)||(K|=I[M+2]<<16-P,F<24-P)||(K|=I[M+3]<<24-P),K&L}function tn(I,N,F){var P=N&7,M=N>>>3;return P<=5?I[M]|=(F&7)<<P:(I[M]|=F<<P&255,I[M+1]=(F&7)>>8-P),N+3}function fn(I,N,F){var P=N&7,M=N>>>3;return F=(F&1)<<P,I[M]|=F,N+1}function dn(I,N,F){var P=N&7,M=N>>>3;return F<<=P,I[M]|=F&255,F>>>=8,I[M+1]=F,N+8}function vs(I,N,F){var P=N&7,M=N>>>3;return F<<=P,I[M]|=F&255,F>>>=8,I[M+1]=F&255,I[M+2]=F>>>8,N+16}function pi(I,N){var F=I.length,P=2*F>N?2*F:N+5,M=0;if(F>=N)return I;if(Ze){var L=Yw(P);if(I.copy)I.copy(L);else for(;M<I.length;++M)L[M]=I[M];return L}else if(fe){var K=new Uint8Array(P);if(K.set)K.set(I);else for(;M<F;++M)K[M]=I[M];return K}return I.length=P,I}function Sr(I){for(var N=new Array(I),F=0;F<I;++F)N[F]=0;return N}function pn(I,N,F){var P=1,M=0,L=0,K=0,ee=0,q=I.length,X=fe?new Uint16Array(32):Sr(32);for(L=0;L<32;++L)X[L]=0;for(L=q;L<F;++L)I[L]=0;q=I.length;var Y=fe?new Uint16Array(q):Sr(q);for(L=0;L<q;++L)X[M=I[L]]++,P<M&&(P=M),Y[L]=0;for(X[0]=0,L=1;L<=P;++L)X[L+16]=ee=ee+X[L-1]<<1;for(L=0;L<q;++L)ee=I[L],ee!=0&&(Y[L]=X[ee+16]++);var le=0;for(L=0;L<q;++L)if(le=I[L],le!=0)for(ee=U(Y[L],P)>>P-le,K=(1<<P+4-le)-1;K>=0;--K)N[ee|K<<le]=le&15|L<<4;return P}var Fn=fe?new Uint16Array(512):Sr(512),zt=fe?new Uint16Array(32):Sr(32);if(!fe){for(var dt=0;dt<512;++dt)Fn[dt]=0;for(dt=0;dt<32;++dt)zt[dt]=0}(function(){for(var I=[],N=0;N<32;N++)I.push(5);pn(I,zt,32);var F=[];for(N=0;N<=143;N++)F.push(8);for(;N<=255;N++)F.push(9);for(;N<=279;N++)F.push(7);for(;N<=287;N++)F.push(8);pn(F,Fn,288)})();var rn=function(){for(var N=fe?new Uint8Array(32768):[],F=0,P=0;F<me.length-1;++F)for(;P<me[F+1];++P)N[P]=F;for(;P<32768;++P)N[P]=29;var M=fe?new Uint8Array(259):[];for(F=0,P=0;F<ne.length-1;++F)for(;P<ne[F+1];++P)M[P]=F;function L(ee,q){for(var X=0;X<ee.length;){var Y=Math.min(65535,ee.length-X),le=X+Y==ee.length;for(q.write_shift(1,+le),q.write_shift(2,Y),q.write_shift(2,~Y&65535);Y-- >0;)q[q.l++]=ee[X++]}return q.l}function K(ee,q){for(var X=0,Y=0,le=fe?new Uint16Array(32768):[];Y<ee.length;){var pe=Math.min(65535,ee.length-Y);if(pe<10){for(X=tn(q,X,+(Y+pe==ee.length)),X&7&&(X+=8-(X&7)),q.l=X/8|0,q.write_shift(2,pe),q.write_shift(2,~pe&65535);pe-- >0;)q[q.l++]=ee[Y++];X=q.l*8;continue}X=tn(q,X,+(Y+pe==ee.length)+2);for(var Se=0;pe-- >0;){var ge=ee[Y];Se=(Se<<5^ge)&32767;var Te=-1,Be=0;if((Te=le[Se])&&(Te|=Y&-32768,Te>Y&&(Te-=32768),Te<Y))for(;ee[Te+Be]==ee[Y+Be]&&Be<250;)++Be;if(Be>2){ge=M[Be],ge<=22?X=dn(q,X,se[ge+1]>>1)-1:(dn(q,X,3),X+=5,dn(q,X,se[ge-23]>>5),X+=3);var It=ge<8?0:ge-4>>2;It>0&&(vs(q,X,Be-ne[ge]),X+=It),ge=N[Y-Te],X=dn(q,X,se[ge]>>3),X-=3;var gr=ge<4?0:ge-2>>1;gr>0&&(vs(q,X,Y-Te-me[ge]),X+=gr);for(var Ct=0;Ct<Be;++Ct)le[Se]=Y&32767,Se=(Se<<5^ee[Y])&32767,++Y;pe-=Be-1}else ge<=143?ge=ge+48:X=fn(q,X,1),X=dn(q,X,se[ge]),le[Se]=Y&32767,++Y}X=dn(q,X,0)-1}return q.l=(X+7)/8|0,q.l}return function(q,X){return q.length<8?L(q,X):K(q,X)}}();function Ke(I){var N=re(50+Math.floor(I.length*1.1)),F=rn(I,N);return N.slice(0,F)}var Ut=fe?new Uint16Array(32768):Sr(32768),cn=fe?new Uint16Array(32768):Sr(32768),Nt=fe?new Uint16Array(128):Sr(128),mi=1,tl=1;function rl(I,N){var F=Je(I,N)+257;N+=5;var P=Je(I,N)+1;N+=5;var M=ot(I,N)+4;N+=4;for(var L=0,K=fe?new Uint8Array(19):Sr(19),ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],q=1,X=fe?new Uint8Array(8):Sr(8),Y=fe?new Uint8Array(8):Sr(8),le=K.length,pe=0;pe<M;++pe)K[W[pe]]=L=qe(I,N),q<L&&(q=L),X[L]++,N+=3;var Se=0;for(X[0]=0,pe=1;pe<=q;++pe)Y[pe]=Se=Se+X[pe-1]<<1;for(pe=0;pe<le;++pe)(Se=K[pe])!=0&&(ee[pe]=Y[Se]++);var ge=0;for(pe=0;pe<le;++pe)if(ge=K[pe],ge!=0){Se=se[ee[pe]]>>8-ge;for(var Te=(1<<7-ge)-1;Te>=0;--Te)Nt[Se|Te<<ge]=ge&7|pe<<3}var Be=[];for(q=1;Be.length<F+P;)switch(Se=Nt[be(I,N)],N+=Se&7,Se>>>=3){case 16:for(L=3+at(I,N),N+=2,Se=Be[Be.length-1];L-- >0;)Be.push(Se);break;case 17:for(L=3+qe(I,N),N+=3;L-- >0;)Be.push(0);break;case 18:for(L=11+be(I,N),N+=7;L-- >0;)Be.push(0);break;default:Be.push(Se),q<Se&&(q=Se);break}var It=Be.slice(0,F),gr=Be.slice(F);for(pe=F;pe<286;++pe)It[pe]=0;for(pe=P;pe<30;++pe)gr[pe]=0;return mi=pn(It,Ut,286),tl=pn(gr,cn,30),N}function b0(I,N){if(I[0]==3&&!(I[1]&3))return[Hs(N),2];for(var F=0,P=0,M=Yw(N||1<<18),L=0,K=M.length>>>0,ee=0,q=0;!(P&1);){if(P=qe(I,F),F+=3,P>>>1)P>>1==1?(ee=9,q=5):(F=rl(I,F),ee=mi,q=tl);else{F&7&&(F+=8-(F&7));var X=I[F>>>3]|I[(F>>>3)+1]<<8;if(F+=32,X>0)for(!N&&K<L+X&&(M=pi(M,L+X),K=M.length);X-- >0;)M[L++]=I[F>>>3],F+=8;continue}for(;;){!N&&K<L+32767&&(M=pi(M,L+32767),K=M.length);var Y=jt(I,F,ee),le=P>>>1==1?Fn[Y]:Ut[Y];if(F+=le&15,le>>>=4,!(le>>>8&255))M[L++]=le;else{if(le==256)break;le-=257;var pe=le<8?0:le-4>>2;pe>5&&(pe=0);var Se=L+ne[le];pe>0&&(Se+=jt(I,F,pe),F+=pe),Y=jt(I,F,q),le=P>>>1==1?zt[Y]:cn[Y],F+=le&15,le>>>=4;var ge=le<4?0:le-2>>1,Te=me[le];for(ge>0&&(Te+=jt(I,F,ge),F+=ge),!N&&K<Se&&(M=pi(M,Se+100),K=M.length);L<Se;)M[L]=M[L-Te],++L}}}return N?[M,F+7>>>3]:[M.slice(0,L),F+7>>>3]}function mh(I,N){var F=I.slice(I.l||0),P=b0(F,N);return I.l+=P[1],P[0]}function Co(I,N){if(I)typeof console<"u"&&console.error(N);else throw new Error(N)}function nl(I,N){var F=I;Mr(F,0);var P=[],M=[],L={FileIndex:P,FullPaths:M};x(L,{root:N.root});for(var K=F.length-4;(F[K]!=80||F[K+1]!=75||F[K+2]!=5||F[K+3]!=6)&&K>=0;)--K;F.l=K+4,F.l+=4;var ee=F.read_shift(2);F.l+=6;var q=F.read_shift(4);for(F.l=q,K=0;K<ee;++K){F.l+=20;var X=F.read_shift(4),Y=F.read_shift(4),le=F.read_shift(2),pe=F.read_shift(2),Se=F.read_shift(2);F.l+=8;var ge=F.read_shift(4),Te=o(F.slice(F.l+le,F.l+le+pe));F.l+=le+pe+Se;var Be=F.l;F.l=ge+4,gh(F,X,Y,L,Te),F.l=Be}return L}function gh(I,N,F,P,M){I.l+=2;var L=I.read_shift(2),K=I.read_shift(2),ee=a(I);if(L&8257)throw new Error("Unsupported ZIP encryption");for(var q=I.read_shift(4),X=I.read_shift(4),Y=I.read_shift(4),le=I.read_shift(2),pe=I.read_shift(2),Se="",ge=0;ge<le;++ge)Se+=String.fromCharCode(I[I.l++]);if(pe){var Te=o(I.slice(I.l,I.l+pe));(Te[21589]||{}).mt&&(ee=Te[21589].mt),((M||{})[21589]||{}).mt&&(ee=M[21589].mt)}I.l+=pe;var Be=I.slice(I.l,I.l+X);switch(K){case 8:Be=G(I,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+K)}var It=!1;L&8&&(q=I.read_shift(4),q==134695760&&(q=I.read_shift(4),It=!0),X=I.read_shift(4),Y=I.read_shift(4)),X!=N&&Co(It,"Bad compressed size: "+N+" != "+X),Y!=F&&Co(It,"Bad uncompressed size: "+F+" != "+Y),Do(P,Se,Be,{unsafe:!0,mt:ee})}function fa(I,N){var F=N||{},P=[],M=[],L=re(1),K=F.compression?8:0,ee=0,q=!1;q&&(ee|=8);var X=0,Y=0,le=0,pe=0,Se=I.FullPaths[0],ge=Se,Te=I.FileIndex[0],Be=[],It=0;for(X=1;X<I.FullPaths.length;++X)if(ge=I.FullPaths[X].slice(Se.length),Te=I.FileIndex[X],!(!Te.size||!Te.content||ge=="Sh33tJ5")){var gr=le,Ct=re(ge.length);for(Y=0;Y<ge.length;++Y)Ct.write_shift(1,ge.charCodeAt(Y)&127);Ct=Ct.slice(0,Ct.l),Be[pe]=eF.buf(Te.content,0);var Qt=Te.content;K==8&&(Qt=H(Qt)),L=re(30),L.write_shift(4,67324752),L.write_shift(2,20),L.write_shift(2,ee),L.write_shift(2,K),Te.mt?s(L,Te.mt):L.write_shift(4,0),L.write_shift(-4,ee&8?0:Be[pe]),L.write_shift(4,ee&8?0:Qt.length),L.write_shift(4,ee&8?0:Te.content.length),L.write_shift(2,Ct.length),L.write_shift(2,0),le+=L.length,P.push(L),le+=Ct.length,P.push(Ct),le+=Qt.length,P.push(Qt),ee&8&&(L=re(12),L.write_shift(-4,Be[pe]),L.write_shift(4,Qt.length),L.write_shift(4,Te.content.length),le+=L.l,P.push(L)),L=re(46),L.write_shift(4,33639248),L.write_shift(2,0),L.write_shift(2,20),L.write_shift(2,ee),L.write_shift(2,K),L.write_shift(4,0),L.write_shift(-4,Be[pe]),L.write_shift(4,Qt.length),L.write_shift(4,Te.content.length),L.write_shift(2,Ct.length),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(4,0),L.write_shift(4,gr),It+=L.l,M.push(L),It+=Ct.length,M.push(Ct),++pe}return L=re(22),L.write_shift(4,101010256),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(2,pe),L.write_shift(2,pe),L.write_shift(4,It),L.write_shift(4,le),L.write_shift(2,0),Er([Er(P),Er(M),L])}var _s={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function il(I,N){if(I.ctype)return I.ctype;var F=I.name||"",P=F.match(/\.([^\.]+)$/);return P&&_s[P[1]]||N&&(P=(F=N).match(/[\.\\]([^\.\\])+$/),P&&_s[P[1]])?_s[P[1]]:"application/octet-stream"}function Wi(I){for(var N=du(I),F=[],P=0;P<N.length;P+=76)F.push(N.slice(P,P+76));return F.join(`\r
`)+`\r
`}function vh(I){var N=I.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var Y=X.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});N=N.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),N.charAt(0)==`
`&&(N="=0D"+N.slice(1)),N=N.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],P=N.split(`\r
`),M=0;M<P.length;++M){var L=P[M];if(L.length==0){F.push("");continue}for(var K=0;K<L.length;){var ee=76,q=L.slice(K,K+ee);q.charAt(ee-1)=="="?ee--:q.charAt(ee-2)=="="?ee-=2:q.charAt(ee-3)=="="&&(ee-=3),q=L.slice(K,K+ee),K+=ee,K<L.length&&(q+="="),F.push(q)}}return F.join(`\r
`)}function ko(I){for(var N=[],F=0;F<I.length;++F){for(var P=I[F];F<=I.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+I[++F];N.push(P)}for(var M=0;M<N.length;++M)N[M]=N[M].replace(/[=][0-9A-Fa-f]{2}/g,function(L){return String.fromCharCode(parseInt(L.slice(1),16))});return bn(N.join(`\r
`))}function _h(I,N,F){for(var P="",M="",L="",K,ee=0;ee<10;++ee){var q=N[ee];if(!q||q.match(/^\s*$/))break;var X=q.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":P=X[2].trim();break;case"content-type":L=X[2].trim();break;case"content-transfer-encoding":M=X[2].trim();break}}switch(++ee,M.toLowerCase()){case"base64":K=bn(An(N.slice(ee).join("")));break;case"quoted-printable":K=ko(N.slice(ee));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var Y=Do(I,P.slice(F.length),K,{unsafe:!0});L&&(Y.ctype=L)}function da(I,N){if(de(I.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=N&&N.root||"",P=(Ze&&Buffer.isBuffer(I)?I.toString("binary"):de(I)).split(`\r
`),M=0,L="";for(M=0;M<P.length;++M)if(L=P[M],!!/^Content-Location:/i.test(L)&&(L=L.slice(L.indexOf("file")),F||(F=L.slice(0,L.lastIndexOf("/")+1)),L.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),L.slice(0,F.length)!=F););var K=(P[1]||"").match(/boundary="(.*?)"/);if(!K)throw new Error("MAD cannot find boundary");var ee="--"+(K[1]||""),q=[],X=[],Y={FileIndex:q,FullPaths:X};x(Y);var le,pe=0;for(M=0;M<P.length;++M){var Se=P[M];Se!==ee&&Se!==ee+"--"||(pe++&&_h(Y,P.slice(le,M),F),le=M)}return Y}function yh(I,N){var F=N||{},P=F.boundary||"SheetJS";P="------="+P;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],L=I.FullPaths[0],K=L,ee=I.FileIndex[0],q=1;q<I.FullPaths.length;++q)if(K=I.FullPaths[q].slice(L.length),ee=I.FileIndex[q],!(!ee.size||!ee.content||K=="Sh33tJ5")){K=K.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Be){return"_x"+Be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Be){return"_u"+Be.charCodeAt(0).toString(16)+"_"});for(var X=ee.content,Y=Ze&&Buffer.isBuffer(X)?X.toString("binary"):de(X),le=0,pe=Math.min(1024,Y.length),Se=0,ge=0;ge<=pe;++ge)(Se=Y.charCodeAt(ge))>=32&&Se<128&&++le;var Te=le>=pe*4/5;M.push(P),M.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+K),M.push("Content-Transfer-Encoding: "+(Te?"quoted-printable":"base64")),M.push("Content-Type: "+il(ee,K)),M.push(""),M.push(Te?vh(Y):Wi(Y))}return M.push(P+`--\r
`),M.join(`\r
`)}function Cr(I){var N={};return x(N,I),N}function Do(I,N,F,P){var M=P&&P.unsafe;M||x(I);var L=!M&&Re.find(I,N);if(!L){var K=I.FullPaths[0];N.slice(0,K.length)==K?K=N:(K.slice(-1)!="/"&&(K+="/"),K=(K+N).replace("//","/")),L={name:i(N),type:2},I.FileIndex.push(L),I.FullPaths.push(K),M||Re.utils.cfb_gc(I)}return L.content=F,L.size=F?F.length:0,P&&(P.CLSID&&(L.clsid=P.CLSID),P.mt&&(L.mt=P.mt),P.ct&&(L.ct=P.ct)),L}function pa(I,N){x(I);var F=Re.find(I,N);if(F){for(var P=0;P<I.FileIndex.length;++P)if(I.FileIndex[P]==F)return I.FileIndex.splice(P,1),I.FullPaths.splice(P,1),!0}return!1}function ma(I,N,F){x(I);var P=Re.find(I,N);if(P){for(var M=0;M<I.FileIndex.length;++M)if(I.FileIndex[M]==P)return I.FileIndex[M].name=i(F),I.FullPaths[M]=F,!0}return!1}function I0(I){E(I,!0)}return e.find=D,e.read=B,e.parse=h,e.write=Ae,e.writeFile=Ne,e.utils={cfb_new:Cr,cfb_add:Do,cfb_del:pa,cfb_mov:ma,cfb_gc:I0,ReadShift:iu,CheckField:FT,prep_blob:Mr,bconcat:Er,use_zlib:j,_deflateRaw:Ke,_inflateRaw:mh,consts:we},e}(),ic;function tF(t){return typeof t=="string"?ed(t):Array.isArray(t)?SR(t):t}function Au(t,e,r){if(typeof ic<"u"&&ic.writeFileSync)return r?ic.writeFileSync(t,e,r):ic.writeFileSync(t,e);if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=ed(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?ki(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([tF(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=t,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(t);return o.open("w"),o.encoding="binary",Array.isArray(e)&&(e=Ks(e)),o.write(e),o.close(),e}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function rF(t){if(typeof ic<"u")return ic.readFileSync(t);if(typeof Deno<"u")return Deno.readFileSync(t);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var e=File(t);e.open("r"),e.encoding="binary";var r=e.read();return e.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+t)}function Yt(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function iE(t,e){for(var r=[],n=Yt(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function rd(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function nd(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function nF(t){for(var e=[],r=Yt(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var zf=new Date(1899,11,30,0,0,0);function dr(t,e){var r=t.getTime();e&&(r-=1462*24*60*60*1e3);var n=zf.getTime()+(t.getTimezoneOffset()-zf.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var mT=new Date,iF=zf.getTime()+(mT.getTimezoneOffset()-zf.getTimezoneOffset())*6e4,sE=mT.getTimezoneOffset();function id(t){var e=new Date;return e.setTime(t*24*60*60*1e3+iF),e.getTimezoneOffset()!==sE&&e.setTime(e.getTime()+(e.getTimezoneOffset()-sE)*6e4),e}function sF(t){var e=0,r=0,n=!1,i=t.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+t+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}e+=r*parseInt(i[s],10)}return e}var aE=new Date("2017-02-19T19:06:09.000Z"),gT=isNaN(aE.getFullYear())?new Date("2/19/17"):aE,aF=gT.getFullYear()==2017;function Vt(t,e){var r=new Date(t);if(aF)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(gT.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Ha(t,e){if(Ze&&Buffer.isBuffer(t)){if(e){if(t[0]==255&&t[1]==254)return ki(t.slice(2).toString("utf16le"));if(t[1]==254&&t[2]==255)return ki(nT(t.slice(2).toString("binary")))}return t.toString("binary")}if(typeof TextDecoder<"u")try{if(e){if(t[0]==255&&t[1]==254)return ki(new TextDecoder("utf-16le").decode(t.slice(2)));if(t[0]==254&&t[1]==255)return ki(new TextDecoder("utf-16be").decode(t.slice(2)))}var r={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function Bt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=Bt(t[r]));return e}function qt(t,e){for(var r="";r.length<e;)r+=t;return r}function li(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var oF=["january","february","march","april","may","june","july","august","september","october","november","december"];function hc(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var a=t.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&oF.indexOf(a)==-1)return r}else if(a.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}var cF=function(){var t="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(t||typeof n=="string")return r.split(n);for(var s=r.split(n),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function vT(t){return t?t.content&&t.type?Ha(t.content,!0):t.data?tu(t.data):t.asNodeBuffer&&Ze?tu(t.asNodeBuffer().toString("binary")):t.asBinary?tu(t.asBinary()):t._data&&t._data.getContent?tu(Ha(Array.prototype.slice.call(t._data.getContent(),0))):null:null}function _T(t){if(!t)return null;if(t.data)return Rm(t.data);if(t.asNodeBuffer&&Ze)return t.asNodeBuffer();if(t._data&&t._data.getContent){var e=t._data.getContent();return typeof e=="string"?Rm(e):Array.prototype.slice.call(e)}return t.content&&t.type?t.content:null}function lF(t){return t&&t.name.slice(-4)===".bin"?_T(t):vT(t)}function zn(t,e){for(var r=t.FullPaths||Yt(t.files),n=e.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var a=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==a||i==a)return t.files?t.files[r[s]]:t.FileIndex[s]}return null}function Xm(t,e){var r=zn(t,e);if(r==null)throw new Error("Cannot find file "+e+" in zip");return r}function ar(t,e,r){if(!r)return lF(Xm(t,e));if(!e)return null;try{return ar(t,e)}catch{return null}}function In(t,e,r){if(!r)return vT(Xm(t,e));if(!e)return null;try{return In(t,e)}catch{return null}}function yT(t,e,r){if(!r)return _T(Xm(t,e));if(!e)return null;try{return yT(t,e)}catch{return null}}function oE(t){for(var e=t.FullPaths||Yt(t.files),r=[],n=0;n<e.length;++n)e[n].slice(-1)!="/"&&r.push(e[n].replace(/^Root Entry[\/]/,""));return r.sort()}function Ye(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Ze?n=is(r):n=CR(r),Re.utils.cfb_add(t,e,n)}Re.utils.cfb_add(t,e,r)}else t.file(e,r)}function Ym(){return Re.utils.cfb_new()}function xT(t,e){switch(e.type){case"base64":return Re.read(t,{type:"base64"});case"binary":return Re.read(t,{type:"binary"});case"buffer":case"array":return Re.read(t,{type:"buffer"})}throw new Error("Unrecognized type "+e.type)}function nu(t,e){if(t.charAt(0)=="/")return t.slice(1);var r=e.split("/");e.slice(-1)!="/"&&r.pop();for(var n=t.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var rr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uF=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,cE=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,hF=/<[^>]*>/g,Xr=rr.match(cE)?cE:hF,fF=/<\w*:/,dF=/<(\/?)\w+:/;function je(t,e,r){for(var n={},i=0,s=0;i!==t.length&&!((s=t.charCodeAt(i))===32||s===10||s===13);++i);if(e||(n[0]=t.slice(0,i)),i===t.length)return n;var a=t.match(uF),o=0,c="",l=0,h="",f="",d=1;if(a)for(l=0;l!=a.length;++l){for(f=a[l],s=0;s!=f.length&&f.charCodeAt(s)!==61;++s);for(h=f.slice(0,s).trim();f.charCodeAt(s+1)==32;)++s;for(d=(i=f.charCodeAt(s+1))==34||i==39?1:0,c=f.slice(s+1+d,f.length-d),o=0;o!=h.length&&h.charCodeAt(o)!==58;++o);if(o===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),n[h]=c,r||(n[h.toLowerCase()]=c);else{var m=(o===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(o+1);if(n[m]&&h.slice(o-3,o)=="ext")continue;n[m]=c,r||(n[m.toLowerCase()]=c)}}return n}function Ri(t){return t.replace(dF,"<$1")}var wT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Qm=rd(wT),lt=function(){var t=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,e=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(t,function(o,c){return wT[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(e,function(o,c){return String.fromCharCode(parseInt(c,16))});var a=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,a)+r(i.slice(a+3))}}(),Jm=/[&<>'"]/g,pF=/[\u0000-\u0008\u000b-\u001f]/g;function Tt(t){var e=t+"";return e.replace(Jm,function(r){return Qm[r]}).replace(pF,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function lE(t){return Tt(t).replace(/ /g,"_x0020_")}var ET=/[\u0000-\u001f]/g;function Zm(t){var e=t+"";return e.replace(Jm,function(r){return Qm[r]}).replace(/\n/g,"<br/>").replace(ET,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mF(t){var e=t+"";return e.replace(Jm,function(r){return Qm[r]}).replace(ET,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var uE=function(){var t=/&#(\d+);/g;function e(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(t,e)}}();function gF(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Lt(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _m(t){for(var e="",r=0,n=0,i=0,s=0,a=0,o=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){a=(n&31)<<6,a|=i&63,e+=String.fromCharCode(a);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}a=t.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,e+=String.fromCharCode(55296+(o>>>10&1023)),e+=String.fromCharCode(56320+(o&1023))}return e}function hE(t){var e=Hs(2*t.length),r,n,i=1,s=0,a=0,o;for(n=0;n<t.length;n+=i)i=1,(o=t.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(t.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,a=55296+(r>>>10&1023),r=56320+(r&1023)),a!==0&&(e[s++]=a&255,e[s++]=a>>>8,a=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function fE(t){return is(t,"binary").toString("utf8")}var Ff="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",At=Ze&&(fE(Ff)==_m(Ff)&&fE||hE(Ff)==_m(Ff)&&hE)||_m,ki=Ze?function(t){return is(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},mu=function(){var t={};return function(r,n){var i=r+"|"+(n||"");return t[i]?t[i]:t[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),TT=function(){var t=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),vF=function(){var t={};return function(r){return t[r]!==void 0?t[r]:t[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),_F=/<\/?(?:vt:)?variant>/g,yF=/<(?:vt:)([^>]*)>([\s\S]*)</;function dE(t,e){var r=je(t),n=t.match(vF(r.baseType))||[],i=[];if(n.length!=r.size){if(e.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var a=s.replace(_F,"").match(yF);a&&i.push({v:At(a[2]),t:a[1]})}),i}var bT=/(^\s|\s$|\n)/;function Lr(t,e){return"<"+t+(e.match(bT)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function gu(t){return Yt(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function _e(t,e,r){return"<"+t+(r!=null?gu(r):"")+(e!=null?(e.match(bT)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Fm(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function xF(t,e){switch(typeof t){case"string":var r=_e("vt:lpwstr",Tt(t));return e&&(r=r.replace(/&quot;/g,"_x0022_")),r;case"number":return _e((t|0)==t?"vt:i4":"vt:r8",Tt(String(t)));case"boolean":return _e("vt:bool",t?"true":"false")}if(t instanceof Date)return _e("vt:filetime",Fm(t));throw new Error("Unable to serialize "+t)}function eg(t){if(Ze&&Buffer.isBuffer(t))return t.toString("utf8");if(typeof t=="string")return t;if(typeof Uint8Array<"u"&&t instanceof Uint8Array)return At(Ks(Gm(t)));throw new Error("Bad input format: expected Buffer or string")}var vu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,fr={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Xa=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Tn={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function wF(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function EF(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,a=n?-e:e;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var o=0;o<=5;++o,s/=256)t[r+o]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var pE=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},mE=Ze?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:is(e)})):pE(t)}:pE,gE=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(Zi(t,i)));return n.join("").replace(Gr,"")},sd=Ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Gr,""):gE(t,e,r)}:gE,vE=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},IT=Ze?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):vE(t,e,r)}:vE,_E=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(nc(t,i)));return n.join("")},vc=Ze?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):_E(e,r,n)}:_E,AT=function(t,e){var r=wr(t,e);return r>0?vc(t,e+4,e+4+r-1):""},tg=AT,ST=function(t,e){var r=wr(t,e);return r>0?vc(t,e+4,e+4+r-1):""},rg=ST,CT=function(t,e){var r=2*wr(t,e);return r>0?vc(t,e+4,e+4+r-1):""},ng=CT,kT=function(e,r){var n=wr(e,r);return n>0?sd(e,r+4,r+4+n):""},ig=kT,DT=function(t,e){var r=wr(t,e);return r>0?vc(t,e+4,e+4+r):""},sg=DT,RT=function(t,e){return wF(t,e)},Gf=RT,ag=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Ze&&(tg=function(e,r){if(!Buffer.isBuffer(e))return AT(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},rg=function(e,r){if(!Buffer.isBuffer(e))return ST(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},ng=function(e,r){if(!Buffer.isBuffer(e))return CT(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},ig=function(e,r){if(!Buffer.isBuffer(e))return kT(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},sg=function(e,r){if(!Buffer.isBuffer(e))return DT(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},Gf=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):RT(e,r)},ag=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});function TF(){sd=function(t,e,r){return _t.utils.decode(1200,t.slice(e,r)).replace(Gr,"")},vc=function(t,e,r){return _t.utils.decode(65001,t.slice(e,r))},tg=function(t,e){var r=wr(t,e);return r>0?_t.utils.decode(uc,t.slice(e+4,e+4+r-1)):""},rg=function(t,e){var r=wr(t,e);return r>0?_t.utils.decode(Di,t.slice(e+4,e+4+r-1)):""},ng=function(t,e){var r=2*wr(t,e);return r>0?_t.utils.decode(1200,t.slice(e+4,e+4+r-1)):""},ig=function(t,e){var r=wr(t,e);return r>0?_t.utils.decode(1200,t.slice(e+4,e+4+r)):""},sg=function(t,e){var r=wr(t,e);return r>0?_t.utils.decode(65001,t.slice(e+4,e+4+r)):""}}typeof _t<"u"&&TF();var nc=function(t,e){return t[e]},Zi=function(t,e){return t[e+1]*256+t[e]},bF=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},wr=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},La=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},IF=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function iu(t,e){var r="",n,i,s=[],a,o,c,l;switch(e){case"dbcs":if(l=this.l,Ze&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)r+=String.fromCharCode(Zi(this,l)),l+=2;t*=2;break;case"utf8":r=vc(this,this.l,this.l+t);break;case"utf16le":t*=2,r=sd(this,this.l,this.l+t);break;case"wstr":if(typeof _t<"u")r=_t.utils.decode(Di,this.slice(this.l,this.l+2*t));else return iu.call(this,t,"dbcs");t=2*t;break;case"lpstr-ansi":r=tg(this,this.l),t=4+wr(this,this.l);break;case"lpstr-cp":r=rg(this,this.l),t=4+wr(this,this.l);break;case"lpwstr":r=ng(this,this.l),t=4+2*wr(this,this.l);break;case"lpp4":t=4+wr(this,this.l),r=ig(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+wr(this,this.l),r=sg(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(a=nc(this,this.l+t++))!==0;)s.push(Rf(a));r=s.join("");break;case"_wstr":for(t=0,r="";(a=Zi(this,this.l+t))!==0;)s.push(Rf(a)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",l=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=nc(this,l),this.l=l+1,o=iu.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Rf(Zi(this,l))),l+=2}r=s.join(""),t*=2;break;case"cpstr":if(typeof _t<"u"){r=_t.utils.decode(Di,this.slice(this.l,this.l+t));break}case"sbcs-cont":for(r="",l=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(l)!==-1)return a=nc(this,l),this.l=l+1,o=iu.call(this,t-c,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Rf(nc(this,l))),l+=1}r=s.join("");break;default:switch(t){case 1:return n=nc(this,this.l),this.l++,n;case 2:return n=(e==="i"?bF:Zi)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?La:IF)(this,this.l),this.l+=4,n):(i=wr(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=Gf(this,this.l):i=Gf([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=IT(this,this.l,t);break}}return this.l+=t,r}var AF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},SF=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},CF=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function kF(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)CF(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){if(typeof _t<"u"&&uc==874)for(i=0;i!=e.length;++i){var s=_t.utils.encode(uc,e.charAt(i));this[this.l+i]=s[0]}else for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,AF(this,e,this.l);break;case 8:if(n=8,r==="f"){EF(this,e,this.l);break}case 16:break;case-4:n=4,SF(this,e,this.l);break}return this.l+=n,this}function FT(t,e){var r=IT(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function Mr(t,e){t.l=e,t.read_shift=iu,t.chk=FT,t.write_shift=kF}function Kr(t,e){t.l+=e}function re(t){var e=Hs(t);return Mr(e,0),e}function ss(t,e,r){if(t){var n,i,s;Mr(t,t.l||0);for(var a=t.length,o=0,c=0;t.l<a;){o=t.read_shift(1),o&128&&(o=(o&127)+((t.read_shift(1)&127)<<7));var l=Tu[o]||Tu[65535];for(n=t.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=t.read_shift(1))&127)<<7*i;c=t.l+s;var h=l.f&&l.f(t,s,r);if(t.l=c,e(h,l,o))return}}}function un(){var t=[],e=Ze?256:2048,r=function(l){var h=re(l);return Mr(h,0),h},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(l){return n&&l<n.length-n.l?n:(i(),n=r(Math.max(l+1,e)))},a=function(){return i(),Er(t)},o=function(l){i(),n=l,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:o,end:a,_bufs:t}}function ae(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=Tu[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var a=t.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)a.write_shift(1,(n&127)+128),n>>=7;else{a.write_shift(1,n);break}n>0&&ag(r)&&t.push(r)}}function su(t,e,r){var n=Bt(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function yE(t,e,r){var n=Bt(t);return n.s=su(n.s,e.s,r),n.e=su(n.e,e.s,r),n}function au(t,e){if(t.cRel&&t.c<0)for(t=Bt(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=Bt(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=Ue(t);return!t.cRel&&t.cRel!=null&&(r=FF(r)),!t.rRel&&t.rRel!=null&&(r=DF(r)),r}function ym(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+$t(t.s.c)+":"+(t.e.cRel?"":"$")+$t(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+tr(t.s.r)+":"+(t.e.rRel?"":"$")+tr(t.e.r):au(t.s,e.biff)+":"+au(t.e,e.biff)}function og(t){return parseInt(RF(t),10)-1}function tr(t){return""+(t+1)}function DF(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function RF(t){return t.replace(/\$(\d+)$/,"$1")}function cg(t){for(var e=PF(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function $t(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function FF(t){return t.replace(/^([A-Z])/,"$$$1")}function PF(t){return t.replace(/^\$([A-Z])/,"$1")}function OF(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ht(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function Ue(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function hn(t){var e=t.indexOf(":");return e==-1?{s:Ht(t),e:Ht(t)}:{s:Ht(t.slice(0,e)),e:Ht(t.slice(e+1))}}function Ge(t,e){return typeof e>"u"||typeof e=="number"?Ge(t.s,t.e):(typeof t!="string"&&(t=Ue(t)),typeof e!="string"&&(e=Ue(e)),t==e?t:t+":"+e)}function ut(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function xE(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Kn(t.z,r?dr(e):e)}catch{}try{return t.w=Kn((t.XF||{}).numFmtId||(r?14:0),r?dr(e):e)}catch{return""+e}}function ns(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?as[t.v]||t.v:e==null?xE(t,t.v):xE(t,e))}function Xs(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function PT(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense;Xt!=null&&i==null&&(i=Xt);var s=t||(i?[]:{}),a=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ht(n.origin):n.origin;a=c.r,o=c.c}s["!ref"]||(s["!ref"]="A1:A1")}var l={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var h=ut(s["!ref"]);l.s.c=h.s.c,l.s.r=h.s.r,l.e.c=Math.max(l.e.c,h.e.c),l.e.r=Math.max(l.e.r,h.e.r),a==-1&&(l.e.r=a=h.e.r+1)}for(var f=0;f!=e.length;++f)if(e[f]){if(!Array.isArray(e[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[f].length;++d)if(!(typeof e[f][d]>"u")){var m={v:e[f][d]},v=a+f,p=o+d;if(l.s.r>v&&(l.s.r=v),l.s.c>p&&(l.s.c=p),l.e.r<v&&(l.e.r=v),l.e.c<p&&(l.e.c=p),e[f][d]&&typeof e[f][d]=="object"&&!Array.isArray(e[f][d])&&!(e[f][d]instanceof Date))m=e[f][d];else if(Array.isArray(m.v)&&(m.f=e[f][d][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(n.nullError)m.t="e",m.v=0;else if(n.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=n.dateNF||Le[14],n.cellDates?(m.t="d",m.w=Kn(m.z,dr(m.v))):(m.t="n",m.v=dr(m.v),m.w=Kn(m.z,m.v))):m.t="s";if(i)s[v]||(s[v]=[]),s[v][p]&&s[v][p].z&&(m.z=s[v][p].z),s[v][p]=m;else{var _=Ue({c:p,r:v});s[_]&&s[_].z&&(m.z=s[_].z),s[_]=m}}}return l.s.c<1e7&&(s["!ref"]=Ge(l)),s}function _c(t,e){return PT(null,t,e)}function NF(t){return t.read_shift(4,"i")}function ui(t,e){return e||(e=re(4)),e.write_shift(4,t),e}function qr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Tr(t,e){var r=!1;return e==null&&(r=!0,e=re(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function MF(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function LF(t,e){return e||(e=re(4)),e.write_shift(2,t.ich||0),e.write_shift(2,t.ifnt||0),e}function lg(t,e){var r=t.l,n=t.read_shift(1),i=qr(t),s=[],a={t:i,h:i};if(n&1){for(var o=t.read_shift(4),c=0;c!=o;++c)s.push(MF(t));a.r=s}else a.r=[{ich:0,ifnt:0}];return t.l=r+e,a}function VF(t,e){var r=!1;return e==null&&(r=!0,e=re(15+4*t.t.length)),e.write_shift(1,0),Tr(t.t,e),r?e.slice(0,e.l):e}var BF=lg;function UF(t,e){var r=!1;return e==null&&(r=!0,e=re(23+4*t.t.length)),e.write_shift(1,1),Tr(t.t,e),e.write_shift(4,1),LF({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function Xn(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Ya(t,e){return e==null&&(e=re(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Qa(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Ja(t,e){return e==null&&(e=re(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var jF=qr,OT=Tr;function ug(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function qf(t,e){var r=!1;return e==null&&(r=!0,e=re(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var WF=qr,Pm=ug,hg=qf;function fg(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?Gf([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):La(e,0)>>2;return r?i/100:i}function NT(t,e){e==null&&(e=re(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function MT(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function $F(t,e){return e||(e=re(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Za=MT,yc=$F;function zr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function za(t,e){return(e||re(8)).write_shift(8,t,"f")}function HF(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),a=t.read_shift(1),o=t.read_shift(1),c=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var l=Ba[i];l&&(e.rgb=yu(l));break;case 2:e.rgb=yu([a,o,c]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function Kf(t,e){if(e||(e=re(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function zF(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function GF(t,e){e||(e=re(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}function LT(t,e){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=t.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[t.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return t.l-=4,t.read_shift(0,e==1?"lpstr":"lpwstr")}function qF(t){return LT(t,1)}function KF(t){return LT(t,2)}var dg=2,ln=3,Pf=11,wE=12,Xf=19;var Of=64,XF=65,YF=71;var QF=4108,JF=4126,xr=80,VT=81,ZF=[xr,VT],Om={1:{n:"CodePage",t:dg},2:{n:"Category",t:xr},3:{n:"PresentationFormat",t:xr},4:{n:"ByteCount",t:ln},5:{n:"LineCount",t:ln},6:{n:"ParagraphCount",t:ln},7:{n:"SlideCount",t:ln},8:{n:"NoteCount",t:ln},9:{n:"HiddenCount",t:ln},10:{n:"MultimediaClipCount",t:ln},11:{n:"ScaleCrop",t:Pf},12:{n:"HeadingPairs",t:QF},13:{n:"TitlesOfParts",t:JF},14:{n:"Manager",t:xr},15:{n:"Company",t:xr},16:{n:"LinksUpToDate",t:Pf},17:{n:"CharacterCount",t:ln},19:{n:"SharedDoc",t:Pf},22:{n:"HyperlinksChanged",t:Pf},23:{n:"AppVersion",t:ln,p:"version"},24:{n:"DigSig",t:XF},26:{n:"ContentType",t:xr},27:{n:"ContentStatus",t:xr},28:{n:"Language",t:xr},29:{n:"Version",t:xr},255:{},2147483648:{n:"Locale",t:Xf},2147483651:{n:"Behavior",t:Xf},1919054434:{}},Nm={1:{n:"CodePage",t:dg},2:{n:"Title",t:xr},3:{n:"Subject",t:xr},4:{n:"Author",t:xr},5:{n:"Keywords",t:xr},6:{n:"Comments",t:xr},7:{n:"Template",t:xr},8:{n:"LastAuthor",t:xr},9:{n:"RevNumber",t:xr},10:{n:"EditTime",t:Of},11:{n:"LastPrinted",t:Of},12:{n:"CreatedDate",t:Of},13:{n:"ModifiedDate",t:Of},14:{n:"PageCount",t:ln},15:{n:"WordCount",t:ln},16:{n:"CharCount",t:ln},17:{n:"Thumbnail",t:YF},18:{n:"Application",t:xr},19:{n:"DocSecurity",t:ln},255:{},2147483648:{n:"Locale",t:Xf},2147483651:{n:"Behavior",t:Xf},1919054434:{}},EE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},eP=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function tP(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var rP=tP([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Ba=Bt(rP),as={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},BT={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Nf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function pg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function nP(t){var e=pg();if(!t||!t.match)return e;var r={};if((t.match(Xr)||[]).forEach(function(n){var i=je(n);switch(i[0].replace(fF,"<")){case"<?xml":break;case"<Types":e.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":e[Mm[i.ContentType]]!==void 0&&e[Mm[i.ContentType]].push(i.PartName);break}}),e.xmlns!==fr.CT)throw new Error("Unknown Namespace: "+e.xmlns);return e.calcchain=e.calcchains.length>0?e.calcchains[0]:"",e.sst=e.strs.length>0?e.strs[0]:"",e.style=e.styles.length>0?e.styles[0]:"",e.defaults=r,delete e.calcchains,e}function UT(t,e){var r=nF(Mm),n=[],i;n[n.length]=rr,n[n.length]=_e("Types",null,{xmlns:fr.CT,"xmlns:xsd":fr.xsd,"xmlns:xsi":fr.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return _e("Default",null,{Extension:c[0],ContentType:c[1]})}));var s=function(c){t[c]&&t[c].length>0&&(i=t[c][0],n[n.length]=_e("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Nf[c][e.bookType]||Nf[c].xlsx}))},a=function(c){(t[c]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:Nf[c][e.bookType]||Nf[c].xlsx})})},o=function(c){(t[c]||[]).forEach(function(l){n[n.length]=_e("Override",null,{PartName:(l[0]=="/"?"":"/")+l,ContentType:r[c][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function _u(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function ou(t,e){var r={"!id":{}};if(!t)return r;e.charAt(0)!=="/"&&(e="/"+e);var n={};return(t.match(Xr)||[]).forEach(function(i){var s=je(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:nu(s.Target,e);r[o]=a,n[s.Id]=a}}),r["!id"]=n,r}function oc(t){var e=[rr,_e("Relationships",null,{xmlns:fr.RELS})];return Yt(t["!id"]).forEach(function(r){e[e.length]=_e("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Et(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,s?i.TargetMode=s:[Qe.HLINK,Qe.XPATH,Qe.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}var iP="application/vnd.oasis.opendocument.spreadsheet";function sP(t,e){for(var r=eg(t),n,i;n=vu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=je(n[0],!1),i.path=="/"&&i.type!==iP)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(e&&e.WTF)throw n}}function aP(t){var e=[rr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function TE(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function oP(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function cP(t){var e=[rr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(TE(t[r][0],t[r][1])),e.push(oP("",t[r][0]));return e.push(TE("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function jT(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+fu.version+"</meta:generator></office:meta></office:document-meta>"}var qn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lP=function(){for(var t=new Array(qn.length),e=0;e<qn.length;++e){var r=qn[e],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);t[e]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return t}();function WT(t){var e={};t=At(t);for(var r=0;r<qn.length;++r){var n=qn[r],i=t.match(lP[r]);i!=null&&i.length>0&&(e[n[1]]=lt(i[1])),n[2]==="date"&&e[n[1]]&&(e[n[1]]=Vt(e[n[1]]))}return e}function xm(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=Tt(e),n[n.length]=r?_e(t,e,r):Lr(t,e))}function $T(t,e){var r=e||{},n=[rr,_e("cp:coreProperties",null,{"xmlns:cp":fr.CORE_PROPS,"xmlns:dc":fr.dc,"xmlns:dcterms":fr.dcterms,"xmlns:dcmitype":fr.dcmitype,"xmlns:xsi":fr.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&xm("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Fm(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&xm("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Fm(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=qn.length;++s){var a=qn[s],o=r.Props&&r.Props[a[1]]!=null?r.Props[a[1]]:t?t[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&xm(a[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Ua=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],HT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function zT(t,e,r,n){var i=[];if(typeof t=="string")i=dE(t,n);else for(var s=0;s<t.length;++s)i=i.concat(t[s].map(function(h){return{v:h}}));var a=typeof e=="string"?dE(e,n).map(function(h){return h.v}):e,o=0,c=0;if(a.length>0)for(var l=0;l!==i.length;l+=2){switch(c=+i[l+1].v,i[l].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=a.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":r.NamedRanges=c,r.DefinedNames=a.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=a.slice(o,o+c);break}o+=c}}function uP(t,e,r){var n={};return e||(e={}),t=At(t),Ua.forEach(function(i){var s=(t.match(mu(i[0]))||[])[1];switch(i[2]){case"string":s&&(e[i[1]]=lt(s));break;case"bool":e[i[1]]=s==="true";break;case"raw":var a=t.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(n[i[1]]=a[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&zT(n.HeadingPairs,n.TitlesOfParts,e,r),e}function GT(t){var e=[],r=_e;return t||(t={}),t.Application="SheetJS",e[e.length]=rr,e[e.length]=_e("Properties",null,{xmlns:fr.EXT_PROPS,"xmlns:vt":fr.vt}),Ua.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Tt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+Tt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var hP=/<[^>]+>[^<]*/g;function fP(t,e){var r={},n="",i=t.match(hP);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=je(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=lt(o.name);break;case"</property>":n=null;break;default:if(a.indexOf("<vt:")===0){var c=a.split(">"),l=c[0].slice(4),h=c[1];switch(l){case"lpstr":case"bstr":case"lpwstr":r[n]=lt(h);break;case"bool":r[n]=Lt(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(h,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(h);break;case"filetime":case"date":r[n]=Vt(h);break;case"cy":case"error":r[n]=lt(h);break;default:if(l.slice(-1)=="/")break;e.WTF&&typeof console<"u"&&console.warn("Unexpected",a,l,c)}}else if(a.slice(0,2)!=="</"){if(e.WTF)throw new Error(a)}}}return r}function qT(t){var e=[rr,_e("Properties",null,{xmlns:fr.CUST_PROPS,"xmlns:vt":fr.vt})];if(!t)return e.join("");var r=1;return Yt(t).forEach(function(i){++r,e[e.length]=_e("property",xF(t[i],!0),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Tt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Lm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wm;function dP(t,e,r){wm||(wm=rd(Lm)),e=wm[e]||e,t[e]=r}function pP(t,e){var r=[];return Yt(Lm).map(function(n){for(var i=0;i<qn.length;++i)if(qn[i][1]==n)return qn[i];for(i=0;i<Ua.length;++i)if(Ua[i][1]==n)return Ua[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Lr(Lm[n[1]]||n[1],i))}}),_e("DocumentProperties",r.join(""),{xmlns:Tn.o})}function mP(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&Yt(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var a=0;a<qn.length;++a)if(s==qn[a][1])return;for(a=0;a<Ua.length;++a)if(s==Ua[a][1])return;for(a=0;a<r.length;++a)if(s==r[a])return;var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),i.push(_e(lE(s),o,{"dt:dt":c}))}}),e&&Yt(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var a=e[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(_e(lE(s),a,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Tn.o+'">'+i.join("")+"</"+n+">"}function mg(t){var e=t.read_shift(4),r=t.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+e/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function gP(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var a=re(8);return a.write_shift(4,n),a.write_shift(4,i),a}function KT(t,e,r){var n=t.l,i=t.read_shift(0,"lpstr-cp");if(r)for(;t.l-n&3;)++t.l;return i}function XT(t,e,r){var n=t.read_shift(0,"lpwstr");return r&&(t.l+=4-(n.length+1&3)&3),n}function YT(t,e,r){return e===31?XT(t):KT(t,e,r)}function Vm(t,e,r){return YT(t,e,r===!1?0:4)}function vP(t,e){if(!e)throw new Error("VtUnalignedString must have positive length");return YT(t,e,0)}function _P(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n){var i=t.l;r[n]=t.read_shift(0,"lpwstr").replace(Gr,""),t.l-i&2&&(t.l+=2)}return r}function yP(t){for(var e=t.read_shift(4),r=[],n=0;n!=e;++n)r[n]=t.read_shift(0,"lpstr-cp").replace(Gr,"");return r}function xP(t){var e=t.l,r=Yf(t,VT);t[t.l]==0&&t[t.l+1]==0&&t.l-e&2&&(t.l+=2);var n=Yf(t,ln);return[r,n]}function wP(t){for(var e=t.read_shift(4),r=[],n=0;n<e/2;++n)r.push(xP(t));return r}function bE(t,e){for(var r=t.read_shift(4),n={},i=0;i!=r;++i){var s=t.read_shift(4),a=t.read_shift(4);n[s]=t.read_shift(a,e===1200?"utf16le":"utf8").replace(Gr,"").replace(ru,"!"),e===1200&&a%2&&(t.l+=2)}return t.l&3&&(t.l=t.l>>3<<2),n}function QT(t){var e=t.read_shift(4),r=t.slice(t.l,t.l+e);return t.l+=e,(e&3)>0&&(t.l+=4-(e&3)&3),r}function EP(t){var e={};return e.Size=t.read_shift(4),t.l+=e.Size+3-(e.Size-1)%4,e}function Yf(t,e,r){var n=t.read_shift(2),i,s=r||{};if(t.l+=2,e!==wE&&n!==e&&ZF.indexOf(e)===-1&&!((e&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+e+" saw "+n);switch(e===wE?n:e){case 2:return i=t.read_shift(2,"i"),s.raw||(t.l+=2),i;case 3:return i=t.read_shift(4,"i"),i;case 11:return t.read_shift(4)!==0;case 19:return i=t.read_shift(4),i;case 30:return KT(t,n,4).replace(Gr,"");case 31:return XT(t);case 64:return mg(t);case 65:return QT(t);case 71:return EP(t);case 80:return Vm(t,n,!s.raw).replace(Gr,"");case 81:return vP(t,n).replace(Gr,"");case 4108:return wP(t);case 4126:case 4127:return n==4127?_P(t):yP(t);default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+n)}}function IE(t,e){var r=re(4),n=re(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=re(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=gP(e);break;case 31:case 80:for(n=re(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Er([r,n])}function AE(t,e){var r=t.l,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0,o=0,c=-1,l={};for(a=0;a!=i;++a){var h=t.read_shift(4),f=t.read_shift(4);s[a]=[h,f+r]}s.sort(function(S,b){return S[1]-b[1]});var d={};for(a=0;a!=i;++a){if(t.l!==s[a][1]){var m=!0;if(a>0&&e)switch(e[s[a-1][0]].t){case 2:t.l+2===s[a][1]&&(t.l+=2,m=!1);break;case 80:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break;case 4108:t.l<=s[a][1]&&(t.l=s[a][1],m=!1);break}if((!e||a==0)&&t.l<=s[a][1]&&(m=!1,t.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+t.l+" :"+a)}if(e){var v=e[s[a][0]];if(d[v.n]=Yf(t,v.t,{raw:!0}),v.p==="version"&&(d[v.n]=String(d[v.n]>>16)+"."+("0000"+String(d[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(d[v.n]){case 0:d[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:oi(o=d[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[v.n])}}else if(s[a][0]===1){if(o=d.CodePage=Yf(t,dg),oi(o),c!==-1){var p=t.l;t.l=s[c][1],l=bE(t,o),t.l=p}}else if(s[a][0]===0){if(o===0){c=a,t.l=s[a+1][1];continue}l=bE(t,o)}else{var _=l[s[a][0]],T;switch(t[t.l]){case 65:t.l+=4,T=QT(t);break;case 30:t.l+=4,T=Vm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 31:t.l+=4,T=Vm(t,t[t.l-4]).replace(/\u0000+$/,"");break;case 3:t.l+=4,T=t.read_shift(4,"i");break;case 19:t.l+=4,T=t.read_shift(4);break;case 5:t.l+=4,T=t.read_shift(8,"f");break;case 11:t.l+=4,T=er(t,4);break;case 64:t.l+=4,T=Vt(mg(t));break;default:throw new Error("unparsed value: "+t[t.l])}d[_]=T}}return t.l=r+n,d}var JT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function TP(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function SE(t,e,r){var n=re(8),i=[],s=[],a=8,o=0,c=re(8),l=re(8);if(c.write_shift(4,2),c.write_shift(4,1200),l.write_shift(4,1),s.push(c),i.push(l),a+=8+c.length,!e){l=re(8),l.write_shift(4,0),i.unshift(l);var h=[re(4)];for(h[0].write_shift(4,t.length),o=0;o<t.length;++o){var f=t[o][0];for(c=re(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=Er(h),s.unshift(c),a+=8+c.length}for(o=0;o<t.length;++o)if(!(e&&!e[t[o][0]])&&!(JT.indexOf(t[o][0])>-1||HT.indexOf(t[o][0])>-1)&&t[o][1]!=null){var d=t[o][1],m=0;if(e){m=+e[t[o][0]];var v=r[m];if(v.p=="version"&&typeof d=="string"){var p=d.split(".");d=(+p[0]<<16)+(+p[1]||0)}c=IE(v.t,d)}else{var _=TP(d);_==-1&&(_=31,d=String(d)),c=IE(_,d)}s.push(c),l=re(8),l.write_shift(4,e?m:2+o),i.push(l),a+=8+c.length}var T=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,T),T+=s[o].length;return n.write_shift(4,a),n.write_shift(4,s.length),Er([n].concat(i).concat(s))}function CE(t,e,r){var n=t.content;if(!n)return{};Mr(n,0);var i,s,a,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var l=n.read_shift(4),h=n.read_shift(16);if(h!==Re.utils.consts.HEADER_CLSID&&h!==r)throw new Error("Bad PropertySet CLSID "+h);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),o=n.read_shift(4),i===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);i===2&&(a=n.read_shift(16),c=n.read_shift(4));var f=AE(n,e),d={SystemIdentifier:l};for(var m in f)d[m]=f[m];if(d.FMTID=s,i===1)return d;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var v;try{v=AE(n,null)}catch{}for(m in v)d[m]=v[m];return d.FMTID=[s,a],d}function kE(t,e,r,n,i,s){var a=re(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Re.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,e,"hex"),a.write_shift(4,i?68:48);var c=SE(t,r,n);if(o.push(c),i){var l=SE(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+c.length),o.push(l)}return Er(o)}function js(t,e){return t.read_shift(e),null}function bP(t,e){e||(e=re(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function IP(t,e,r){for(var n=[],i=t.l+e;t.l<i;)n.push(r(t,i-t.l));if(i!==t.l)throw new Error("Slurp error");return n}function er(t,e){return t.read_shift(e)===1}function an(t,e){return e||(e=re(2)),e.write_shift(2,+!!t),e}function or(t){return t.read_shift(2,"u")}function Gn(t,e){return e||(e=re(2)),e.write_shift(2,t),e}function ZT(t,e){return IP(t,e,or)}function AP(t){var e=t.read_shift(1),r=t.read_shift(1);return r===1?e:e===1}function eb(t,e,r){return r||(r=re(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function Su(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont",s=Di;if(r&&r.biff>=8&&(Di=1200),!r||r.biff==8){var a=t.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return Di=s,o}function SP(t){var e=Di;Di=1200;var r=t.read_shift(2),n=t.read_shift(1),i=n&4,s=n&8,a=1+(n&1),o=0,c,l={};s&&(o=t.read_shift(2)),i&&(c=t.read_shift(4));var h=a==2?"dbcs-cont":"sbcs-cont",f=r===0?"":t.read_shift(r,h);return s&&(t.l+=4*o),i&&(t.l+=c),l.t=f,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),Di=e,l}function CP(t){var e=t.t||"",r=1,n=re(3+(r>1?2:0));n.write_shift(2,e.length),n.write_shift(1,(r>1?8:0)|1),r>1&&n.write_shift(2,r);var i=re(2*e.length);i.write_shift(2*e.length,e,"utf16le");var s=[n,i];return Er(s)}function Ga(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Cu(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Ga(t,n,r)}function eo(t,e,r){if(r.biff>5)return Cu(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function tb(t,e,r){return r||(r=re(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function kP(t){var e=t.read_shift(1);t.l++;var r=t.read_shift(2);return t.l+=2,[e,r]}function DP(t){var e=t.read_shift(4),r=t.l,n=!1;e>24&&(t.l+=e-24,t.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),t.l=r);var i=t.read_shift((n?e-24:e)>>1,"utf16le").replace(Gr,"");return n&&(t.l+=24),i}function RP(t){for(var e=t.read_shift(2),r="";e-- >0;)r+="../";var n=t.read_shift(0,"lpstr-ansi");if(t.l+=2,t.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=t.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=t.read_shift(4);if(t.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=t.read_shift(s>>1,"utf16le").replace(Gr,"");return r+a}function FP(t,e){var r=t.read_shift(16);switch(e-=16,r){case"e0c9ea79f9bace118c8200aa004ba90b":return DP(t,e);case"0303000000000000c000000000000046":return RP(t,e);default:throw new Error("Unsupported Moniker "+r)}}function Mf(t){var e=t.read_shift(4),r=e>0?t.read_shift(e,"utf16le").replace(Gr,""):"";return r}function DE(t,e){e||(e=re(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function PP(t,e){var r=t.l+e,n=t.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=t.read_shift(2);t.l+=2;var s,a,o,c,l="",h,f;i&16&&(s=Mf(t,r-t.l)),i&128&&(a=Mf(t,r-t.l)),(i&257)===257&&(o=Mf(t,r-t.l)),(i&257)===1&&(c=FP(t,r-t.l)),i&8&&(l=Mf(t,r-t.l)),i&32&&(h=t.read_shift(16)),i&64&&(f=mg(t)),t.l=r;var d=a||o||c||"";d&&l&&(d+="#"+l),d||(d="#"+l),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var m={Target:d};return h&&(m.guid=h),f&&(m.time=f),s&&(m.Tooltip=s),m}function OP(t){var e=re(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(r=0;r<a.length;++r)e.write_shift(4,a[r]);if(s==28)n=n.slice(1),DE(n,e);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));var o=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)e.write_shift(2,o.charCodeAt(r));e.write_shift(2,0),s&8&&DE(i>-1?n.slice(i+1):"",e)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<a.length;++r)e.write_shift(1,parseInt(a[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(e.write_shift(2,c),e.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)e.write_shift(1,n.charCodeAt(r+3*c)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function rb(t){var e=t.read_shift(1),r=t.read_shift(1),n=t.read_shift(1),i=t.read_shift(1);return[e,r,n,i]}function nb(t,e){var r=rb(t,e);return r[3]=0,r}function Fi(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return{r:e,c:r,ixfe:n}}function qa(t,e,r,n){return n||(n=re(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function NP(t){var e=t.read_shift(2),r=t.read_shift(2);return t.l+=8,{type:e,flags:r}}function MP(t,e,r){return e===0?"":eo(t,e,r)}function LP(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),a=t.read_shift(n,"i");return[i,s,a]}function ib(t){var e=t.read_shift(2),r=fg(t);return[e,r]}function VP(t,e,r){t.l+=4,e-=4;var n=t.l+e,i=Su(t,e,r),s=t.read_shift(2);if(n-=t.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return t.l+=s,i}function ad(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function sb(t,e){return e||(e=re(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function ab(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(1),i=t.read_shift(1);return{s:{c:n,r:e},e:{c:i,r}}}var BP=ab;function ob(t){t.l+=4;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2);return t.l+=12,[r,e,n]}function UP(t){var e={};return t.l+=4,t.l+=16,e.fSharedNote=t.read_shift(2),t.l+=4,e}function jP(t){var e={};return t.l+=4,t.cf=t.read_shift(2),e}function jr(t){t.l+=2,t.l+=t.read_shift(2)}var WP={0:jr,4:jr,5:jr,6:jr,7:jP,8:jr,9:jr,10:jr,11:jr,12:jr,13:UP,14:jr,15:jr,16:jr,17:jr,18:jr,19:jr,20:jr,21:ob};function $P(t,e){for(var r=t.l+e,n=[];t.l<r;){var i=t.read_shift(2);t.l-=2;try{n.push(WP[i](t,r-t.l))}catch{return t.l=r,n}}return t.l!=r&&(t.l=r),n}function Lf(t,e){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=t.read_shift(2),e-=2,e>=2&&(r.dt=t.read_shift(2),t.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(e>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return t.read_shift(e),r}function gg(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=re(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function HP(t,e){return e===0||t.read_shift(2),1200}function zP(t,e,r){if(r.enc)return t.l+=e,"";var n=t.l,i=eo(t,0,r);return t.read_shift(e+n-t.l),i}function GP(t,e){var r=!e||e.biff==8,n=re(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function qP(t,e,r){var n=r&&r.biff==8||e==2?t.read_shift(2):(t.l+=e,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function KP(t,e,r){var n=t.read_shift(4),i=t.read_shift(1)&3,s=t.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Su(t,0,r);return a.length===0&&(a="Sheet1"),{pos:n,hs:i,dt:s,name:a}}function XP(t,e){var r=!e||e.biff>=8?2:1,n=re(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function YP(t,e){for(var r=t.l+e,n=t.read_shift(4),i=t.read_shift(4),s=[],a=0;a!=i&&t.l<r;++a)s.push(SP(t));return s.Count=n,s.Unique=i,s}function QP(t,e){var r=re(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=CP(t[i],e);var s=Er([r].concat(n));return s.parts=[r.length].concat(n.map(function(a){return a.length})),s}function JP(t,e){var r={};return r.dsst=t.read_shift(2),t.l+=e-2,r}function ZP(t){var e={};e.r=t.read_shift(2),e.c=t.read_shift(2),e.cnt=t.read_shift(2)-e.c;var r=t.read_shift(2);t.l+=4;var n=t.read_shift(1);return t.l+=3,n&7&&(e.level=n&7),n&32&&(e.hidden=!0),n&64&&(e.hpt=r/20),e}function eO(t){var e=NP(t);if(e.type!=2211)throw new Error("Invalid Future Record "+e.type);var r=t.read_shift(4);return r!==0}function tO(t){return t.read_shift(2),t.read_shift(4)}function RE(t,e,r){var n=0;r&&r.biff==2||(n=t.read_shift(2));var i=t.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function rO(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=t.read_shift(2),c=t.read_shift(2),l=t.read_shift(2);return{Pos:[e,r],Dim:[n,i],Flags:s,CurTab:a,FirstTab:o,Selected:c,TabRatio:l}}function nO(){var t=re(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function iO(t,e,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=t.read_shift(2);return{RTL:n&64}}function sO(t){var e=re(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function aO(){}function oO(t,e,r){var n={dyHeight:t.read_shift(2),fl:t.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:t.l+=2;break;default:t.l+=10;break}return n.name=Su(t,0,r),n}function cO(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=re(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function lO(t){var e=Fi(t);return e.isst=t.read_shift(4),e}function uO(t,e,r,n){var i=re(10);return qa(t,e,n,i),i.write_shift(4,r),i}function hO(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=t.l+e,i=Fi(t,6);r.biff==2&&t.l++;var s=Cu(t,n-t.l,r);return i.val=s,i}function fO(t,e,r,n,i){var s=!i||i.biff==8,a=re(8+ +s+(1+s)*r.length);return qa(t,e,n,a),a.write_shift(2,r.length),s&&a.write_shift(1,1),a.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),a}function dO(t,e,r){var n=t.read_shift(2),i=eo(t,0,r);return[n,i]}function pO(t,e,r,n){var i=r&&r.biff==5;n||(n=re(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var mO=eo;function FE(t,e,r){var n=t.l+e,i=r.biff==8||!r.biff?4:2,s=t.read_shift(i),a=t.read_shift(i),o=t.read_shift(2),c=t.read_shift(2);return t.l=n,{s:{r:s,c:o},e:{r:a,c}}}function gO(t,e){var r=e.biff==8||!e.biff?4:2,n=re(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function vO(t){var e=t.read_shift(2),r=t.read_shift(2),n=ib(t);return{r:e,c:r,ixfe:n[0],rknum:n[1]}}function _O(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(ib(t));if(t.l!==r)throw new Error("MulRK read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:a,rkrec:s}}function yO(t,e){for(var r=t.l+e-2,n=t.read_shift(2),i=t.read_shift(2),s=[];t.l<r;)s.push(t.read_shift(2));if(t.l!==r)throw new Error("MulBlank read error");var a=t.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:a,ixfe:s}}function xO(t,e,r,n){var i={},s=t.read_shift(4),a=t.read_shift(4),o=t.read_shift(4),c=t.read_shift(2);return i.patternType=eP[o>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function wO(t,e,r){var n={};return n.ifnt=t.read_shift(2),n.numFmtId=t.read_shift(2),n.flags=t.read_shift(2),n.fStyle=n.flags>>2&1,e-=6,n.data=xO(t,e,n.fStyle,r),n}function PE(t,e,r,n){var i=r&&r.biff==5;n||(n=re(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function EO(t){t.l+=4;var e=[t.read_shift(2),t.read_shift(2)];if(e[0]!==0&&e[0]--,e[1]!==0&&e[1]--,e[0]>7||e[1]>7)throw new Error("Bad Gutters: "+e.join("|"));return e}function TO(t){var e=re(8);return e.write_shift(4,0),e.write_shift(2,t[0]?t[0]+1:0),e.write_shift(2,t[1]?t[1]+1:0),e}function OE(t,e,r){var n=Fi(t,6);(r.biff==2||e==9)&&++t.l;var i=AP(t,2);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function bO(t,e,r,n,i,s){var a=re(8);return qa(t,e,n,a),eb(r,s,a),a}function IO(t,e,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Fi(t,6),i=zr(t,8);return n.val=i,n}function AO(t,e,r,n){var i=re(14);return qa(t,e,n,i),za(r,i),i}var NE=MP;function SO(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=Ga(t,s),o=[];n>t.l;)o.push(Cu(t));return[s,i,a,o]}function ME(t,e,r){var n=t.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=VP(t,e-2,r)),s.body=i||t.read_shift(e-2),typeof i=="string"&&(s.Name=i),s}var CO=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function LE(t,e,r){var n=t.l+e,i=t.read_shift(2),s=t.read_shift(1),a=t.read_shift(1),o=t.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(t.l+=2),c=t.read_shift(2),r.biff==5&&(t.l+=2),t.l+=4);var l=Ga(t,a,r);i&32&&(l=CO[l.charCodeAt(0)]);var h=n-t.l;r&&r.biff==2&&--h;var f=n==t.l||o===0||!(h>0)?[]:$L(t,h,r,o);return{chKey:s,Name:l,itab:c,rgce:f}}function cb(t,e,r){if(r.biff<8)return kO(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(LP(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function kO(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=Su(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function DO(t,e,r){if(r.biff<8){t.l+=e;return}var n=t.read_shift(2),i=t.read_shift(2),s=Ga(t,n,r),a=Ga(t,i,r);return[s,a]}function RO(t,e,r){var n=ab(t,6);t.l++;var i=t.read_shift(1);return e-=8,[HL(t,e,r),i,n]}function VE(t,e,r){var n=BP(t,6);switch(r.biff){case 2:t.l++,e-=7;break;case 3:case 4:t.l+=2,e-=8;break;default:t.l+=6,e-=12}return[n,jL(t,e,r,n)]}function FO(t){var e=t.read_shift(4)!==0,r=t.read_shift(4)!==0,n=t.read_shift(4);return[e,r,n]}function PO(t,e,r){if(!(r.biff<8)){var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2),o=eo(t,0,r);return r.biff<8&&t.read_shift(1),[{r:n,c:i},o,a,s]}}function OO(t,e,r){return PO(t,e,r)}function NO(t,e){for(var r=[],n=t.read_shift(2);n--;)r.push(ad(t,e));return r}function MO(t){var e=re(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)sb(t[r],e);return e}function LO(t,e,r){if(r&&r.biff<8)return BO(t,e,r);var n=ob(t,22),i=$P(t,e-22,n[1]);return{cmo:n,ft:i}}var VO={8:function(t,e){var r=t.l+e;t.l+=10;var n=t.read_shift(2);t.l+=4,t.l+=2,t.l+=2,t.l+=2,t.l+=4;var i=t.read_shift(1);return t.l+=i,t.l=r,{fmt:n}}};function BO(t,e,r){t.l+=4;var n=t.read_shift(2),i=t.read_shift(2),s=t.read_shift(2);t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=2,t.l+=6,e-=36;var a=[];return a.push((VO[n]||Kr)(t,e,r)),{cmo:[i,n,s],ft:a}}function UO(t,e,r){var n=t.l,i="";try{t.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?t.l+=6:a=kP(t,6,r);var o=t.read_shift(2);t.read_shift(2),or(t,2);var c=t.read_shift(2);t.l+=c;for(var l=1;l<t.lens.length-1;++l){if(t.l-n!=t.lens[l])throw new Error("TxO: bad continue record");var h=t[t.l],f=Ga(t,t.lens[l+1]-t.lens[l]-1);if(i+=f,i.length>=(h?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return t.l=n+e,{t:i}}catch{return t.l=n+e,{t:i}}}function jO(t,e){var r=ad(t,8);t.l+=16;var n=PP(t,e-24);return[r,n]}function WO(t){var e=re(24),r=Ht(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return Er([e,OP(t[1])])}function $O(t,e){t.read_shift(2);var r=ad(t,8),n=t.read_shift((e-10)/2,"dbcs-cont");return n=n.replace(Gr,""),[r,n]}function HO(t){var e=t[1].Tooltip,r=re(10+2*(e.length+1));r.write_shift(2,2048);var n=Ht(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function zO(t){var e=[0,0],r;return r=t.read_shift(2),e[0]=EE[r]||r,r=t.read_shift(2),e[1]=EE[r]||r,e}function GO(t){return t||(t=re(4)),t.write_shift(2,1),t.write_shift(2,1),t}function qO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(nb(t,8));return r}function KO(t){for(var e=t.read_shift(2),r=[];e-- >0;)r.push(nb(t,8));return r}function XO(t){t.l+=2;var e={cxfs:0,crc:0};return e.cxfs=t.read_shift(2),e.crc=t.read_shift(4),e}function lb(t,e,r){if(!r.cellStyles)return Kr(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),a=t.read_shift(n),o=t.read_shift(n),c=t.read_shift(2);n==2&&(t.l+=2);var l={s:i,e:s,w:a,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(l.level=c>>8&7),l}function YO(t,e){var r=re(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function QO(t,e){var r={};return e<32||(t.l+=16,r.header=zr(t,8),r.footer=zr(t,8),t.l+=2),r}function JO(t,e,r){var n={area:!1};if(r.biff!=5)return t.l+=e,n;var i=t.read_shift(1);return t.l+=3,i&16&&(n.area=!0),n}function ZO(t){for(var e=re(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}var eN=Fi,tN=ZT,rN=Cu;function nN(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i={fmt:e,env:r,len:n,data:t.slice(t.l,t.l+n)};return t.l+=n,i}function iN(t,e,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Fi(t,6);++t.l;var i=eo(t,e-7,r);return n.t="str",n.val=i,n}function sN(t){var e=Fi(t,6);++t.l;var r=zr(t,8);return e.t="n",e.val=r,e}function aN(t,e,r){var n=re(15);return Fu(n,t,e),n.write_shift(8,r,"f"),n}function oN(t){var e=Fi(t,6);++t.l;var r=t.read_shift(2);return e.t="n",e.val=r,e}function cN(t,e,r){var n=re(9);return Fu(n,t,e),n.write_shift(2,r),n}function lN(t){var e=t.read_shift(1);return e===0?(t.l++,""):t.read_shift(e,"sbcs-cont")}function uN(t,e){t.l+=6,t.l+=2,t.l+=1,t.l+=3,t.l+=1,t.l+=e-13}function hN(t,e,r){var n=t.l+e,i=Fi(t,6),s=t.read_shift(2),a=Ga(t,s,r);return t.l=n,i.t="str",i.val=a,i}var fN=[2,3,48,49,131,139,140,245],Bm=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=rd({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var l=[],h=Hs(1);switch(c.type){case"base64":h=bn(An(o));break;case"binary":h=bn(o);break;case"buffer":case"array":h=o;break}Mr(h,0);var f=h.read_shift(1),d=!!(f&136),m=!1,v=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,d=!0;break;case 49:m=!0,d=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var p=0,_=521;f==2&&(p=h.read_shift(2)),h.l+=3,f!=2&&(p=h.read_shift(4)),p>1048576&&(p=1e6),f!=2&&(_=h.read_shift(2));var T=h.read_shift(2),S=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(S=t[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var b=[],O={},V=Math.min(h.length,f==2?521:_-10-(m?264:0)),B=v?32:11;h.l<V&&h[h.l]!=13;)switch(O={},O.name=_t.utils.decode(S,h.slice(h.l,h.l+B)).replace(/[\u0000\r\n].*$/g,""),h.l+=B,O.type=String.fromCharCode(h.read_shift(1)),f!=2&&!v&&(O.offset=h.read_shift(4)),O.len=h.read_shift(1),f==2&&(O.offset=h.read_shift(2)),O.dec=h.read_shift(1),O.name.length&&b.push(O),f!=2&&(h.l+=v?13:14),O.type){case"B":(!m||O.len!=8)&&c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+O.name+":"+O.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+O.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var x=0,w=0;for(l[0]=[],w=0;w!=b.length;++w)l[0][w]=b[w].name;for(;p-- >0;){if(h[h.l]===42){h.l+=T;continue}for(++h.l,l[++x]=[],w=0,w=0;w!=b.length;++w){var E=h.slice(h.l,h.l+b[w].len);h.l+=b[w].len,Mr(E,0);var C=_t.utils.decode(S,E);switch(b[w].type){case"C":C.trim().length&&(l[x][w]=C.replace(/\s+$/,""));break;case"D":C.length===8?l[x][w]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):l[x][w]=C;break;case"F":l[x][w]=parseFloat(C.trim());break;case"+":case"I":l[x][w]=v?E.read_shift(-4,"i")^2147483648:E.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":l[x][w]=!0;break;case"N":case"F":l[x][w]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));l[x][w]="##MEMO##"+(v?parseInt(C.trim(),10):E.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(l[x][w]=+C||0);break;case"@":l[x][w]=new Date(E.read_shift(-8,"f")-621356832e5);break;case"T":l[x][w]=new Date((E.read_shift(4)-2440588)*864e5+E.read_shift(4));break;case"Y":l[x][w]=E.read_shift(4,"i")/1e4+E.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":l[x][w]=-E.read_shift(-8,"f");break;case"B":if(m&&b[w].len==8){l[x][w]=E.read_shift(8,"f");break}case"G":case"P":E.l+=b[w].len;break;case"0":if(b[w].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+b[w].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(l=l.slice(0,c.sheetRows)),c.DBF=b,l}function n(o,c){var l=c||{};l.dateNF||(l.dateNF="yyyymmdd");var h=_c(r(o,l),l);return h["!cols"]=l.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete l.DBF,h}function i(o,c){try{return Xs(n(o,c),c)}catch(l){if(c&&c.WTF)throw l}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,c){var l=c||{};if(+l.codepage>=0&&oi(+l.codepage),l.type=="string")throw new Error("Cannot write DBF to JS string");var h=un(),f=Zf(o,{header:1,raw:!0,cellDates:!0}),d=f[0],m=f.slice(1),v=o["!cols"]||[],p=0,_=0,T=0,S=1;for(p=0;p<d.length;++p){if(((v[p]||{}).DBF||{}).name){d[p]=v[p].DBF.name,++T;continue}if(d[p]!=null){if(++T,typeof d[p]=="number"&&(d[p]=d[p].toString(10)),typeof d[p]!="string")throw new Error("DBF Invalid column name "+d[p]+" |"+typeof d[p]+"|");if(d.indexOf(d[p])!==p){for(_=0;_<1024;++_)if(d.indexOf(d[p]+"_"+_)==-1){d[p]+="_"+_;break}}}}var b=ut(o["!ref"]),O=[],V=[],B=[];for(p=0;p<=b.e.c-b.s.c;++p){var x="",w="",E=0,C=[];for(_=0;_<m.length;++_)m[_][p]!=null&&C.push(m[_][p]);if(C.length==0||d[p]==null){O[p]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":w="B";break;case"string":w="C";break;case"boolean":w="L";break;case"object":w=C[_]instanceof Date?"D":"C";break;default:w="C"}E=Math.max(E,String(C[_]).length),x=x&&x!=w?"C":w}E>250&&(E=250),w=((v[p]||{}).DBF||{}).type,w=="C"&&v[p].DBF.len>E&&(E=v[p].DBF.len),x=="B"&&w=="N"&&(x="N",B[p]=v[p].DBF.dec,E=v[p].DBF.len),V[p]=x=="C"||w=="N"?E:s[x]||0,S+=V[p],O[p]=x}var D=h.next(32);for(D.write_shift(4,318902576),D.write_shift(4,m.length),D.write_shift(2,296+32*T),D.write_shift(2,S),p=0;p<4;++p)D.write_shift(4,0);for(D.write_shift(4,0|(+e[uc]||3)<<8),p=0,_=0;p<d.length;++p)if(d[p]!=null){var A=h.next(32),R=(d[p].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);A.write_shift(1,R,"sbcs"),A.write_shift(1,O[p]=="?"?"C":O[p],"sbcs"),A.write_shift(4,_),A.write_shift(1,V[p]||s[O[p]]||0),A.write_shift(1,B[p]||0),A.write_shift(1,2),A.write_shift(4,0),A.write_shift(1,0),A.write_shift(4,0),A.write_shift(4,0),_+=V[p]||s[O[p]]||0}var oe=h.next(264);for(oe.write_shift(4,13),p=0;p<65;++p)oe.write_shift(4,0);for(p=0;p<m.length;++p){var ce=h.next(S);for(ce.write_shift(1,0),_=0;_<d.length;++_)if(d[_]!=null)switch(O[_]){case"L":ce.write_shift(1,m[p][_]==null?63:m[p][_]?84:70);break;case"B":ce.write_shift(8,m[p][_]||0,"f");break;case"N":var ke="0";for(typeof m[p][_]=="number"&&(ke=m[p][_].toFixed(B[_]||0)),T=0;T<V[_]-ke.length;++T)ce.write_shift(1,32);ce.write_shift(1,ke,"sbcs");break;case"D":m[p][_]?(ce.write_shift(4,("0000"+m[p][_].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(m[p][_].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+m[p][_].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var we=String(m[p][_]!=null?m[p][_]:"").slice(0,V[_]);for(ce.write_shift(1,we,"sbcs"),T=0;T<V[_]-we.length;++T)ce.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:n,from_sheet:a}}(),ub=function(){var t={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Yt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,m){var v=t[m];return typeof v=="number"?Xw(v):v},n=function(d,m,v){var p=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return p==59?d:Xw(p)};t["|"]=254;function i(d,m){switch(m.type){case"base64":return s(An(d),m);case"binary":return s(d,m);case"buffer":return s(Ze&&Buffer.isBuffer(d)?d.toString("binary"):Ks(d),m);case"array":return s(Ha(d),m)}throw new Error("Unrecognized type "+m.type)}function s(d,m){var v=d.split(/[\n\r]+/),p=-1,_=-1,T=0,S=0,b=[],O=[],V=null,B={},x=[],w=[],E=[],C=0,D;for(+m.codepage>=0&&oi(+m.codepage);T!==v.length;++T){C=0;var A=v[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),R=A.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),oe=R[0],ce;if(A.length>0)switch(oe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":R[1].charAt(0)=="P"&&O.push(A.slice(3).replace(/;;/g,";"));break;case"C":var ke=!1,we=!1,Ne=!1,de=!1,Ae=-1,ie=-1;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"A":break;case"X":_=parseInt(R[S].slice(1))-1,we=!0;break;case"Y":for(p=parseInt(R[S].slice(1))-1,we||(_=0),D=b.length;D<=p;++D)b[D]=[];break;case"K":ce=R[S].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(li(ce))?isNaN(hc(ce).getDate())||(ce=Vt(ce)):(ce=li(ce),V!==null&&mc(V)&&(ce=id(ce))),typeof _t<"u"&&typeof ce=="string"&&(m||{}).type!="string"&&(m||{}).codepage&&(ce=_t.utils.decode(m.codepage,ce)),ke=!0;break;case"E":de=!0;var j=cc(R[S].slice(1),{r:p,c:_});b[p][_]=[b[p][_],j];break;case"S":Ne=!0,b[p][_]=[b[p][_],"S5S"];break;case"G":break;case"R":Ae=parseInt(R[S].slice(1))-1;break;case"C":ie=parseInt(R[S].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}if(ke&&(b[p][_]&&b[p][_].length==2?b[p][_][0]=ce:b[p][_]=ce,V=null),Ne){if(de)throw new Error("SYLK shared formula cannot have own formula");var G=Ae>-1&&b[Ae][ie];if(!G||!G[1])throw new Error("SYLK shared formula cannot find base");b[p][_][1]=Cb(G[1],{r:p-Ae,c:_-ie})}break;case"F":var H=0;for(S=1;S<R.length;++S)switch(R[S].charAt(0)){case"X":_=parseInt(R[S].slice(1))-1,++H;break;case"Y":for(p=parseInt(R[S].slice(1))-1,D=b.length;D<=p;++D)b[D]=[];break;case"M":C=parseInt(R[S].slice(1))/20;break;case"F":break;case"G":break;case"P":V=O[parseInt(R[S].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(E=R[S].slice(1).split(" "),D=parseInt(E[0],10);D<=parseInt(E[1],10);++D)C=parseInt(E[2],10),w[D-1]=C===0?{hidden:!0}:{wch:C},zs(w[D-1]);break;case"C":_=parseInt(R[S].slice(1))-1,w[_]||(w[_]={});break;case"R":p=parseInt(R[S].slice(1))-1,x[p]||(x[p]={}),C>0?(x[p].hpt=C,x[p].hpx=dc(C)):C===0&&(x[p].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}H<1&&(V=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+A)}}return x.length>0&&(B["!rows"]=x),w.length>0&&(B["!cols"]=w),m&&m.sheetRows&&(b=b.slice(0,m.sheetRows)),[b,B]}function a(d,m){var v=i(d,m),p=v[0],_=v[1],T=_c(p,m);return Yt(_).forEach(function(S){T[S]=_[S]}),T}function o(d,m){return Xs(a(d,m),m)}function c(d,m,v,p){var _="C;Y"+(v+1)+";X"+(p+1)+";K";switch(d.t){case"n":_+=d.v||0,d.f&&!d.F&&(_+=";E"+Eg(d.f,{r:v,c:p}));break;case"b":_+=d.v?"TRUE":"FALSE";break;case"e":_+=d.w||d.v;break;case"d":_+='"'+(d.w||d.v)+'"';break;case"s":_+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function l(d,m){m.forEach(function(v,p){var _="F;W"+(p+1)+" "+(p+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=xu(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=wu(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&d.push(_)})}function h(d,m){m.forEach(function(v,p){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*Eu(v.hpx)+";"),_.length>2&&d.push(_+"R"+(p+1))})}function f(d,m){var v=["ID;PWXL;N;E"],p=[],_=ut(d["!ref"]),T,S=Array.isArray(d),b=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),d["!cols"]&&l(v,d["!cols"]),d["!rows"]&&h(v,d["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var O=_.s.r;O<=_.e.r;++O)for(var V=_.s.c;V<=_.e.c;++V){var B=Ue({r:O,c:V});T=S?(d[O]||[])[V]:d[B],!(!T||T.v==null&&(!T.f||T.F))&&p.push(c(T,d,O,V,m))}return v.join(b)+b+p.join(b)+b+"E"+b}return{to_workbook:o,to_sheet:a,from_sheet:f}}(),hb=function(){function t(s,a){switch(a.type){case"base64":return e(An(s),a);case"binary":return e(s,a);case"buffer":return e(Ze&&Buffer.isBuffer(s)?s.toString("binary"):Ks(s),a);case"array":return e(Ha(s),a)}throw new Error("Unrecognized type "+a.type)}function e(s,a){for(var o=s.split(`
`),c=-1,l=-1,h=0,f=[];h!==o.length;++h){if(o[h].trim()==="BOT"){f[++c]=[],l=0;continue}if(!(c<0)){var d=o[h].trim().split(","),m=d[0],v=d[1];++h;for(var p=o[h]||"";(p.match(/["]/g)||[]).length&1&&h<o.length-1;)p+=`
`+o[++h];switch(p=p.trim(),+m){case-1:if(p==="BOT"){f[++c]=[],l=0;continue}else if(p!=="EOD")throw new Error("Unrecognized DIF special command "+p);break;case 0:p==="TRUE"?f[c][l]=!0:p==="FALSE"?f[c][l]=!1:isNaN(li(v))?isNaN(hc(v).getDate())?f[c][l]=v:f[c][l]=Vt(v):f[c][l]=li(v),++l;break;case 1:p=p.slice(1,p.length-1),p=p.replace(/""/g,'"'),Zl&&p&&p.match(/^=".*"$/)&&(p=p.slice(2,-1)),f[c][l++]=p!==""?p:null;break}if(p==="EOD")break}}return a&&a.sheetRows&&(f=f.slice(0,a.sheetRows)),f}function r(s,a){return _c(t(s,a),a)}function n(s,a){return Xs(r(s,a),a)}var i=function(){var s=function(c,l,h,f,d){c.push(l),c.push(h+","+f),c.push('"'+d.replace(/"/g,'""')+'"')},a=function(c,l,h,f){c.push(l+","+h),c.push(l==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var l=[],h=ut(c["!ref"]),f,d=Array.isArray(c);s(l,"TABLE",0,1,"sheetjs"),s(l,"VECTORS",0,h.e.r-h.s.r+1,""),s(l,"TUPLES",0,h.e.c-h.s.c+1,""),s(l,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){a(l,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var p=Ue({r:m,c:v});if(f=d?(c[m]||[])[v]:c[p],!f){a(l,1,0,"");continue}switch(f.t){case"n":var _=Zl?f.w:f.v;!_&&f.v!=null&&(_=f.v),_==null?Zl&&f.f&&!f.F?a(l,1,0,"="+f.f):a(l,1,0,""):a(l,0,_,"V");break;case"b":a(l,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":a(l,1,0,!Zl||isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=Kn(f.z||Le[14],dr(Vt(f.v)))),Zl?a(l,0,f.w,"V"):a(l,1,0,f.w);break;default:a(l,1,0,"")}}}a(l,-1,0,"EOD");var T=`\r
`,S=l.join(T);return S}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),fb=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(f,d){for(var m=f.split(`
`),v=-1,p=-1,_=0,T=[];_!==m.length;++_){var S=m[_].trim().split(":");if(S[0]==="cell"){var b=Ht(S[1]);if(T.length<=b.r)for(v=T.length;v<=b.r;++v)T[v]||(T[v]=[]);switch(v=b.r,p=b.c,S[2]){case"t":T[v][p]=t(S[3]);break;case"v":T[v][p]=+S[3];break;case"vtf":var O=S[S.length-1];case"vtc":switch(S[3]){case"nl":T[v][p]=!!+S[4];break;default:T[v][p]=+S[4];break}S[2]=="vtf"&&(T[v][p]=[T[v][p],O])}}}return d&&d.sheetRows&&(T=T.slice(0,d.sheetRows)),T}function n(f,d){return _c(r(f,d),d)}function i(f,d){return Xs(n(f,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function l(f){if(!f||!f["!ref"])return"";for(var d=[],m=[],v,p="",_=hn(f["!ref"]),T=Array.isArray(f),S=_.s.r;S<=_.e.r;++S)for(var b=_.s.c;b<=_.e.c;++b)if(p=Ue({r:S,c:b}),v=T?(f[S]||[])[b]:f[p],!(!v||v.v==null||v.t==="z")){switch(m=["cell",p,"t"],v.t){case"s":case"str":m.push(e(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=e(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=e(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var O=dr(Vt(v.v));m[2]="vtc",m[3]="nd",m[4]=""+O,m[5]=v.w||Kn(v.z||Le[14],O);break;case"e":continue}d.push(m.join(":"))}return d.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function h(f){return[s,a,o,a,l(f),c].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:h}}(),fc=function(){function t(h,f,d,m,v){v.raw?f[d][m]=h:h===""||(h==="TRUE"?f[d][m]=!0:h==="FALSE"?f[d][m]=!1:isNaN(li(h))?isNaN(hc(h).getDate())?f[d][m]=h:f[d][m]=Vt(h):f[d][m]=li(h))}function e(h,f){var d=f||{},m=[];if(!h||h.length===0)return m;for(var v=h.split(/[\r\n]/),p=v.length-1;p>=0&&v[p].length===0;)--p;for(var _=10,T=0,S=0;S<=p;++S)T=v[S].indexOf(" "),T==-1?T=v[S].length:T++,_=Math.max(_,T);for(S=0;S<=p;++S){m[S]=[];var b=0;for(t(v[S].slice(0,_).trim(),m,S,b,d),b=1;b<=(v[S].length-_)/10+1;++b)t(v[S].slice(_+(b-1)*10,_+b*10).trim(),m,S,b,d)}return d.sheetRows&&(m=m.slice(0,d.sheetRows)),m}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(h){for(var f={},d=!1,m=0,v=0;m<h.length;++m)(v=h.charCodeAt(m))==34?d=!d:!d&&v in r&&(f[v]=(f[v]||0)+1);v=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m]);if(!v.length){f=n;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&v.push([f[m],m])}return v.sort(function(p,_){return p[0]-_[0]||n[p[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(h,f){var d=f||{},m="";Xt!=null&&d.dense==null&&(d.dense=Xt);var v=d.dense?[]:{},p={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=i(h.slice(0,1024)):d&&d.FS?m=d.FS:m=i(h.slice(0,1024));var _=0,T=0,S=0,b=0,O=0,V=m.charCodeAt(0),B=!1,x=0,w=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var E=d.dateNF!=null?JR(d.dateNF):null;function C(){var D=h.slice(b,O),A={};if(D.charAt(0)=='"'&&D.charAt(D.length-1)=='"'&&(D=D.slice(1,-1).replace(/""/g,'"')),D.length===0)A.t="z";else if(d.raw)A.t="s",A.v=D;else if(D.trim().length===0)A.t="s",A.v=D;else if(D.charCodeAt(0)==61)D.charCodeAt(1)==34&&D.charCodeAt(D.length-1)==34?(A.t="s",A.v=D.slice(2,-1).replace(/""/g,'"')):S4(D)?(A.t="n",A.f=D.slice(1)):(A.t="s",A.v=D);else if(D=="TRUE")A.t="b",A.v=!0;else if(D=="FALSE")A.t="b",A.v=!1;else if(!isNaN(S=li(D)))A.t="n",d.cellText!==!1&&(A.w=D),A.v=S;else if(!isNaN(hc(D).getDate())||E&&D.match(E)){A.z=d.dateNF||Le[14];var R=0;E&&D.match(E)&&(D=ZR(D,d.dateNF,D.match(E)||[]),R=1),d.cellDates?(A.t="d",A.v=Vt(D,R)):(A.t="n",A.v=dr(Vt(D,R))),d.cellText!==!1&&(A.w=Kn(A.z,A.v instanceof Date?dr(A.v):A.v)),d.cellNF||delete A.z}else A.t="s",A.v=D;if(A.t=="z"||(d.dense?(v[_]||(v[_]=[]),v[_][T]=A):v[Ue({c:T,r:_})]=A),b=O+1,w=h.charCodeAt(b),p.e.c<T&&(p.e.c=T),p.e.r<_&&(p.e.r=_),x==V)++T;else if(T=0,++_,d.sheetRows&&d.sheetRows<=_)return!0}e:for(;O<h.length;++O)switch(x=h.charCodeAt(O)){case 34:w===34&&(B=!B);break;case V:case 10:case 13:if(!B&&C())break e;break;default:break}return O-b>0&&C(),v["!ref"]=Ge(p),v}function a(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?s(h,f):_c(e(h,f),f)}function o(h,f){var d="",m=f.type=="string"?[0,0,0,0]:Dg(h,f);switch(f.type){case"base64":d=An(h);break;case"binary":d=h;break;case"buffer":f.codepage==65001?d=h.toString("utf8"):f.codepage&&typeof _t<"u"?d=_t.utils.decode(f.codepage,h):d=Ze&&Buffer.isBuffer(h)?h.toString("binary"):Ks(h);break;case"array":d=Ha(h);break;case"string":d=h;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?d=At(d.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?d=At(d):f.type=="binary"&&typeof _t<"u"&&f.codepage&&(d=_t.utils.decode(f.codepage,_t.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?fb.to_sheet(f.type=="string"?d:At(d),f):a(d,f)}function c(h,f){return Xs(o(h,f),f)}function l(h){for(var f=[],d=ut(h["!ref"]),m,v=Array.isArray(h),p=d.s.r;p<=d.e.r;++p){for(var _=[],T=d.s.c;T<=d.e.c;++T){var S=Ue({r:p,c:T});if(m=v?(h[p]||[])[T]:h[S],!m||m.v==null){_.push("          ");continue}for(var b=(m.w||(ns(m),m.w)||"").slice(0,10);b.length<10;)b+=" ";_.push(b+(T===0?" ":""))}f.push(_.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:l}}();function dN(t,e){var r=e||{},n=!!r.WTF;r.WTF=!0;try{var i=ub.to_workbook(t,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return fc.to_workbook(t,e)}}var ja=function(){function t(j,G,H){if(j){Mr(j,j.l||0);for(var W=H.Enum||Ae;j.l<j.length;){var ne=j.read_shift(2),me=W[ne]||W[65535],ue=j.read_shift(2),fe=j.l+ue,se=me.f&&me.f(j,ue,H);if(j.l=fe,G(se,me,ne))return}}}function e(j,G){switch(G.type){case"base64":return r(bn(An(j)),G);case"binary":return r(bn(j),G);case"buffer":case"array":return r(j,G)}throw"Unsupported type "+G.type}function r(j,G){if(!j)return j;var H=G||{};Xt!=null&&H.dense==null&&(H.dense=Xt);var W=H.dense?[]:{},ne="Sheet1",me="",ue=0,fe={},se=[],We=[],U={s:{r:0,c:0},e:{r:0,c:0}},at=H.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)H.Enum=Ae,t(j,function(be,jt,tn){switch(tn){case 0:H.vers=be,be>=4096&&(H.qpro=!0);break;case 6:U=be;break;case 204:be&&(me=be);break;case 222:me=be;break;case 15:case 51:H.qpro||(be[1].v=be[1].v.slice(1));case 13:case 14:case 16:tn==14&&(be[2]&112)==112&&(be[2]&15)>1&&(be[2]&15)<15&&(be[1].z=H.dateNF||Le[14],H.cellDates&&(be[1].t="d",be[1].v=id(be[1].v))),H.qpro&&be[3]>ue&&(W["!ref"]=Ge(U),fe[ne]=W,se.push(ne),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ue=be[3],ne=me||"Sheet"+(ue+1),me="");var fn=H.dense?(W[be[0].r]||[])[be[0].c]:W[Ue(be[0])];if(fn){fn.t=be[1].t,fn.v=be[1].v,be[1].z!=null&&(fn.z=be[1].z),be[1].f!=null&&(fn.f=be[1].f);break}H.dense?(W[be[0].r]||(W[be[0].r]=[]),W[be[0].r][be[0].c]=be[1]):W[Ue(be[0])]=be[1];break;default:}},H);else if(j[2]==26||j[2]==14)H.Enum=ie,j[2]==14&&(H.qpro=!0,j.l=0),t(j,function(be,jt,tn){switch(tn){case 204:ne=be;break;case 22:be[1].v=be[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(be[3]>ue&&(W["!ref"]=Ge(U),fe[ne]=W,se.push(ne),W=H.dense?[]:{},U={s:{r:0,c:0},e:{r:0,c:0}},ue=be[3],ne="Sheet"+(ue+1)),at>0&&be[0].r>=at)break;H.dense?(W[be[0].r]||(W[be[0].r]=[]),W[be[0].r][be[0].c]=be[1]):W[Ue(be[0])]=be[1],U.e.c<be[0].c&&(U.e.c=be[0].c),U.e.r<be[0].r&&(U.e.r=be[0].r);break;case 27:be[14e3]&&(We[be[14e3][0]]=be[14e3][1]);break;case 1537:We[be[0]]=be[1],be[0]==ue&&(ne=be[1]);break;default:break}},H);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(W["!ref"]=Ge(U),fe[me||ne]=W,se.push(me||ne),!We.length)return{SheetNames:se,Sheets:fe};for(var qe={},ot=[],Je=0;Je<We.length;++Je)fe[se[Je]]?(ot.push(We[Je]||se[Je]),qe[We[Je]]=fe[We[Je]]||fe[se[Je]]):(ot.push(We[Je]),qe[We[Je]]={"!ref":"A1"});return{SheetNames:ot,Sheets:qe}}function n(j,G){var H=G||{};if(+H.codepage>=0&&oi(+H.codepage),H.type=="string")throw new Error("Cannot write WK1 to JS string");var W=un(),ne=ut(j["!ref"]),me=Array.isArray(j),ue=[];ye(W,0,s(1030)),ye(W,6,c(ne));for(var fe=Math.min(ne.e.r,8191),se=ne.s.r;se<=fe;++se)for(var We=tr(se),U=ne.s.c;U<=ne.e.c;++U){se===ne.s.r&&(ue[U]=$t(U));var at=ue[U]+We,qe=me?(j[se]||[])[U]:j[at];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?ye(W,13,m(se,U,qe.v)):ye(W,14,p(se,U,qe.v));else{var ot=ns(qe);ye(W,15,f(se,U,ot.slice(0,239)))}}return ye(W,1),W.end()}function i(j,G){var H=G||{};if(+H.codepage>=0&&oi(+H.codepage),H.type=="string")throw new Error("Cannot write WK3 to JS string");var W=un();ye(W,0,a(j));for(var ne=0,me=0;ne<j.SheetNames.length;++ne)(j.Sheets[j.SheetNames[ne]]||{})["!ref"]&&ye(W,27,de(j.SheetNames[ne],me++));var ue=0;for(ne=0;ne<j.SheetNames.length;++ne){var fe=j.Sheets[j.SheetNames[ne]];if(!(!fe||!fe["!ref"])){for(var se=ut(fe["!ref"]),We=Array.isArray(fe),U=[],at=Math.min(se.e.r,8191),qe=se.s.r;qe<=at;++qe)for(var ot=tr(qe),Je=se.s.c;Je<=se.e.c;++Je){qe===se.s.r&&(U[Je]=$t(Je));var be=U[Je]+ot,jt=We?(fe[qe]||[])[Je]:fe[be];if(!(!jt||jt.t=="z"))if(jt.t=="n")ye(W,23,C(qe,Je,ue,jt.v));else{var tn=ns(jt);ye(W,22,x(qe,Je,ue,tn.slice(0,239)))}}++ue}}return ye(W,1),W.end()}function s(j){var G=re(2);return G.write_shift(2,j),G}function a(j){var G=re(26);G.write_shift(2,4096),G.write_shift(2,4),G.write_shift(4,0);for(var H=0,W=0,ne=0,me=0;me<j.SheetNames.length;++me){var ue=j.SheetNames[me],fe=j.Sheets[ue];if(!(!fe||!fe["!ref"])){++ne;var se=hn(fe["!ref"]);H<se.e.r&&(H=se.e.r),W<se.e.c&&(W=se.e.c)}}return H>8191&&(H=8191),G.write_shift(2,H),G.write_shift(1,ne),G.write_shift(1,W),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(1,1),G.write_shift(1,2),G.write_shift(4,0),G.write_shift(4,0),G}function o(j,G,H){var W={s:{c:0,r:0},e:{c:0,r:0}};return G==8&&H.qpro?(W.s.c=j.read_shift(1),j.l++,W.s.r=j.read_shift(2),W.e.c=j.read_shift(1),j.l++,W.e.r=j.read_shift(2),W):(W.s.c=j.read_shift(2),W.s.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.e.c=j.read_shift(2),W.e.r=j.read_shift(2),G==12&&H.qpro&&(j.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(j){var G=re(8);return G.write_shift(2,j.s.c),G.write_shift(2,j.s.r),G.write_shift(2,j.e.c),G.write_shift(2,j.e.r),G}function l(j,G,H){var W=[{c:0,r:0},{t:"n",v:0},0,0];return H.qpro&&H.vers!=20768?(W[0].c=j.read_shift(1),W[3]=j.read_shift(1),W[0].r=j.read_shift(2),j.l+=2):(W[2]=j.read_shift(1),W[0].c=j.read_shift(2),W[0].r=j.read_shift(2)),W}function h(j,G,H){var W=j.l+G,ne=l(j,G,H);if(ne[1].t="s",H.vers==20768){j.l++;var me=j.read_shift(1);return ne[1].v=j.read_shift(me,"utf8"),ne}return H.qpro&&j.l++,ne[1].v=j.read_shift(W-j.l,"cstr"),ne}function f(j,G,H){var W=re(7+H.length);W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(1,39);for(var ne=0;ne<W.length;++ne){var me=H.charCodeAt(ne);W.write_shift(1,me>=128?95:me)}return W.write_shift(1,0),W}function d(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(2,"i"),W}function m(j,G,H){var W=re(7);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(2,H,"i"),W}function v(j,G,H){var W=l(j,G,H);return W[1].v=j.read_shift(8,"f"),W}function p(j,G,H){var W=re(13);return W.write_shift(1,255),W.write_shift(2,G),W.write_shift(2,j),W.write_shift(8,H,"f"),W}function _(j,G,H){var W=j.l+G,ne=l(j,G,H);if(ne[1].v=j.read_shift(8,"f"),H.qpro)j.l=W;else{var me=j.read_shift(2);O(j.slice(j.l,j.l+me),ne),j.l+=me}return ne}function T(j,G,H){var W=G&32768;return G&=-32769,G=(W?j:0)+(G>=8192?G-16384:G),(W?"":"$")+(H?$t(G):tr(G))}var S={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},b=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function O(j,G){Mr(j,0);for(var H=[],W=0,ne="",me="",ue="",fe="";j.l<j.length;){var se=j[j.l++];switch(se){case 0:H.push(j.read_shift(8,"f"));break;case 1:me=T(G[0].c,j.read_shift(2),!0),ne=T(G[0].r,j.read_shift(2),!1),H.push(me+ne);break;case 2:{var We=T(G[0].c,j.read_shift(2),!0),U=T(G[0].r,j.read_shift(2),!1);me=T(G[0].c,j.read_shift(2),!0),ne=T(G[0].r,j.read_shift(2),!1),H.push(We+U+":"+me+ne)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:H.push("("+H.pop()+")");break;case 5:H.push(j.read_shift(2));break;case 6:{for(var at="";se=j[j.l++];)at+=String.fromCharCode(se);H.push('"'+at.replace(/"/g,'""')+'"')}break;case 8:H.push("-"+H.pop());break;case 23:H.push("+"+H.pop());break;case 22:H.push("NOT("+H.pop()+")");break;case 20:case 21:fe=H.pop(),ue=H.pop(),H.push(["AND","OR"][se-20]+"("+ue+","+fe+")");break;default:if(se<32&&b[se])fe=H.pop(),ue=H.pop(),H.push(ue+b[se]+fe);else if(S[se]){if(W=S[se][1],W==69&&(W=j[j.l++]),W>H.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+H.join("|")+"|");return}var qe=H.slice(-W);H.length-=W,H.push(S[se][0]+"("+qe.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}H.length==1?G[1].f=""+H[0]:console.error("WK1 bad formula parse |"+H.join("|")+"|")}function V(j){var G=[{c:0,r:0},{t:"n",v:0},0];return G[0].r=j.read_shift(2),G[3]=j[j.l++],G[0].c=j[j.l++],G}function B(j,G){var H=V(j,G);return H[1].t="s",H[1].v=j.read_shift(G-4,"cstr"),H}function x(j,G,H,W){var ne=re(6+W.length);ne.write_shift(2,j),ne.write_shift(1,H),ne.write_shift(1,G),ne.write_shift(1,39);for(var me=0;me<W.length;++me){var ue=W.charCodeAt(me);ne.write_shift(1,ue>=128?95:ue)}return ne.write_shift(1,0),ne}function w(j,G){var H=V(j,G);H[1].v=j.read_shift(2);var W=H[1].v>>1;if(H[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return H[1].v=W,H}function E(j,G){var H=V(j,G),W=j.read_shift(4),ne=j.read_shift(4),me=j.read_shift(2);if(me==65535)return W===0&&ne===3221225472?(H[1].t="e",H[1].v=15):W===0&&ne===3489660928?(H[1].t="e",H[1].v=42):H[1].v=0,H;var ue=me&32768;return me=(me&32767)-16446,H[1].v=(1-ue*2)*(ne*Math.pow(2,me+32)+W*Math.pow(2,me)),H}function C(j,G,H,W){var ne=re(14);if(ne.write_shift(2,j),ne.write_shift(1,H),ne.write_shift(1,G),W==0)return ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(2,65535),ne;var me=0,ue=0,fe=0,se=0;return W<0&&(me=1,W=-W),ue=Math.log2(W)|0,W/=Math.pow(2,ue-31),se=W>>>0,se&2147483648||(W/=2,++ue,se=W>>>0),W-=se,se|=2147483648,se>>>=0,W*=Math.pow(2,32),fe=W>>>0,ne.write_shift(4,fe),ne.write_shift(4,se),ue+=16383+(me?32768:0),ne.write_shift(2,ue),ne}function D(j,G){var H=E(j,14);return j.l+=G-14,H}function A(j,G){var H=V(j,G),W=j.read_shift(4);return H[1].v=W>>6,H}function R(j,G){var H=V(j,G),W=j.read_shift(8,"f");return H[1].v=W,H}function oe(j,G){var H=R(j,14);return j.l+=G-10,H}function ce(j,G){return j[j.l+G-1]==0?j.read_shift(G,"cstr"):""}function ke(j,G){var H=j[j.l++];H>G-1&&(H=G-1);for(var W="";W.length<H;)W+=String.fromCharCode(j[j.l++]);return W}function we(j,G,H){if(!(!H.qpro||G<21)){var W=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var ne=j.read_shift(G-21,"cstr");return[W,ne]}}function Ne(j,G){for(var H={},W=j.l+G;j.l<W;){var ne=j.read_shift(2);if(ne==14e3){for(H[ne]=[0,""],H[ne][0]=j.read_shift(2);j[j.l];)H[ne][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return H}function de(j,G){var H=re(5+j.length);H.write_shift(2,14e3),H.write_shift(2,G);for(var W=0;W<j.length;++W){var ne=j.charCodeAt(W);H[H.l++]=ne>127?95:ne}return H[H.l++]=0,H}var Ae={0:{n:"BOF",f:or},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:ke},65535:{n:""}},ie={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:E},24:{n:"NUMBER18",f:w},25:{n:"FORMULA19",f:D},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:A},38:{n:"??"},39:{n:"NUMBER27",f:R},40:{n:"FORMULA28",f:oe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}();function pN(t){var e={},r=t.match(Xr),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=je(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":e.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;e.cp=$m[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":e.outline=1;break;case"</outline>":break;case"<rFont":e.name=s.val;break;case"<sz":e.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":e.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":e.uval="double";break;case"singleAccounting":e.uval="single-accounting";break;case"doubleAccounting":e.uval="double-accounting";break}case"<u>":case"<u/>":e.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":e.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":e.i=1;break;case"</i>":break;case"<color":s.rgb&&(e.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":e.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":e.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return e}var mN=function(){var t=mu("t"),e=mu("rPr");function r(s){var a=s.match(t);if(!a)return{t:"s",v:""};var o={t:"s",v:lt(a[1])},c=s.match(e);return c&&(o.s=pN(c[1])),o}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(n,"").split(i).map(r).filter(function(o){return o.v})}}(),gN=function(){var e=/(\r\n|\n)/g;function r(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(s.push("<"+c+">"),a.push("</"+c+">")),a.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(e,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),vN=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_N=/<(?:\w+:)?r>/,yN=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function vg(t,e){var r=e?e.cellHTML:!0,n={};return t?(t.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=lt(At(t.slice(t.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=At(t),r&&(n.h=Zm(n.t))):t.match(_N)&&(n.r=At(t),n.t=lt(At((t.replace(yN,"").match(vN)||[]).join("").replace(Xr,""))),r&&(n.h=gN(mN(n.r)))),n):{t:""}}var xN=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,wN=/<(?:\w+:)?(?:si|sstItem)>/g,EN=/<\/(?:\w+:)?(?:si|sstItem)>/;function TN(t,e){var r=[],n="";if(!t)return r;var i=t.match(xN);if(i){n=i[2].replace(wN,"").split(EN);for(var s=0;s!=n.length;++s){var a=vg(n[s].trim(),e);a!=null&&(r[r.length]=a)}i=je(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var bN=/^\s|\s$|[\t\n\r]/;function db(t,e){if(!e.bookSST)return"";var r=[rr];r[r.length]=_e("sst",null,{xmlns:Xa[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(bN)&&(s+=' xml:space="preserve"'),s+=">"+Tt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function IN(t){return[t.read_shift(4),t.read_shift(4)]}function AN(t,e){var r=[],n=!1;return ss(t,function(s,a,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||e.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function SN(t,e){return e||(e=re(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var CN=VF;function kN(t){var e=un();ae(e,159,SN(t));for(var r=0;r<t.length;++r)ae(e,19,CN(t[r]));return ae(e,160),e.end()}function pb(t){if(typeof _t<"u")return _t.utils.encode(uc,t);for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function rs(t,e){var r={};return r.Major=t.read_shift(2),r.Minor=t.read_shift(2),e>=4&&(t.l+=e-4),r}function DN(t){var e={};return e.id=t.read_shift(0,"lpp4"),e.R=rs(t,4),e.U=rs(t,4),e.W=rs(t,4),e}function RN(t){for(var e=t.read_shift(4),r=t.l+e-4,n={},i=t.read_shift(4),s=[];i-- >0;)s.push({t:t.read_shift(4),v:t.read_shift(0,"lpp4")});if(n.name=t.read_shift(0,"lpp4"),n.comps=s,t.l!=r)throw new Error("Bad DataSpaceMapEntry: "+t.l+" != "+r);return n}function FN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(RN(t));return e}function PN(t){var e=[];t.l+=4;for(var r=t.read_shift(4);r-- >0;)e.push(t.read_shift(0,"lpp4"));return e}function ON(t){var e={};return t.read_shift(4),t.l+=4,e.id=t.read_shift(0,"lpp4"),e.name=t.read_shift(0,"lpp4"),e.R=rs(t,4),e.U=rs(t,4),e.W=rs(t,4),e}function NN(t){var e=ON(t);if(e.ename=t.read_shift(0,"8lpp4"),e.blksz=t.read_shift(4),e.cmode=t.read_shift(4),t.read_shift(4)!=4)throw new Error("Bad !Primary record");return e}function mb(t,e){var r=t.l+e,n={};n.Flags=t.read_shift(4)&63,t.l+=4,n.AlgID=t.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=t.read_shift(4),n.KeySize=t.read_shift(4),n.ProviderType=t.read_shift(4),t.l+=8,n.CSPName=t.read_shift(r-t.l>>1,"utf16le"),t.l=r,n}function gb(t,e){var r={},n=t.l+e;return t.l+=4,r.Salt=t.slice(t.l,t.l+16),t.l+=16,r.Verifier=t.slice(t.l,t.l+16),t.l+=16,t.read_shift(4),r.VerifierHash=t.slice(t.l,n),t.l=n,r}function MN(t){var e=rs(t);switch(e.Minor){case 2:return[e.Minor,LN(t,e)];case 3:return[e.Minor,VN(t,e)];case 4:return[e.Minor,BN(t,e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+e.Minor)}function LN(t){var e=t.read_shift(4);if((e&63)!=36)throw new Error("EncryptionInfo mismatch");var r=t.read_shift(4),n=mb(t,r),i=gb(t,t.length-t.l);return{t:"Std",h:n,v:i}}function VN(){throw new Error("File is password-protected: ECMA-376 Extensible")}function BN(t){var e=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];t.l+=4;var r=t.read_shift(t.length-t.l,"utf8"),n={};return r.replace(Xr,function(s){var a=je(s);switch(Ri(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":e.forEach(function(o){n[o]=a[o]});break;case"<dataIntegrity":n.encryptedHmacKey=a.encryptedHmacKey,n.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(a);break;default:throw a[0]}}),n}function UN(t,e){var r={},n=r.EncryptionVersionInfo=rs(t,4);if(e-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=t.read_shift(4),e-=4;var i=t.read_shift(4);return e-=4,r.EncryptionHeader=mb(t,i),e-=i,r.EncryptionVerifier=gb(t,e),r}function jN(t){var e={},r=e.EncryptionVersionInfo=rs(t,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return e.Salt=t.read_shift(16),e.EncryptedVerifier=t.read_shift(16),e.EncryptedVerifierHash=t.read_shift(16),e}function _g(t){var e=0,r,n=pb(t),i=n.length+1,s,a,o,c,l;for(r=Hs(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)a=r[s],o=e&16384?1:0,c=e<<1&32767,l=o|c,e=l^a;return e^52811}var vb=function(){var t=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],e=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(a){return(a/2|a*128)&255},i=function(a,o){return n(a^o)},s=function(a){for(var o=e[a.length-1],c=104,l=a.length-1;l>=0;--l)for(var h=a[l],f=0;f!=7;++f)h&64&&(o^=r[c]),h*=2,--c;return o};return function(a){for(var o=pb(a),c=s(o),l=o.length,h=Hs(16),f=0;f!=16;++f)h[f]=0;var d,m,v;for((l&1)===1&&(d=c>>8,h[l]=i(t[0],d),--l,d=c&255,m=o[o.length-1],h[l]=i(m,d));l>0;)--l,d=c>>8,h[l]=i(o[l],d),--l,d=c&255,h[l]=i(o[l],d);for(l=15,v=15-o.length;v>0;)d=c>>8,h[l]=i(t[v],d),--l,--v,d=c&255,h[l]=i(o[l],d),--l,--v;return h}}(),WN=function(t,e,r,n,i){i||(i=e),n||(n=vb(t));var s,a;for(s=0;s!=e.length;++s)a=e[s],a^=n[r],a=(a>>5|a<<3)&255,i[s]=a,++r;return[i,r,n]},$N=function(t){var e=0,r=vb(t);return function(n){var i=WN("",n,e,r);return e=i[1],i[0]}};function HN(t,e,r,n){var i={key:or(t),verificationBytes:or(t)};return r.password&&(i.verifier=_g(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=$N(r.password)),i}function zN(t,e,r){var n=r||{};return n.Info=t.read_shift(2),t.l-=2,n.Info===1?n.Data=jN(t,e):n.Data=UN(t,e),n}function GN(t,e,r){var n={Type:r.biff>=8?t.read_shift(2):0};return n.Type?zN(t,e-2,n):HN(t,r.biff>=8?e:e-2,r,n),n}var _b=function(){function t(i,s){switch(s.type){case"base64":return e(An(i),s);case"binary":return e(i,s);case"buffer":return e(Ze&&Buffer.isBuffer(i)?i.toString("binary"):Ks(i),s);case"array":return e(Ha(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var a=s||{},o=a.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var l={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(o)&&(o[f]=[]);for(var d=/\\\w+\b/g,m=0,v,p=-1;v=d.exec(h);){switch(v[0]){case"\\cell":var _=h.slice(m,d.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++p,_.length){var T={v:_,t:"s"};Array.isArray(o)?o[f][p]=T:o[Ue({r:f,c:p})]=T}break}m=d.lastIndex}p>l.e.c&&(l.e.c=p)}),o["!ref"]=Ge(l),o}function r(i,s){return Xs(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],a=ut(i["!ref"]),o,c=Array.isArray(i),l=a.s.r;l<=a.e.r;++l){s.push("\\trowd\\trautofit1");for(var h=a.s.c;h<=a.e.c;++h)s.push("\\cellx"+(h+1));for(s.push("\\pard\\intbl"),h=a.s.c;h<=a.e.c;++h){var f=Ue({r:l,c:h});o=c?(i[l]||[])[h]:i[f],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ns(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function qN(t){var e=t.slice(t[0]==="#"?1:0).slice(0,6);return[parseInt(e.slice(0,2),16),parseInt(e.slice(2,4),16),parseInt(e.slice(4,6),16)]}function yu(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}function KN(t){var e=t[0]/255,r=t[1]/255,n=t[2]/255,i=Math.max(e,r,n),s=Math.min(e,r,n),a=i-s;if(a===0)return[0,0,e];var o=0,c=0,l=i+s;switch(c=a/(l>1?2-l:l),i){case e:o=((r-n)/a+6)%6;break;case r:o=(n-e)/a+2;break;case n:o=(e-r)/a+4;break}return[o/6,c,l/2]}function XN(t){var e=t[0],r=t[1],n=t[2],i=r*2*(n<.5?n:1-n),s=n-i/2,a=[s,s,s],o=6*e,c;if(r!==0)switch(o|0){case 0:case 6:c=i*o,a[0]+=i,a[1]+=c;break;case 1:c=i*(2-o),a[0]+=c,a[1]+=i;break;case 2:c=i*(o-2),a[1]+=i,a[2]+=c;break;case 3:c=i*(4-o),a[1]+=c,a[2]+=i;break;case 4:c=i*(o-4),a[2]+=i,a[0]+=c;break;case 5:c=i*(6-o),a[2]+=c,a[0]+=i;break}for(var l=0;l!=3;++l)a[l]=Math.round(a[l]*255);return a}function Qf(t,e){if(e===0)return t;var r=KN(qN(t));return e<0?r[2]=r[2]*(1+e):r[2]=1-(1-r[2])*(1-e),yu(XN(r))}var yb=6,YN=15,QN=1,Hr=yb;function xu(t){return Math.floor((t+Math.round(128/Hr)/256)*Hr)}function wu(t){return Math.floor((t-5)/Hr*100+.5)/100}function Jf(t){return Math.round((t*Hr+5)/Hr*256)/256}function Em(t){return Jf(wu(xu(t)))}function yg(t){var e=Math.abs(t-Em(t)),r=Hr;if(e>.005)for(Hr=QN;Hr<YN;++Hr)Math.abs(t-Em(t))<=e&&(e=Math.abs(t-Em(t)),r=Hr);Hr=r}function zs(t){t.width?(t.wpx=xu(t.width),t.wch=wu(t.wpx),t.MDW=Hr):t.wpx?(t.wch=wu(t.wpx),t.width=Jf(t.wch),t.MDW=Hr):typeof t.wch=="number"&&(t.width=Jf(t.wch),t.wpx=xu(t.width),t.MDW=Hr),t.customWidth&&delete t.customWidth}var JN=96,xb=JN;function Eu(t){return t*96/xb}function dc(t){return t*xb/96}var ZN={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function eM(t,e,r,n){e.Borders=[];var i={},s=!1;(t[0].match(Xr)||[]).forEach(function(a){var o=je(a);switch(Ri(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=Lt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=Lt(o.diagonalDown)),e.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function tM(t,e,r,n){e.Fills=[];var i={},s=!1;(t[0].match(Xr)||[]).forEach(function(a){var o=je(a);switch(Ri(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},e.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":e.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function rM(t,e,r,n){e.Fonts=[];var i={},s=!1;(t[0].match(Xr)||[]).forEach(function(a){var o=je(a);switch(Ri(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":e.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=At(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?Lt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?Lt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?Lt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?Lt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?Lt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?Lt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?Lt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=$m[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=Lt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var c=Ba[i.color.index];i.color.index==81&&(c=Ba[1]),c||(c=Ba[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=Qf(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function nM(t,e,r){e.NumberFmt=[];for(var n=Yt(Le),i=0;i<n.length;++i)e.NumberFmt[n[i]]=Le[n[i]];var s=t[0].match(Xr);if(s)for(i=0;i<s.length;++i){var a=je(s[i]);switch(Ri(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=lt(At(a.formatCode)),c=parseInt(a.numFmtId,10);if(e.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&e.NumberFmt[c]!=null;--c);e.NumberFmt[c]=o}ts(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function iM(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=_e("numFmt",null,{numFmtId:n,formatCode:Tt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=_e("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var Vf=["numFmtId","fillId","fontId","borderId","xfId"],Bf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function sM(t,e,r){e.CellXf=[];var n,i=!1;(t[0].match(Xr)||[]).forEach(function(s){var a=je(s),o=0;switch(Ri(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=a,delete n[0],o=0;o<Vf.length;++o)n[Vf[o]]&&(n[Vf[o]]=parseInt(n[Vf[o]],10));for(o=0;o<Bf.length;++o)n[Bf[o]]&&(n[Bf[o]]=Lt(n[Bf[o]]));if(e.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(e.NumberFmt[n.numFmtId]==e.NumberFmt[o]){n.numFmtId=o;break}}e.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};a.vertical&&(c.vertical=a.vertical),a.horizontal&&(c.horizontal=a.horizontal),a.textRotation!=null&&(c.textRotation=a.textRotation),a.indent&&(c.indent=a.indent),a.wrapText&&(c.wrapText=Lt(a.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function aM(t){var e=[];return e[e.length]=_e("cellXfs",null),t.forEach(function(r){e[e.length]=_e("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=_e("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}var oM=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,l){var h={};if(!o)return h;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var f;return(f=o.match(e))&&nM(f,h,l),(f=o.match(i))&&rM(f,h,c,l),(f=o.match(n))&&tM(f,h,c,l),(f=o.match(s))&&eM(f,h,c,l),(f=o.match(r))&&sM(f,h,l),h}}();function wb(t,e){var r=[rr,_e("styleSheet",null,{xmlns:Xa[0],"xmlns:vt":fr.vt})],n;return t.SSF&&(n=iM(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=aM(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function cM(t,e){var r=t.read_shift(2),n=qr(t,e-2);return[r,n]}function lM(t,e,r){r||(r=re(6+4*e.length)),r.write_shift(2,t),Tr(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function uM(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=zF(t,2,r);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var a=t.read_shift(1);a!=0&&(n.underline=a);var o=t.read_shift(1);o>0&&(n.family=o);var c=t.read_shift(1);switch(c>0&&(n.charset=c),t.l++,n.color=HF(t,8),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=qr(t,e-21),n}function hM(t,e){e||(e=re(25+4*32)),e.write_shift(2,t.sz*20),GF(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),Kf(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),Tr(t.name,e),e.length>e.l?e.slice(0,e.l):e}var fM=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tm,dM=Kr;function BE(t,e){e||(e=re(4*3+8*7+16*1)),Tm||(Tm=rd(fM));var r=Tm[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(Kf({auto:1},e),Kf({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function pM(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function Eb(t,e,r){r||(r=re(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function eu(t,e){return e||(e=re(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var mM=Kr;function gM(t,e){return e||(e=re(51)),e.write_shift(1,0),eu(null,e),eu(null,e),eu(null,e),eu(null,e),eu(null,e),e.length>e.l?e.slice(0,e.l):e}function vM(t,e){return e||(e=re(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),qf(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function _M(t,e,r){var n=re(2052);return n.write_shift(4,t),qf(e,n),qf(r,n),n.length>n.l?n.slice(0,n.l):n}function yM(t,e,r){var n={};n.NumberFmt=[];for(var i in Le)n.NumberFmt[i]=Le[i];n.CellXf=[],n.Fonts=[];var s=[],a=!1;return ss(t,function(c,l,h){switch(h){case 44:n.NumberFmt[c[0]]=c[1],ts(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&e&&e.themeElements&&e.themeElements.clrScheme&&(c.color.rgb=Qf(e.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(h),a=!0;break;case 38:s.pop(),a=!1;break;default:if(l.T>0)s.push(h);else if(l.T<0)s.pop();else if(!a||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),n}function xM(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(ae(t,615,ui(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ae(t,44,lM(i,e[i]))}),ae(t,616))}}function wM(t){var e=1;e!=0&&(ae(t,611,ui(e)),ae(t,43,hM({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ae(t,612))}function EM(t){var e=2;e!=0&&(ae(t,603,ui(e)),ae(t,45,BE({patternType:"none"})),ae(t,45,BE({patternType:"gray125"})),ae(t,604))}function TM(t){var e=1;e!=0&&(ae(t,613,ui(e)),ae(t,46,gM({})),ae(t,614))}function bM(t){var e=1;ae(t,626,ui(e)),ae(t,47,Eb({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ae(t,627)}function IM(t,e){ae(t,617,ui(e.length)),e.forEach(function(r){ae(t,47,Eb(r,0))}),ae(t,618)}function AM(t){var e=1;ae(t,619,ui(e)),ae(t,48,vM({xfId:0,builtinId:0,name:"Normal"})),ae(t,620)}function SM(t){var e=0;ae(t,505,ui(e)),ae(t,506)}function CM(t){var e=0;ae(t,508,_M(e,"TableStyleMedium9","PivotStyleMedium4")),ae(t,509)}function kM(t,e){var r=un();return ae(r,278),xM(r,t.SSF),wM(r,t),EM(r,t),TM(r,t),bM(r,t),IM(r,e.cellXfs),AM(r,t),SM(r,t),CM(r,t),ae(r,279),r.end()}var DM=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function RM(t,e,r){e.themeElements.clrScheme=[];var n={};(t[0].match(Xr)||[]).forEach(function(i){var s=je(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(e.themeElements.clrScheme[DM.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function FM(){}function PM(){}var OM=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,NM=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,MM=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function LM(t,e,r){e.themeElements={};var n;[["clrScheme",OM,RM],["fontScheme",NM,FM],["fmtScheme",MM,PM]].forEach(function(i){if(!(n=t.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,e,r)})}var VM=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tb(t,e){(!t||t.length===0)&&(t=xg());var r,n={};if(!(r=t.match(VM)))throw new Error("themeElements not found in theme");return LM(r[0],n,e),n.raw=t,n}function xg(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[rr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',r[r.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',r[r.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',r[r.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function BM(t,e,r){var n=t.l+e,i=t.read_shift(4);if(i!==124226){if(!r.cellStyles){t.l=n;return}var s=t.slice(t.l);t.l=n;var a;try{a=xT(s,{type:"array"})}catch{return}var o=In(a,"theme/theme/theme1.xml",!0);if(o)return Tb(o,r)}}function UM(t){return t.read_shift(4)}function jM(t){var e={};switch(e.xclrType=t.read_shift(2),e.nTintShade=t.read_shift(2),e.xclrType){case 0:t.l+=4;break;case 1:e.xclrValue=WM(t,4);break;case 2:e.xclrValue=rb(t,4);break;case 3:e.xclrValue=UM(t,4);break;case 4:t.l+=4;break}return t.l+=8,e}function WM(t,e){return Kr(t,e)}function $M(t,e){return Kr(t,e)}function HM(t){var e=t.read_shift(2),r=t.read_shift(2)-4,n=[e];switch(e){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=jM(t,r);break;case 6:n[1]=$M(t,r);break;case 14:case 15:n[1]=t.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+e+" "+r)}return n}function zM(t,e){var r=t.l+e;t.l+=2;var n=t.read_shift(2);t.l+=2;for(var i=t.read_shift(2),s=[];i-- >0;)s.push(HM(t,r-t.l));return{ixfe:n,ext:s}}function GM(t,e){e.forEach(function(r){switch(r[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function qM(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:qr(t,e-8)}}function KM(t){var e=re(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Tr(t.name,e),e.slice(0,e.l)}function XM(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function YM(t){var e=re(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function QM(t,e){var r=re(8+2*e.length);return r.write_shift(4,t),Tr(e,r),r.slice(0,r.l)}function JM(t){return t.l+=4,t.read_shift(4)!=0}function ZM(t,e){var r=re(8);return r.write_shift(4,t),r.write_shift(4,e?1:0),r}function e4(t,e,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],a=!1,o=2;return ss(t,function(c,l,h){switch(h){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(f){o==1?n.Cell.push({type:n.Types[f[0]-1].name,index:f[1]}):o==0&&n.Value.push({type:n.Types[f[0]-1].name,index:f[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:s.push(h),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!l.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),n}function t4(){var t=un();return ae(t,332),ae(t,334,ui(1)),ae(t,335,KM({name:"XLDAPR",version:12e4,flags:3496657072})),ae(t,336),ae(t,339,QM(1,"XLDAPR")),ae(t,52),ae(t,35,ui(514)),ae(t,4096,ui(0)),ae(t,4097,Gn(1)),ae(t,36),ae(t,53),ae(t,340),ae(t,337,ZM(1,!0)),ae(t,51,YM([[1,0]])),ae(t,338),ae(t,333),t.end()}function r4(t,e,r){var n={Types:[],Cell:[],Value:[]};if(!t)return n;var i=!1,s=2,a;return t.replace(Xr,function(o){var c=je(o);switch(Ri(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var l=0;l<n.Types.length;++l)n.Types[l].name==c.name&&(a=n.Types[l]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):s==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+c.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function bb(){var t=[rr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function n4(t){var e=[];if(!t)return e;var r=1;return(t.match(Xr)||[]).forEach(function(n){var i=je(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,e.push(i);break}}),e}function i4(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=Ue(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}function s4(t,e,r){var n=[],i=!1;return ss(t,function(a,o,c){switch(c){case 63:n.push(a);break;default:if(!o.T){if(!i||r.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),n}function a4(t,e,r,n){if(!t)return t;var i=n||{},s=!1,a=!1;ss(t,function(c,l,h){if(!a)switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function o4(t,e){if(!t)return"??";var r=(t.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return e["!id"][r].Target}var sc=1024;function Ib(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[_e("xml",null,{"xmlns:v":Tn.v,"xmlns:o":Tn.o,"xmlns:x":Tn.x,"xmlns:mv":Tn.mv}).replace(/\/>/,">"),_e("o:shapelayout",_e("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),_e("v:shapetype",[_e("v:stroke",null,{joinstyle:"miter"}),_e("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];sc<t*1e3;)sc+=1e3;return e.forEach(function(s){var a=Ht(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?_e("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,l=_e("v:fill",c,o),h={on:"t",obscured:"t"};++sc,i=i.concat(["<v:shape"+gu({id:"_x0000_s"+sc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",l,_e("v:shadow",null,h),_e("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Lr("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Lr("x:AutoFill","False"),Lr("x:Row",String(a.r)),Lr("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function UE(t,e,r,n){var i=Array.isArray(t),s;e.forEach(function(a){var o=Ht(a.ref);if(i?(t[o.r]||(t[o.r]=[]),s=t[o.r][o.c]):s=t[a.ref],!s){s={t:"z"},i?t[o.r][o.c]=s:t[a.ref]=s;var c=ut(t["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var l=Ge(c);l!==t["!ref"]&&(t["!ref"]=l)}s.c||(s.c=[]);var h={a:a.author,t:a.t,r:a.r,T:r};a.h&&(h.h=a.h);for(var f=s.c.length-1;f>=0;--f){if(!r&&s.c[f].T)return;r&&!s.c[f].T&&s.c.splice(f,1)}if(r&&n){for(f=0;f<n.length;++f)if(h.a==n[f].id){h.a=n[f].name||h.a;break}}s.c.push(h)})}function c4(t,e){if(t.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=t.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=t.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=je(o[0]),l={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=Ht(c.ref);if(!(e.sheetRows&&e.sheetRows<=h.r)){var f=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!f&&!!f[1]&&vg(f[1])||{r:"",t:"",h:""};l.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),l.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.cellHTML&&(l.h=d.h),n.push(l)}}}}),n}function Ab(t){var e=[rr,_e("comments",null,{xmlns:Xa[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=Tt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(i=r.indexOf(Tt(c.a))),s.push(c.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(Lr("t",Tt(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;e.push(Lr("t",Tt(a)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function l4(t,e){var r=[],n=!1,i={},s=0;return t.replace(Xr,function(o,c){var l=je(o);switch(Ri(l[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=c+o.length;break;case"</text>":i.t=t.slice(s,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return o}),r}function u4(t,e,r){var n=[rr,_e("ThreadedComments",null,{xmlns:fr.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&e.indexOf(a.a)==-1&&e.push(a.a);var c={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?s=c.id:c.parentId=s,a.ID=c.id,a.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(a.a)).slice(-12)+"}"),n.push(_e("threadedComment",Lr("text",a.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function h4(t,e){var r=[],n=!1;return t.replace(Xr,function(s){var a=je(s);switch(Ri(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&e.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),r}function f4(t){var e=[rr,_e("personList",null,{xmlns:fr.TCMNT,"xmlns:x":Xa[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(_e("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function d4(t){var e={};e.iauthor=t.read_shift(4);var r=Za(t,16);return e.rfx=r.s,e.ref=Ue(r.s),t.l+=16,e}function p4(t,e){return e==null&&(e=re(36)),e.write_shift(4,t[1].iauthor),yc(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var m4=qr;function g4(t){return Tr(t.slice(0,54))}function v4(t,e){var r=[],n=[],i={},s=!1;return ss(t,function(o,c,l){switch(l){case 632:n.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,e.sheetRows&&i.rfx&&e.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!s||e.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}}),r}function _4(t){var e=un(),r=[];return ae(e,628),ae(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),ae(e,632,g4(i.a)))})}),ae(e,631),ae(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:Ht(n[0]),e:Ht(n[0])};ae(e,635,p4([s,i])),i.t&&i.t.length>0&&ae(e,637,UF(i)),ae(e,636),delete i.iauthor})}),ae(e,634),ae(e,629),e.end()}var y4="application/vnd.ms-office.vbaProject";function x4(t){var e=Re.utils.cfb_new({root:"R"});return t.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Re.utils.cfb_add(e,i,t.FileIndex[n].content)}}),Re.write(e)}function w4(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Re.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var Sb=["xlsb","xlsm","xlam","biff8","xla"];function E4(){return{"!type":"dialog"}}function T4(){return{"!type":"dialog"}}function b4(){return{"!type":"macro"}}function I4(){return{"!type":"macro"}}var cc=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,a){var o=!1,c=!1;s.length==0?c=!0:s.charAt(0)=="["&&(c=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var l=s.length>0?parseInt(s,10)|0:0,h=a.length>0?parseInt(a,10)|0:0;return o?h+=e.c:--h,c?l+=e.r:--l,i+(o?"":"$")+$t(h)+(c?"":"$")+tr(l)}return function(i,s){return e=s,i.replace(t,r)}}(),wg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Eg=function(){return function(e,r){return e.replace(wg,function(n,i,s,a,o,c){var l=cg(a)-(s?0:r.c),h=og(c)-(o?0:r.r),f=h==0?"":o?h+1:"["+h+"]",d=l==0?"":s?l+1:"["+l+"]";return i+"R"+f+"C"+d})}}();function Cb(t,e){return t.replace(wg,function(r,n,i,s,a,o){return n+(i=="$"?i+s:$t(cg(s)+e.c))+(a=="$"?a+o:tr(og(o)+e.r))})}function A4(t,e,r){var n=hn(e),i=n.s,s=Ht(r),a={r:s.r-i.r,c:s.c-i.c};return Cb(t,a)}function S4(t){return t.length!=1}function jE(t){return t.replace(/_xlfn\./g,"")}function sr(t){t.l+=1}function Gs(t,e){var r=t.read_shift(e==1?1:2);return[r&16383,r>>14&1,r>>15&1]}function kb(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Db(t,e,r);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),a=Gs(t,2),o=Gs(t,2);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Db(t){var e=Gs(t,2),r=Gs(t,2),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function C4(t,e,r){if(r.biff<8)return Db(t,e,r);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Gs(t,2),a=Gs(t,2);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function Rb(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return k4(t,e,r);var n=t.read_shift(r&&r.biff==12?4:2),i=Gs(t,2);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function k4(t){var e=Gs(t,2),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function D4(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function R4(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return F4(t,e,r);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function F4(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function P4(t,e,r){var n=(t[t.l++]&96)>>5,i=kb(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function O4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var a=kb(t,s,r);return[n,i,a]}function N4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function M4(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function L4(t,e,r){var n=(t[t.l++]&96)>>5,i=C4(t,e-1,r);return[n,i]}function V4(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function WE(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function B4(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function U4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function j4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function W4(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function $4(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function Fb(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function H4(t){return t.read_shift(2),Fb(t,2)}function z4(t){return t.read_shift(2),Fb(t,2)}function G4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=Rb(t,0,r);return[n,i]}function q4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=R4(t,0,r);return[n,i]}function K4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=Rb(t,0,r);return[n,i,s]}function X4(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[JL[i],Nb[i],n]}function Y4(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:Q4(t);return[i,(s[0]===0?Nb:QL)[s[1]]]}function Q4(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function J4(t,e,r){t.l+=r&&r.biff==2?3:4}function Z4(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function eL(t){return t.l++,as[t.read_shift(1)]}function tL(t){return t.l++,t.read_shift(2)}function rL(t){return t.l++,t.read_shift(1)!==0}function nL(t){return t.l++,zr(t,8)}function iL(t,e,r){return t.l++,Su(t,e-1,r)}function sL(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=er(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=as[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=zr(t,8);break;case 2:r[1]=eo(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function aL(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Za:ad)(t,8));return i}function oL(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,a=[];s!=n&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=sL(t,r.biff);return a}function cL(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function lL(t,e,r){if(r.biff==5)return uL(t,e,r);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function uL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function hL(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function fL(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function dL(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function pL(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var mL=Kr,gL=Kr,vL=Kr;function ku(t,e,r){return t.l+=2,[D4(t,4,r)]}function Tg(t){return t.l+=6,[]}var _L=ku,yL=Tg,xL=Tg,wL=ku;function Pb(t){return t.l+=2,[or(t),t.read_shift(2)&1]}var EL=ku,TL=Pb,bL=Tg,IL=ku,AL=ku,SL=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function CL(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),a=SL[r>>2&31];return{ixti:e,coltype:r&3,rt:a,idx:n,c:i,C:s}}function kL(t){return t.l+=2,[t.read_shift(4)]}function DL(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function RL(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function FL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function PL(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function OL(t){return t.l+=4,[0,0]}var $E={1:{n:"PtgExp",f:Z4},2:{n:"PtgTbl",f:vL},3:{n:"PtgAdd",f:sr},4:{n:"PtgSub",f:sr},5:{n:"PtgMul",f:sr},6:{n:"PtgDiv",f:sr},7:{n:"PtgPower",f:sr},8:{n:"PtgConcat",f:sr},9:{n:"PtgLt",f:sr},10:{n:"PtgLe",f:sr},11:{n:"PtgEq",f:sr},12:{n:"PtgGe",f:sr},13:{n:"PtgGt",f:sr},14:{n:"PtgNe",f:sr},15:{n:"PtgIsect",f:sr},16:{n:"PtgUnion",f:sr},17:{n:"PtgRange",f:sr},18:{n:"PtgUplus",f:sr},19:{n:"PtgUminus",f:sr},20:{n:"PtgPercent",f:sr},21:{n:"PtgParen",f:sr},22:{n:"PtgMissArg",f:sr},23:{n:"PtgStr",f:iL},26:{n:"PtgSheet",f:DL},27:{n:"PtgEndSheet",f:RL},28:{n:"PtgErr",f:eL},29:{n:"PtgBool",f:rL},30:{n:"PtgInt",f:tL},31:{n:"PtgNum",f:nL},32:{n:"PtgArray",f:V4},33:{n:"PtgFunc",f:X4},34:{n:"PtgFuncVar",f:Y4},35:{n:"PtgName",f:cL},36:{n:"PtgRef",f:G4},37:{n:"PtgArea",f:P4},38:{n:"PtgMemArea",f:hL},39:{n:"PtgMemErr",f:mL},40:{n:"PtgMemNoMem",f:gL},41:{n:"PtgMemFunc",f:fL},42:{n:"PtgRefErr",f:dL},43:{n:"PtgAreaErr",f:N4},44:{n:"PtgRefN",f:q4},45:{n:"PtgAreaN",f:L4},46:{n:"PtgMemAreaN",f:FL},47:{n:"PtgMemNoMemN",f:PL},57:{n:"PtgNameX",f:lL},58:{n:"PtgRef3d",f:K4},59:{n:"PtgArea3d",f:O4},60:{n:"PtgRefErr3d",f:pL},61:{n:"PtgAreaErr3d",f:M4},255:{}},NL={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},ML={1:{n:"PtgElfLel",f:Pb},2:{n:"PtgElfRw",f:IL},3:{n:"PtgElfCol",f:_L},6:{n:"PtgElfRwV",f:AL},7:{n:"PtgElfColV",f:wL},10:{n:"PtgElfRadical",f:EL},11:{n:"PtgElfRadicalS",f:bL},13:{n:"PtgElfColS",f:yL},15:{n:"PtgElfColSV",f:xL},16:{n:"PtgElfRadicalLel",f:TL},25:{n:"PtgList",f:CL},29:{n:"PtgSxName",f:kL},255:{}},LL={0:{n:"PtgAttrNoop",f:OL},1:{n:"PtgAttrSemi",f:$4},2:{n:"PtgAttrIf",f:j4},4:{n:"PtgAttrChoose",f:B4},8:{n:"PtgAttrGoto",f:U4},16:{n:"PtgAttrSum",f:J4},32:{n:"PtgAttrBaxcel",f:WE},33:{n:"PtgAttrBaxcel",f:WE},64:{n:"PtgAttrSpace",f:H4},65:{n:"PtgAttrSpaceSemi",f:z4},128:{n:"PtgAttrIfError",f:W4},255:{}};function Du(t,e,r,n){if(n.biff<8)return Kr(t,e);for(var i=t.l+e,s=[],a=0;a!==r.length;++a)switch(r[a][0]){case"PtgArray":r[a][1]=oL(t,0,n),s.push(r[a][1]);break;case"PtgMemArea":r[a][2]=aL(t,r[a][1],n),s.push(r[a][2]);break;case"PtgExp":n&&n.biff==12&&(r[a][1][1]=t.read_shift(4),s.push(r[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[a][0];default:break}return e=i-t.l,e!==0&&s.push(Kr(t,e)),s}function Ru(t,e,r){for(var n=t.l+e,i,s,a=[];n!=t.l;)e=n-t.l,s=t[t.l],i=$E[s]||$E[NL[s]],(s===24||s===25)&&(i=(s===24?ML:LL)[t[t.l+1]]),!i||!i.f?Kr(t,e):a.push([i.n,i.f(t,e,r)]);return a}function VL(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var a=n[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var BL={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function UL(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Ob(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function HE(t,e,r){var n=Ob(t,e,r);return n=="#REF"?n:UL(n,r)}function $r(t,e,r,n,i){var s=i&&i.biff||8,a={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,l,h,f=0,d=0,m,v="";if(!t[0]||!t[0][0])return"";for(var p=-1,_="",T=0,S=t[0].length;T<S;++T){var b=t[0][T];switch(b[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),l=o.pop(),p>=0){switch(t[0][p][1][0]){case 0:_=qt(" ",t[0][p][1][1]);break;case 1:_=qt("\r",t[0][p][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}l=l+_,p=-1}o.push(l+BL[b[0]]+c);break;case"PtgIsect":c=o.pop(),l=o.pop(),o.push(l+" "+c);break;case"PtgUnion":c=o.pop(),l=o.pop(),o.push(l+","+c);break;case"PtgRange":c=o.pop(),l=o.pop(),o.push(l+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=su(b[1][1],a,i),o.push(au(h,s));break;case"PtgRefN":h=r?su(b[1][1],r,i):b[1][1],o.push(au(h,s));break;case"PtgRef3d":f=b[1][1],h=su(b[1][2],a,i),v=HE(n,f,i);var O=v;o.push(v+"!"+au(h,s));break;case"PtgFunc":case"PtgFuncVar":var V=b[1][0],B=b[1][1];V||(V=0),V&=127;var x=V==0?[]:o.slice(-V);o.length-=V,B==="User"&&(B=x.shift()),o.push(B+"("+x.join(",")+")");break;case"PtgBool":o.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(b[1]);break;case"PtgNum":o.push(String(b[1]));break;case"PtgStr":o.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(b[1]);break;case"PtgAreaN":m=yE(b[1][1],r?{s:r}:a,i),o.push(ym(m,i));break;case"PtgArea":m=yE(b[1][1],a,i),o.push(ym(m,i));break;case"PtgArea3d":f=b[1][1],m=b[1][2],v=HE(n,f,i),o.push(v+"!"+ym(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=b[1][2];var w=(n.names||[])[d-1]||(n[0]||[])[d],E=w?w.Name:"SH33TJSNAME"+String(d);E&&E.slice(0,6)=="_xlfn."&&!i.xlfn&&(E=E.slice(6)),o.push(E);break;case"PtgNameX":var C=b[1][1];d=b[1][2];var D;if(i.biff<=5)C<0&&(C=-C),n[C]&&(D=n[C][d]);else{var A="";if(((n[C]||[])[0]||[])[0]==14849||(((n[C]||[])[0]||[])[0]==1025?n[C][d]&&n[C][d].itab>0&&(A=n.SheetNames[n[C][d].itab-1]+"!"):A=n.SheetNames[d-1]+"!"),n[C]&&n[C][d])A+=n[C][d].Name;else if(n[0]&&n[0][d])A+=n[0][d].Name;else{var R=(Ob(n,C,i)||"").split(";;");R[d-1]?A=R[d-1]:A+="SH33TJSERRX"}o.push(A);break}D||(D={Name:"SH33TJSERRY"}),o.push(D.Name);break;case"PtgParen":var oe="(",ce=")";if(p>=0){switch(_="",t[0][p][1][0]){case 2:oe=qt(" ",t[0][p][1][1])+oe;break;case 3:oe=qt("\r",t[0][p][1][1])+oe;break;case 4:ce=qt(" ",t[0][p][1][1])+ce;break;case 5:ce=qt("\r",t[0][p][1][1])+ce;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][p][1][0])}p=-1}o.push(oe+o.pop()+ce);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":h={c:b[1][1],r:b[1][0]};var ke={c:r.c,r:r.r};if(n.sharedf[Ue(h)]){var we=n.sharedf[Ue(h)];o.push($r(we,a,ke,n,i))}else{var Ne=!1;for(c=0;c!=n.arrayf.length;++c)if(l=n.arrayf[c],!(h.c<l[0].s.c||h.c>l[0].e.c)&&!(h.r<l[0].s.r||h.r>l[0].e.r)){o.push($r(l[1],a,ke,n,i)),Ne=!0;break}Ne||o.push(b[1])}break;case"PtgArray":o.push("{"+VL(b[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(b));default:throw new Error("Unrecognized Formula Token: "+String(b))}var de=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&p>=0&&de.indexOf(t[0][T][0])==-1){b=t[0][p];var Ae=!0;switch(b[1][0]){case 4:Ae=!1;case 0:_=qt(" ",b[1][1]);break;case 5:Ae=!1;case 1:_=qt("\r",b[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}o.push((Ae?_:"")+o.pop()+(Ae?"":_)),p=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function jL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Kr(t,e-2)];var o=Ru(t,a,r);return e!==a+i&&(s=Du(t,e-a-i,o,r)),t.l=n,[o,s]}function WL(t,e,r){var n=t.l+e,i=r.biff==2?1:2,s,a=t.read_shift(i);if(a==65535)return[[],Kr(t,e-2)];var o=Ru(t,a,r);return e!==a+i&&(s=Du(t,e-a-i,o,r)),t.l=n,[o,s]}function $L(t,e,r,n){var i=t.l+e,s=Ru(t,n,r),a;return i!==t.l&&(a=Du(t,i-t.l,s,r)),[s,a]}function HL(t,e,r){var n=t.l+e,i,s=t.read_shift(2),a=Ru(t,s,r);return s==65535?[[],Kr(t,e-2)]:(e!==s+2&&(i=Du(t,n-s-2,a,r)),[a,i])}function zL(t){var e;if(Zi(t,t.l+6)!==65535)return[zr(t),"n"];switch(t[t.l]){case 0:return t.l+=8,["String","s"];case 1:return e=t[t.l+2]===1,t.l+=8,[e,"b"];case 2:return e=t[t.l+2],t.l+=8,[e,"e"];case 3:return t.l+=8,["","s"]}return[]}function GL(t){if(t==null){var e=re(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return za(t);return za(0)}function bm(t,e,r){var n=t.l+e,i=Fi(t,6);r.biff==2&&++t.l;var s=zL(t,8),a=t.read_shift(1);r.biff!=2&&(t.read_shift(1),r.biff>=5&&t.read_shift(4));var o=WL(t,n-t.l,r);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function qL(t,e,r,n,i){var s=qa(e,r,i),a=GL(t.v),o=re(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var l=re(t.bf.length),h=0;h<t.bf.length;++h)l[h]=t.bf[h];var f=Er([s,a,o,l]);return f}function od(t,e,r){var n=t.read_shift(4),i=Ru(t,n,r),s=t.read_shift(4),a=s>0?Du(t,s,i,r):null;return[i,a]}var KL=od,cd=od,XL=od,YL=od,QL={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Nb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},JL={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function zE(t){return t.slice(0,3)=="of:"&&(t=t.slice(3)),t.charCodeAt(0)==61&&(t=t.slice(1),t.charCodeAt(0)==61&&(t=t.slice(1))),t=t.replace(/COM\.MICROSOFT\./g,""),t=t.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,r){return r.replace(/\./g,"")}),t=t.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),t.replace(/[;~]/g,",").replace(/\|/g,";")}function ZL(t){var e="of:="+t.replace(wg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Im(t){var e=t.split(":"),r=e[0].split(".")[0];return[r,e[0].split(".")[1]+(e.length>1?":"+(e[1].split(".")[1]||e[1].split(".")[0]):"")]}function e3(t){return t.replace(/\./,"!")}var cu={},lc={},lu=typeof Map<"u";function bg(t,e,r){var n=0,i=t.length;if(r){if(lu?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=lu?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(lu?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function ld(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(Hr=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=wu(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=Jf(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function Wa(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];e=="xlml"&&(r=[1,1,1,1,.5,.5]),t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function Ys(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){ts(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function Mb(t,e,r,n,i,s){try{n.cellNF&&(t.z=Le[e])}catch(o){if(n.WTF)throw o}if(!(t.t==="z"&&!n.cellStyles)){if(t.t==="d"&&typeof t.v=="string"&&(t.v=Vt(t.v)),(!n||n.cellText!==!1)&&t.t!=="z")try{if(Le[e]==null&&ts(QR[e]||"General",e),t.t==="e")t.w=t.w||as[t.v];else if(e===0)if(t.t==="n")(t.v|0)===t.v?t.w=t.v.toString(10):t.w=pu(t.v);else if(t.t==="d"){var a=dr(t.v);(a|0)===a?t.w=a.toString(10):t.w=pu(a)}else{if(t.v===void 0)return"";t.w=$a(t.v,lc)}else t.t==="d"?t.w=Kn(e,dr(t.v),lc):t.w=Kn(e,t.v,lc)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{t.s=s.Fills[r],t.s.fgColor&&t.s.fgColor.theme&&!t.s.fgColor.rgb&&(t.s.fgColor.rgb=Qf(i.themeElements.clrScheme[t.s.fgColor.theme].rgb,t.s.fgColor.tint||0),n.WTF&&(t.s.fgColor.raw_rgb=i.themeElements.clrScheme[t.s.fgColor.theme].rgb)),t.s.bgColor&&t.s.bgColor.theme&&(t.s.bgColor.rgb=Qf(i.themeElements.clrScheme[t.s.bgColor.theme].rgb,t.s.bgColor.tint||0),n.WTF&&(t.s.bgColor.raw_rgb=i.themeElements.clrScheme[t.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function t3(t,e,r){if(t&&t["!ref"]){var n=ut(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function r3(t,e){var r=ut(e);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(t["!ref"]=Ge(r))}var n3=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,i3=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,s3=/<(?:\w:)?hyperlink [^>]*>/mg,a3=/"(\w*:\w*)"/,o3=/<(?:\w:)?col\b[^>]*[\/]?>/g,c3=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,l3=/<(?:\w:)?pageMargins[^>]*\/>/g,Lb=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,u3=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,h3=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function f3(t,e,r,n,i,s,a){if(!t)return t;n||(n={"!id":{}}),Xt!=null&&e.dense==null&&(e.dense=Xt);var o=e.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},l="",h="",f=t.match(i3);f?(l=t.slice(0,f.index),h=t.slice(f.index+f[0].length)):l=h=t;var d=l.match(Lb);d?Ig(d[0],o,i,r):(d=l.match(u3))&&p3(d[0],d[1]||"",o,i,r,a,s);var m=(l.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=l.slice(m,m+50).match(a3);v&&r3(o,v[1])}var p=l.match(h3);p&&p[1]&&S3(p[1],i);var _=[];if(e.cellStyles){var T=l.match(o3);T&&E3(_,T)}f&&D3(f[1],o,e,c,s,a);var S=h.match(c3);S&&(o["!autofilter"]=b3(S[0]));var b=[],O=h.match(n3);if(O)for(m=0;m!=O.length;++m)b[m]=ut(O[m].slice(O[m].indexOf('"')+1));var V=h.match(s3);V&&y3(o,V,n);var B=h.match(l3);if(B&&(o["!margins"]=x3(je(B[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=Ge(c)),e.sheetRows>0&&o["!ref"]){var x=ut(o["!ref"]);e.sheetRows<=+x.e.r&&(x.e.r=e.sheetRows-1,x.e.r>c.e.r&&(x.e.r=c.e.r),x.e.r<x.s.r&&(x.s.r=x.e.r),x.e.c>c.e.c&&(x.e.c=c.e.c),x.e.c<x.s.c&&(x.s.c=x.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Ge(x))}return _.length>0&&(o["!cols"]=_),b.length>0&&(o["!merges"]=b),o}function d3(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+Ge(t[r])+'"/>';return e+"</mergeCells>"}function Ig(t,e,r,n){var i=je(t);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=lt(At(i.codeName)))}function p3(t,e,r,n,i){Ig(t.slice(0,t.indexOf(">")),r,n,i)}function m3(t,e,r,n,i){var s=!1,a={},o=null;if(n.bookType!=="xlsx"&&e.vbaraw){var c=e.SheetNames[r];try{e.Workbook&&(c=e.Workbook.Sheets[r].CodeName||c)}catch{}s=!0,a.codeName=ki(Tt(c))}if(t&&t["!outline"]){var l={summaryBelow:1,summaryRight:1};t["!outline"].above&&(l.summaryBelow=0),t["!outline"].left&&(l.summaryRight=0),o=(o||"")+_e("outlinePr",null,l)}!s&&!o||(i[i.length]=_e("sheetPr",o,a))}var g3=["objects","scenarios","selectLockedCells","selectUnlockedCells"],v3=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function _3(t){var e={sheet:1};return g3.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),v3.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=_g(t.password).toString(16).toUpperCase()),_e("sheetProtection",null,e)}function y3(t,e,r){for(var n=Array.isArray(t),i=0;i!=e.length;++i){var s=je(At(e[i]),!0);if(!s.ref)return;var a=((r||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+lt(s.location))):(s.Target="#"+lt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=ut(s.ref),c=o.s.r;c<=o.e.r;++c)for(var l=o.s.c;l<=o.e.c;++l){var h=Ue({c:l,r:c});n?(t[c]||(t[c]=[]),t[c][l]||(t[c][l]={t:"z",v:void 0}),t[c][l].l=s):(t[h]||(t[h]={t:"z",v:void 0}),t[h].l=s)}}}function x3(t){var e={};return["left","right","top","bottom","header","footer"].forEach(function(r){t[r]&&(e[r]=parseFloat(t[r]))}),e}function w3(t){return Wa(t),_e("pageMargins",null,t)}function E3(t,e){for(var r=!1,n=0;n!=e.length;++n){var i=je(e[n],!0);i.hidden&&(i.hidden=Lt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,yg(i.width)),zs(i);s<=a;)t[s++]=Bt(i)}}function T3(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=_e("col",null,ld(i,n)));return r[r.length]="</cols>",r.join("")}function b3(t){var e={ref:(t.match(/ref="([^"]*)"/)||[])[1]};return e}function I3(t,e,r,n){var i=typeof t.ref=="string"?t.ref:Ge(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,a=hn(i);a.s.r==a.e.r&&(a.e.r=hn(e["!ref"]).e.r,i=Ge(a));for(var o=0;o<s.length;++o){var c=s[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),_e("autoFilter",null,{ref:i})}var A3=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function S3(t,e){e.Views||(e.Views=[{}]),(t.match(A3)||[]).forEach(function(r,n){var i=je(r);e.Views[n]||(e.Views[n]={}),+i.zoomScale&&(e.Views[n].zoom=+i.zoomScale),Lt(i.rightToLeft)&&(e.Views[n].RTL=!0)})}function C3(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),_e("sheetViews",_e("sheetView",null,i),{})}function k3(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,a=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=as[t.v];break;case"d":n&&n.cellDates?i=Vt(t.v,-1).toISOString():(t=Bt(t),t.t="n",i=""+(t.v=dr(Vt(t.v)))),typeof t.z>"u"&&(t.z=Le[14]);break;default:i=t.v;break}var o=Lr("v",Tt(i)),c={r:e},l=Ys(n.cellXfs,t,n);switch(l!==0&&(c.s=l),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Lr("v",""+bg(n.Strings,t.v,n.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=s&&(t.t=s,t.v=a),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;o=_e("f",Tt(t.f),h)+(t.v!=null?o:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(c.cm=1),_e("c",o,c)}var D3=function(){var t=/<(?:\w+:)?c[ \/>]/,e=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=mu("v"),a=mu("f");return function(c,l,h,f,d,m){for(var v=0,p="",_=[],T=[],S=0,b=0,O=0,V="",B,x,w=0,E=0,C,D,A=0,R=0,oe=Array.isArray(m.CellXf),ce,ke=[],we=[],Ne=Array.isArray(l),de=[],Ae={},ie=!1,j=!!h.sheetStubs,G=c.split(e),H=0,W=G.length;H!=W;++H){p=G[H].trim();var ne=p.length;if(ne!==0){var me=0;e:for(v=0;v<ne;++v)switch(p[v]){case">":if(p[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(x=je(p.slice(me,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,h.sheetRows&&h.sheetRows<w)continue;Ae={},ie=!1,x.ht&&(ie=!0,Ae.hpt=parseFloat(x.ht),Ae.hpx=dc(Ae.hpt)),x.hidden=="1"&&(ie=!0,Ae.hidden=!0),x.outlineLevel!=null&&(ie=!0,Ae.level=+x.outlineLevel),ie&&(de[w-1]=Ae)}break;case"<":me=v;break}if(me>=v)break;if(x=je(p.slice(me,v),!0),w=x.r!=null?parseInt(x.r,10):w+1,E=-1,!(h.sheetRows&&h.sheetRows<w)){f.s.r>w-1&&(f.s.r=w-1),f.e.r<w-1&&(f.e.r=w-1),h&&h.cellStyles&&(Ae={},ie=!1,x.ht&&(ie=!0,Ae.hpt=parseFloat(x.ht),Ae.hpx=dc(Ae.hpt)),x.hidden=="1"&&(ie=!0,Ae.hidden=!0),x.outlineLevel!=null&&(ie=!0,Ae.level=+x.outlineLevel),ie&&(de[w-1]=Ae)),_=p.slice(v).split(t);for(var ue=0;ue!=_.length&&_[ue].trim().charAt(0)=="<";++ue);for(_=_.slice(ue),v=0;v!=_.length;++v)if(p=_[v].trim(),p.length!==0){if(T=p.match(r),S=v,b=0,O=0,p="<c "+(p.slice(0,1)=="<"?">":"")+p,T!=null&&T.length===2){for(S=0,V=T[1],b=0;b!=V.length&&!((O=V.charCodeAt(b)-64)<1||O>26);++b)S=26*S+O;--S,E=S}else++E;for(b=0;b!=p.length&&p.charCodeAt(b)!==62;++b);if(++b,x=je(p.slice(0,b),!0),x.r||(x.r=Ue({r:w-1,c:E})),V=p.slice(b),B={t:""},(T=V.match(s))!=null&&T[1]!==""&&(B.v=lt(T[1])),h.cellFormula){if((T=V.match(a))!=null&&T[1]!==""){if(B.f=lt(At(T[1])).replace(/\r\n/g,`
`),h.xlfn||(B.f=jE(B.f)),T[0].indexOf('t="array"')>-1)B.F=(V.match(i)||[])[1],B.F.indexOf(":")>-1&&ke.push([ut(B.F),B.F]);else if(T[0].indexOf('t="shared"')>-1){D=je(T[0]);var fe=lt(At(T[1]));h.xlfn||(fe=jE(fe)),we[parseInt(D.si,10)]=[D,fe,x.r]}}else(T=V.match(/<f[^>]*\/>/))&&(D=je(T[0]),we[D.si]&&(B.f=A4(we[D.si][1],we[D.si][2],x.r)));var se=Ht(x.r);for(b=0;b<ke.length;++b)se.r>=ke[b][0].s.r&&se.r<=ke[b][0].e.r&&se.c>=ke[b][0].s.c&&se.c<=ke[b][0].e.c&&(B.F=ke[b][1])}if(x.t==null&&B.v===void 0)if(B.f||B.F)B.v=0,B.t="n";else if(j)B.t="z";else continue;else B.t=x.t||"n";switch(f.s.c>E&&(f.s.c=E),f.e.c<E&&(f.e.c=E),B.t){case"n":if(B.v==""||B.v==null){if(!j)continue;B.t="z"}else B.v=parseFloat(B.v);break;case"s":if(typeof B.v>"u"){if(!j)continue;B.t="z"}else C=cu[parseInt(B.v,10)],B.v=C.t,B.r=C.r,h.cellHTML&&(B.h=C.h);break;case"str":B.t="s",B.v=B.v!=null?At(B.v):"",h.cellHTML&&(B.h=Zm(B.v));break;case"inlineStr":T=V.match(n),B.t="s",T!=null&&(C=vg(T[1]))?(B.v=C.t,h.cellHTML&&(B.h=C.h)):B.v="";break;case"b":B.v=Lt(B.v);break;case"d":h.cellDates?B.v=Vt(B.v,1):(B.v=dr(Vt(B.v,1)),B.t="n");break;case"e":(!h||h.cellText!==!1)&&(B.w=B.v),B.v=BT[B.v];break}if(A=R=0,ce=null,oe&&x.s!==void 0&&(ce=m.CellXf[x.s],ce!=null&&(ce.numFmtId!=null&&(A=ce.numFmtId),h.cellStyles&&ce.fillId!=null&&(R=ce.fillId))),Mb(B,A,R,h,d,m),h.cellDates&&oe&&B.t=="n"&&mc(Le[A])&&(B.t="d",B.v=id(B.v)),x.cm&&h.xlmeta){var We=(h.xlmeta.Cell||[])[+x.cm-1];We&&We.type=="XLDAPR"&&(B.D=!0)}if(Ne){var U=Ht(x.r);l[U.r]||(l[U.r]=[]),l[U.r][U.c]=B}else l[x.r]=B}}}}de.length>0&&(l["!rows"]=de)}}();function R3(t,e,r,n){var i=[],s=[],a=ut(t["!ref"]),o="",c,l="",h=[],f=0,d=0,m=t["!rows"],v=Array.isArray(t),p={r:l},_,T=-1;for(d=a.s.c;d<=a.e.c;++d)h[d]=$t(d);for(f=a.s.r;f<=a.e.r;++f){for(s=[],l=tr(f),d=a.s.c;d<=a.e.c;++d){c=h[d]+l;var S=v?(t[f]||[])[d]:t[c];S!==void 0&&(o=k3(S,c,t,e,r,n))!=null&&s.push(o)}(s.length>0||m&&m[f])&&(p={r:l},m&&m[f]&&(_=m[f],_.hidden&&(p.hidden=1),T=-1,_.hpx?T=Eu(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(p.ht=T,p.customHeight=1),_.level&&(p.outlineLevel=_.level)),i[i.length]=_e("row",s.join(""),p))}if(m)for(;f<m.length;++f)m&&m[f]&&(p={r:f+1},_=m[f],_.hidden&&(p.hidden=1),T=-1,_.hpx?T=Eu(_.hpx):_.hpt&&(T=_.hpt),T>-1&&(p.ht=T,p.customHeight=1),_.level&&(p.outlineLevel=_.level),i[i.length]=_e("row","",p));return i.join("")}function Vb(t,e,r,n){var i=[rr,_e("worksheet",null,{xmlns:Xa[0],"xmlns:r":fr.r})],s=r.SheetNames[t],a=0,o="",c=r.Sheets[s];c==null&&(c={});var l=c["!ref"]||"A1",h=ut(l);if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+l+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),l=Ge(h)}n||(n={}),c["!comments"]=[];var f=[];m3(c,r,t,e,i),i[i.length]=_e("dimension",null,{ref:l}),i[i.length]=C3(c,e,t,r),e.sheetFormat&&(i[i.length]=_e("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(i[i.length]=T3(c,c["!cols"])),i[a=i.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=R3(c,e,t,r,n),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),c["!protect"]&&(i[i.length]=_3(c["!protect"])),c["!autofilter"]!=null&&(i[i.length]=I3(c["!autofilter"],c,r,t)),c["!merges"]!=null&&c["!merges"].length>0&&(i[i.length]=d3(c["!merges"]));var d=-1,m,v=-1;return c["!links"].length>0&&(i[i.length]="<hyperlinks>",c["!links"].forEach(function(p){p[1].Target&&(m={ref:p[0]},p[1].Target.charAt(0)!="#"&&(v=Et(n,-1,Tt(p[1].Target).replace(/#.*$/,""),Qe.HLINK),m["r:id"]="rId"+v),(d=p[1].Target.indexOf("#"))>-1&&(m.location=Tt(p[1].Target.slice(d+1))),p[1].Tooltip&&(m.tooltip=Tt(p[1].Tooltip)),i[i.length]=_e("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(i[i.length]=w3(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=Lr("ignoredErrors",_e("ignoredError",null,{numberStoredAsText:1,sqref:l}))),f.length>0&&(v=Et(n,-1,"../drawings/drawing"+(t+1)+".xml",Qe.DRAW),i[i.length]=_e("drawing",null,{"r:id":"rId"+v}),c["!drawing"]=f),c["!comments"].length>0&&(v=Et(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Qe.VML),i[i.length]=_e("legacyDrawing",null,{"r:id":"rId"+v}),c["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function F3(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function P3(t,e,r){var n=re(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=Eu(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),n.write_shift(1,a),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var l={r:t,c:0},h=0;h<16;++h)if(!(e.s.c>h+1<<10||e.e.c<h<<10)){for(var f=-1,d=-1,m=h<<10;m<h+1<<10;++m){l.c=m;var v=Array.isArray(r)?(r[l.r]||[])[l.c]:r[Ue(l)];v&&(f<0&&(f=m),d=m)}f<0||(++o,n.write_shift(4,f),n.write_shift(4,d))}var p=n.l;return n.l=c,n.write_shift(4,o),n.l=p,n.length>n.l?n.slice(0,n.l):n}function O3(t,e,r,n){var i=P3(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&ae(t,0,i)}var N3=Za,M3=yc;function L3(){}function V3(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=jF(t,e-19),r}function B3(t,e,r){r==null&&(r=re(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return Kf({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),OT(t,r),r.slice(0,r.l)}function U3(t){var e=Xn(t);return[e]}function j3(t,e,r){return r==null&&(r=re(8)),Ya(e,r)}function W3(t){var e=Qa(t);return[e]}function $3(t,e,r){return r==null&&(r=re(4)),Ja(e,r)}function H3(t){var e=Xn(t),r=t.read_shift(1);return[e,r,"b"]}function z3(t,e,r){return r==null&&(r=re(9)),Ya(e,r),r.write_shift(1,t.v?1:0),r}function G3(t){var e=Qa(t),r=t.read_shift(1);return[e,r,"b"]}function q3(t,e,r){return r==null&&(r=re(5)),Ja(e,r),r.write_shift(1,t.v?1:0),r}function K3(t){var e=Xn(t),r=t.read_shift(1);return[e,r,"e"]}function X3(t,e,r){return r==null&&(r=re(9)),Ya(e,r),r.write_shift(1,t.v),r}function Y3(t){var e=Qa(t),r=t.read_shift(1);return[e,r,"e"]}function Q3(t,e,r){return r==null&&(r=re(8)),Ja(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function J3(t){var e=Xn(t),r=t.read_shift(4);return[e,r,"s"]}function Z3(t,e,r){return r==null&&(r=re(12)),Ya(e,r),r.write_shift(4,e.v),r}function eV(t){var e=Qa(t),r=t.read_shift(4);return[e,r,"s"]}function tV(t,e,r){return r==null&&(r=re(8)),Ja(e,r),r.write_shift(4,e.v),r}function rV(t){var e=Xn(t),r=zr(t);return[e,r,"n"]}function nV(t,e,r){return r==null&&(r=re(16)),Ya(e,r),za(t.v,r),r}function Bb(t){var e=Qa(t),r=zr(t);return[e,r,"n"]}function iV(t,e,r){return r==null&&(r=re(12)),Ja(e,r),za(t.v,r),r}function sV(t){var e=Xn(t),r=fg(t);return[e,r,"n"]}function aV(t,e,r){return r==null&&(r=re(12)),Ya(e,r),NT(t.v,r),r}function oV(t){var e=Qa(t),r=fg(t);return[e,r,"n"]}function cV(t,e,r){return r==null&&(r=re(8)),Ja(e,r),NT(t.v,r),r}function lV(t){var e=Xn(t),r=lg(t);return[e,r,"is"]}function uV(t){var e=Xn(t),r=qr(t);return[e,r,"str"]}function hV(t,e,r){return r==null&&(r=re(12+4*t.v.length)),Ya(e,r),Tr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function fV(t){var e=Qa(t),r=qr(t);return[e,r,"str"]}function dV(t,e,r){return r==null&&(r=re(8+4*t.v.length)),Ja(e,r),Tr(t.v,r),r.length>r.l?r.slice(0,r.l):r}function pV(t,e,r){var n=t.l+e,i=Xn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"b"];if(r.cellFormula){t.l+=2;var o=cd(t,n-t.l,r);a[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return a}function mV(t,e,r){var n=t.l+e,i=Xn(t);i.r=r["!row"];var s=t.read_shift(1),a=[i,s,"e"];if(r.cellFormula){t.l+=2;var o=cd(t,n-t.l,r);a[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return a}function gV(t,e,r){var n=t.l+e,i=Xn(t);i.r=r["!row"];var s=zr(t),a=[i,s,"n"];if(r.cellFormula){t.l+=2;var o=cd(t,n-t.l,r);a[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return a}function vV(t,e,r){var n=t.l+e,i=Xn(t);i.r=r["!row"];var s=qr(t),a=[i,s,"str"];if(r.cellFormula){t.l+=2;var o=cd(t,n-t.l,r);a[3]=$r(o,null,i,r.supbooks,r)}else t.l=n;return a}var _V=Za,yV=yc;function xV(t,e){return e==null&&(e=re(4)),e.write_shift(4,t),e}function wV(t,e){var r=t.l+e,n=Za(t,16),i=ug(t),s=qr(t),a=qr(t),o=qr(t);t.l=r;var c={rfx:n,relId:i,loc:s,display:o};return a&&(c.Tooltip=a),c}function EV(t,e){var r=re(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));yc({s:Ht(t[0]),e:Ht(t[0])},r),hg("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return Tr(i||"",r),Tr(t[1].Tooltip||"",r),Tr("",r),r.slice(0,r.l)}function TV(){}function bV(t,e,r){var n=t.l+e,i=MT(t,16),s=t.read_shift(1),a=[i];if(a[2]=s,r.cellFormula){var o=KL(t,n-t.l,r);a[1]=o}else t.l=n;return a}function IV(t,e,r){var n=t.l+e,i=Za(t,16),s=[i];if(r.cellFormula){var a=YL(t,n-t.l,r);s[1]=a,t.l=n}else t.l=n;return s}function AV(t,e,r){r==null&&(r=re(18));var n=ld(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var Ub=["left","right","top","bottom","header","footer"];function SV(t){var e={};return Ub.forEach(function(r){e[r]=zr(t,8)}),e}function CV(t,e){return e==null&&(e=re(6*8)),Wa(t),Ub.forEach(function(r){za(t[r],e)}),e}function kV(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function DV(t,e,r){r==null&&(r=re(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function RV(t){var e=re(24);return e.write_shift(4,4),e.write_shift(4,1),yc(t,e),e}function FV(t,e){return e==null&&(e=re(16*4+2)),e.write_shift(2,t.password?_g(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function PV(){}function OV(){}function NV(t,e,r,n,i,s,a){if(!t)return t;var o=e||{};n||(n={"!id":{}}),Xt!=null&&o.dense==null&&(o.dense=Xt);var c=o.dense?[]:{},l,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},f=[],d=!1,m=!1,v,p,_,T,S,b,O,V,B,x=[];o.biff=12,o["!row"]=0;var w=0,E=!1,C=[],D={},A=o.supbooks||i.supbooks||[[]];if(A.sharedf=D,A.arrayf=C,A.SheetNames=i.SheetNames||i.Sheets.map(function(Ae){return Ae.name}),!o.supbooks&&(o.supbooks=A,i.Names))for(var R=0;R<i.Names.length;++R)A[0][R+1]=i.Names[R];var oe=[],ce=[],ke=!1;Tu[16]={n:"BrtShortReal",f:Bb};var we,Ne;if(ss(t,function(ie,j,G){if(!m)switch(G){case 148:l=ie;break;case 0:v=ie,o.sheetRows&&o.sheetRows<=v.r&&(m=!0),V=tr(T=v.r),o["!row"]=v.r,(ie.hidden||ie.hpt||ie.level!=null)&&(ie.hpt&&(ie.hpx=dc(ie.hpt)),ce[ie.r]=ie);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(p={t:ie[2]},ie[2]){case"n":p.v=ie[1];break;case"s":O=cu[ie[1]],p.v=O.t,p.r=O.r;break;case"b":p.v=!!ie[1];break;case"e":p.v=ie[1],o.cellText!==!1&&(p.w=as[p.v]);break;case"str":p.t="s",p.v=ie[1];break;case"is":p.t="s",p.v=ie[1].t;break}if((_=a.CellXf[ie[0].iStyleRef])&&Mb(p,_.numFmtId,null,o,s,a),S=ie[0].c==-1?S+1:ie[0].c,o.dense?(c[T]||(c[T]=[]),c[T][S]=p):c[$t(S)+V]=p,o.cellFormula){for(E=!1,w=0;w<C.length;++w){var H=C[w];v.r>=H[0].s.r&&v.r<=H[0].e.r&&S>=H[0].s.c&&S<=H[0].e.c&&(p.F=Ge(H[0]),E=!0)}!E&&ie.length>3&&(p.f=ie[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>S&&(h.s.c=S),h.e.r<v.r&&(h.e.r=v.r),h.e.c<S&&(h.e.c=S),o.cellDates&&_&&p.t=="n"&&mc(Le[_.numFmtId])){var W=Va(p.v);W&&(p.t="d",p.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}we&&(we.type=="XLDAPR"&&(p.D=!0),we=void 0),Ne&&(Ne=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;p={t:"z",v:void 0},S=ie[0].c==-1?S+1:ie[0].c,o.dense?(c[T]||(c[T]=[]),c[T][S]=p):c[$t(S)+V]=p,h.s.r>v.r&&(h.s.r=v.r),h.s.c>S&&(h.s.c=S),h.e.r<v.r&&(h.e.r=v.r),h.e.c<S&&(h.e.c=S),we&&(we.type=="XLDAPR"&&(p.D=!0),we=void 0),Ne&&(Ne=void 0);break;case 176:x.push(ie);break;case 49:we=((o.xlmeta||{}).Cell||[])[ie-1];break;case 494:var ne=n["!id"][ie.relId];for(ne?(ie.Target=ne.Target,ie.loc&&(ie.Target+="#"+ie.loc),ie.Rel=ne):ie.relId==""&&(ie.Target="#"+ie.loc),T=ie.rfx.s.r;T<=ie.rfx.e.r;++T)for(S=ie.rfx.s.c;S<=ie.rfx.e.c;++S)o.dense?(c[T]||(c[T]=[]),c[T][S]||(c[T][S]={t:"z",v:void 0}),c[T][S].l=ie):(b=Ue({c:S,r:T}),c[b]||(c[b]={t:"z",v:void 0}),c[b].l=ie);break;case 426:if(!o.cellFormula)break;C.push(ie),B=o.dense?c[T][S]:c[$t(S)+V],B.f=$r(ie[1],h,{r:v.r,c:S},A,o),B.F=Ge(ie[0]);break;case 427:if(!o.cellFormula)break;D[Ue(ie[0].s)]=ie[1],B=o.dense?c[T][S]:c[$t(S)+V],B.f=$r(ie[1],h,{r:v.r,c:S},A,o);break;case 60:if(!o.cellStyles)break;for(;ie.e>=ie.s;)oe[ie.e--]={width:ie.w/256,hidden:!!(ie.flags&1),level:ie.level},ke||(ke=!0,yg(ie.w/256)),zs(oe[ie.e+1]);break;case 161:c["!autofilter"]={ref:Ge(ie)};break;case 476:c["!margins"]=ie;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),ie.name&&(i.Sheets[r].CodeName=ie.name),(ie.above||ie.left)&&(c["!outline"]={above:ie.above,left:ie.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),ie.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:f.push(G),d=!0;break;case 38:f.pop(),d=!1;break;default:if(!j.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(h.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(c["!ref"]=Ge(l||h)),o.sheetRows&&c["!ref"]){var de=ut(c["!ref"]);o.sheetRows<=+de.e.r&&(de.e.r=o.sheetRows-1,de.e.r>h.e.r&&(de.e.r=h.e.r),de.e.r<de.s.r&&(de.s.r=de.e.r),de.e.c>h.e.c&&(de.e.c=h.e.c),de.e.c<de.s.c&&(de.s.c=de.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ge(de))}return x.length>0&&(c["!merges"]=x),oe.length>0&&(c["!cols"]=oe),ce.length>0&&(c["!rows"]=ce),c}function MV(t,e,r,n,i,s,a){if(e.v===void 0)return!1;var o="";switch(e.t){case"b":o=e.v?"1":"0";break;case"d":e=Bt(e),e.z=e.z||Le[14],e.v=dr(Vt(e.v)),e.t="n";break;case"n":case"e":o=""+e.v;break;default:o=e.v;break}var c={r,c:n};switch(c.s=Ys(i.cellXfs,e,i),e.l&&s["!links"].push([Ue(c),e.l]),e.c&&s["!comments"].push([Ue(c),e.c]),e.t){case"s":case"str":return i.bookSST?(o=bg(i.Strings,e.v,i.revStrings),c.t="s",c.v=o,a?ae(t,18,tV(e,c)):ae(t,7,Z3(e,c))):(c.t="str",a?ae(t,17,dV(e,c)):ae(t,6,hV(e,c))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?a?ae(t,13,cV(e,c)):ae(t,2,aV(e,c)):a?ae(t,16,iV(e,c)):ae(t,5,nV(e,c)),!0;case"b":return c.t="b",a?ae(t,15,q3(e,c)):ae(t,4,z3(e,c)),!0;case"e":return c.t="e",a?ae(t,14,Q3(e,c)):ae(t,3,X3(e,c)),!0}return a?ae(t,12,$3(e,c)):ae(t,1,j3(e,c)),!0}function LV(t,e,r,n){var i=ut(e["!ref"]||"A1"),s,a="",o=[];ae(t,145);var c=Array.isArray(e),l=i.e.r;e["!rows"]&&(l=Math.max(i.e.r,e["!rows"].length-1));for(var h=i.s.r;h<=l;++h){a=tr(h),O3(t,e,i,h);var f=!1;if(h<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(o[d]=$t(d)),s=o[d]+a;var m=c?(e[h]||[])[d]:e[s];if(!m){f=!1;continue}f=MV(t,m,h,d,n,e,f)}}ae(t,146)}function VV(t,e){!e||!e["!merges"]||(ae(t,177,xV(e["!merges"].length)),e["!merges"].forEach(function(r){ae(t,176,yV(r))}),ae(t,178))}function BV(t,e){!e||!e["!cols"]||(ae(t,390),e["!cols"].forEach(function(r,n){r&&ae(t,60,AV(n,r))}),ae(t,391))}function UV(t,e){!e||!e["!ref"]||(ae(t,648),ae(t,649,RV(ut(e["!ref"]))),ae(t,650))}function jV(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Et(r,-1,n[1].Target.replace(/#.*$/,""),Qe.HLINK);ae(t,494,EV(n,i))}}),delete e["!links"]}function WV(t,e,r,n){if(e["!comments"].length>0){var i=Et(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Qe.VML);ae(t,551,hg("rId"+i)),e["!legacy"]=i}}function $V(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:Ge(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,o=hn(s);o.s.r==o.e.r&&(o.e.r=hn(e["!ref"]).e.r,s=Ge(o));for(var c=0;c<a.length;++c){var l=a[c];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+s;break}}c==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ae(t,161,yc(ut(s))),ae(t,162)}}function HV(t,e,r){ae(t,133),ae(t,137,DV(e,r)),ae(t,138),ae(t,134)}function zV(t,e){e["!protect"]&&ae(t,535,FV(e["!protect"]))}function GV(t,e,r,n){var i=un(),s=r.SheetNames[t],a=r.Sheets[s]||{},o=s;try{r&&r.Workbook&&(o=r.Workbook.Sheets[t].CodeName||o)}catch{}var c=ut(a["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],ae(i,129),(r.vbaraw||a["!outline"])&&ae(i,147,B3(o,a["!outline"])),ae(i,148,M3(c)),HV(i,a,r.Workbook),BV(i,a,t,e,r),LV(i,a,t,e,r),zV(i,a),$V(i,a,r,t),VV(i,a),jV(i,a,n),a["!margins"]&&ae(i,476,CV(a["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&UV(i,a),WV(i,a,t,n),ae(i,130),i.end()}function qV(t){var e=[],r=t.match(/^<c:numCache>/),n;(t.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(e[+a[1]]=r?+a[2]:a[2])});var i=lt((t.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(t.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[e,i,n]}function KV(t,e,r,n,i,s){var a=s||{"!type":"chart"};if(!t)return s;var o=0,c=0,l="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(t.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(f){var d=qV(f);h.s.r=h.s.c=0,h.e.c=o,l=$t(o),d[0].forEach(function(m,v){a[l+tr(v)]={t:"n",v:m,z:d[1]},c=v}),h.e.r<c&&(h.e.r=c),++o}),o>0&&(a["!ref"]=Ge(h)),a}function XV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=t.match(Lb);return o&&Ig(o[0],s,i,r),(a=t.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function YV(t,e){t.l+=10;var r=qr(t,e-10);return{name:r}}function QV(t,e,r,n,i){if(!t)return t;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=[],o=!1;return ss(t,function(l,h,f){switch(f){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:a.push(f);break;case 38:a.pop();break;default:if(h.T>0)a.push(f);else if(h.T<0)a.pop();else if(!o||e.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}},e),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var Ag=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JV=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ZV=[],e6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function GE(t,e){for(var r=0;r!=t.length;++r)for(var n=t[r],i=0;i!=e.length;++i){var s=e[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Lt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function qE(t,e){for(var r=0;r!=e.length;++r){var n=e[r];if(t[n[0]]==null)t[n[0]]=n[1];else switch(n[2]){case"bool":typeof t[n[0]]=="string"&&(t[n[0]]=Lt(t[n[0]]));break;case"int":typeof t[n[0]]=="string"&&(t[n[0]]=parseInt(t[n[0]],10));break}}}function jb(t){qE(t.WBProps,Ag),qE(t.CalcPr,e6),GE(t.WBView,JV),GE(t.Sheets,ZV),lc.date1904=Lt(t.WBProps.date1904)}function t6(t){return!t.Workbook||!t.Workbook.WBProps?"false":Lt(t.Workbook.WBProps.date1904)?"true":"false"}var r6="][*?/\\".split("");function Wb(t,e){if(t.length>31){if(e)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var r=!0;return r6.forEach(function(n){if(t.indexOf(n)!=-1){if(!e)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");r=!1}}),r}function n6(t,e,r){t.forEach(function(n,i){Wb(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var a=e&&e[i]&&e[i].CodeName||n;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function i6(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];n6(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)t3(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}var s6=/<\w+:workbook/;function a6(t,e){if(!t)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},a=0;if(t.replace(Xr,function(c,l){var h=je(c);switch(Ri(h[0])){case"<?xml":break;case"<workbook":c.match(s6)&&(i="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],r.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Ag.forEach(function(f){if(h[f[0]]!=null)switch(f[2]){case"bool":r.WBProps[f[0]]=Lt(h[f[0]]);break;case"int":r.WBProps[f[0]]=parseInt(h[f[0]],10);break;default:r.WBProps[f[0]]=h[f[0]]}}),h.codeName&&(r.WBProps.CodeName=At(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],r.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=lt(At(h.name)),delete h[0],r.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=At(h.name),h.comment&&(s.Comment=h.comment),h.localSheetId&&(s.Sheet=+h.localSheetId),Lt(h.hidden||"0")&&(s.Hidden=!0),a=l+c.length;break;case"</definedName>":s.Ref=lt(At(t.slice(a,l))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete h[0],r.CalcPr=h;break;case"<calcPr/>":delete h[0],r.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&e.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),Xa.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return jb(r),r}function $b(t){var e=[rr];e[e.length]=_e("workbook",null,{xmlns:Xa[0],"xmlns:r":fr.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Ag.forEach(function(o){t.Workbook.WBProps[o[0]]!=null&&t.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=t.Workbook.WBProps[o[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=_e("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var a={name:Tt(t.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}e[e.length]=_e("sheet",null,a)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(e[e.length]=_e("definedName",Tt(o.Ref),c))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function o6(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=Pm(t,e-8),r.name=qr(t),r}function c6(t,e){return e||(e=re(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),hg(t.strRelID,e),Tr(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function l6(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?qr(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function u6(t,e){e||(e=re(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),OT(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function h6(t,e){var r={};return t.read_shift(4),r.ArchID=t.read_shift(4),t.l+=e-8,r}function f6(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=WF(t),a=XL(t,0,r),o=ug(t);t.l=n;var c={Name:s,Ptg:a};return i<268435455&&(c.Sheet=i),o&&(c.Comment=o),c}function d6(t,e){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;e||(e={}),e.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Tu[16]={n:"BrtFRTArchID$",f:h6},ss(t,function(c,l,h){switch(h){case 156:a.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(e.SID=c.Sheet),c.Ref=$r(c.Ptg,null,null,a,e),delete e.SID,delete c.Ptg,s.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([h,c]):a[0]=[h,c],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(c),a.XTI=a.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(h),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(h),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!l.T){if(!i||e.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},e),jb(r),r.Names=s,r.supbooks=a,r}function p6(t,e){ae(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};ae(t,156,c6(i))}ae(t,144)}function m6(t,e){e||(e=re(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return Tr("SheetJS",e),Tr(fu.version,e),Tr(fu.version,e),Tr("7262",e),e.length>e.l?e.slice(0,e.l):e}function g6(t,e){e||(e=re(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function v6(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(ae(t,135),ae(t,158,g6(i)),ae(t,136))}}function _6(t,e){var r=un();return ae(r,131),ae(r,128,m6()),ae(r,153,u6(t.Workbook&&t.Workbook.WBProps||null)),v6(r,t,e),p6(r,t,e),ae(r,132),r.end()}function y6(t,e,r){return e.slice(-4)===".bin"?d6(t,r):a6(t,r)}function x6(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?NV(t,n,r,i,s,a,o):f3(t,n,r,i,s,a,o)}function w6(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?QV(t,n,r,i,s,a,o):XV(t,n,r,i,s,a,o)}function E6(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?b4(t,n,r,i,s,a,o):I4(t,n,r,i,s,a,o)}function T6(t,e,r,n,i,s,a,o){return e.slice(-4)===".bin"?E4(t,n,r,i,s,a,o):T4(t,n,r,i,s,a,o)}function b6(t,e,r,n){return e.slice(-4)===".bin"?yM(t,r,n):oM(t,r,n)}function I6(t,e,r){return Tb(t,r)}function A6(t,e,r){return e.slice(-4)===".bin"?AN(t,r):TN(t,r)}function S6(t,e,r){return e.slice(-4)===".bin"?v4(t,r):c4(t,r)}function C6(t,e,r){return e.slice(-4)===".bin"?s4(t,e,r):n4(t,e,r)}function k6(t,e,r,n){return r.slice(-4)===".bin"?a4(t,e,r,n):void 0}function D6(t,e,r){return e.slice(-4)===".bin"?e4(t,e,r):r4(t,e,r)}function R6(t,e,r){return(e.slice(-4)===".bin"?_6:$b)(t,r)}function F6(t,e,r,n,i){return(e.slice(-4)===".bin"?GV:Vb)(t,r,n,i)}function P6(t,e,r){return(e.slice(-4)===".bin"?kM:wb)(t,r)}function O6(t,e,r){return(e.slice(-4)===".bin"?kN:db)(t,r)}function N6(t,e,r){return(e.slice(-4)===".bin"?_4:Ab)(t,r)}function M6(t){return(t.slice(-4)===".bin"?t4:bb)()}var Hb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,zb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ai(t,e){var r=t.split(/\s+/),n=[];if(e||(n[0]=r[0]),r.length===1)return n;var i=t.match(Hb),s,a,o,c;if(i)for(c=0;c!=i.length;++c)s=i[c].match(zb),(a=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),n[o]=s[2].slice(1,s[2].length-1));return n}function L6(t){var e=t.split(/\s+/),r={};if(e.length===1)return r;var n=t.match(Hb),i,s,a,o;if(n)for(o=0;o!=n.length;++o)i=n[o].match(zb),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),r[a]=i[2].slice(1,i[2].length-1));return r}var uu;function V6(t,e){var r=uu[t]||lt(t);return r==="General"?$a(e):Kn(r,e)}function B6(t,e,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Lt(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Vt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}t[lt(e)]=i}function U6(t,e,r){if(t.t!=="z"){if(!r||r.cellText!==!1)try{t.t==="e"?t.w=t.w||as[t.v]:e==="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=pu(t.v):t.w=$a(t.v):t.w=V6(e||"General",t.v)}catch(s){if(r.WTF)throw s}try{var n=uu[e]||e||"General";if(r.cellNF&&(t.z=n),r.cellDates&&t.t=="n"&&mc(n)){var i=Va(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function j6(t,e,r){if(r.cellStyles&&e.Interior){var n=e.Interior;n.Pattern&&(n.patternType=ZN[n.Pattern]||n.Pattern)}t[e.ID]=e}function W6(t,e,r,n,i,s,a,o,c,l){var h="General",f=n.StyleID,d={};l=l||{};var m=[],v=0;for(f===void 0&&o&&(f=o.StyleID),f===void 0&&a&&(f=a.StyleID);s[f]!==void 0&&(s[f].nf&&(h=s[f].nf),s[f].Interior&&m.push(s[f].Interior),!!s[f].Parent);)f=s[f].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Lt(t);break;case"String":n.t="s",n.r=uE(lt(t)),n.v=t.indexOf("<")>-1?lt(e||t).replace(/<.*?>/g,""):n.r;break;case"DateTime":t.slice(-1)!="Z"&&(t+="Z"),n.v=(Vt(t)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=lt(t):n.v<60&&(n.v=n.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+t),n.t||(n.t="n");break;case"Error":n.t="e",n.v=BT[t],l.cellText!==!1&&(n.w=t);break;default:t==""&&e==""?n.t="z":(n.t="s",n.v=uE(e||t));break}if(U6(n,h,l),l.cellFormula!==!1)if(n.Formula){var p=lt(n.Formula);p.charCodeAt(0)==61&&(p=p.slice(1)),n.f=cc(p,i),delete n.Formula,n.ArrayRange=="RC"?n.F=cc("RC:RC",i):n.ArrayRange&&(n.F=cc(n.ArrayRange,i),c.push([ut(n.F),n.F]))}else for(v=0;v<c.length;++v)i.r>=c[v][0].s.r&&i.r<=c[v][0].e.r&&i.c>=c[v][0].s.c&&i.c<=c[v][0].e.c&&(n.F=c[v][1]);l.cellStyles&&(m.forEach(function(_){!d.patternType&&_.patternType&&(d.patternType=_.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function $6(t){t.t=t.v||"",t.t=t.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.v=t.w=t.ixfe=void 0}function Am(t,e){var r=e||{};gc();var n=tu(eg(t));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(typeof _t<"u"?n=_t.utils.decode(65001,Rm(n)):n=At(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=Bt(r);return a.type="string",fc.to_workbook(n,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(jt){i.indexOf("<"+jt)>=0&&(s=!0)}),s)return C8(n,r);uu={"General Number":"General","General Date":Le[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Le[15],"Short Date":Le[14],"Long Time":Le[19],"Medium Time":Le[18],"Short Time":Le[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Le[2],Standard:Le[4],Percent:Le[10],Scientific:Le[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],l;Xt!=null&&r.dense==null&&(r.dense=Xt);var h={},f=[],d=r.dense?[]:{},m="",v={},p={},_=ai('<Data ss:Type="String">'),T=0,S=0,b=0,O={s:{r:2e6,c:2e6},e:{r:0,c:0}},V={},B={},x="",w=0,E=[],C={},D={},A=0,R=[],oe=[],ce={},ke=[],we,Ne=!1,de=[],Ae=[],ie={},j=0,G=0,H={Sheets:[],WBProps:{date1904:!1}},W={};vu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var ne="";o=vu.exec(n);)switch(o[3]=(ne=o[3]).toLowerCase()){case"data":if(ne=="data"){if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?W6(n.slice(T,o.index),x,_,c[c.length-1][0]=="comment"?ce:v,{c:S,r:b},V,ke[S],p,de,r):(x="",_=ai(o[0]),T=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(oe.length>0&&(v.c=oe),(!r.sheetRows||r.sheetRows>b)&&v.v!==void 0&&(r.dense?(d[b]||(d[b]=[]),d[b][S]=v):d[$t(S)+tr(b)]=v),v.HRef&&(v.l={Target:lt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(j=S+(parseInt(v.MergeAcross,10)|0),G=b+(parseInt(v.MergeDown,10)|0),E.push({s:{c:S,r:b},e:{c:j,r:G}})),!r.sheetStubs)v.MergeAcross?S=j+1:++S;else if(v.MergeAcross||v.MergeDown){for(var me=S;me<=j;++me)for(var ue=b;ue<=G;++ue)(me>S||ue>b)&&(r.dense?(d[ue]||(d[ue]=[]),d[ue][me]={t:"z"}):d[$t(me)+tr(ue)]={t:"z"});S=j+1}else++S;else v=L6(o[0]),v.Index&&(S=+v.Index-1),S<O.s.c&&(O.s.c=S),S>O.e.c&&(O.e.c=S),o[0].slice(-2)==="/>"&&++S,oe=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(b<O.s.r&&(O.s.r=b),b>O.e.r&&(O.e.r=b),o[0].slice(-2)==="/>"&&(p=ai(o[0]),p.Index&&(b=+p.Index-1)),S=0,++b):(p=ai(o[0]),p.Index&&(b=+p.Index-1),ie={},(p.AutoFitHeight=="0"||p.Height)&&(ie.hpx=parseInt(p.Height,10),ie.hpt=Eu(ie.hpx),Ae[b]=ie),p.Hidden=="1"&&(ie.hidden=!0,Ae[b]=ie));break;case"worksheet":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));f.push(m),O.s.r<=O.e.r&&O.s.c<=O.e.c&&(d["!ref"]=Ge(O),r.sheetRows&&r.sheetRows<=O.e.r&&(d["!fullref"]=d["!ref"],O.e.r=r.sheetRows-1,d["!ref"]=Ge(O))),E.length&&(d["!merges"]=E),ke.length>0&&(d["!cols"]=ke),Ae.length>0&&(d["!rows"]=Ae),h[m]=d}else O={s:{r:2e6,c:2e6},e:{r:0,c:0}},b=S=0,c.push([o[3],!1]),l=ai(o[0]),m=lt(l.Name),d=r.dense?[]:{},E=[],de=[],Ae=[],W={name:m,Hidden:0},H.Sheets.push(W);break;case"table":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),ke=[],Ne=!1}break;case"style":o[1]==="/"?j6(V,B,r):B=ai(o[0]);break;case"numberformat":B.nf=lt(ai(o[0]).Format||"General"),uu[B.nf]&&(B.nf=uu[B.nf]);for(var fe=0;fe!=392&&Le[fe]!=B.nf;++fe);if(fe==392){for(fe=57;fe!=392;++fe)if(Le[fe]==null){ts(B.nf,fe);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(we=ai(o[0]),we.Hidden&&(we.hidden=!0,delete we.Hidden),we.Width&&(we.wpx=parseInt(we.Width,10)),!Ne&&we.wpx>10){Ne=!0,Hr=yb;for(var se=0;se<ke.length;++se)ke[se]&&zs(ke[se])}Ne&&zs(we),ke[we.Index-1||ke.length]=we;for(var We=0;We<+we.Span;++We)ke[ke.length]=Bt(we);break;case"namedrange":if(o[1]==="/")break;H.Names||(H.Names=[]);var U=je(o[0]),at={Name:U.Name,Ref:cc(U.RefersTo.slice(1),{r:0,c:0})};H.Sheets.length>0&&(at.Sheet=H.Sheets.length-1),H.Names.push(at);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?x+=n.slice(w,o.index):w=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;B.Interior=ai(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dP(C,ne,n.slice(A,o.index)):A=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"));$6(ce),oe.push(ce)}else c.push([o[3],!1]),l=ai(o[0]),ce={a:l.Author};break;case"autofilter":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var qe=ai(o[0]);d["!autofilter"]={ref:cc(qe.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((l=c.pop())[0]!==o[3])throw new Error("Bad state: "+l.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return JE(n,r);var ot=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(o[3]){case"date1904":H.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(A,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else A=o.index+o[0].length;break;case"header":d["!margins"]||Wa(d["!margins"]={},"xlml"),isNaN(+je(o[0]).Margin)||(d["!margins"].header=+je(o[0]).Margin);break;case"footer":d["!margins"]||Wa(d["!margins"]={},"xlml"),isNaN(+je(o[0]).Margin)||(d["!margins"].footer=+je(o[0]).Margin);break;case"pagemargins":var Je=je(o[0]);d["!margins"]||Wa(d["!margins"]={},"xlml"),isNaN(+Je.Top)||(d["!margins"].top=+Je.Top),isNaN(+Je.Left)||(d["!margins"].left=+Je.Left),isNaN(+Je.Right)||(d["!margins"].right=+Je.Right),isNaN(+Je.Bottom)||(d["!margins"].bottom=+Je.Bottom);break;case"displayrighttoleft":H.Views||(H.Views=[]),H.Views[0]||(H.Views[0]={}),H.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?B6(D,ne,R,n.slice(A,o.index)):(R=o,A=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var be={};return!r.bookSheets&&!r.bookProps&&(be.Sheets=h),be.SheetNames=f,be.Workbook=H,be.SSF=Bt(Le),be.Props=C,be.Custprops=D,be}function Um(t,e){switch(Cg(e=e||{}),e.type||"base64"){case"base64":return Am(An(t),e);case"binary":case"buffer":case"file":return Am(t,e);case"array":return Am(Ks(t),e)}}function H6(t,e){var r=[];return t.Props&&r.push(pP(t.Props,e)),t.Custprops&&r.push(mP(t.Props,t.Custprops,e)),r.join("")}function z6(){return""}function G6(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(_e("NumberFormat",null,{"ss:Format":Tt(Le[n.numFmtId])}));var a={"ss:ID":"s"+(21+i)};r.push(_e("Style",s.join(""),a))}),_e("Styles",r.join(""))}function Gb(t){return _e("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Eg(t.Ref,{r:0,c:0})})}function q6(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Gb(i)))}return _e("Names",r.join(""))}function K6(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||s.push(Gb(o)))}return s.join("")}function X6(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(_e("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(_e("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(_e("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(_e("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(Lr("ProtectContents","True")),t["!protect"].objects&&i.push(Lr("ProtectObjects","True")),t["!protect"].scenarios&&i.push(Lr("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(Lr("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(Lr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){t["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":_e("WorksheetOptions",i.join(""),{xmlns:Tn.x})}function Y6(t){return t.map(function(e){var r=gF(e.t||""),n=_e("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return _e("Comment",n,{"ss:Author":e.a})}).join("")}function Q6(t,e,r,n,i,s,a){if(!t||t.v==null&&t.f==null)return"";var o={};if(t.f&&(o["ss:Formula"]="="+Tt(Eg(t.f,a))),t.F&&t.F.slice(0,e.length)==e){var c=Ht(t.F.slice(e.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==a.r?"":"["+(c.r-a.r)+"]")+"C"+(c.c==a.c?"":"["+(c.c-a.c)+"]")}if(t.l&&t.l.Target&&(o["ss:HRef"]=Tt(t.l.Target),t.l.Tooltip&&(o["x:HRefScreenTip"]=Tt(t.l.Tooltip))),r["!merges"])for(var l=r["!merges"],h=0;h!=l.length;++h)l[h].s.c!=a.c||l[h].s.r!=a.r||(l[h].e.c>l[h].s.c&&(o["ss:MergeAcross"]=l[h].e.c-l[h].s.c),l[h].e.r>l[h].s.r&&(o["ss:MergeDown"]=l[h].e.r-l[h].s.r));var f="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":f="Number",d=String(t.v);break;case"b":f="Boolean",d=t.v?"1":"0";break;case"e":f="Error",d=as[t.v];break;case"d":f="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Le[14]);break;case"s":f="String",d=mF(t.v||"");break}var m=Ys(n.cellXfs,t,n);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var v=t.v!=null?d:"",p=t.t=="z"?"":'<Data ss:Type="'+f+'">'+v+"</Data>";return(t.c||[]).length>0&&(p+=Y6(t.c)),_e("Cell",p,o)}function J6(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=dc(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function Z6(t,e,r,n){if(!t["!ref"])return"";var i=ut(t["!ref"]),s=t["!merges"]||[],a=0,o=[];t["!cols"]&&t["!cols"].forEach(function(_,T){zs(_);var S=!!_.width,b=ld(T,_),O={"ss:Index":T+1};S&&(O["ss:Width"]=xu(b.width)),_.hidden&&(O["ss:Hidden"]="1"),o.push(_e("Column",null,O))});for(var c=Array.isArray(t),l=i.s.r;l<=i.e.r;++l){for(var h=[J6(l,(t["!rows"]||[])[l])],f=i.s.c;f<=i.e.c;++f){var d=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>f)&&!(s[a].s.r>l)&&!(s[a].e.c<f)&&!(s[a].e.r<l)){(s[a].s.c!=f||s[a].s.r!=l)&&(d=!0);break}if(!d){var m={r:l,c:f},v=Ue(m),p=c?(t[l]||[])[f]:t[v];h.push(Q6(p,v,t,e,r,n,m))}}h.push("</Row>"),h.length>2&&o.push(h.join(""))}return o.join("")}function e8(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],a=s?K6(s,e,t,r):"";return a.length>0&&n.push("<Names>"+a+"</Names>"),a=s?Z6(s,e,t,r):"",a.length>0&&n.push("<Table>"+a+"</Table>"),n.push(X6(s,e,t,r)),n.join("")}function t8(t,e){e||(e={}),t.SSF||(t.SSF=Bt(Le)),t.SSF&&(gc(),td(t.SSF),e.revssf=nd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(H6(t,e)),r.push(z6(t,e)),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(_e("Worksheet",e8(n,e,t),{"ss:Name":Tt(t.SheetNames[n])}));return r[2]=G6(t,e),r[3]=q6(t,e),rr+_e("Workbook",r.join(""),{xmlns:Tn.ss,"xmlns:o":Tn.o,"xmlns:x":Tn.x,"xmlns:ss":Tn.ss,"xmlns:dt":Tn.dt,"xmlns:html":Tn.html})}function r8(t){var e={},r=t.content;if(r.l=28,e.AnsiUserType=r.read_shift(0,"lpstr-ansi"),e.AnsiClipboardFormat=qF(r),r.length-r.l<=4)return e;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,e.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(e.UnicodeClipboardFormat=KF(r),n=r.read_shift(4),n==0||n>40))return e;r.l-=4,e.Reserved2=r.read_shift(0,"lpwstr")}var n8=[60,1084,2066,2165,2175];function i8(t,e,r,n,i){var s=n,a=[],o=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(t){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),r.l+=s;for(var c=Zi(r,r.l),l=jm[c],h=0;l!=null&&n8.indexOf(c)>-1;)s=Zi(r,r.l+2),h=r.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),o=r.slice(h,r.l+4+s),a.push(o),r.l+=4+s,l=jm[c=Zi(r,r.l)];var f=Er(a);Mr(f,0);var d=0;f.lens=[];for(var m=0;m<a.length;++m)f.lens.push(d),d+=a[m].length;if(f.length<n)throw"XLS Record 0x"+t.toString(16)+" Truncated: "+f.length+" < "+n;return e.f(f,f.length,i)}function Ai(t,e,r){if(t.t!=="z"&&t.XF){var n=0;try{n=t.z||t.XF.numFmtId||0,e.cellNF&&(t.z=Le[n])}catch(s){if(e.WTF)throw s}if(!e||e.cellText!==!1)try{t.t==="e"?t.w=t.w||as[t.v]:n===0||n=="General"?t.t==="n"?(t.v|0)===t.v?t.w=t.v.toString(10):t.w=pu(t.v):t.w=$a(t.v):t.w=Kn(n,t.v,{date1904:!!r,dateNF:e&&e.dateNF})}catch(s){if(e.WTF)throw s}if(e.cellDates&&n&&t.t=="n"&&mc(Le[n]||String(n))){var i=Va(t.v);i&&(t.t="d",t.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Uf(t,e,r){return{v:t,ixfe:e,t:r}}function s8(t,e){var r={opts:{}},n={};Xt!=null&&e.dense==null&&(e.dense=Xt);var i=e.dense?[]:{},s={},a={},o=null,c=[],l="",h={},f,d="",m,v,p,_,T={},S=[],b,O,V=[],B=[],x={Sheets:[],WBProps:{date1904:!1},Views:[{}]},w={},E=function(Ke){return Ke<8?Ba[Ke]:Ke<64&&B[Ke-8]||Ba[Ke]},C=function(Ke,Ut,cn){var Nt=Ut.XF.data;if(!(!Nt||!Nt.patternType||!cn||!cn.cellStyles)){Ut.s={},Ut.s.patternType=Nt.patternType;var mi;(mi=yu(E(Nt.icvFore)))&&(Ut.s.fgColor={rgb:mi}),(mi=yu(E(Nt.icvBack)))&&(Ut.s.bgColor={rgb:mi})}},D=function(Ke,Ut,cn){if(!(ie>1)&&!(cn.sheetRows&&Ke.r>=cn.sheetRows)){if(cn.cellStyles&&Ut.XF&&Ut.XF.data&&C(Ke,Ut,cn),delete Ut.ixfe,delete Ut.XF,f=Ke,d=Ue(Ke),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),Ke.r<a.s.r&&(a.s.r=Ke.r),Ke.c<a.s.c&&(a.s.c=Ke.c),Ke.r+1>a.e.r&&(a.e.r=Ke.r+1),Ke.c+1>a.e.c&&(a.e.c=Ke.c+1),cn.cellFormula&&Ut.f){for(var Nt=0;Nt<S.length;++Nt)if(!(S[Nt][0].s.c>Ke.c||S[Nt][0].s.r>Ke.r)&&!(S[Nt][0].e.c<Ke.c||S[Nt][0].e.r<Ke.r)){Ut.F=Ge(S[Nt][0]),(S[Nt][0].s.c!=Ke.c||S[Nt][0].s.r!=Ke.r)&&delete Ut.f,Ut.f&&(Ut.f=""+$r(S[Nt][1],a,Ke,de,A));break}}cn.dense?(i[Ke.r]||(i[Ke.r]=[]),i[Ke.r][Ke.c]=Ut):i[d]=Ut}},A={enc:!1,sbcch:0,snames:[],sharedf:T,arrayf:S,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!e&&!!e.cellStyles,WTF:!!e&&!!e.wtf};e.password&&(A.password=e.password);var R,oe=[],ce=[],ke=[],we=[],Ne=!1,de=[];de.SheetNames=A.snames,de.sharedf=A.sharedf,de.arrayf=A.arrayf,de.names=[],de.XTI=[];var Ae=0,ie=0,j=0,G=[],H=[],W;A.codepage=1200,oi(1200);for(var ne=!1;t.l<t.length-1;){var me=t.l,ue=t.read_shift(2);if(ue===0&&Ae===10)break;var fe=t.l===t.length?0:t.read_shift(2),se=jm[ue];if(se&&se.f){if(e.bookSheets&&Ae===133&&ue!==133)break;if(Ae=ue,se.r===2||se.r==12){var We=t.read_shift(2);if(fe-=2,!A.enc&&We!==ue&&((We&255)<<8|We>>8)!==ue)throw new Error("rt mismatch: "+We+"!="+ue);se.r==12&&(t.l+=10,fe-=10)}var U={};if(ue===10?U=se.f(t,fe,A):U=i8(ue,se,t,fe,A),ie==0&&[9,521,1033,2057].indexOf(Ae)===-1)continue;switch(ue){case 34:r.opts.Date1904=x.WBProps.date1904=U;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(A.enc||(t.l=0),A.enc=U,!e.password)throw new Error("File is password-protected");if(U.valid==null)throw new Error("Encryption scheme unsupported");if(!U.valid)throw new Error("Password is incorrect");break;case 92:A.lastuser=U;break;case 66:var at=Number(U);switch(at){case 21010:at=1200;break;case 32768:at=1e4;break;case 32769:at=1252;break}oi(A.codepage=at),ne=!0;break;case 317:A.rrtabid=U;break;case 25:A.winlocked=U;break;case 439:r.opts.RefreshAll=U;break;case 12:r.opts.CalcCount=U;break;case 16:r.opts.CalcDelta=U;break;case 17:r.opts.CalcIter=U;break;case 13:r.opts.CalcMode=U;break;case 14:r.opts.CalcPrecision=U;break;case 95:r.opts.CalcSaveRecalc=U;break;case 15:A.CalcRefMode=U;break;case 2211:r.opts.FullCalc=U;break;case 129:U.fDialog&&(i["!type"]="dialog"),U.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),U.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:V.push(U);break;case 430:de.push([U]),de[de.length-1].XTI=[];break;case 35:case 547:de[de.length-1].push(U);break;case 24:case 536:W={Name:U.Name,Ref:$r(U.rgce,a,null,de,A)},U.itab>0&&(W.Sheet=U.itab-1),de.names.push(W),de[0]||(de[0]=[],de[0].XTI=[]),de[de.length-1].push(U),U.Name=="_xlnm._FilterDatabase"&&U.itab>0&&U.rgce&&U.rgce[0]&&U.rgce[0][0]&&U.rgce[0][0][0]=="PtgArea3d"&&(H[U.itab-1]={ref:Ge(U.rgce[0][0][1][2])});break;case 22:A.ExternCount=U;break;case 23:de.length==0&&(de[0]=[],de[0].XTI=[]),de[de.length-1].XTI=de[de.length-1].XTI.concat(U),de.XTI=de.XTI.concat(U);break;case 2196:if(A.biff<8)break;W!=null&&(W.Comment=U[1]);break;case 18:i["!protect"]=U;break;case 19:U!==0&&A.WTF&&console.error("Password verifier: "+U);break;case 133:s[U.pos]=U,A.snames.push(U.name);break;case 10:{if(--ie)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=Ge(a),e.sheetRows&&e.sheetRows<=a.e.r){var qe=a.e.r;a.e.r=e.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=Ge(a),a.e.r=qe}a.e.r++,a.e.c++}oe.length>0&&(i["!merges"]=oe),ce.length>0&&(i["!objects"]=ce),ke.length>0&&(i["!cols"]=ke),we.length>0&&(i["!rows"]=we),x.Sheets.push(w)}l===""?h=i:n[l]=i,i=e.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(A.biff===8&&(A.biff={9:2,521:3,1033:4}[ue]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[U.BIFFVer]||8),A.biffguess=U.BIFFVer==0,U.BIFFVer==0&&U.dt==4096&&(A.biff=5,ne=!0,oi(A.codepage=28591)),A.biff==8&&U.BIFFVer==0&&U.dt==16&&(A.biff=2),ie++)break;if(i=e.dense?[]:{},A.biff<8&&!ne&&(ne=!0,oi(A.codepage=e.codepage||1252)),A.biff<5||U.BIFFVer==0&&U.dt==4096){l===""&&(l="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:t.l-fe,name:l};s[ot.pos]=ot,A.snames.push(l)}else l=(s[me]||{name:""}).name;U.dt==32&&(i["!type"]="chart"),U.dt==64&&(i["!type"]="macro"),oe=[],ce=[],A.arrayf=S=[],ke=[],we=[],Ne=!1,w={Hidden:(s[me]||{hs:0}).hs,name:l}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(e.dense?(i[U.r]||[])[U.c]:i[Ue({c:U.c,r:U.r})])&&++U.c,b={ixfe:U.ixfe,XF:V[U.ixfe]||{},v:U.val,t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 5:case 517:b={ixfe:U.ixfe,XF:V[U.ixfe],v:U.val,t:U.t},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 638:b={ixfe:U.ixfe,XF:V[U.ixfe],v:U.rknum,t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 189:for(var Je=U.c;Je<=U.C;++Je){var be=U.rkrec[Je-U.c][0];b={ixfe:be,XF:V[be],v:U.rkrec[Je-U.c][1],t:"n"},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:Je,r:U.r},b,e)}break;case 6:case 518:case 1030:{if(U.val=="String"){o=U;break}if(b=Uf(U.val,U.cell.ixfe,U.tt),b.XF=V[b.ixfe],e.cellFormula){var jt=U.formula;if(jt&&jt[0]&&jt[0][0]&&jt[0][0][0]=="PtgExp"){var tn=jt[0][0][1][0],fn=jt[0][0][1][1],dn=Ue({r:tn,c:fn});T[dn]?b.f=""+$r(U.formula,a,U.cell,de,A):b.F=((e.dense?(i[tn]||[])[fn]:i[dn])||{}).F}else b.f=""+$r(U.formula,a,U.cell,de,A)}j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D(U.cell,b,e),o=U}break;case 7:case 519:if(o)o.val=U,b=Uf(U,o.cell.ixfe,"s"),b.XF=V[b.ixfe],e.cellFormula&&(b.f=""+$r(o.formula,a,o.cell,de,A)),j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D(o.cell,b,e),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{S.push(U);var vs=Ue(U[0].s);if(m=e.dense?(i[U[0].s.r]||[])[U[0].s.c]:i[vs],e.cellFormula&&m){if(!o||!vs||!m)break;m.f=""+$r(U[1],a,U[0],de,A),m.F=Ge(U[0])}}break;case 1212:{if(!e.cellFormula)break;if(d){if(!o)break;T[Ue(o.cell)]=U[0],m=e.dense?(i[o.cell.r]||[])[o.cell.c]:i[Ue(o.cell)],(m||{}).f=""+$r(U[0],a,f,de,A)}}break;case 253:b=Uf(c[U.isst].t,U.ixfe,"s"),c[U.isst].h&&(b.h=c[U.isst].h),b.XF=V[b.ixfe],j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 513:e.sheetStubs&&(b={ixfe:U.ixfe,XF:V[U.ixfe],t:"z"},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e));break;case 190:if(e.sheetStubs)for(var pi=U.c;pi<=U.C;++pi){var Sr=U.ixfe[pi-U.c];b={ixfe:Sr,XF:V[Sr],t:"z"},j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:pi,r:U.r},b,e)}break;case 214:case 516:case 4:b=Uf(U.val,U.ixfe,"s"),b.XF=V[b.ixfe],j>0&&(b.z=G[b.ixfe>>8&63]),Ai(b,e,r.opts.Date1904),D({c:U.c,r:U.r},b,e);break;case 0:case 512:ie===1&&(a=U);break;case 252:c=U;break;case 1054:if(A.biff==4){G[j++]=U[1];for(var pn=0;pn<j+163&&Le[pn]!=U[1];++pn);pn>=163&&ts(U[1],j+163)}else ts(U[1],U[0]);break;case 30:{G[j++]=U;for(var Fn=0;Fn<j+163&&Le[Fn]!=U;++Fn);Fn>=163&&ts(U,j+163)}break;case 229:oe=oe.concat(U);break;case 93:ce[U.cmo[0]]=A.lastobj=U;break;case 438:A.lastobj.TxO=U;break;case 127:A.lastobj.ImData=U;break;case 440:for(_=U[0].s.r;_<=U[0].e.r;++_)for(p=U[0].s.c;p<=U[0].e.c;++p)m=e.dense?(i[_]||[])[p]:i[Ue({c:p,r:_})],m&&(m.l=U[1]);break;case 2048:for(_=U[0].s.r;_<=U[0].e.r;++_)for(p=U[0].s.c;p<=U[0].e.c;++p)m=e.dense?(i[_]||[])[p]:i[Ue({c:p,r:_})],m&&m.l&&(m.l.Tooltip=U[1]);break;case 28:{if(A.biff<=5&&A.biff>=2)break;m=e.dense?(i[U[0].r]||[])[U[0].c]:i[Ue(U[0])];var zt=ce[U[2]];m||(e.dense?(i[U[0].r]||(i[U[0].r]=[]),m=i[U[0].r][U[0].c]={t:"z"}):m=i[Ue(U[0])]={t:"z"},a.e.r=Math.max(a.e.r,U[0].r),a.s.r=Math.min(a.s.r,U[0].r),a.e.c=Math.max(a.e.c,U[0].c),a.s.c=Math.min(a.s.c,U[0].c)),m.c||(m.c=[]),v={a:U[1],t:zt.TxO.t},m.c.push(v)}break;case 2173:GM(V[U.ixfe],U.ext);break;case 125:{if(!A.cellStyles)break;for(;U.e>=U.s;)ke[U.e--]={width:U.w/256,level:U.level||0,hidden:!!(U.flags&1)},Ne||(Ne=!0,yg(U.w/256)),zs(ke[U.e+1])}break;case 520:{var dt={};U.level!=null&&(we[U.r]=dt,dt.level=U.level),U.hidden&&(we[U.r]=dt,dt.hidden=!0),U.hpt&&(we[U.r]=dt,dt.hpt=U.hpt,dt.hpx=dc(U.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Wa(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ue]]=U;break;case 161:i["!margins"]||Wa(i["!margins"]={}),i["!margins"].header=U.header,i["!margins"].footer=U.footer;break;case 574:U.RTL&&(x.Views[0].RTL=!0);break;case 146:B=U;break;case 2198:R=U;break;case 140:O=U;break;case 442:l?w.CodeName=U||w.name:x.WBProps.CodeName=U||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+ue.toString(16)),t.l+=fe}return r.SheetNames=Yt(s).sort(function(rn,Ke){return Number(rn)-Number(Ke)}).map(function(rn){return s[rn].name}),e.bookSheets||(r.Sheets=n),!r.SheetNames.length&&h["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=h)):r.Preamble=h,r.Sheets&&H.forEach(function(rn,Ke){r.Sheets[r.SheetNames[Ke]]["!autofilter"]=rn}),r.Strings=c,r.SSF=Bt(Le),A.enc&&(r.Encryption=A.enc),R&&(r.Themes=R),r.Metadata={},O!==void 0&&(r.Metadata.Country=O),de.names.length>0&&(x.Names=de.names),r.Workbook=x,r}var hu={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function a8(t,e,r){var n=Re.find(t,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=CE(n,Om,hu.DSI);for(var s in i)e[s]=i[s]}catch(l){if(r.WTF)throw l}var a=Re.find(t,"/!SummaryInformation");if(a&&a.size>0)try{var o=CE(a,Nm,hu.SI);for(var c in o)e[c]==null&&(e[c]=o[c])}catch(l){if(r.WTF)throw l}e.HeadingPairs&&e.TitlesOfParts&&(zT(e.HeadingPairs,e.TitlesOfParts,e,r),delete e.HeadingPairs,delete e.TitlesOfParts)}function o8(t,e){var r=[],n=[],i=[],s=0,a,o=iE(Om,"n"),c=iE(Nm,"n");if(t.Props)for(a=Yt(t.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Props[a[s]]]);if(t.Custprops)for(a=Yt(t.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?r:Object.prototype.hasOwnProperty.call(c,a[s])?n:i).push([a[s],t.Custprops[a[s]]]);var l=[];for(s=0;s<i.length;++s)JT.indexOf(i[s][0])>-1||HT.indexOf(i[s][0])>-1||i[s][1]!=null&&l.push(i[s]);n.length&&Re.utils.cfb_add(e,"/SummaryInformation",kE(n,hu.SI,c,Nm)),(r.length||l.length)&&Re.utils.cfb_add(e,"/DocumentSummaryInformation",kE(r,hu.DSI,o,Om,l.length?l:null,hu.UDI))}function qb(t,e){e||(e={}),Cg(e),zm(),e.codepage&&Hm(e.codepage);var r,n;if(t.FullPaths){if(Re.find(t,"/encryption"))throw new Error("File is password-protected");r=Re.find(t,"!CompObj"),n=Re.find(t,"/Workbook")||Re.find(t,"/Book")}else{switch(e.type){case"base64":t=bn(An(t));break;case"binary":t=bn(t);break;case"buffer":break;case"array":Array.isArray(t)||(t=Array.prototype.slice.call(t));break}Mr(t,0),n={content:t}}var i,s;if(r&&r8(r),e.bookProps&&!e.bookSheets)i={};else{var a=Ze?"buffer":"array";if(n&&n.content)i=s8(n.content,e);else if((s=Re.find(t,"PerfectOffice_MAIN"))&&s.content)i=ja.to_workbook(s.content,(e.type=a,e));else if((s=Re.find(t,"NativeContent_MAIN"))&&s.content)i=ja.to_workbook(s.content,(e.type=a,e));else throw(s=Re.find(t,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");e.bookVBA&&t.FullPaths&&Re.find(t,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=x4(t))}var o={};return t.FullPaths&&a8(t,o,e),i.Props=i.Custprops=o,e.bookFiles&&(i.cfb=t),i}function c8(t,e){var r=e||{},n=Re.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Re.utils.cfb_add(n,i,Kb(t,r)),r.biff==8&&(t.Props||t.Custprops)&&o8(t,n),r.biff==8&&t.vbaraw&&w4(n,Re.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var Tu={0:{f:F3},1:{f:U3},2:{f:sV},3:{f:K3},4:{f:H3},5:{f:rV},6:{f:uV},7:{f:J3},8:{f:vV},9:{f:gV},10:{f:pV},11:{f:mV},12:{f:W3},13:{f:oV},14:{f:Y3},15:{f:G3},16:{f:Bb},17:{f:fV},18:{f:eV},19:{f:lg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:f6},40:{},42:{},43:{f:uM},44:{f:cM},45:{f:dM},46:{f:mM},47:{f:pM},48:{},49:{f:NF},50:{},51:{f:XM},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lb},62:{f:lV},63:{f:i4},64:{f:PV},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:kV},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:V3},148:{f:N3,p:16},151:{f:TV},152:{},153:{f:l6},154:{},155:{},156:{f:o6},157:{},158:{},159:{T:1,f:IN},160:{T:-1},161:{T:1,f:Za},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_V},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:qM},336:{T:-1},337:{f:JM,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cb},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:bV},427:{f:IV},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:SV},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:L3},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wV},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:m4},633:{T:1},634:{T:-1},635:{T:1,f:d4},636:{T:-1},637:{f:BF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:YV},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:OV},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},jm={6:{f:bm},10:{f:js},12:{f:or},13:{f:or},14:{f:er},15:{f:er},16:{f:zr},17:{f:er},18:{f:er},19:{f:or},20:{f:NE},21:{f:NE},23:{f:cb},24:{f:LE},25:{f:er},26:{},27:{},28:{f:OO},29:{},34:{f:er},35:{f:ME},38:{f:zr},39:{f:zr},40:{f:zr},41:{f:zr},42:{f:er},43:{f:er},47:{f:GN},49:{f:oO},51:{f:or},60:{},61:{f:rO},64:{f:er},65:{f:aO},66:{f:or},77:{},80:{},81:{},82:{},85:{f:or},89:{},90:{},91:{},92:{f:zP},93:{f:LO},94:{},95:{f:er},96:{},97:{},99:{f:er},125:{f:lb},128:{f:EO},129:{f:qP},130:{f:or},131:{f:er},132:{f:er},133:{f:KP},134:{},140:{f:zO},141:{f:or},144:{},146:{f:KO},151:{},152:{},153:{},154:{},155:{},156:{f:or},157:{},158:{},160:{f:tN},161:{f:QO},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:_O},190:{f:yO},193:{f:js},197:{},198:{},199:{},200:{},201:{},202:{f:er},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:or},220:{},221:{f:er},222:{},224:{f:wO},225:{f:HP},226:{f:js},227:{},229:{f:NO},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:YP},253:{f:lO},255:{f:JP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:ZT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:er},353:{f:js},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:SO},431:{f:er},432:{},433:{},434:{},437:{},438:{f:UO},439:{f:er},440:{f:jO},441:{},442:{f:Cu},443:{},444:{f:or},445:{},446:{},448:{f:js},449:{f:tO,r:2},450:{f:js},512:{f:FE},513:{f:eN},515:{f:IO},516:{f:hO},517:{f:OE},519:{f:rN},520:{f:ZP},523:{},545:{f:VE},549:{f:RE},566:{},574:{f:iO},638:{f:vO},659:{},1048:{},1054:{f:dO},1084:{},1212:{f:RO},2048:{f:$O},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Lf},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:js},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:XO,r:12},2173:{f:zM,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:er,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:DO,r:12},2197:{},2198:{f:BM,r:12},2199:{},2200:{},2201:{},2202:{f:FO,r:12},2203:{f:js},2204:{},2205:{},2206:{},2207:{},2211:{f:eO},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:or},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:JO},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:qO},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:FE},1:{},2:{f:oN},3:{f:sN},4:{f:iN},5:{f:OE},7:{f:lN},8:{},9:{f:Lf},11:{},22:{f:or},30:{f:mO},31:{},32:{},33:{f:VE},36:{},37:{f:RE},50:{f:uN},62:{},52:{},67:{},68:{f:or},69:{},86:{},126:{},127:{f:nN},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:hN},223:{},234:{},354:{},421:{},518:{f:bm},521:{f:Lf},536:{f:LE},547:{f:ME},561:{},579:{},1030:{f:bm},1033:{f:Lf},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function ye(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,a=t.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&ag(r)&&t.push(r)}}function l8(t,e,r,n){var i=n||(r||[]).length||0;if(i<=8224)return ye(t,e,r,i);var s=e;if(!isNaN(s)){for(var a=r.parts||[],o=0,c=0,l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;var h=t.next(4);for(h.write_shift(2,s),h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l;c<i;){for(h=t.next(4),h.write_shift(2,60),l=0;l+(a[o]||8224)<=8224;)l+=a[o]||8224,o++;h.write_shift(2,l),t.push(r.slice(c,c+l)),c+=l}}}function Fu(t,e,r){return t||(t=re(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function u8(t,e,r,n){var i=re(9);return Fu(i,t,e),eb(r,n||"b",i),i}function h8(t,e,r){var n=re(8+2*r.length);return Fu(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function f8(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?dr(Vt(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?ye(t,2,cN(r,n,i)):ye(t,3,aN(r,n,i));return;case"b":case"e":ye(t,5,u8(r,n,e.v,e.t));return;case"s":case"str":ye(t,4,h8(r,n,(e.v||"").slice(0,255)));return}ye(t,1,Fu(null,r,n))}function d8(t,e,r,n){var i=Array.isArray(e),s=ut(e["!ref"]||"A1"),a,o="",c=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=Ge(s)}for(var l=s.s.r;l<=s.e.r;++l){o=tr(l);for(var h=s.s.c;h<=s.e.c;++h){l===s.s.r&&(c[h]=$t(h)),a=c[h]+o;var f=i?(e[l]||[])[h]:e[a];f&&f8(t,f,l,h,n)}}}function p8(t,e){var r=e||{};Xt!=null&&r.dense==null&&(r.dense=Xt);for(var n=un(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return ye(n,r.biff==4?1033:r.biff==3?521:9,gg(t,16,r)),d8(n,t.Sheets[t.SheetNames[i]],i,r,t),ye(n,10),n.end()}function m8(t,e,r){ye(t,49,cO({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function g8(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&ye(t,1054,pO(i,e[i],r))})}function v8(t,e){var r=re(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),ye(t,2151,r),r=re(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),sb(ut(e["!ref"]||"A1"),r),r.write_shift(4,4),ye(t,2152,r)}function _8(t,e){for(var r=0;r<16;++r)ye(t,224,PE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){ye(t,224,PE(n,0,e))})}function y8(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];ye(t,440,WO(n)),n[1].Tooltip&&ye(t,2048,HO(n))}delete e["!links"]}function x8(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&ye(t,125,YO(ld(i,n),i))})}}function w8(t,e,r,n,i){var s=16+Ys(i.cellXfs,e,i);if(e.v==null&&!e.bf){ye(t,513,qa(r,n,s));return}if(e.bf)ye(t,6,qL(e,r,n,i,s));else switch(e.t){case"d":case"n":var a=e.t=="d"?dr(Vt(e.v)):e.v;ye(t,515,AO(r,n,a,s,i));break;case"b":case"e":ye(t,517,bO(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var o=bg(i.Strings,e.v,i.revStrings);ye(t,253,uO(r,n,o,s,i))}else ye(t,516,fO(r,n,(e.v||"").slice(0,255),s,i));break;default:ye(t,513,qa(r,n,s))}}function E8(t,e,r){var n=un(),i=r.SheetNames[t],s=r.Sheets[i]||{},a=(r||{}).Workbook||{},o=(a.Sheets||[])[t]||{},c=Array.isArray(s),l=e.biff==8,h,f="",d=[],m=ut(s["!ref"]||"A1"),v=l?65536:16384;if(m.e.c>255||m.e.r>=v){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}ye(n,2057,gg(r,16,e)),ye(n,13,Gn(1)),ye(n,12,Gn(100)),ye(n,15,an(!0)),ye(n,17,an(!1)),ye(n,16,za(.001)),ye(n,95,an(!0)),ye(n,42,an(!1)),ye(n,43,an(!1)),ye(n,130,Gn(1)),ye(n,128,TO([0,0])),ye(n,131,an(!1)),ye(n,132,an(!1)),l&&x8(n,s["!cols"]),ye(n,512,gO(m,e)),l&&(s["!links"]=[]);for(var p=m.s.r;p<=m.e.r;++p){f=tr(p);for(var _=m.s.c;_<=m.e.c;++_){p===m.s.r&&(d[_]=$t(_)),h=d[_]+f;var T=c?(s[p]||[])[_]:s[h];T&&(w8(n,T,p,_,e),l&&T.l&&s["!links"].push([h,T.l]))}}var S=o.CodeName||o.name||i;return l&&ye(n,574,sO((a.Views||[])[0])),l&&(s["!merges"]||[]).length&&ye(n,229,MO(s["!merges"])),l&&y8(n,s),ye(n,442,tb(S,e)),l&&v8(n,s),ye(n,10),n.end()}function T8(t,e,r){var n=un(),i=(t||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=r.biff==8,c=r.biff==5;if(ye(n,2057,gg(t,5,r)),r.bookType=="xla"&&ye(n,135),ye(n,225,o?Gn(1200):null),ye(n,193,bP(2)),c&&ye(n,191),c&&ye(n,192),ye(n,226),ye(n,92,GP("SheetJS",r)),ye(n,66,Gn(o?1200:1252)),o&&ye(n,353,Gn(0)),o&&ye(n,448),ye(n,317,ZO(t.SheetNames.length)),o&&t.vbaraw&&ye(n,211),o&&t.vbaraw){var l=a.CodeName||"ThisWorkbook";ye(n,442,tb(l,r))}ye(n,156,Gn(17)),ye(n,25,an(!1)),ye(n,18,an(!1)),ye(n,19,Gn(0)),o&&ye(n,431,an(!1)),o&&ye(n,444,Gn(0)),ye(n,61,nO(r)),ye(n,64,an(!1)),ye(n,141,Gn(0)),ye(n,34,an(t6(t)=="true")),ye(n,14,an(!0)),o&&ye(n,439,an(!1)),ye(n,218,Gn(0)),m8(n,t,r),g8(n,t.SSF,r),_8(n,r),o&&ye(n,352,an(!1));var h=n.end(),f=un();o&&ye(f,140,GO()),o&&r.Strings&&l8(f,252,QP(r.Strings,r)),ye(f,10);var d=f.end(),m=un(),v=0,p=0;for(p=0;p<t.SheetNames.length;++p)v+=(o?12:11)+(o?2:1)*t.SheetNames[p].length;var _=h.length+v+d.length;for(p=0;p<t.SheetNames.length;++p){var T=s[p]||{};ye(m,133,XP({pos:_,hs:T.Hidden||0,dt:0,name:t.SheetNames[p]},r)),_+=e[p].length}var S=m.end();if(v!=S.length)throw new Error("BS8 "+v+" != "+S.length);var b=[];return h.length&&b.push(h),S.length&&b.push(S),d.length&&b.push(d),Er(b)}function b8(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=Bt(Le)),t&&t.SSF&&(gc(),td(t.SSF),r.revssf=nd(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,kg(r),r.cellXfs=[],Ys(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=E8(i,r,t);return n.unshift(T8(t,n,r)),Er(n)}function Kb(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=hn(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return b8(t,e);case 4:case 3:case 2:return p8(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function KE(t,e){var r=e||{};Xt!=null&&r.dense==null&&(r.dense=Xt);var n=r.dense?[]:{};t=t.replace(/<!--.*?-->/g,"");var i=t.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=t.match(/<\/table/i),a=i.index,o=s&&s.index||t.length,c=cF(t.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),l=-1,h=0,f=0,d=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<c.length;++a){var p=c[a].trim(),_=p.slice(0,3).toLowerCase();if(_=="<tr"){if(++l,r.sheetRows&&r.sheetRows<=l){--l;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var T=p.split(/<\/t[dh]>/i);for(o=0;o<T.length;++o){var S=T[o].trim();if(S.match(/<t[dh]/i)){for(var b=S,O=0;b.charAt(0)=="<"&&(O=b.indexOf(">"))>-1;)b=b.slice(O+1);for(var V=0;V<v.length;++V){var B=v[V];B.s.c==h&&B.s.r<l&&l<=B.e.r&&(h=B.e.c+1,V=-1)}var x=je(S.slice(0,S.indexOf(">")));d=x.colspan?+x.colspan:1,((f=+x.rowspan)>1||d>1)&&v.push({s:{r:l,c:h},e:{r:l+(f||1)-1,c:h+d-1}});var w=x.t||x["data-t"]||"";if(!b.length){h+=d;continue}if(b=TT(b),m.s.r>l&&(m.s.r=l),m.e.r<l&&(m.e.r=l),m.s.c>h&&(m.s.c=h),m.e.c<h&&(m.e.c=h),!b.length){h+=d;continue}var E={t:"s",v:b};r.raw||!b.trim().length||w=="s"||(b==="TRUE"?E={t:"b",v:!0}:b==="FALSE"?E={t:"b",v:!1}:isNaN(li(b))?isNaN(hc(b).getDate())||(E={t:"d",v:Vt(b)},r.cellDates||(E={t:"n",v:dr(E.v)}),E.z=r.dateNF||Le[14]):E={t:"n",v:li(b)}),r.dense?(n[l]||(n[l]=[]),n[l][h]=E):n[Ue({r:l,c:h})]=E,h+=d}}}}return n["!ref"]=Ge(m),v.length&&(n["!merges"]=v),n}function I8(t,e,r,n){for(var i=t["!merges"]||[],s=[],a=e.s.c;a<=e.e.c;++a){for(var o=0,c=0,l=0;l<i.length;++l)if(!(i[l].s.r>r||i[l].s.c>a)&&!(i[l].e.r<r||i[l].e.c<a)){if(i[l].s.r<r||i[l].s.c<a){o=-1;break}o=i[l].e.r-i[l].s.r+1,c=i[l].e.c-i[l].s.c+1;break}if(!(o<0)){var h=Ue({r,c:a}),f=n.dense?(t[r]||[])[a]:t[h],d=f&&f.v!=null&&(f.h||Zm(f.w||(ns(f),f.w)||""))||"",m={};o>1&&(m.rowspan=o),c>1&&(m.colspan=c),n.editable?d='<span contenteditable="true">'+d+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+f.l.Target+'">'+d+"</a>")),m.id=(n.id||"sjs")+"-"+h,s.push(_e("td",d,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var A8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',S8="</body></html>";function C8(t,e){var r=t.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Xs(KE(r[0],e),e);var n=Fg();return r.forEach(function(i,s){Pg(n,KE(i,e),"Sheet"+(s+1))}),n}function k8(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Xb(t,e){var r=e||{},n=r.header!=null?r.header:A8,i=r.footer!=null?r.footer:S8,s=[n],a=hn(t["!ref"]);r.dense=Array.isArray(t),s.push(k8(t,a,r));for(var o=a.s.r;o<=a.e.r;++o)s.push(I8(t,a,o,r));return s.push("</table>"+i),s.join("")}function Yb(t,e,r){var n=r||{};Xt!=null&&(n.dense=Xt);var i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var a=typeof n.origin=="string"?Ht(n.origin):n.origin;i=a.r,s=a.c}var o=e.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),l={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var h=hn(t["!ref"]);l.s.r=Math.min(l.s.r,h.s.r),l.s.c=Math.min(l.s.c,h.s.c),l.e.r=Math.max(l.e.r,h.e.r),l.e.c=Math.max(l.e.c,h.e.c),i==-1&&(l.e.r=i=h.e.r+1)}var f=[],d=0,m=t["!rows"]||(t["!rows"]=[]),v=0,p=0,_=0,T=0,S=0,b=0;for(t["!cols"]||(t["!cols"]=[]);v<o.length&&p<c;++v){var O=o[v];if(XE(O)){if(n.display)continue;m[p]={hidden:!0}}var V=O.children;for(_=T=0;_<V.length;++_){var B=V[_];if(!(n.display&&XE(B))){var x=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):TT(B.innerHTML),w=B.getAttribute("data-z")||B.getAttribute("z");for(d=0;d<f.length;++d){var E=f[d];E.s.c==T+s&&E.s.r<p+i&&p+i<=E.e.r&&(T=E.e.c+1-s,d=-1)}b=+B.getAttribute("colspan")||1,((S=+B.getAttribute("rowspan")||1)>1||b>1)&&f.push({s:{r:p+i,c:T+s},e:{r:p+i+(S||1)-1,c:T+s+(b||1)-1}});var C={t:"s",v:x},D=B.getAttribute("data-t")||B.getAttribute("t")||"";x!=null&&(x.length==0?C.t=D||"z":n.raw||x.trim().length==0||D=="s"||(x==="TRUE"?C={t:"b",v:!0}:x==="FALSE"?C={t:"b",v:!1}:isNaN(li(x))?isNaN(hc(x).getDate())||(C={t:"d",v:Vt(x)},n.cellDates||(C={t:"n",v:dr(C.v)}),C.z=n.dateNF||Le[14]):C={t:"n",v:li(x)})),C.z===void 0&&w!=null&&(C.z=w);var A="",R=B.getElementsByTagName("A");if(R&&R.length)for(var oe=0;oe<R.length&&!(R[oe].hasAttribute("href")&&(A=R[oe].getAttribute("href"),A.charAt(0)!="#"));++oe);A&&A.charAt(0)!="#"&&(C.l={Target:A}),n.dense?(t[p+i]||(t[p+i]=[]),t[p+i][T+s]=C):t[Ue({c:T+s,r:p+i})]=C,l.e.c<T+s&&(l.e.c=T+s),T+=b}}++p}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),l.e.r=Math.max(l.e.r,p-1+i),t["!ref"]=Ge(l),p>=c&&(t["!fullref"]=Ge((l.e.r=o.length-v+p-1+i,l))),t}function Qb(t,e){var r=e||{},n=r.dense?[]:{};return Yb(n,t,e)}function D8(t,e){return Xs(Qb(t,e),e)}function XE(t){var e="",r=R8(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function R8(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function F8(t){var e=t.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=lt(e.replace(/<[^>]*>/g,""));return[r]}var YE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Jb(t,e){var r=e||{};Xt!=null&&r.dense==null&&(r.dense=Xt);var n=eg(t),i=[],s,a,o={name:""},c="",l=0,h,f,d={},m=[],v=r.dense?[]:{},p,_,T={value:""},S="",b=0,O,V=[],B=-1,x=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},E=0,C={},D=[],A={},R=0,oe=0,ce=[],ke=1,we=1,Ne=[],de={Names:[]},Ae={},ie=["",""],j=[],G={},H="",W=0,ne=!1,me=!1,ue=0;for(vu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");p=vu.exec(n);)switch(p[3]=p[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":p[1]==="/"?(w.e.c>=w.s.c&&w.e.r>=w.s.r?v["!ref"]=Ge(w):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=w.e.r&&(v["!fullref"]=v["!ref"],w.e.r=r.sheetRows-1,v["!ref"]=Ge(w)),D.length&&(v["!merges"]=D),ce.length&&(v["!rows"]=ce),h.name=h.\u540D\u79F0||h.name,typeof JSON<"u"&&JSON.stringify(h),m.push(h.name),d[h.name]=v,me=!1):p[0].charAt(p[0].length-2)!=="/"&&(h=je(p[0],!1),B=x=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,v=r.dense?[]:{},D=[],ce=[],me=!0);break;case"table-row-group":p[1]==="/"?--E:++E;break;case"table-row":case"\u884C":if(p[1]==="/"){B+=ke,ke=1;break}if(f=je(p[0],!1),f.\u884C\u53F7?B=f.\u884C\u53F7-1:B==-1&&(B=0),ke=+f["number-rows-repeated"]||1,ke<10)for(ue=0;ue<ke;++ue)E>0&&(ce[B+ue]={level:E});x=-1;break;case"covered-table-cell":p[1]!=="/"&&++x,r.sheetStubs&&(r.dense?(v[B]||(v[B]=[]),v[B][x]={t:"z"}):v[Ue({r:B,c:x})]={t:"z"}),S="",V=[];break;case"table-cell":case"\u6570\u636E":if(p[0].charAt(p[0].length-2)==="/")++x,T=je(p[0],!1),we=parseInt(T["number-columns-repeated"]||"1",10),_={t:"z",v:null},T.formula&&r.cellFormula!=!1&&(_.f=zE(lt(T.formula))),(T.\u6570\u636E\u7C7B\u578B||T["value-type"])=="string"&&(_.t="s",_.v=lt(T["string-value"]||""),r.dense?(v[B]||(v[B]=[]),v[B][x]=_):v[Ue({r:B,c:x})]=_),x+=we-1;else if(p[1]!=="/"){++x,S="",b=0,V=[],we=1;var fe=ke?B+ke-1:B;if(x>w.e.c&&(w.e.c=x),x<w.s.c&&(w.s.c=x),B<w.s.r&&(w.s.r=B),fe>w.e.r&&(w.e.r=fe),T=je(p[0],!1),j=[],G={},_={t:T.\u6570\u636E\u7C7B\u578B||T["value-type"],v:null},r.cellFormula)if(T.formula&&(T.formula=lt(T.formula)),T["number-matrix-columns-spanned"]&&T["number-matrix-rows-spanned"]&&(R=parseInt(T["number-matrix-rows-spanned"],10)||0,oe=parseInt(T["number-matrix-columns-spanned"],10)||0,A={s:{r:B,c:x},e:{r:B+R-1,c:x+oe-1}},_.F=Ge(A),Ne.push([A,_.F])),T.formula)_.f=zE(T.formula);else for(ue=0;ue<Ne.length;++ue)B>=Ne[ue][0].s.r&&B<=Ne[ue][0].e.r&&x>=Ne[ue][0].s.c&&x<=Ne[ue][0].e.c&&(_.F=Ne[ue][1]);switch((T["number-columns-spanned"]||T["number-rows-spanned"])&&(R=parseInt(T["number-rows-spanned"],10)||0,oe=parseInt(T["number-columns-spanned"],10)||0,A={s:{r:B,c:x},e:{r:B+R-1,c:x+oe-1}},D.push(A)),T["number-columns-repeated"]&&(we=parseInt(T["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Lt(T["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(T.value);break;case"percentage":_.t="n",_.v=parseFloat(T.value);break;case"currency":_.t="n",_.v=parseFloat(T.value);break;case"date":_.t="d",_.v=Vt(T["date-value"]),r.cellDates||(_.t="n",_.v=dr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=sF(T["time-value"])/86400,r.cellDates&&(_.t="d",_.v=id(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(T.\u6570\u636E\u6570\u503C);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",T["string-value"]!=null&&(S=lt(T["string-value"]),V=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(ne=!1,_.t==="s"&&(_.v=S||"",V.length&&(_.R=V),ne=b==0),Ae.Target&&(_.l=Ae),j.length>0&&(_.c=j,j=[]),S&&r.cellText!==!1&&(_.w=S),ne&&(_.t="z",delete _.v),(!ne||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=B))for(var se=0;se<ke;++se){if(we=parseInt(T["number-columns-repeated"]||"1",10),r.dense)for(v[B+se]||(v[B+se]=[]),v[B+se][x]=se==0?_:Bt(_);--we>0;)v[B+se][x+we]=Bt(_);else for(v[Ue({r:B+se,c:x})]=_;--we>0;)v[Ue({r:B+se,c:x+we})]=Bt(_);w.e.c<=x&&(w.e.c=x)}we=parseInt(T["number-columns-repeated"]||"1",10),x+=we-1,we=0,_={},S="",V=[]}Ae={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!0]);break;case"annotation":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s;G.t=S,V.length&&(G.R=V),G.a=H,j.push(G)}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);H="",W=0,S="",b=0,V=[];break;case"creator":p[1]==="/"?H=n.slice(W,p.index):W=p.index+p[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(p[1]==="/"){if((s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&i.push([p[3],!1]);S="",b=0,V=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(p[1]==="/"){if(C[o.name]=c,(s=i.pop())[0]!==p[3])throw"Bad state: "+s}else p[0].charAt(p[0].length-2)!=="/"&&(c="",o=je(p[0],!1),i.push([p[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=je(p[0],!1),c+=YE[p[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=je(p[0],!1),c+=YE[p[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(p[0].slice(-2)==="/>")break;if(p[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(l,p.index);break}else l=p.index+p[0].length;break;case"named-range":a=je(p[0],!1),ie=Im(a["cell-range-address"]);var We={Name:a.name,Ref:ie[0]+"!"+ie[1]};me&&(We.Sheet=m.length),de.Names.push(We);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(p[1]==="/"&&(!T||!T["string-value"])){var U=F8(n.slice(b,p.index),O);S=(S.length>0?S+`
`:"")+U[0]}else O=je(p[0],!1),b=p.index+p[0].length;break;case"s":break;case"database-range":if(p[1]==="/")break;try{ie=Im(je(p[0])["target-range-address"]),d[ie[0]]["!autofilter"]={ref:ie[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(p[1]!=="/"){if(Ae=je(p[0],!1),!Ae.href)break;Ae.Target=lt(Ae.href),delete Ae.href,Ae.Target.charAt(0)=="#"&&Ae.Target.indexOf(".")>-1?(ie=Im(Ae.Target.slice(1)),Ae.Target="#"+ie[0]+"!"+ie[1]):Ae.Target.match(/^\.\.[\\\/]/)&&(Ae.Target=Ae.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(p[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(r.WTF)throw new Error(p)}}var at={Sheets:d,SheetNames:m,Workbook:de};return r.bookSheets&&delete at.Sheets,at}function QE(t,e){e=e||{},zn(t,"META-INF/manifest.xml")&&sP(ar(t,"META-INF/manifest.xml"),e);var r=In(t,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Jb(At(r),e);return zn(t,"meta.xml")&&(n.Props=WT(ar(t,"meta.xml"))),n}function JE(t,e){return Jb(t,e)}var P8=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+gu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return rr+e}}(),ZE=function(){var t=function(s){return Tt(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,a,o){var c=[];c.push('      <table:table table:name="'+Tt(a.SheetNames[o])+`" table:style-name="ta1">
`);var l=0,h=0,f=hn(s["!ref"]||"A1"),d=s["!merges"]||[],m=0,v=Array.isArray(s);if(s["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(s["!cols"][h]?' table:style-name="co'+s["!cols"][h].ods+'"':"")+`></table:table-column>
`);var p="",_=s["!rows"]||[];for(l=0;l<f.s.r;++l)p=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+p+`></table:table-row>
`);for(;l<=f.e.r;++l){for(p=_[l]?' table:style-name="ro'+_[l].ods+'"':"",c.push("        <table:table-row"+p+`>
`),h=0;h<f.s.c;++h)c.push(e);for(;h<=f.e.c;++h){var T=!1,S={},b="";for(m=0;m!=d.length;++m)if(!(d[m].s.c>h)&&!(d[m].s.r>l)&&!(d[m].e.c<h)&&!(d[m].e.r<l)){(d[m].s.c!=h||d[m].s.r!=l)&&(T=!0),S["table:number-columns-spanned"]=d[m].e.c-d[m].s.c+1,S["table:number-rows-spanned"]=d[m].e.r-d[m].s.r+1;break}if(T){c.push(r);continue}var O=Ue({r:l,c:h}),V=v?(s[l]||[])[h]:s[O];if(V&&V.f&&(S["table:formula"]=Tt(ZL(V.f)),V.F&&V.F.slice(0,O.length)==O)){var B=hn(V.F);S["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,S["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!V){c.push(e);continue}switch(V.t){case"b":b=V.v?"TRUE":"FALSE",S["office:value-type"]="boolean",S["office:boolean-value"]=V.v?"true":"false";break;case"n":b=V.w||String(V.v||0),S["office:value-type"]="float",S["office:value"]=V.v||0;break;case"s":case"str":b=V.v==null?"":V.v,S["office:value-type"]="string";break;case"d":b=V.w||Vt(V.v).toISOString(),S["office:value-type"]="date",S["office:date-value"]=Vt(V.v).toISOString(),S["table:style-name"]="ce1";break;default:c.push(e);continue}var x=t(b);if(V.l&&V.l.Target){var w=V.l.Target;w=w.charAt(0)=="#"?"#"+e3(w.slice(1)):w,w.charAt(0)!="#"&&!w.match(/^\w+:/)&&(w="../"+w),x=_e("text:a",x,{"xlink:href":w.replace(/&/g,"&amp;")})}c.push("          "+_e("table:table-cell",_e("text:p",x,{}),S)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!cols"]){for(var h=0;h<l["!cols"].length;++h)if(l["!cols"][h]){var f=l["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;zs(f),f.ods=o;var d=l["!cols"][h].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++o}}});var c=0;a.SheetNames.map(function(l){return a.Sheets[l]}).forEach(function(l){if(l&&l["!rows"]){for(var h=0;h<l["!rows"].length;++h)if(l["!rows"][h]){l["!rows"][h].ods=c;var f=l["!rows"][h].hpx+"px";s.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),s.push(`  </style:style>
`),++c}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var c=[rr],l=gu({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=gu({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+l+h+`>
`),c.push(jT().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+l+`>
`),i(c,a),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=a.SheetNames.length;++f)c.push(n(a.Sheets[a.SheetNames[f]],a,f,o));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Zb(t,e){if(e.bookType=="fods")return ZE(t,e);var r=Ym(),n="",i=[],s=[];return n="mimetype",Ye(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Ye(r,n,ZE(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",Ye(r,n,P8(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",Ye(r,n,rr+jT()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",Ye(r,n,cP(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Ye(r,n,aP(i)),r}function Ka(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Wm(t){return typeof TextDecoder<"u"?new TextDecoder().decode(t):At(Ks(t))}function O8(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):bn(ki(t))}function N8(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function qs(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function eT(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>>24}function M8(t,e){for(var r=(t[e+15]&127)<<7|t[e+14]>>1,n=t[e+14]&1,i=e+13;i>=e;--i)n=n*256+t[i];return(t[e+15]&128?-n:n)*Math.pow(10,r-6176)}function L8(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function bu(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function wt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function Kt(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function ft(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=bu(t,r),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var c=r[0];t[r[0]++]>=128;);o=t.slice(c,r[0])}break;case 5:a=4,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 1:a=8,o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 2:a=bu(t,r),o=t.slice(r[0],r[0]+a),r[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var l={data:o,type:s};e[i]==null?e[i]=[l]:e[i].push(l)}return e}function Nr(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(wt(n*8+i.type)),i.type==2&&e.push(wt(i.data.length)),e.push(i.data))})}),qs(e)}function Sg(t,e){return t?.map(function(r){return e(r.data)})||[]}function $n(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=bu(t,n),s=ft(t.slice(n[0],n[0]+i));n[0]+=i;var a={id:Kt(s[1][0].data),messages:[]};s[2].forEach(function(o){var c=ft(o.data),l=Kt(c[3][0].data);a.messages.push({meta:c,data:t.slice(n[0],n[0]+l)}),n[0]+=l}),(e=s[3])!=null&&e[0]&&(a.merge=Kt(s[3][0].data)>>>0>0),r.push(a)}return r}function tc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:wt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:wt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:wt(a.data.length)}],n[2].push({data:Nr(a.meta),type:2})});var s=Nr(n);e.push(wt(s.length)),e.push(s),i.forEach(function(a){return e.push(a)})}),qs(e)}function V8(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=bu(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var a=e[r[0]++]>>2;if(a<60)++a;else{var o=a-59;a=e[r[0]],o>1&&(a|=e[r[0]+1]<<8),o>2&&(a|=e[r[0]+2]<<16),o>3&&(a|=e[r[0]+3]<<24),a>>>=0,a++,r[0]+=o}i.push(e.slice(r[0],r[0]+a)),r[0]+=a;continue}else{var c=0,l=0;if(s==1?(l=(e[r[0]]>>2&7)+4,c=(e[r[0]++]&224)<<3,c|=e[r[0]++]):(l=(e[r[0]++]>>2)+1,s==2?(c=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(c=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[qs(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(l>=c)for(i.push(i[0].slice(-c)),l-=c;l>=i[i.length-1].length;)i.push(i[i.length-1]),l-=i[i.length-1].length;i.push(i[0].slice(-c,-c+l))}}var h=qs(i);if(h.length!=n)throw new Error("Unexpected length: ".concat(h.length," != ").concat(n));return h}function Hn(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(V8(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return qs(e)}function rc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=wt(n),a=s.length;e.push(s),n<=60?(a++,e.push(new Uint8Array([n-1<<2]))):n<=256?(a+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(a+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(a+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(a+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),a+=n,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,r+=n}return qs(e)}function B8(t,e,r,n){var i=Ka(t),s=i.getUint32(4,!0),a=(n>1?12:8)+eT(s&(n>1?3470:398))*4,o=-1,c=-1,l=NaN,h=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=eT(s&(n>1?12288:4096))*4,s&16&&(c=i.getUint32(a,!0),a+=4),s&32&&(l=i.getFloat64(a,!0),a+=8),s&64&&(h.setTime(h.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var f;switch(t[2]){case 0:break;case 2:f={t:"n",v:l};break;case 3:f={t:"s",v:e[c]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(o>-1)f={t:"s",v:r[o]};else if(c>-1)f={t:"s",v:e[c]};else if(!isNaN(l))f={t:"n",v:l};else throw new Error("Unsupported cell type ".concat(t.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(t.slice(0,4)))}return f}function U8(t,e,r){var n=Ka(t),i=n.getUint32(8,!0),s=12,a=-1,o=-1,c=NaN,l=NaN,h=new Date(2001,0,1);i&1&&(c=M8(t,s),s+=16),i&2&&(l=n.getFloat64(s,!0),s+=8),i&4&&(h.setTime(h.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=n.getUint32(s,!0),s+=4),i&16&&(a=n.getUint32(s,!0),s+=4);var f;switch(t[1]){case 0:break;case 2:f={t:"n",v:c};break;case 3:f={t:"s",v:e[o]};break;case 5:f={t:"d",v:h};break;case 6:f={t:"b",v:l>0};break;case 7:f={t:"n",v:l/86400};break;case 8:f={t:"e",v:0};break;case 9:if(a>-1)f={t:"s",v:r[a]};else throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)));break;case 10:f={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(t[1]," : ").concat(i&31," : ").concat(t.slice(0,4)))}return f}function Sm(t,e){var r=new Uint8Array(32),n=Ka(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,L8(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Cm(t,e){var r=new Uint8Array(32),n=Ka(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function j8(t,e,r){switch(t[0]){case 0:case 1:case 2:case 3:return B8(t,e,r,t[0]);case 5:return U8(t,e,r);default:throw new Error("Unsupported payload version ".concat(t[0]))}}function Wr(t){var e=ft(t);return bu(e[1][0].data)}function tT(t,e){var r=ft(e.data),n=Kt(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(a){var o=ft(a.data),c=Kt(o[1][0].data)>>>0;switch(n){case 1:s[c]=Wm(o[3][0].data);break;case 8:{var l=t[Wr(o[9][0].data)][0],h=ft(l.data),f=t[Wr(h[1][0].data)][0],d=Kt(f.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var m=ft(f.data);s[c]=m[3].map(function(v){return Wm(v.data)}).join("")}break}}),s}function W8(t,e){var r,n,i,s,a,o,c,l,h,f,d,m,v,p,_=ft(t),T=Kt(_[1][0].data)>>>0,S=Kt(_[2][0].data)>>>0,b=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Kt(_[8][0].data)>0||!1,O,V;if((s=(i=_[7])==null?void 0:i[0])!=null&&s.data&&e!=0)O=(o=(a=_[7])==null?void 0:a[0])==null?void 0:o.data,V=(l=(c=_[6])==null?void 0:c[0])==null?void 0:l.data;else if((f=(h=_[4])==null?void 0:h[0])!=null&&f.data&&e!=1)O=(m=(d=_[4])==null?void 0:d[0])==null?void 0:m.data,V=(p=(v=_[3])==null?void 0:v[0])==null?void 0:p.data;else throw"NUMBERS Tile missing ".concat(e," cell storage");for(var B=b?4:1,x=Ka(O),w=[],E=0;E<O.length/2;++E){var C=x.getUint16(E*2,!0);C<65535&&w.push([E,C])}if(w.length!=S)throw"Expected ".concat(S," cells, found ").concat(w.length);var D=[];for(E=0;E<w.length-1;++E)D[w[E][0]]=V.subarray(w[E][1]*B,w[E+1][1]*B);return w.length>=1&&(D[w[w.length-1][0]]=V.subarray(w[w.length-1][1]*B)),{R:T,cells:D}}function $8(t,e){var r,n=ft(e.data),i=(r=n?.[7])!=null&&r[0]?Kt(n[7][0].data)>>>0>0?1:0:-1,s=Sg(n[5],function(a){return W8(a,i)});return{nrows:Kt(n[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(c,l){if(a[o.R][l])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(l));a[o.R][l]=c}),a},[])}}function H8(t,e,r){var n,i=ft(e.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Kt(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(Kt(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=Ge(s);var a=ft(i[4][0].data),o=tT(t,t[Wr(a[4][0].data)][0]),c=(n=a[17])!=null&&n[0]?tT(t,t[Wr(a[17][0].data)][0]):[],l=ft(a[3][0].data),h=0;l[1].forEach(function(f){var d=ft(f.data),m=t[Wr(d[2][0].data)][0],v=Kt(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var p=$8(t,m);p.data.forEach(function(_,T){_.forEach(function(S,b){var O=Ue({r:h+T,c:b}),V=j8(S,o,c);V&&(r[O]=V)})}),h+=p.nrows})}function z8(t,e){var r=ft(e.data),n={"!ref":"A1"},i=t[Wr(r[2][0].data)],s=Kt(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return H8(t,i[0],n),n}function G8(t,e){var r,n=ft(e.data),i={name:(r=n[1])!=null&&r[0]?Wm(n[1][0].data):"",sheets:[]},s=Sg(n[2],Wr);return s.forEach(function(a){t[a].forEach(function(o){var c=Kt(o.meta[1][0].data);c==6e3&&i.sheets.push(z8(t,o))})}),i}function q8(t,e){var r=Fg(),n=ft(e.data),i=Sg(n[1],Wr);if(i.forEach(function(s){t[s].forEach(function(a){var o=Kt(a.meta[1][0].data);if(o==2){var c=G8(t,a);c.sheets.forEach(function(l,h){Pg(r,l,h==0?c.name:c.name+"_"+h,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function km(t){var e,r,n,i,s={},a=[];if(t.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),t.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var l;try{l=Hn(c.content)}catch(f){return console.log("?? "+c.content.length+" "+(f.message||f))}var h;try{h=$n(l)}catch(f){return console.log("## "+(f.message||f))}h.forEach(function(f){s[f.id]=f.messages,a.push(f.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(n=(r=(e=s?.[1])==null?void 0:e[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&Kt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(c){s[c].forEach(function(l){var h=Kt(l.meta[1][0].data)>>>0;if(h==1)if(!o)o=l;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return q8(s,o)}function K8(t,e,r){var n,i,s,a;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=t[8])==null?void 0:s[0])==null?void 0:a.data)&&Kt(t[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,l=Ka(t[7][0].data),h=0,f=[],d=Ka(t[4][0].data),m=0,v=[],p=0;p<e.length;++p){if(e[p]==null){l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535);continue}l.setUint16(p*2,h,!0),d.setUint16(p*2,m,!0);var _,T;switch(typeof e[p]){case"string":_=Sm({t:"s",v:e[p]},r),T=Cm({t:"s",v:e[p]},r);break;case"number":_=Sm({t:"n",v:e[p]},r),T=Cm({t:"n",v:e[p]},r);break;case"boolean":_=Sm({t:"b",v:e[p]},r),T=Cm({t:"b",v:e[p]},r);break;default:throw new Error("Unsupported value "+e[p])}f.push(_),h+=_.length,v.push(T),m+=T.length,++c}for(t[2][0].data=wt(c);p<t[7][0].data.length/2;++p)l.setUint16(p*2,65535,!0),d.setUint16(p*2,65535,!0);return t[6][0].data=qs(f),t[3][0].data=qs(v),c}function X8(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=hn(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(Ge(n)));var s=Zf(r,{range:n,header:1}),a=["~Sh33tJ5~"];s.forEach(function(H){return H.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},c=[],l=Re.read(e.numbers,{type:"base64"});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],ne=H[1];if(W.type==2&&W.name.match(/\.iwa/)){var me=W.content,ue=Hn(me),fe=$n(ue);fe.forEach(function(se){c.push(se.id),o[se.id]={deps:[],location:ne,type:Kt(se.messages[0].meta[1][0].data)}})}}),c.sort(function(H,W){return H-W});var h=c.filter(function(H){return H>1}).map(function(H){return[H,wt(H)]});l.FileIndex.map(function(H,W){return[H,l.FullPaths[W]]}).forEach(function(H){var W=H[0],ne=H[1];if(W.name.match(/\.iwa/)){var me=$n(Hn(W.content));me.forEach(function(ue){ue.messages.forEach(function(fe){h.forEach(function(se){ue.messages.some(function(We){return Kt(We.meta[1][0].data)!=11006&&N8(We.data,se[1])})&&o[se[0]].deps.push(ue.id)})})})}});function f(){for(var H=927262;H<2e6;++H)if(!o[H])return H;throw new Error("Too many messages")}for(var d=Re.find(l,o[1].location),m=$n(Hn(d.content)),v,p=0;p<m.length;++p){var _=m[p];_.id==1&&(v=_)}var T=Wr(ft(v.messages[0].data)[1][0].data);for(d=Re.find(l,o[T].location),m=$n(Hn(d.content)),p=0;p<m.length;++p)_=m[p],_.id==T&&(v=_);for(T=Wr(ft(v.messages[0].data)[2][0].data),d=Re.find(l,o[T].location),m=$n(Hn(d.content)),p=0;p<m.length;++p)_=m[p],_.id==T&&(v=_);for(T=Wr(ft(v.messages[0].data)[2][0].data),d=Re.find(l,o[T].location),m=$n(Hn(d.content)),p=0;p<m.length;++p)_=m[p],_.id==T&&(v=_);var S=ft(v.messages[0].data);{S[6][0].data=wt(n.e.r+1),S[7][0].data=wt(n.e.c+1);var b=Wr(S[46][0].data),O=Re.find(l,o[b].location),V=$n(Hn(O.content));{for(var B=0;B<V.length&&V[B].id!=b;++B);if(V[B].id!=b)throw"Bad ColumnRowUIDMapArchive";var x=ft(V[B].messages[0].data);x[1]=[],x[2]=[],x[3]=[];for(var w=0;w<=n.e.c;++w){var E=[];E[1]=E[2]=[{type:0,data:wt(w+420690)}],x[1].push({type:2,data:Nr(E)}),x[2].push({type:0,data:wt(w)}),x[3].push({type:0,data:wt(w)})}x[4]=[],x[5]=[],x[6]=[];for(var C=0;C<=n.e.r;++C)E=[],E[1]=E[2]=[{type:0,data:wt(C+726270)}],x[4].push({type:2,data:Nr(E)}),x[5].push({type:0,data:wt(C)}),x[6].push({type:0,data:wt(C)});V[B].messages[0].data=Nr(x)}O.content=rc(tc(V)),O.size=O.content.length,delete S[46];var D=ft(S[4][0].data);{D[7][0].data=wt(n.e.r+1);var A=ft(D[1][0].data),R=Wr(A[2][0].data);O=Re.find(l,o[R].location),V=$n(Hn(O.content));{if(V[0].id!=R)throw"Bad HeaderStorageBucket";var oe=ft(V[0].messages[0].data);for(C=0;C<s.length;++C){var ce=ft(oe[2][0].data);ce[1][0].data=wt(C),ce[4][0].data=wt(s[C].length),oe[2][C]={type:oe[2][0].type,data:Nr(ce)}}V[0].messages[0].data=Nr(oe)}O.content=rc(tc(V)),O.size=O.content.length;var ke=Wr(D[2][0].data);O=Re.find(l,o[ke].location),V=$n(Hn(O.content));{if(V[0].id!=ke)throw"Bad HeaderStorageBucket";for(oe=ft(V[0].messages[0].data),w=0;w<=n.e.c;++w)ce=ft(oe[2][0].data),ce[1][0].data=wt(w),ce[4][0].data=wt(n.e.r+1),oe[2][w]={type:oe[2][0].type,data:Nr(ce)};V[0].messages[0].data=Nr(oe)}O.content=rc(tc(V)),O.size=O.content.length;var we=Wr(D[4][0].data);(function(){for(var H=Re.find(l,o[we].location),W=$n(Hn(H.content)),ne,me=0;me<W.length;++me){var ue=W[me];ue.id==we&&(ne=ue)}var fe=ft(ne.messages[0].data);{fe[3]=[];var se=[];a.forEach(function(at,qe){se[1]=[{type:0,data:wt(qe)}],se[2]=[{type:0,data:wt(1)}],se[3]=[{type:2,data:O8(at)}],fe[3].push({type:2,data:Nr(se)})})}ne.messages[0].data=Nr(fe);var We=tc(W),U=rc(We);H.content=U,H.size=H.content.length})();var Ne=ft(D[3][0].data);{var de=Ne[1][0];delete Ne[2];var Ae=ft(de.data);{var ie=Wr(Ae[2][0].data);(function(){for(var H=Re.find(l,o[ie].location),W=$n(Hn(H.content)),ne,me=0;me<W.length;++me){var ue=W[me];ue.id==ie&&(ne=ue)}var fe=ft(ne.messages[0].data);{delete fe[6],delete Ne[7];var se=new Uint8Array(fe[5][0].data);fe[5]=[];for(var We=0,U=0;U<=n.e.r;++U){var at=ft(se);We+=K8(at,s[U],a),at[1][0].data=wt(U),fe[5].push({data:Nr(at),type:2})}fe[1]=[{type:0,data:wt(n.e.c+1)}],fe[2]=[{type:0,data:wt(n.e.r+1)}],fe[3]=[{type:0,data:wt(We)}],fe[4]=[{type:0,data:wt(n.e.r+1)}]}ne.messages[0].data=Nr(fe);var qe=tc(W),ot=rc(qe);H.content=ot,H.size=H.content.length})()}de.data=Nr(Ae)}D[3][0].data=Nr(Ne)}S[4][0].data=Nr(D)}v.messages[0].data=Nr(S);var j=tc(m),G=rc(j);return d.content=G,d.size=d.content.length,l}function eI(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Cg(t){eI([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(t)}function kg(t){eI([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Y8(t){return Qe.WS.indexOf(t)>-1?"sheet":Qe.CS&&t==Qe.CS?"chart":Qe.DS&&t==Qe.DS?"dialog":Qe.MS&&t==Qe.MS?"macro":t&&t.length?t:"sheet"}function Q8(t,e){if(!t)return 0;try{t=e.map(function(n){return n.id||(n.id=n.strRelID),[n.name,t["!id"][n.id].Target,Y8(t["!id"][n.id].Type)]})}catch{return null}return!t||t.length===0?null:t}function J8(t,e,r,n,i,s,a,o,c,l,h,f){try{s[n]=ou(In(t,r,!0),e);var d=ar(t,e),m;switch(o){case"sheet":m=x6(d,e,i,c,s[n],l,h,f);break;case"chart":if(m=w6(d,e,i,c,s[n],l,h,f),!m||!m["!drawel"])break;var v=nu(m["!drawel"].Target,e),p=_u(v),_=o4(In(t,v,!0),ou(In(t,p,!0),v)),T=nu(_,v),S=_u(T);m=KV(In(t,T,!0),T,c,ou(In(t,S,!0),T),l,m);break;case"macro":m=E6(d,e,i,c,s[n],l,h,f);break;case"dialog":m=T6(d,e,i,c,s[n],l,h,f);break;default:throw new Error("Unrecognized sheet type "+o)}a[n]=m;var b=[];s&&s[n]&&Yt(s[n]).forEach(function(O){var V="";if(s[n][O].Type==Qe.CMNT){V=nu(s[n][O].Target,e);var B=S6(ar(t,V,!0),V,c);if(!B||!B.length)return;UE(m,B,!1)}s[n][O].Type==Qe.TCMNT&&(V=nu(s[n][O].Target,e),b=b.concat(l4(ar(t,V,!0),c)))}),b&&b.length&&UE(m,b,!0,c.people||[])}catch(O){if(c.WTF)throw O}}function jn(t){return t.charAt(0)=="/"?t.slice(1):t}function Z8(t,e){if(gc(),e=e||{},Cg(e),zn(t,"META-INF/manifest.xml")||zn(t,"objectdata.xml"))return QE(t,e);if(zn(t,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof km<"u"){if(t.FileIndex)return km(t);var r=Re.utils.cfb_new();return oE(t).forEach(function(oe){Ye(r,oe,yT(t,oe))}),km(r)}throw new Error("Unsupported NUMBERS file")}if(!zn(t,"[Content_Types].xml"))throw zn(t,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):zn(t,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=oE(t),i=nP(In(t,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",ar(t,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!ar(t,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var c={},l={};if(!e.bookSheets&&!e.bookProps){if(cu=[],i.sst)try{cu=A6(ar(t,jn(i.sst)),i.sst,e)}catch(oe){if(e.WTF)throw oe}e.cellStyles&&i.themes.length&&(c=I6(In(t,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],e)),i.style&&(l=b6(ar(t,jn(i.style)),i.style,c,e))}i.links.map(function(oe){try{var ce=ou(In(t,_u(jn(oe))),oe);return k6(ar(t,jn(oe)),ce,oe,e)}catch{}});var h=y6(ar(t,jn(i.workbooks[0])),i.workbooks[0],e),f={},d="";i.coreprops.length&&(d=ar(t,jn(i.coreprops[0]),!0),d&&(f=WT(d)),i.extprops.length!==0&&(d=ar(t,jn(i.extprops[0]),!0),d&&uP(d,f,e)));var m={};(!e.bookSheets||e.bookProps)&&i.custprops.length!==0&&(d=In(t,jn(i.custprops[0]),!0),d&&(m=fP(d,e)));var v={};if((e.bookSheets||e.bookProps)&&(h.Sheets?a=h.Sheets.map(function(ce){return ce.name}):f.Worksheets&&f.SheetNames.length>0&&(a=f.SheetNames),e.bookProps&&(v.Props=f,v.Custprops=m),e.bookSheets&&typeof a<"u"&&(v.SheetNames=a),e.bookSheets?v.SheetNames:e.bookProps))return v;a={};var p={};e.bookDeps&&i.calcchain&&(p=C6(ar(t,jn(i.calcchain)),i.calcchain,e));var _=0,T={},S,b;{var O=h.Sheets;f.Worksheets=O.length,f.SheetNames=[];for(var V=0;V!=O.length;++V)f.SheetNames[V]=O[V].name}var B=s?"bin":"xml",x=i.workbooks[0].lastIndexOf("/"),w=(i.workbooks[0].slice(0,x+1)+"_rels/"+i.workbooks[0].slice(x+1)+".rels").replace(/^\//,"");zn(t,w)||(w="xl/_rels/workbook."+B+".rels");var E=ou(In(t,w,!0),w.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(e.xlmeta=D6(ar(t,jn(i.metadata[0])),i.metadata[0],e)),(i.people||[]).length>=1&&(e.people=h4(ar(t,jn(i.people[0])),e)),E&&(E=Q8(E,h.Sheets));var C=ar(t,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=f.Worksheets;++_){var D="sheet";if(E&&E[_]?(S="xl/"+E[_][1].replace(/[\/]?xl\//,""),zn(t,S)||(S=E[_][1]),zn(t,S)||(S=w.replace(/_rels\/.*$/,"")+E[_][1]),D=E[_][2]):(S="xl/worksheets/sheet"+(_+1-C)+"."+B,S=S.replace(/sheet0\./,"sheet.")),b=S.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),e&&e.sheets!=null)switch(typeof e.sheets){case"number":if(_!=e.sheets)continue e;break;case"string":if(f.SheetNames[_].toLowerCase()!=e.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(e.sheets)){for(var A=!1,R=0;R!=e.sheets.length;++R)typeof e.sheets[R]=="number"&&e.sheets[R]==_&&(A=1),typeof e.sheets[R]=="string"&&e.sheets[R].toLowerCase()==f.SheetNames[_].toLowerCase()&&(A=1);if(!A)continue e}}J8(t,S,b,f.SheetNames[_],_,T,a,D,e,h,c,l)}return v={Directory:i,Workbook:h,Props:f,Custprops:m,Deps:p,Sheets:a,SheetNames:f.SheetNames,Strings:cu,Styles:l,Themes:c,SSF:Bt(Le)},e&&e.bookFiles&&(t.files?(v.keys=n,v.files=t.files):(v.keys=[],v.files={},t.FullPaths.forEach(function(oe,ce){oe=oe.replace(/^Root Entry[\/]/,""),v.keys.push(oe),v.files[oe]=t.FileIndex[ce]}))),e&&e.bookVBA&&(i.vba.length>0?v.vbaraw=ar(t,jn(i.vba[0]),!0):i.defaults&&i.defaults.bin===y4&&(v.vbaraw=ar(t,"xl/vbaProject.bin",!0))),v}function e5(t,e){var r=e||{},n="Workbook",i=Re.find(t,n);try{if(n="/!DataSpaces/Version",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(DN(i.content),n="/!DataSpaces/DataSpaceMap",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=FN(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=PN(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);NN(i.content)}catch{}if(n="/EncryptionInfo",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=MN(i.content);if(n="/EncryptedPackage",i=Re.find(t,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function t5(t,e){return e.bookType=="ods"?Zb(t,e):e.bookType=="numbers"?X8(t,e):e.bookType=="xlsb"?r5(t,e):n5(t,e)}function r5(t,e){sc=1024,t&&!t.SSF&&(t.SSF=Bt(Le)),t&&t.SSF&&(gc(),td(t.SSF),e.revssf=nd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,lu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=Sb.indexOf(e.bookType)>-1,i=pg();kg(e=e||{});var s=Ym(),a="",o=0;if(e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ye(s,a,$T(t.Props,e)),i.coreprops.push(a),Et(e.rels,2,a,Qe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Ye(s,a,GT(t.Props,e)),i.extprops.push(a),Et(e.rels,3,a,Qe.EXT_PROPS),t.Custprops!==t.Props&&Yt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,qT(t.Custprops,e)),i.custprops.push(a),Et(e.rels,4,a,Qe.CUST_PROPS)),o=1;o<=t.SheetNames.length;++o){var h={"!id":{}},f=t.Sheets[t.SheetNames[o-1]],d=(f||{})["!type"]||"sheet";switch(d){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ye(s,a,F6(o-1,a,e,t,h)),i.sheets.push(a),Et(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Qe.WS[0])}if(f){var m=f["!comments"],v=!1,p="";m&&m.length>0&&(p="xl/comments"+o+"."+r,Ye(s,p,N6(m,p,e)),i.comments.push(p),Et(h,-1,"../comments"+o+"."+r,Qe.CMNT),v=!0),f["!legacy"]&&v&&Ye(s,"xl/drawings/vmlDrawing"+o+".vml",Ib(o,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Ye(s,_u(a),oc(h))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ye(s,a,O6(e.Strings,a,e)),i.strs.push(a),Et(e.wbrels,-1,"sharedStrings."+r,Qe.SST)),a="xl/workbook."+r,Ye(s,a,R6(t,a,e)),i.workbooks.push(a),Et(e.rels,1,a,Qe.WB),a="xl/theme/theme1.xml",Ye(s,a,xg(t.Themes,e)),i.themes.push(a),Et(e.wbrels,-1,"theme/theme1.xml",Qe.THEME),a="xl/styles."+r,Ye(s,a,P6(t,a,e)),i.styles.push(a),Et(e.wbrels,-1,"styles."+r,Qe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ye(s,a,t.vbaraw),i.vba.push(a),Et(e.wbrels,-1,"vbaProject.bin",Qe.VBA)),a="xl/metadata."+r,Ye(s,a,M6(a)),i.metadata.push(a),Et(e.wbrels,-1,"metadata."+r,Qe.XLMETA),Ye(s,"[Content_Types].xml",UT(i,e)),Ye(s,"_rels/.rels",oc(e.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",oc(e.wbrels)),delete e.revssf,delete e.ssf,s}function n5(t,e){sc=1024,t&&!t.SSF&&(t.SSF=Bt(Le)),t&&t.SSF&&(gc(),td(t.SSF),e.revssf=nd(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,lu?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=Sb.indexOf(e.bookType)>-1,i=pg();kg(e=e||{});var s=Ym(),a="",o=0;if(e.cellXfs=[],Ys(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),a="docProps/core.xml",Ye(s,a,$T(t.Props,e)),i.coreprops.push(a),Et(e.rels,2,a,Qe.CORE_PROPS),a="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],l=0;l<t.SheetNames.length;++l)(t.Workbook.Sheets[l]||{}).Hidden!=2&&c.push(t.SheetNames[l]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Ye(s,a,GT(t.Props,e)),i.extprops.push(a),Et(e.rels,3,a,Qe.EXT_PROPS),t.Custprops!==t.Props&&Yt(t.Custprops||{}).length>0&&(a="docProps/custom.xml",Ye(s,a,qT(t.Custprops,e)),i.custprops.push(a),Et(e.rels,4,a,Qe.CUST_PROPS));var h=["SheetJ5"];for(e.tcid=0,o=1;o<=t.SheetNames.length;++o){var f={"!id":{}},d=t.Sheets[t.SheetNames[o-1]],m=(d||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+r,Ye(s,a,Vb(o-1,e,t,f)),i.sheets.push(a),Et(e.wbrels,-1,"worksheets/sheet"+o+"."+r,Qe.WS[0])}if(d){var v=d["!comments"],p=!1,_="";if(v&&v.length>0){var T=!1;v.forEach(function(S){S[1].forEach(function(b){b.T==!0&&(T=!0)})}),T&&(_="xl/threadedComments/threadedComment"+o+"."+r,Ye(s,_,u4(v,h,e)),i.threadedcomments.push(_),Et(f,-1,"../threadedComments/threadedComment"+o+"."+r,Qe.TCMNT)),_="xl/comments"+o+"."+r,Ye(s,_,Ab(v,e)),i.comments.push(_),Et(f,-1,"../comments"+o+"."+r,Qe.CMNT),p=!0}d["!legacy"]&&p&&Ye(s,"xl/drawings/vmlDrawing"+o+".vml",Ib(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Ye(s,_u(a),oc(f))}return e.Strings!=null&&e.Strings.length>0&&(a="xl/sharedStrings."+r,Ye(s,a,db(e.Strings,e)),i.strs.push(a),Et(e.wbrels,-1,"sharedStrings."+r,Qe.SST)),a="xl/workbook."+r,Ye(s,a,$b(t,e)),i.workbooks.push(a),Et(e.rels,1,a,Qe.WB),a="xl/theme/theme1.xml",Ye(s,a,xg(t.Themes,e)),i.themes.push(a),Et(e.wbrels,-1,"theme/theme1.xml",Qe.THEME),a="xl/styles."+r,Ye(s,a,wb(t,e)),i.styles.push(a),Et(e.wbrels,-1,"styles."+r,Qe.STY),t.vbaraw&&n&&(a="xl/vbaProject.bin",Ye(s,a,t.vbaraw),i.vba.push(a),Et(e.wbrels,-1,"vbaProject.bin",Qe.VBA)),a="xl/metadata."+r,Ye(s,a,bb()),i.metadata.push(a),Et(e.wbrels,-1,"metadata."+r,Qe.XLMETA),h.length>1&&(a="xl/persons/person.xml",Ye(s,a,f4(h,e)),i.people.push(a),Et(e.wbrels,-1,"persons/person.xml",Qe.PEOPLE)),Ye(s,"[Content_Types].xml",UT(i,e)),Ye(s,"_rels/.rels",oc(e.rels)),Ye(s,"xl/_rels/workbook."+r+".rels",oc(e.wbrels)),delete e.revssf,delete e.ssf,s}function Dg(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=An(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function i5(t,e){return Re.find(t,"EncryptedPackage")?e5(t,e):qb(t,e)}function s5(t,e){var r,n=t,i=e||{};return i.type||(i.type=Ze&&Buffer.isBuffer(t)?"buffer":"base64"),r=xT(n,i),Z8(r,i)}function tI(t,e){var r=0;e:for(;r<t.length;)switch(t.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Um(t.slice(r),e);default:break e}return fc.to_workbook(t,e)}function a5(t,e){var r="",n=Dg(t,e);switch(e.type){case"base64":r=An(t);break;case"binary":r=t;break;case"buffer":r=t.toString("binary");break;case"array":r=Ha(t);break;default:throw new Error("Unrecognized type "+e.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=At(r)),e.type="binary",tI(r,e)}function o5(t,e){var r=t;return e.type=="base64"&&(r=An(r)),r=_t.utils.decode(1200,r.slice(2),"str"),e.type="binary",tI(r,e)}function c5(t){return t.match(/[^\x00-\x7F]/)?ki(t):t}function Dm(t,e,r,n){return n?(r.type="string",fc.to_workbook(t,r)):fc.to_workbook(e,r)}function pc(t,e){zm();var r=e||{};if(typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer)return pc(new Uint8Array(t),(r=Bt(r),r.type="array",r));typeof Uint8Array<"u"&&t instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=t,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),lc={},r.dateNF&&(lc.dateNF=r.dateNF),r.type||(r.type=Ze&&Buffer.isBuffer(t)?"buffer":"base64"),r.type=="file"&&(r.type=Ze?"buffer":"binary",n=rF(t),typeof Uint8Array<"u"&&!Ze&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=c5(t)),r.type=="array"&&typeof Uint8Array<"u"&&t instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return r=Bt(r),r.type="array",pc(Gm(n),r)}switch((i=Dg(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return i5(Re.read(n,r),r);break;case 9:if(i[1]<=8)return qb(n,r);break;case 60:return Um(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return dN(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return hb.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?s5(n,r):Dm(t,n,r,s);case 239:return i[3]===60?Um(n,r):Dm(t,n,r,s);case 255:if(i[1]===254)return o5(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return ja.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return ja.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Bm.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return _b.to_workbook(n,r);break;case 10:case 13:case 32:return a5(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return fN.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Bm.to_workbook(n,r):Dm(t,n,r,s)}function rI(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Au(e.file,Re.write(t,{type:Ze?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Re.write(t,e)}function l5(t,e){var r=Bt(e||{}),n=t5(t,r);return u5(n,r)}function u5(t,e){var r={},n=Ze?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Re.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(ed(i))}return e.password&&typeof encrypt_agile<"u"?rI(encrypt_agile(i,e.password),e):e.type==="file"?Au(e.file,i):e.type=="string"?At(i):i}function h5(t,e){var r=e||{},n=c8(t,r);return rI(n,r)}function Ci(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return du(ki(n));case"binary":return ki(n);case"string":return t;case"file":return Au(e.file,n,"utf8");case"buffer":return Ze?is(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ci(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function f5(t,e){switch(e.type){case"base64":return du(t);case"binary":return t;case"string":return t;case"file":return Au(e.file,t,"binary");case"buffer":return Ze?is(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function jf(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?du(r):e.type=="string"?At(r):r;case"file":return Au(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function nI(t,e){zm(),i6(t);var r=Bt(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=nI(t,r);return r.type="array",ed(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ci(t8(t,r),r);case"slk":case"sylk":return Ci(ub.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return Ci(Xb(t.Sheets[t.SheetNames[i]],r),r);case"txt":return f5(sI(t.Sheets[t.SheetNames[i]],r),r);case"csv":return Ci(Rg(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ci(hb.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return jf(Bm.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return Ci(fc.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return Ci(_b.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return Ci(fb.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return Ci(Zb(t,r),r);case"wk1":return jf(ja.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return jf(ja.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),jf(Kb(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),h5(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return l5(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function d5(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function iI(t,e,r){var n=r||{};return n.type="file",n.file=e,d5(n),nI(t,n)}function p5(t,e,r,n,i,s,a,o){var c=tr(r),l=o.defval,h=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),f=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!a||t[r])for(var m=e.s.c;m<=e.e.c;++m){var v=a?t[r][m]:t[n[m]+c];if(v===void 0||v.t===void 0){if(l===void 0)continue;s[m]!=null&&(d[s[m]]=l);continue}var p=v.v;switch(v.t){case"z":if(p==null)break;continue;case"e":p=p==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(p==null)if(v.t=="e"&&p===null)d[s[m]]=null;else if(l!==void 0)d[s[m]]=l;else if(h&&p===null)d[s[m]]=null;else continue;else d[s[m]]=h&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?p:ns(v,p,o);p!=null&&(f=!1)}}return{row:d,isempty:f}}function Zf(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],a=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},l=e||{},h=l.range!=null?l.range:t["!ref"];switch(l.header===1?n=1:l.header==="A"?n=2:Array.isArray(l.header)?n=3:l.header==null&&(n=0),typeof h){case"string":c=ut(h);break;case"number":c=ut(t["!ref"]),c.s.r=h;break;default:c=h}n>0&&(i=0);var f=tr(c.s.r),d=[],m=[],v=0,p=0,_=Array.isArray(t),T=c.s.r,S=0,b={};_&&!t[T]&&(t[T]=[]);var O=l.skipHidden&&t["!cols"]||[],V=l.skipHidden&&t["!rows"]||[];for(S=c.s.c;S<=c.e.c;++S)if(!(O[S]||{}).hidden)switch(d[S]=$t(S),r=_?t[T][S]:t[d[S]+f],n){case 1:s[S]=S-c.s.c;break;case 2:s[S]=d[S];break;case 3:s[S]=l.header[S-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=a=ns(r,null,l),p=b[a]||0,!p)b[a]=1;else{do o=a+"_"+p++;while(b[o]);b[a]=p,b[o]=1}s[S]=o}for(T=c.s.r+i;T<=c.e.r;++T)if(!(V[T]||{}).hidden){var B=p5(t,c,T,d,n,s,_,l);(B.isempty===!1||(n===1?l.blankrows!==!1:l.blankrows))&&(m[v++]=B.row)}return m.length=v,m}var rT=/"/g;function m5(t,e,r,n,i,s,a,o){for(var c=!0,l=[],h="",f=tr(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var m=o.dense?(t[r]||[])[d]:t[n[d]+f];if(m==null)h="";else if(m.v!=null){c=!1,h=""+(o.rawNumbers&&m.t=="n"?m.v:ns(m,null,o));for(var v=0,p=0;v!==h.length;++v)if((p=h.charCodeAt(v))===i||p===s||p===34||o.forceQuotes){h='"'+h.replace(rT,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(c=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(rT,'""')+'"')):h="";l.push(h)}return o.blankrows===!1&&c?null:l.join(a)}function Rg(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ut(t["!ref"]),s=n.FS!==void 0?n.FS:",",a=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),l=new RegExp((s=="|"?"\\|":s)+"+$"),h="",f=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],m=n.skipHidden&&t["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(d[v]||{}).hidden||(f[v]=$t(v));for(var p=0,_=i.s.r;_<=i.e.r;++_)(m[_]||{}).hidden||(h=m5(t,i,_,f,a,c,s,n),h!=null&&(n.strip&&(h=h.replace(l,"")),(h||n.blankrows!==!1)&&r.push((p++?o:"")+h)));return delete n.dense,r.join("")}function sI(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=Rg(t,e);if(typeof _t>"u"||e.type=="string")return r;var n=_t.utils.encode(1200,r,"str");return"\xFF\xFE"+n}function g5(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ut(t["!ref"]),s="",a=[],o,c=[],l=Array.isArray(t);for(o=i.s.c;o<=i.e.c;++o)a[o]=$t(o);for(var h=i.s.r;h<=i.e.r;++h)for(s=tr(h),o=i.s.c;o<=i.e.c;++o)if(e=a[o]+s,r=l?(t[h]||[])[o]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=e+"="+n}return c}function aI(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},a=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var c=typeof n.origin=="string"?Ht(n.origin):n.origin;a=c.r,o=c.c}var l,h={s:{c:0,r:0},e:{c:o,r:a+e.length-1+i}};if(s["!ref"]){var f=ut(s["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),a==-1&&(a=f.e.r+1,h.e.r=a+e.length-1+i)}else a==-1&&(a=0,h.e.r=e.length-1+i);var d=n.header||[],m=0;e.forEach(function(p,_){Yt(p).forEach(function(T){(m=d.indexOf(T))==-1&&(d[m=d.length]=T);var S=p[T],b="z",O="",V=Ue({c:o+m,r:a+_+i});l=Iu(s,V),S&&typeof S=="object"&&!(S instanceof Date)?s[V]=S:(typeof S=="number"?b="n":typeof S=="boolean"?b="b":typeof S=="string"?b="s":S instanceof Date?(b="d",n.cellDates||(b="n",S=dr(S)),O=n.dateNF||Le[14]):S===null&&n.nullError&&(b="e",S=0),l?(l.t=b,l.v=S,delete l.w,delete l.R,O&&(l.z=O)):s[V]=l={t:b,v:S},O&&(l.z=O))})}),h.e.c=Math.max(h.e.c,o+d.length-1);var v=tr(a);if(i)for(m=0;m<d.length;++m)s[$t(m+o)+v]={t:"s",v:d[m]};return s["!ref"]=Ge(h),s}function v5(t,e){return aI(null,t,e)}function Iu(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=Ht(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?Iu(t,Ue(e)):Iu(t,Ue({r:e,c:r||0}))}function _5(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Fg(){return{SheetNames:[],Sheets:{}}}function Pg(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=a+i)!=-1;++i);}if(Wb(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function y5(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=_5(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function x5(t,e){return t.z=e,t}function oI(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function w5(t,e,r){return oI(t,"#"+e,r)}function E5(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function T5(t,e,r,n){for(var i=typeof e!="string"?e:ut(e),s=typeof e=="string"?e:Ge(e),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var c=Iu(t,a,o);c.t="n",c.F=s,delete c.v,a==i.s.r&&o==i.s.c&&(c.f=r,n&&(c.D=!0))}return t}var to={encode_col:$t,encode_row:tr,encode_cell:Ue,encode_range:Ge,decode_col:cg,decode_row:og,split_cell:OF,decode_cell:Ht,decode_range:hn,format_cell:ns,sheet_add_aoa:PT,sheet_add_json:aI,sheet_add_dom:Yb,aoa_to_sheet:_c,json_to_sheet:v5,table_to_sheet:Qb,table_to_book:D8,sheet_to_csv:Rg,sheet_to_txt:sI,sheet_to_json:Zf,sheet_to_html:Xb,sheet_to_formulae:g5,sheet_to_row_object_array:Zf,sheet_get_cell:Iu,book_new:Fg,book_append_sheet:Pg,book_set_sheet_visibility:y5,cell_set_number_format:x5,cell_set_hyperlink:oI,cell_set_internal_link:w5,cell_add_comment:E5,sheet_set_array_formula:T5,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var xG=fu.version;var ud=(()=>{let e=class e{constructor(){this.data={}}setHeaderData(n){this.data=n}getHeaderData(){return this.data}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var uI=(()=>{let e=class e{constructor(n){this.headerDataService=n,this.guardarHeader=new Rr,this.cerrarModal=new Rr,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[];let i=this.headerDataService.getHeaderData();i&&(this.institucion=i.institucion,this.examen=i.examen,this.fecha=i.fecha==null||i.fecha==""?this.getFechaActual():i.fecha,this.duracion=i.duracion,this.profesor=i.profesor,this.catedra=i.catedra,this.dniChecked=i.dniChecked,this.puntosChecked=i.puntosChecked,this.logoFiles=i.logoFile==null?[]:i.logoFile)}guardarDatosHeader(){let n={institucion:this.institucion,examen:this.examen,fecha:this.fecha,duracion:this.duracion,profesor:this.profesor,catedra:this.catedra,logoFile:this.logoFiles,dniChecked:this.dniChecked,puntosChecked:this.puntosChecked};this.headerDataService.setHeaderData(n),this.guardarHeader.emit(n),this.cerrarModal.emit()}onClose(){this.cerrarModal.emit()}onLogoChange(n){let i=n.target,s=i.files&&i.files[0];s&&this.logoFiles.push(s)}getFechaActual(){let n=new Date,i=new Date(n.toLocaleString("en-US",{timeZone:"America/Argentina/Buenos_Aires"})),s=i.getFullYear(),a=String(i.getMonth()+1).padStart(2,"0"),o=String(i.getDate()).padStart(2,"0");return`${s}-${a}-${o}`}};e.\u0275fac=function(i){return new(i||e)(Pe(ud))},e.\u0275cmp=Dt({type:e,selectors:[["app-header"]],outputs:{guardarHeader:"guardarHeader",cerrarModal:"cerrarModal"},standalone:!0,features:[Rt],decls:48,vars:8,consts:[[1,"fixed","inset-0","z-50","flex","items-center","justify-center","bg-gray-900","bg-opacity-50"],["id","modal",1,"bg-white","p-6","rounded-lg","shadow-lg","max-w-lg","w-full","mx-4","max-h-[85vh]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],[1,"space-y-4",3,"ngSubmit"],["for","institucion",1,"block","font-semibold","mb-2"],["type","text","id","institucion","name","institucion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","logo",1,"block","font-semibold","mb-2"],["type","file","id","logoInput","accept","image/*",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"change"],["for","examen",1,"block","font-semibold","mb-2"],["type","text","id","examen","name","examen","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","flex-col","sm:flex-row","gap-2"],[1,"flex-1"],["for","fecha",1,"block","font-semibold","mb-2"],["type","date","id","fecha","name","fecha","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","duracion",1,"block","font-semibold","mb-2"],["type","text","id","duracion","name","duracion","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","profesor",1,"block","font-semibold","mb-2"],["type","text","id","profesor","name","profesor","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],["for","catedra",1,"block","font-semibold","mb-2"],["type","text","id","catedra","name","catedra","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"flex","items-center","mb-4"],["type","checkbox","id","dniCheckbox","name","dniCheckbox",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","dniCheckbox",1,"ms-2","font-semibold"],["type","checkbox","id","puntosCheckbox","name","puntos",1,"w-4","h-4","text-blue-700","bg-gray-600","border-gray-300","rounded",3,"ngModelChange","ngModel"],["for","puntos",1,"ms-2","font-semibold"],[1,"flex","justify-end","space-x-4"],["type","button",1,"bg-gray-300","text-gray-800","py-2","px-4","rounded","hover:bg-gray-400",3,"click"],["type","submit",1,"bg-blue-500","text-white","py-2","px-4","rounded","hover:bg-blue-600"]],template:function(i,s){i&1&&(Z(0,"div",0)(1,"div",1)(2,"h2",2),ve(3,"Ingresar datos del membrete"),J(),Z(4,"form",3),ct("ngSubmit",function(){return s.guardarDatosHeader()}),Z(5,"div")(6,"label",4),ve(7,"Instituci\xF3n:"),J(),Z(8,"input",5),xn("ngModelChange",function(o){return yn(s.institucion,o)||(s.institucion=o),o}),J()(),Z(9,"div")(10,"label",6),ve(11,"Logo de la instituci\xF3n:"),J(),Z(12,"input",7),ct("change",function(o){return s.onLogoChange(o)}),J()(),Z(13,"div")(14,"label",8),ve(15,"Examen:"),J(),Z(16,"input",9),xn("ngModelChange",function(o){return yn(s.examen,o)||(s.examen=o),o}),J()(),Z(17,"div",10)(18,"div",11)(19,"label",12),ve(20,"Fecha:"),J(),Z(21,"input",13),xn("ngModelChange",function(o){return yn(s.fecha,o)||(s.fecha=o),o}),J()(),Z(22,"div",11)(23,"label",14),ve(24,"Duraci\xF3n:"),J(),Z(25,"input",15),xn("ngModelChange",function(o){return yn(s.duracion,o)||(s.duracion=o),o}),J()()(),Z(26,"div",10)(27,"div",11)(28,"label",16),ve(29,"Profesor:"),J(),Z(30,"input",17),xn("ngModelChange",function(o){return yn(s.profesor,o)||(s.profesor=o),o}),J()(),Z(31,"div",11)(32,"label",18),ve(33,"C\xE1tedra:"),J(),Z(34,"input",19),xn("ngModelChange",function(o){return yn(s.catedra,o)||(s.catedra=o),o}),J()()(),Z(35,"div",20)(36,"input",21),xn("ngModelChange",function(o){return yn(s.dniChecked,o)||(s.dniChecked=o),o}),J(),Z(37,"label",22),ve(38,"DNI Alumno"),J()(),Z(39,"div",20)(40,"input",23),xn("ngModelChange",function(o){return yn(s.puntosChecked,o)||(s.puntosChecked=o),o}),J(),Z(41,"label",24),ve(42,"Puntos"),J()(),Z(43,"div",25)(44,"button",26),ct("click",function(){return s.onClose()}),ve(45," Cancelar "),J(),Z(46,"button",27),ve(47," Guardar "),J()()()()()),i&2&&(De(8),_n("ngModel",s.institucion),De(8),_n("ngModel",s.examen),De(5),_n("ngModel",s.fecha),De(4),_n("ngModel",s.duracion),De(5),_n("ngModel",s.profesor),De(4),_n("ngModel",s.catedra),De(2),_n("ngModel",s.dniChecked),De(4),_n("ngModel",s.puntosChecked))},dependencies:[Jo,Us,Ii,em,Vs,Bs,Oa,Xl,am],encapsulation:2});let t=e;return t})();function hI(t,e){return typeof t=="function"?t(e):t}function Og(t){return t.split("-")[0]}function fI(t){return t.split("-")[1]}function dI(t){return["top","bottom"].includes(Og(t))?"y":"x"}function I5(t,e){return te(this,null,function*(){let{placement:r,platform:n,elements:i}=t,s=yield n.isRTL==null?void 0:n.isRTL(i.floating),a=Og(r),o=fI(r),c=dI(r)==="y",l=["left","top"].includes(a)?-1:1,h=s&&c?-1:1,f=hI(e,t),{mainAxis:d,crossAxis:m,alignmentAxis:v}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:Ie({mainAxis:0,crossAxis:0,alignmentAxis:null},f);return o&&typeof v=="number"&&(m=o==="end"?v*-1:v),c?{x:m*h,y:d*l}:{x:d*l,y:m*h}})}var pI=function(t){return t===void 0&&(t=0),{name:"offset",options:t,fn(r){return te(this,null,function*(){var n,i;let{x:s,y:a,placement:o,middlewareData:c}=r,l=yield I5(r,t);return o===((n=c.offset)==null?void 0:n.placement)&&(i=c.arrow)!=null&&i.alignmentOffset?{}:{x:s+l.x,y:a+l.y,data:mt(Ie({},l),{placement:o})}})}}};var Pi=pI;var mI=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-loading-print"]],standalone:!0,features:[Rt],decls:7,vars:0,consts:[["id","printOverlay",1,"fixed","inset-0","bg-white","flex","flex-col","items-center","justify-center","z-50","print:flex"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"animate-spin","h-16","w-16","mb-4"],["cx","16","cy","16","r","14","fill","#3498db",1,"shadow-md"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"text-lg","font-semibold","text-gray-700"]],template:function(i,s){i&1&&(Z(0,"div",0),Dr(),Z(1,"svg",1),ze(2,"circle",2)(3,"circle",3)(4,"circle",4),J(),xi(),Z(5,"p",5),ve(6,"Cargando, por favor espere..."),J()())},encapsulation:2});let t=e;return t})();var Qs=(()=>{let e=class e{constructor(){this.toastSubject=new On}getToast(){return this.toastSubject.asObservable()}showToast(n){this.toastSubject.next(n),setTimeout(()=>this.toastSubject.next({type:n.type,message:n.message,active:n.active}))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var ro={firebaseConfig:{apiKey:"AIzaSyAkCAXhb0PSyTe55CW-yKEH9xcmQC_JcZc",authDomain:"examenapp-a4984.firebaseapp.com",projectId:"examenapp-a4984",storageBucket:"examenapp-a4984.appspot.com",messagingSenderId:"112556396178",appId:"1:112556396178:web:7f8fd791bcd43218bae04b"},endpointReporte:"https://api.evalu.ar/api/Reporte",endpointGoogleCalendar:"https://www.googleapis.com/calendar/v3/calendars/primary/events?conferenceDataVersion=1&sendUpdates=all",endpointGoogleAccessToken:"https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/calendar&include_granted_scopes=true&response_type=token&state=nonces&redirect_uri=http://localhost:4200/eventos&client_id=112556396178-7s1es441csnn69lgq8c4gf2887cjqos8.apps.googleusercontent.com"};var gI=(()=>{let e=class e{generateExams(n,i,s,a){let o=[];if(s!=0)for(let c=0;c<n;c++){let l=[],h=0;for(;h<s&&a.length!==0;){let d=Math.floor(Math.random()*a.length),m=a[d];!l.some(p=>p.pregunta===m.pregunta)&&Number(m.puntaje)<=s&&(l.push(m),h-=Number(m.puntaje))}let f=l.map(d=>Ie({},d));o.push(f)}else for(let c=0;c<n;c++){let l=[];for(;l.length<i;){let d=this.getRandomQuestion(a),m=this.mezclarArray(d.respuesta);d.respuesta=m,l.some(p=>p.pregunta===d.pregunta)||l.push(d)}let h=100/i,f=l.map(d=>mt(Ie({},d),{puntaje:h}));o.push(f)}return o}getRandomQuestion(n){let i=Math.floor(Math.random()*n.length);return n[i]}mezclarArray(n){let i=[...n];for(let s=i.length-1;s>0;s--){let a=Math.floor(Math.random()*(s+1)),o=i[s];i[s]=i[a],i[a]=o}return i}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var S5=function(e){return C5(e)&&!k5(e)};function C5(t){return!!t&&typeof t=="object"}function k5(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||F5(t)}var D5=typeof Symbol=="function"&&Symbol.for,R5=D5?Symbol.for("react.element"):60103;function F5(t){return t.$$typeof===R5}function P5(t){return Array.isArray(t)?[]:{}}function Ou(t,e){return e.clone!==!1&&e.isMergeableObject(t)?Ic(P5(t),t,e):t}function O5(t,e,r){return t.concat(e).map(function(n){return Ou(n,r)})}function N5(t,e){if(!e.customMerge)return Ic;var r=e.customMerge(t);return typeof r=="function"?r:Ic}function M5(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function vI(t){return Object.keys(t).concat(M5(t))}function MI(t,e){try{return e in t}catch{return!1}}function L5(t,e){return MI(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function V5(t,e,r){var n={};return r.isMergeableObject(t)&&vI(t).forEach(function(i){n[i]=Ou(t[i],r)}),vI(e).forEach(function(i){L5(t,i)||(MI(t,i)&&r.isMergeableObject(e[i])?n[i]=N5(i,r)(t[i],e[i],r):n[i]=Ou(e[i],r))}),n}function Ic(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||O5,r.isMergeableObject=r.isMergeableObject||S5,r.cloneUnlessOtherwiseSpecified=Ou;var n=Array.isArray(e),i=Array.isArray(t),s=n===i;return s?n?r.arrayMerge(t,e,r):V5(t,e,r):Ou(e,r)}Ic.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,i){return Ic(n,i,r)},{})};var B5=Ic,Yg=B5;function U5(t){return t instanceof Element}function Qg(t){return t instanceof HTMLElement}function oo(t){return typeof t=="function"}function Nu(t){return typeof t=="string"}function Yr(t){return t===void 0}var Mu=class{on(e,r,n,i=!1){return Yr(this.bindings)&&(this.bindings={}),Yr(this.bindings[e])&&(this.bindings[e]=[]),this.bindings[e].push({handler:r,ctx:n,once:i}),this}once(e,r,n){return this.on(e,r,n,!0)}off(e,r){return Yr(this.bindings)||Yr(this.bindings[e])?this:(Yr(r)?delete this.bindings[e]:this.bindings[e].forEach((n,i)=>{n.handler===r&&this.bindings[e].splice(i,1)}),this)}trigger(e,...r){return!Yr(this.bindings)&&this.bindings[e]&&this.bindings[e].forEach((n,i)=>{let{ctx:s,handler:a,once:o}=n,c=s||this;a.apply(c,r),o&&this.bindings[e].splice(i,1)}),this}};function LI(t){let e=Object.getOwnPropertyNames(t.constructor.prototype);for(let r=0;r<e.length;r++){let n=e[r],i=t[n];n!=="constructor"&&typeof i=="function"&&(t[n]=i.bind(t))}return t}function j5(t,e){return r=>{if(e.isOpen()){let n=e.el&&r.currentTarget===e.el;(!Yr(t)&&r.currentTarget.matches(t)||n)&&e.tour.next()}}}function W5(t){let{event:e,selector:r}=t.options.advanceOn||{};if(e){let n=j5(r,t),i;try{i=document.querySelector(r)}catch{}if(!Yr(r)&&!i)return console.error(`No element was found for the selector supplied to advanceOn: ${r}`);i?(i.addEventListener(e,n),t.on("destroy",()=>i.removeEventListener(e,n))):(document.body.addEventListener(e,n,!0),t.on("destroy",()=>document.body.removeEventListener(e,n,!0)))}else return console.error("advanceOn was defined, but no event name was passed.")}function VI(t){return!Nu(t)||t===""?"":t.charAt(t.length-1)!=="-"?`${t}-`:t}function $5(t){let e=t.options.attachTo||{},r=Object.assign({},e);if(oo(r.element)&&(r.element=r.element.call(t)),Nu(r.element)){try{r.element=document.querySelector(r.element)}catch{}r.element||console.error(`The element for this Shepherd step was not found ${e.element}`)}return r}function BI(t){return t==null?!0:!t.element||!t.on}function Jg(){let t=Date.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{let r=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(e=="x"?r:r&3|8).toString(16)})}function Qr(){return Qr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Qr.apply(this,arguments)}function UI(t,e){if(t==null)return{};var r={},n=Object.keys(t),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(r[i]=t[i]);return r}var Ac=Math.min,io=Math.max,dd=Math.round,hd=Math.floor,Zs=t=>({x:t,y:t}),H5={left:"right",right:"left",bottom:"top",top:"bottom"},z5={start:"end",end:"start"};function Mg(t,e,r){return io(t,Ac(e,r))}function Sc(t,e){return typeof t=="function"?t(e):t}function co(t){return t.split("-")[0]}function yd(t){return t.split("-")[1]}function Zg(t){return t==="x"?"y":"x"}function ev(t){return t==="y"?"height":"width"}function xd(t){return["top","bottom"].includes(co(t))?"y":"x"}function tv(t){return Zg(xd(t))}function G5(t,e,r){r===void 0&&(r=!1);let n=yd(t),i=tv(t),s=ev(i),a=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=pd(a)),[a,pd(a)]}function q5(t){let e=pd(t);return[Lg(t),e,Lg(e)]}function Lg(t){return t.replace(/start|end/g,e=>z5[e])}function K5(t,e,r){let n=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return r?e?i:n:e?n:i;case"left":case"right":return e?s:a;default:return[]}}function X5(t,e,r,n){let i=yd(t),s=K5(co(t),r==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(Lg)))),s}function pd(t){return t.replace(/left|right|bottom|top/g,e=>H5[e])}function Y5(t){return Qr({top:0,right:0,bottom:0,left:0},t)}function jI(t){return typeof t!="number"?Y5(t):{top:t,right:t,bottom:t,left:t}}function md(t){return Qr({},t,{top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height})}var Q5=["mainAxis","crossAxis","fallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","flipAlignment"],J5=["mainAxis","crossAxis","limiter"];function _I(t,e,r){let{reference:n,floating:i}=t,s=xd(e),a=tv(e),o=ev(a),c=co(e),l=s==="y",h=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,d=n[o]/2-i[o]/2,m;switch(c){case"top":m={x:h,y:n.y-i.height};break;case"bottom":m={x:h,y:n.y+n.height};break;case"right":m={x:n.x+n.width,y:f};break;case"left":m={x:n.x-i.width,y:f};break;default:m={x:n.x,y:n.y}}switch(yd(e)){case"start":m[a]-=d*(r&&l?-1:1);break;case"end":m[a]+=d*(r&&l?-1:1);break}return m}var Z5=(t,e,r)=>te(void 0,null,function*(){let{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=r,o=s.filter(Boolean),c=yield a.isRTL==null?void 0:a.isRTL(e),l=yield a.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:f}=_I(l,n,c),d=n,m={},v=0;for(let p=0;p<o.length;p++){let{name:_,fn:T}=o[p],{x:S,y:b,data:O,reset:V}=yield T({x:h,y:f,initialPlacement:n,placement:d,strategy:i,middlewareData:m,rects:l,platform:a,elements:{reference:t,floating:e}});if(h=S??h,f=b??f,m=Qr({},m,{[_]:Qr({},m[_],O)}),V&&v<=50){v++,typeof V=="object"&&(V.placement&&(d=V.placement),V.rects&&(l=V.rects===!0?yield a.getElementRects({reference:t,floating:e,strategy:i}):V.rects),{x:h,y:f}=_I(l,d,c)),p=-1;continue}}return{x:h,y:f,placement:d,strategy:i,middlewareData:m}});function WI(t,e){return te(this,null,function*(){var r;e===void 0&&(e={});let{x:n,y:i,platform:s,rects:a,elements:o,strategy:c}=t,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:f="floating",altBoundary:d=!1,padding:m=0}=Sc(e,t),v=jI(m),_=o[d?f==="floating"?"reference":"floating":f],T=md(yield s.getClippingRect({element:(r=yield s.isElement==null?void 0:s.isElement(_))==null||r?_:_.contextElement||(yield s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:l,rootBoundary:h,strategy:c})),S=f==="floating"?Qr({},a.floating,{x:n,y:i}):a.reference,b=yield s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating),O=(yield s.isElement==null?void 0:s.isElement(b))?(yield s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},V=md(s.convertOffsetParentRelativeRectToViewportRelativeRect?yield s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:S,offsetParent:b,strategy:c}):S);return{top:(T.top-V.top+v.top)/O.y,bottom:(V.bottom-T.bottom+v.bottom)/O.y,left:(T.left-V.left+v.left)/O.x,right:(V.right-T.right+v.right)/O.x}})}var eB=t=>({name:"arrow",options:t,fn(r){return te(this,null,function*(){let{x:n,y:i,placement:s,rects:a,platform:o,elements:c}=r,{element:l,padding:h=0}=Sc(t,r)||{};if(l==null)return{};let f=jI(h),d={x:n,y:i},m=tv(s),v=ev(m),p=yield o.getDimensions(l),_=m==="y",T=_?"top":"left",S=_?"bottom":"right",b=_?"clientHeight":"clientWidth",O=a.reference[v]+a.reference[m]-d[m]-a.floating[v],V=d[m]-a.reference[m],B=yield o.getOffsetParent==null?void 0:o.getOffsetParent(l),x=B?B[b]:0;(!x||!(yield o.isElement==null?void 0:o.isElement(B)))&&(x=c.floating[b]||a.floating[v]);let w=O/2-V/2,E=x/2-p[v]/2-1,C=Ac(f[T],E),D=Ac(f[S],E),A=C,R=x-p[v]-D,oe=x/2-p[v]/2+w,ce=Mg(A,oe,R),we=yd(s)!=null&&oe!=ce&&a.reference[v]/2-(oe<A?C:D)-p[v]/2<0?oe<A?A-oe:R-oe:0;return{[m]:d[m]-we,data:{[m]:ce,centerOffset:oe-ce+we}}})}}),tB=function(e){return e===void 0&&(e={}),{name:"flip",options:e,fn(n){return te(this,null,function*(){var i;let{placement:s,middlewareData:a,rects:o,initialPlacement:c,platform:l,elements:h}=n,f=Sc(e,n),{mainAxis:d=!0,crossAxis:m=!0,fallbackPlacements:v,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:_="none",flipAlignment:T=!0}=f,S=UI(f,Q5),b=co(s),O=co(c)===c,V=yield l.isRTL==null?void 0:l.isRTL(h.floating),B=v||(O||!T?[pd(c)]:q5(c));!v&&_!=="none"&&B.push(...X5(c,T,_,V));let x=[c,...B],w=yield WI(n,S),E=[],C=((i=a.flip)==null?void 0:i.overflows)||[];if(d&&E.push(w[b]),m){let oe=G5(s,o,V);E.push(w[oe[0]],w[oe[1]])}if(C=[...C,{placement:s,overflows:E}],!E.every(oe=>oe<=0)){var D,A;let oe=(((D=a.flip)==null?void 0:D.index)||0)+1,ce=x[oe];if(ce)return{data:{index:oe,overflows:C},reset:{placement:ce}};let ke=(A=C.filter(we=>we.overflows[0]<=0).sort((we,Ne)=>we.overflows[1]-Ne.overflows[1])[0])==null?void 0:A.placement;if(!ke)switch(p){case"bestFit":{var R;let we=(R=C.map(Ne=>[Ne.placement,Ne.overflows.filter(de=>de>0).reduce((de,Ae)=>de+Ae,0)]).sort((Ne,de)=>Ne[1]-de[1])[0])==null?void 0:R[0];we&&(ke=we);break}case"initialPlacement":ke=c;break}if(s!==ke)return{reset:{placement:ke}}}return{}})}}},rB=function(e){return e===void 0&&(e={}),{name:"shift",options:e,fn(n){return te(this,null,function*(){let{x:i,y:s,placement:a}=n,o=Sc(e,n),{mainAxis:c=!0,crossAxis:l=!1,limiter:h={fn:b=>{let{x:O,y:V}=b;return{x:O,y:V}}}}=o,f=UI(o,J5),d={x:i,y:s},m=yield WI(n,f),v=xd(co(a)),p=Zg(v),_=d[p],T=d[v];if(c){let b=p==="y"?"top":"left",O=p==="y"?"bottom":"right",V=_+m[b],B=_-m[O];_=Mg(V,_,B)}if(l){let b=v==="y"?"top":"left",O=v==="y"?"bottom":"right",V=T+m[b],B=T-m[O];T=Mg(V,T,B)}let S=h.fn(Qr({},n,{[p]:_,[v]:T}));return Qr({},S,{data:{x:S.x-i,y:S.y-s}})})}}},nB=function(e){return e===void 0&&(e={}),{options:e,fn(r){let{x:n,y:i,placement:s,rects:a,middlewareData:o}=r,{offset:c=0,mainAxis:l=!0,crossAxis:h=!0}=Sc(e,r),f={x:n,y:i},d=xd(s),m=Zg(d),v=f[m],p=f[d],_=Sc(c,r),T=typeof _=="number"?{mainAxis:_,crossAxis:0}:Qr({mainAxis:0,crossAxis:0},_);if(l){let O=m==="y"?"height":"width",V=a.reference[m]-a.floating[O]+T.mainAxis,B=a.reference[m]+a.reference[O]-T.mainAxis;v<V?v=V:v>B&&(v=B)}if(h){var S,b;let O=m==="y"?"width":"height",V=["top","left"].includes(co(s)),B=a.reference[d]-a.floating[O]+(V&&((S=o.offset)==null?void 0:S[d])||0)+(V?0:T.crossAxis),x=a.reference[d]+a.reference[O]+(V?0:((b=o.offset)==null?void 0:b[d])||0)-(V?T.crossAxis:0);p<B?p=B:p>x&&(p=x)}return{[m]:v,[d]:p}}}};function ea(t){return $I(t)?(t.nodeName||"").toLowerCase():"#document"}function Sn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function cs(t){var e;return(e=($I(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function $I(t){return t instanceof Node||t instanceof Sn(t).Node}function os(t){return t instanceof Element||t instanceof Sn(t).Element}function Oi(t){return t instanceof HTMLElement||t instanceof Sn(t).HTMLElement}function yI(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Sn(t).ShadowRoot}function Bu(t){let{overflow:e,overflowX:r,overflowY:n,display:i}=Yn(t);return/auto|scroll|overlay|hidden|clip/.test(e+n+r)&&!["inline","contents"].includes(i)}function iB(t){return["table","td","th"].includes(ea(t))}function rv(t){let e=nv(),r=Yn(t);return r.transform!=="none"||r.perspective!=="none"||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||["transform","perspective","filter"].some(n=>(r.willChange||"").includes(n))||["paint","layout","strict","content"].some(n=>(r.contain||"").includes(n))}function sB(t){let e=Cc(t);for(;Oi(e)&&!wd(e);){if(rv(e))return e;e=Cc(e)}return null}function nv(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function wd(t){return["html","body","#document"].includes(ea(t))}function Yn(t){return Sn(t).getComputedStyle(t)}function Ed(t){return os(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function Cc(t){if(ea(t)==="html")return t;let e=t.assignedSlot||t.parentNode||yI(t)&&t.host||cs(t);return yI(e)?e.host:e}function HI(t){let e=Cc(t);return wd(e)?t.ownerDocument?t.ownerDocument.body:t.body:Oi(e)&&Bu(e)?e:HI(e)}function gd(t,e){var r;e===void 0&&(e=[]);let n=HI(t),i=n===((r=t.ownerDocument)==null?void 0:r.body),s=Sn(n);return i?e.concat(s,s.visualViewport||[],Bu(n)?n:[]):e.concat(n,gd(n))}function zI(t){let e=Yn(t),r=parseFloat(e.width)||0,n=parseFloat(e.height)||0,i=Oi(t),s=i?t.offsetWidth:r,a=i?t.offsetHeight:n,o=dd(r)!==s||dd(n)!==a;return o&&(r=s,n=a),{width:r,height:n,$:o}}function iv(t){return os(t)?t:t.contextElement}function Tc(t){let e=iv(t);if(!Oi(e))return Zs(1);let r=e.getBoundingClientRect(),{width:n,height:i,$:s}=zI(e),a=(s?dd(r.width):r.width)/n,o=(s?dd(r.height):r.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}var aB=Zs(0);function GI(t){let e=Sn(t);return!nv()||!e.visualViewport?aB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function oB(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Sn(t)?!1:e}function lo(t,e,r,n){e===void 0&&(e=!1),r===void 0&&(r=!1);let i=t.getBoundingClientRect(),s=iv(t),a=Zs(1);e&&(n?os(n)&&(a=Tc(n)):a=Tc(t));let o=oB(s,r,n)?GI(s):Zs(0),c=(i.left+o.x)/a.x,l=(i.top+o.y)/a.y,h=i.width/a.x,f=i.height/a.y;if(s){let d=Sn(s),m=n&&os(n)?Sn(n):n,v=d.frameElement;for(;v&&n&&m!==d;){let p=Tc(v),_=v.getBoundingClientRect(),T=Yn(v),S=_.left+(v.clientLeft+parseFloat(T.paddingLeft))*p.x,b=_.top+(v.clientTop+parseFloat(T.paddingTop))*p.y;c*=p.x,l*=p.y,h*=p.x,f*=p.y,c+=S,l+=b,v=Sn(v).frameElement}}return md({width:h,height:f,x:c,y:l})}function cB(t){let{rect:e,offsetParent:r,strategy:n}=t,i=Oi(r),s=cs(r);if(r===s)return e;let a={scrollLeft:0,scrollTop:0},o=Zs(1),c=Zs(0);if((i||!i&&n!=="fixed")&&((ea(r)!=="body"||Bu(s))&&(a=Ed(r)),Oi(r))){let l=lo(r);o=Tc(r),c.x=l.x+r.clientLeft,c.y=l.y+r.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+c.x,y:e.y*o.y-a.scrollTop*o.y+c.y}}function lB(t){return Array.from(t.getClientRects())}function qI(t){return lo(cs(t)).left+Ed(t).scrollLeft}function uB(t){let e=cs(t),r=Ed(t),n=t.ownerDocument.body,i=io(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=io(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight),a=-r.scrollLeft+qI(t),o=-r.scrollTop;return Yn(n).direction==="rtl"&&(a+=io(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}function hB(t,e){let r=Sn(t),n=cs(t),i=r.visualViewport,s=n.clientWidth,a=n.clientHeight,o=0,c=0;if(i){s=i.width,a=i.height;let l=nv();(!l||l&&e==="fixed")&&(o=i.offsetLeft,c=i.offsetTop)}return{width:s,height:a,x:o,y:c}}function fB(t,e){let r=lo(t,!0,e==="fixed"),n=r.top+t.clientTop,i=r.left+t.clientLeft,s=Oi(t)?Tc(t):Zs(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,c=i*s.x,l=n*s.y;return{width:a,height:o,x:c,y:l}}function xI(t,e,r){let n;if(e==="viewport")n=hB(t,r);else if(e==="document")n=uB(cs(t));else if(os(e))n=fB(e,r);else{let i=GI(t);n=Qr({},e,{x:e.x-i.x,y:e.y-i.y})}return md(n)}function KI(t,e){let r=Cc(t);return r===e||!os(r)||wd(r)?!1:Yn(r).position==="fixed"||KI(r,e)}function dB(t,e){let r=e.get(t);if(r)return r;let n=gd(t).filter(o=>os(o)&&ea(o)!=="body"),i=null,s=Yn(t).position==="fixed",a=s?Cc(t):t;for(;os(a)&&!wd(a);){let o=Yn(a),c=rv(a);!c&&o.position==="fixed"&&(i=null),(s?!c&&!i:!c&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||Bu(a)&&!c&&KI(t,a))?n=n.filter(h=>h!==a):i=o,a=Cc(a)}return e.set(t,n),n}function pB(t){let{element:e,boundary:r,rootBoundary:n,strategy:i}=t,a=[...r==="clippingAncestors"?dB(e,this._c):[].concat(r),n],o=a[0],c=a.reduce((l,h)=>{let f=xI(e,h,i);return l.top=io(f.top,l.top),l.right=Ac(f.right,l.right),l.bottom=Ac(f.bottom,l.bottom),l.left=io(f.left,l.left),l},xI(e,o,i));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function mB(t){return zI(t)}function gB(t,e,r){let n=Oi(e),i=cs(e),s=r==="fixed",a=lo(t,!0,s,e),o={scrollLeft:0,scrollTop:0},c=Zs(0);if(n||!n&&!s)if((ea(e)!=="body"||Bu(i))&&(o=Ed(e)),n){let l=lo(e,!0,s,e);c.x=l.x+e.clientLeft,c.y=l.y+e.clientTop}else i&&(c.x=qI(i));return{x:a.left+o.scrollLeft-c.x,y:a.top+o.scrollTop-c.y,width:a.width,height:a.height}}function wI(t,e){return!Oi(t)||Yn(t).position==="fixed"?null:e?e(t):t.offsetParent}function XI(t,e){let r=Sn(t);if(!Oi(t))return r;let n=wI(t,e);for(;n&&iB(n)&&Yn(n).position==="static";)n=wI(n,e);return n&&(ea(n)==="html"||ea(n)==="body"&&Yn(n).position==="static"&&!rv(n))?r:n||sB(t)||r}var vB=function(e){return te(this,null,function*(){let{reference:r,floating:n,strategy:i}=e,s=this.getOffsetParent||XI,a=this.getDimensions;return{reference:gB(r,yield s(n),i),floating:Qr({x:0,y:0},yield a(n))}})};function _B(t){return Yn(t).direction==="rtl"}var yB={convertOffsetParentRelativeRectToViewportRelativeRect:cB,getDocumentElement:cs,getClippingRect:pB,getOffsetParent:XI,getElementRects:vB,getClientRects:lB,getDimensions:mB,getScale:Tc,isElement:os,isRTL:_B};function xB(t,e){let r=null,n,i=cs(t);function s(){clearTimeout(n),r&&r.disconnect(),r=null}function a(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),s();let{left:l,top:h,width:f,height:d}=t.getBoundingClientRect();if(o||e(),!f||!d)return;let m=hd(h),v=hd(i.clientWidth-(l+f)),p=hd(i.clientHeight-(h+d)),_=hd(l),S={rootMargin:-m+"px "+-v+"px "+-p+"px "+-_+"px",threshold:io(0,Ac(1,c))||1},b=!0;function O(V){let B=V[0].intersectionRatio;if(B!==c){if(!b)return a();B?a(!1,B):n=setTimeout(()=>{a(!1,1e-7)},100)}b=!1}try{r=new IntersectionObserver(O,Qr({},S,{root:i.ownerDocument}))}catch{r=new IntersectionObserver(O,S)}r.observe(t)}return a(!0),s}function wB(t,e,r,n){n===void 0&&(n={});let{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,l=iv(t),h=i||s?[...l?gd(l):[],...gd(e)]:[];h.forEach(T=>{i&&T.addEventListener("scroll",r,{passive:!0}),s&&T.addEventListener("resize",r)});let f=l&&o?xB(l,r):null,d=-1,m=null;a&&(m=new ResizeObserver(T=>{let[S]=T;S&&S.target===l&&m&&(m.unobserve(e),cancelAnimationFrame(d),d=requestAnimationFrame(()=>{m&&m.observe(e)})),r()}),l&&!c&&m.observe(l),m.observe(e));let v,p=c?lo(t):null;c&&_();function _(){let T=lo(t);p&&(T.x!==p.x||T.y!==p.y||T.width!==p.width||T.height!==p.height)&&r(),p=T,v=requestAnimationFrame(_)}return r(),()=>{h.forEach(T=>{i&&T.removeEventListener("scroll",r),s&&T.removeEventListener("resize",r)}),f&&f(),m&&m.disconnect(),m=null,c&&cancelAnimationFrame(v)}}var EB=(t,e,r)=>{let n=new Map,i=Qr({platform:yB},r),s=Qr({},i.platform,{_c:n});return Z5(t,e,Qr({},i,{platform:s}))};function TB(t){t.cleanup&&t.cleanup();let e=t._getResolvedAttachToOptions(),r=e.element,n=kB(e,t),i=BI(e);return i&&(r=document.body,t.shepherdElementComponent.getElement().classList.add("shepherd-centered")),t.cleanup=wB(r,t.el,()=>{if(!t.el){t.cleanup();return}AB(r,t,n,i)}),t.target=e.element,n}function bB(t,e){return{floatingUIOptions:Yg(t.floatingUIOptions||{},e.floatingUIOptions||{})}}function IB(t){t.cleanup&&t.cleanup(),t.cleanup=null}function AB(t,e,r,n){return EB(t,e.el,r).then(SB(e,n)).then(i=>new Promise(s=>{setTimeout(()=>s(i),300)})).then(i=>{i&&i.el&&i.el.focus({preventScroll:!0})})}function SB(t,e){return({x:r,y:n,placement:i,middlewareData:s})=>(t.el&&(e?Object.assign(t.el.style,{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)"}):Object.assign(t.el.style,{position:"absolute",left:`${r}px`,top:`${n}px`}),t.el.dataset.popperPlacement=i,CB(t.el,s)),t)}function CB(t,e){let r=t.querySelector(".shepherd-arrow");if(r&&e.arrow){let{x:n,y:i}=e.arrow;Object.assign(r.style,{left:n!=null?`${n}px`:"",top:i!=null?`${i}px`:""})}}function kB(t,e){let r={strategy:"absolute",middleware:[]},n=DB(e);return BI(t)||(r.middleware.push(tB(),rB({limiter:nB(),crossAxis:!0})),n&&r.middleware.push(eB({element:n})),r.placement=t.on),Yg(e.options.floatingUIOptions||{},r)}function DB(t){return t.options.arrow&&t.el?t.el.querySelector(".shepherd-arrow"):!1}function Cn(){}function RB(t,e){for(let r in e)t[r]=e[r];return t}function YI(t){return t()}function EI(){return Object.create(null)}function Uu(t){t.forEach(YI)}function sv(t){return typeof t=="function"}function ls(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function FB(t){return Object.keys(t).length===0}function kc(t,e){t.appendChild(e)}function fi(t,e,r){t.insertBefore(e,r||null)}function Qn(t){t.parentNode&&t.parentNode.removeChild(t)}function PB(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function Ni(t){return document.createElement(t)}function TI(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function QI(t){return document.createTextNode(t)}function vd(){return QI(" ")}function OB(){return QI("")}function Td(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function Ft(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}var NB=["width","height"];function bI(t,e){let r=Object.getOwnPropertyDescriptors(t.__proto__);for(let n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:r[n]&&r[n].set&&NB.indexOf(n)===-1?t[n]=e[n]:Ft(t,n,e[n])}function MB(t){return Array.from(t.childNodes)}function xc(t,e,r){t.classList[r?"add":"remove"](e)}var Lu;function Pu(t){Lu=t}function JI(){if(!Lu)throw new Error("Function called outside component initialization");return Lu}function LB(t){JI().$$.on_mount.push(t)}function av(t){JI().$$.after_update.push(t)}var Ec=[],Dc=[],bc=[],II=[],VB=Promise.resolve(),Vg=!1;function BB(){Vg||(Vg=!0,VB.then(ZI))}function Bg(t){bc.push(t)}var Ng=new Set,wc=0;function ZI(){if(wc!==0)return;let t=Lu;do{try{for(;wc<Ec.length;){let e=Ec[wc];wc++,Pu(e),UB(e.$$)}}catch(e){throw Ec.length=0,wc=0,e}for(Pu(null),Ec.length=0,wc=0;Dc.length;)Dc.pop()();for(let e=0;e<bc.length;e+=1){let r=bc[e];Ng.has(r)||(Ng.add(r),r())}bc.length=0}while(Ec.length);for(;II.length;)II.pop()();Vg=!1,Ng.clear(),Pu(t)}function UB(t){if(t.fragment!==null){t.update(),Uu(t.before_update);let e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Bg)}}function jB(t){let e=[],r=[];bc.forEach(n=>t.indexOf(n)===-1?e.push(n):r.push(n)),r.forEach(n=>n()),bc=e}var fd=new Set,no;function so(){no={r:0,c:[],p:no}}function ao(){no.r||Uu(no.c),no=no.p}function bt(t,e){t&&t.i&&(fd.delete(t),t.i(e))}function nr(t,e,r,n){if(t&&t.o){if(fd.has(t))return;fd.add(t),no.c.push(()=>{fd.delete(t),n&&(r&&t.d(1),n())}),t.o(e)}else n&&n()}function WB(t,e){let r={},n={},i={$$scope:1},s=t.length;for(;s--;){let a=t[s],o=e[s];if(o){for(let c in a)c in o||(n[c]=1);for(let c in o)i[c]||(r[c]=o[c],i[c]=1);t[s]=o}else for(let c in a)i[c]=1}for(let a in n)a in r||(r[a]=void 0);return r}function uo(t){t&&t.c()}function ta(t,e,r,n){let{fragment:i,after_update:s}=t.$$;i&&i.m(e,r),n||Bg(()=>{let a=t.$$.on_mount.map(YI).filter(sv);t.$$.on_destroy?t.$$.on_destroy.push(...a):Uu(a),t.$$.on_mount=[]}),s.forEach(Bg)}function ra(t,e){let r=t.$$;r.fragment!==null&&(jB(r.after_update),Uu(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function $B(t,e){t.$$.dirty[0]===-1&&(Ec.push(t),BB(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function us(t,e,r,n,i,s,a,o=[-1]){let c=Lu;Pu(t);let l=t.$$={fragment:null,ctx:[],props:s,update:Cn,not_equal:i,bound:EI(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:EI(),dirty:o,skip_bound:!1,root:e.target||c.$$.root};a&&a(l.root);let h=!1;if(l.ctx=r?r(t,e.props||{},(f,d,...m)=>{let v=m.length?m[0]:d;return l.ctx&&i(l.ctx[f],l.ctx[f]=v)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](v),h&&$B(t,f)),d}):[],l.update(),h=!0,Uu(l.before_update),l.fragment=n?n(l.ctx):!1,e.target){if(e.hydrate){let f=MB(e.target);l.fragment&&l.fragment.l(f),f.forEach(Qn)}else l.fragment&&l.fragment.c();e.intro&&bt(t.$$.fragment),ta(t,e.target,e.anchor,e.customElement),ZI()}Pu(c)}var hi=class{$destroy(){ra(this,1),this.$destroy=Cn}$on(e,r){if(!sv(r))return Cn;let n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{let i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!FB(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}};function HB(t){let e,r,n,i,s;return{c(){e=Ni("button"),Ft(e,"aria-label",r=t[3]?t[3]:null),Ft(e,"class",n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`),e.disabled=t[2],Ft(e,"tabindex","0")},m(a,o){fi(a,e,o),e.innerHTML=t[5],i||(s=Td(e,"click",function(){sv(t[0])&&t[0].apply(this,arguments)}),i=!0)},p(a,[o]){t=a,o&32&&(e.innerHTML=t[5]),o&8&&r!==(r=t[3]?t[3]:null)&&Ft(e,"aria-label",r),o&18&&n!==(n=`${t[1]||""} shepherd-button ${t[4]?"shepherd-button-secondary":""}`)&&Ft(e,"class",n),o&4&&(e.disabled=t[2])},i:Cn,o:Cn,d(a){a&&Qn(e),i=!1,s()}}}function zB(t,e,r){let{config:n,step:i}=e,s,a,o,c,l,h;function f(d){return oo(d)?d=d.call(i):d}return t.$$set=d=>{"config"in d&&r(6,n=d.config),"step"in d&&r(7,i=d.step)},t.$$.update=()=>{t.$$.dirty&192&&(r(0,s=n.action?n.action.bind(i.tour):null),r(1,a=n.classes),r(2,o=n.disabled?f(n.disabled):!1),r(3,c=n.label?f(n.label):null),r(4,l=n.secondary),r(5,h=n.text?f(n.text):null))},[s,a,o,c,l,h,n,i]}var Ug=class extends hi{constructor(e){super(),us(this,e,zB,HB,ls,{config:6,step:7})}};function AI(t,e,r){let n=t.slice();return n[2]=e[r],n}function SI(t){let e,r,n=t[1],i=[];for(let a=0;a<n.length;a+=1)i[a]=CI(AI(t,n,a));let s=a=>nr(i[a],1,1,()=>{i[a]=null});return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=OB()},m(a,o){for(let c=0;c<i.length;c+=1)i[c]&&i[c].m(a,o);fi(a,e,o),r=!0},p(a,o){if(o&3){n=a[1];let c;for(c=0;c<n.length;c+=1){let l=AI(a,n,c);i[c]?(i[c].p(l,o),bt(i[c],1)):(i[c]=CI(l),i[c].c(),bt(i[c],1),i[c].m(e.parentNode,e))}for(so(),c=n.length;c<i.length;c+=1)s(c);ao()}},i(a){if(!r){for(let o=0;o<n.length;o+=1)bt(i[o]);r=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)nr(i[o]);r=!1},d(a){PB(i,a),a&&Qn(e)}}}function CI(t){let e,r;return e=new Ug({props:{config:t[2],step:t[0]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.config=n[2]),i&1&&(s.step=n[0]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function GB(t){let e,r,n=t[1]&&SI(t);return{c(){e=Ni("footer"),n&&n.c(),Ft(e,"class","shepherd-footer")},m(i,s){fi(i,e,s),n&&n.m(e,null),r=!0},p(i,[s]){i[1]?n?(n.p(i,s),s&2&&bt(n,1)):(n=SI(i),n.c(),bt(n,1),n.m(e,null)):n&&(so(),nr(n,1,1,()=>{n=null}),ao())},i(i){r||(bt(n),r=!0)},o(i){nr(n),r=!1},d(i){i&&Qn(e),n&&n.d()}}}function qB(t,e,r){let n,{step:i}=e;return t.$$set=s=>{"step"in s&&r(0,i=s.step)},t.$$.update=()=>{t.$$.dirty&1&&r(1,n=i.options.buttons)},[i,n]}var jg=class extends hi{constructor(e){super(),us(this,e,qB,GB,ls,{step:0})}};function KB(t){let e,r,n,i,s;return{c(){e=Ni("button"),r=Ni("span"),r.textContent="\xD7",Ft(r,"aria-hidden","true"),Ft(e,"aria-label",n=t[0].label?t[0].label:"Close Tour"),Ft(e,"class","shepherd-cancel-icon"),Ft(e,"type","button")},m(a,o){fi(a,e,o),kc(e,r),i||(s=Td(e,"click",t[1]),i=!0)},p(a,[o]){o&1&&n!==(n=a[0].label?a[0].label:"Close Tour")&&Ft(e,"aria-label",n)},i:Cn,o:Cn,d(a){a&&Qn(e),i=!1,s()}}}function XB(t,e,r){let{cancelIcon:n,step:i}=e,s=a=>{a.preventDefault(),i.cancel()};return t.$$set=a=>{"cancelIcon"in a&&r(0,n=a.cancelIcon),"step"in a&&r(2,i=a.step)},[n,s,i]}var Wg=class extends hi{constructor(e){super(),us(this,e,XB,KB,ls,{cancelIcon:0,step:2})}};function YB(t){let e;return{c(){e=Ni("h3"),Ft(e,"id",t[1]),Ft(e,"class","shepherd-title")},m(r,n){fi(r,e,n),t[3](e)},p(r,[n]){n&2&&Ft(e,"id",r[1])},i:Cn,o:Cn,d(r){r&&Qn(e),t[3](null)}}}function QB(t,e,r){let{labelId:n,element:i,title:s}=e;av(()=>{oo(s)&&r(2,s=s()),r(0,i.innerHTML=s,i)});function a(o){Dc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"labelId"in o&&r(1,n=o.labelId),"element"in o&&r(0,i=o.element),"title"in o&&r(2,s=o.title)},[i,n,s,a]}var $g=class extends hi{constructor(e){super(),us(this,e,QB,YB,ls,{labelId:1,element:0,title:2})}};function kI(t){let e,r;return e=new $g({props:{labelId:t[0],title:t[2]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.labelId=n[0]),i&4&&(s.title=n[2]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function DI(t){let e,r;return e=new Wg({props:{cancelIcon:t[3],step:t[1]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&8&&(s.cancelIcon=n[3]),i&2&&(s.step=n[1]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function JB(t){let e,r,n,i=t[2]&&kI(t),s=t[3]&&t[3].enabled&&DI(t);return{c(){e=Ni("header"),i&&i.c(),r=vd(),s&&s.c(),Ft(e,"class","shepherd-header")},m(a,o){fi(a,e,o),i&&i.m(e,null),kc(e,r),s&&s.m(e,null),n=!0},p(a,[o]){a[2]?i?(i.p(a,o),o&4&&bt(i,1)):(i=kI(a),i.c(),bt(i,1),i.m(e,r)):i&&(so(),nr(i,1,1,()=>{i=null}),ao()),a[3]&&a[3].enabled?s?(s.p(a,o),o&8&&bt(s,1)):(s=DI(a),s.c(),bt(s,1),s.m(e,null)):s&&(so(),nr(s,1,1,()=>{s=null}),ao())},i(a){n||(bt(i),bt(s),n=!0)},o(a){nr(i),nr(s),n=!1},d(a){a&&Qn(e),i&&i.d(),s&&s.d()}}}function ZB(t,e,r){let{labelId:n,step:i}=e,s,a;return t.$$set=o=>{"labelId"in o&&r(0,n=o.labelId),"step"in o&&r(1,i=o.step)},t.$$.update=()=>{t.$$.dirty&2&&(r(2,s=i.options.title),r(3,a=i.options.cancelIcon))},[n,i,s,a]}var Hg=class extends hi{constructor(e){super(),us(this,e,ZB,JB,ls,{labelId:0,step:1})}};function eU(t){let e;return{c(){e=Ni("div"),Ft(e,"class","shepherd-text"),Ft(e,"id",t[1])},m(r,n){fi(r,e,n),t[3](e)},p(r,[n]){n&2&&Ft(e,"id",r[1])},i:Cn,o:Cn,d(r){r&&Qn(e),t[3](null)}}}function tU(t,e,r){let{descriptionId:n,element:i,step:s}=e;av(()=>{let{text:o}=s.options;oo(o)&&(o=o.call(s)),Qg(o)?i.appendChild(o):r(0,i.innerHTML=o,i)});function a(o){Dc[o?"unshift":"push"](()=>{i=o,r(0,i)})}return t.$$set=o=>{"descriptionId"in o&&r(1,n=o.descriptionId),"element"in o&&r(0,i=o.element),"step"in o&&r(2,s=o.step)},[i,n,s,a]}var zg=class extends hi{constructor(e){super(),us(this,e,tU,eU,ls,{descriptionId:1,element:0,step:2})}};function RI(t){let e,r;return e=new Hg({props:{labelId:t[1],step:t[2]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&2&&(s.labelId=n[1]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function FI(t){let e,r;return e=new zg({props:{descriptionId:t[0],step:t[2]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&1&&(s.descriptionId=n[0]),i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function PI(t){let e,r;return e=new jg({props:{step:t[2]}}),{c(){uo(e.$$.fragment)},m(n,i){ta(e,n,i),r=!0},p(n,i){let s={};i&4&&(s.step=n[2]),e.$set(s)},i(n){r||(bt(e.$$.fragment,n),r=!0)},o(n){nr(e.$$.fragment,n),r=!1},d(n){ra(e,n)}}}function rU(t){let e,r=!Yr(t[2].options.title)||t[2].options.cancelIcon&&t[2].options.cancelIcon.enabled,n,i=!Yr(t[2].options.text),s,a=Array.isArray(t[2].options.buttons)&&t[2].options.buttons.length,o,c=r&&RI(t),l=i&&FI(t),h=a&&PI(t);return{c(){e=Ni("div"),c&&c.c(),n=vd(),l&&l.c(),s=vd(),h&&h.c(),Ft(e,"class","shepherd-content")},m(f,d){fi(f,e,d),c&&c.m(e,null),kc(e,n),l&&l.m(e,null),kc(e,s),h&&h.m(e,null),o=!0},p(f,[d]){d&4&&(r=!Yr(f[2].options.title)||f[2].options.cancelIcon&&f[2].options.cancelIcon.enabled),r?c?(c.p(f,d),d&4&&bt(c,1)):(c=RI(f),c.c(),bt(c,1),c.m(e,n)):c&&(so(),nr(c,1,1,()=>{c=null}),ao()),d&4&&(i=!Yr(f[2].options.text)),i?l?(l.p(f,d),d&4&&bt(l,1)):(l=FI(f),l.c(),bt(l,1),l.m(e,s)):l&&(so(),nr(l,1,1,()=>{l=null}),ao()),d&4&&(a=Array.isArray(f[2].options.buttons)&&f[2].options.buttons.length),a?h?(h.p(f,d),d&4&&bt(h,1)):(h=PI(f),h.c(),bt(h,1),h.m(e,null)):h&&(so(),nr(h,1,1,()=>{h=null}),ao())},i(f){o||(bt(c),bt(l),bt(h),o=!0)},o(f){nr(c),nr(l),nr(h),o=!1},d(f){f&&Qn(e),c&&c.d(),l&&l.d(),h&&h.d()}}}function nU(t,e,r){let{descriptionId:n,labelId:i,step:s}=e;return t.$$set=a=>{"descriptionId"in a&&r(0,n=a.descriptionId),"labelId"in a&&r(1,i=a.labelId),"step"in a&&r(2,s=a.step)},[n,i,s]}var Gg=class extends hi{constructor(e){super(),us(this,e,nU,rU,ls,{descriptionId:0,labelId:1,step:2})}};function OI(t){let e;return{c(){e=Ni("div"),Ft(e,"class","shepherd-arrow"),Ft(e,"data-popper-arrow","")},m(r,n){fi(r,e,n)},d(r){r&&Qn(e)}}}function iU(t){let e,r,n,i,s,a,o,c,l=t[4].options.arrow&&t[4].options.attachTo&&t[4].options.attachTo.element&&t[4].options.attachTo.on&&OI();n=new Gg({props:{descriptionId:t[2],labelId:t[3],step:t[4]}});let h=[{"aria-describedby":i=Yr(t[4].options.text)?null:t[2]},{"aria-labelledby":s=t[4].options.title?t[3]:null},t[1],{role:"dialog"},{tabindex:"0"}],f={};for(let d=0;d<h.length;d+=1)f=RB(f,h[d]);return{c(){e=Ni("div"),l&&l.c(),r=vd(),uo(n.$$.fragment),bI(e,f),xc(e,"shepherd-has-cancel-icon",t[5]),xc(e,"shepherd-has-title",t[6]),xc(e,"shepherd-element",!0)},m(d,m){fi(d,e,m),l&&l.m(e,null),kc(e,r),ta(n,e,null),t[13](e),a=!0,o||(c=Td(e,"keydown",t[7]),o=!0)},p(d,[m]){d[4].options.arrow&&d[4].options.attachTo&&d[4].options.attachTo.element&&d[4].options.attachTo.on?l||(l=OI(),l.c(),l.m(e,r)):l&&(l.d(1),l=null);let v={};m&4&&(v.descriptionId=d[2]),m&8&&(v.labelId=d[3]),m&16&&(v.step=d[4]),n.$set(v),bI(e,f=WB(h,[(!a||m&20&&i!==(i=Yr(d[4].options.text)?null:d[2]))&&{"aria-describedby":i},(!a||m&24&&s!==(s=d[4].options.title?d[3]:null))&&{"aria-labelledby":s},m&2&&d[1],{role:"dialog"},{tabindex:"0"}])),xc(e,"shepherd-has-cancel-icon",d[5]),xc(e,"shepherd-has-title",d[6]),xc(e,"shepherd-element",!0)},i(d){a||(bt(n.$$.fragment,d),a=!0)},o(d){nr(n.$$.fragment,d),a=!1},d(d){d&&Qn(e),l&&l.d(),ra(n),t[13](null),o=!1,c()}}}var sU=9,aU=27,oU=37,cU=39;function NI(t){return t.split(" ").filter(e=>!!e.length)}function lU(t,e,r){let{classPrefix:n,element:i,descriptionId:s,firstFocusableElement:a,focusableElements:o,labelId:c,lastFocusableElement:l,step:h,dataStepId:f}=e,d,m,v,p=()=>i;LB(()=>{r(1,f={[`data-${n}shepherd-step-id`]:h.id}),r(9,o=i.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex="0"]')),r(8,a=o[0]),r(10,l=o[o.length-1])}),av(()=>{v!==h.options.classes&&_()});function _(){T(v),v=h.options.classes,S(v)}function T(V){if(Nu(V)){let B=NI(V);B.length&&i.classList.remove(...B)}}function S(V){if(Nu(V)){let B=NI(V);B.length&&i.classList.add(...B)}}let b=V=>{let{tour:B}=h;switch(V.keyCode){case sU:if(o.length===0){V.preventDefault();break}V.shiftKey?(document.activeElement===a||document.activeElement.classList.contains("shepherd-element"))&&(V.preventDefault(),l.focus()):document.activeElement===l&&(V.preventDefault(),a.focus());break;case aU:B.options.exitOnEsc&&(V.stopPropagation(),h.cancel());break;case oU:B.options.keyboardNavigation&&(V.stopPropagation(),B.back());break;case cU:B.options.keyboardNavigation&&(V.stopPropagation(),B.next());break}};function O(V){Dc[V?"unshift":"push"](()=>{i=V,r(0,i)})}return t.$$set=V=>{"classPrefix"in V&&r(11,n=V.classPrefix),"element"in V&&r(0,i=V.element),"descriptionId"in V&&r(2,s=V.descriptionId),"firstFocusableElement"in V&&r(8,a=V.firstFocusableElement),"focusableElements"in V&&r(9,o=V.focusableElements),"labelId"in V&&r(3,c=V.labelId),"lastFocusableElement"in V&&r(10,l=V.lastFocusableElement),"step"in V&&r(4,h=V.step),"dataStepId"in V&&r(1,f=V.dataStepId)},t.$$.update=()=>{t.$$.dirty&16&&(r(5,d=h.options&&h.options.cancelIcon&&h.options.cancelIcon.enabled),r(6,m=h.options&&h.options.title))},[i,f,s,c,h,d,m,b,a,o,l,n,p,O]}var qg=class extends hi{constructor(e){super(),us(this,e,lU,iU,ls,{classPrefix:11,element:0,descriptionId:2,firstFocusableElement:8,focusableElements:9,labelId:3,lastFocusableElement:10,step:4,dataStepId:1,getElement:12})}get getElement(){return this.$$.ctx[12]}},Vu=class extends Mu{constructor(e,r={}){return super(e,r),this.tour=e,this.classPrefix=this.tour.options?VI(this.tour.options.classPrefix):"",this.styles=e.styles,this._resolvedAttachTo=null,LI(this),this._setOptions(r),this}cancel(){this.tour.cancel(),this.trigger("cancel")}complete(){this.tour.complete(),this.trigger("complete")}destroy(){IB(this),Qg(this.el)&&(this.el.remove(),this.el=null),this._updateStepTargetOnHide(),this.trigger("destroy")}getTour(){return this.tour}hide(){this.tour.modal.hide(),this.trigger("before-hide"),this.el&&(this.el.hidden=!0),this._updateStepTargetOnHide(),this.trigger("hide")}_resolveAttachToOptions(){return this._resolvedAttachTo=$5(this),this._resolvedAttachTo}_getResolvedAttachToOptions(){return this._resolvedAttachTo===null?this._resolveAttachToOptions():this._resolvedAttachTo}isOpen(){return!!(this.el&&!this.el.hidden)}show(){return oo(this.options.beforeShowPromise)?Promise.resolve(this.options.beforeShowPromise()).then(()=>this._show()):Promise.resolve(this._show())}updateStepOptions(e){Object.assign(this.options,e),this.shepherdElementComponent&&this.shepherdElementComponent.$set({step:this})}getElement(){return this.el}getTarget(){return this.target}_createTooltipContent(){let e=`${this.id}-description`,r=`${this.id}-label`;return this.shepherdElementComponent=new qg({target:this.tour.options.stepsContainer||document.body,props:{classPrefix:this.classPrefix,descriptionId:e,labelId:r,step:this,styles:this.styles}}),this.shepherdElementComponent.getElement()}_scrollTo(e){let{element:r}=this._getResolvedAttachToOptions();oo(this.options.scrollToHandler)?this.options.scrollToHandler(r):U5(r)&&typeof r.scrollIntoView=="function"&&r.scrollIntoView(e)}_getClassOptions(e){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions,n=e.classes?e.classes:"",i=r&&r.classes?r.classes:"",s=[...n.split(" "),...i.split(" ")],a=new Set(s);return Array.from(a).join(" ").trim()}_setOptions(e={}){let r=this.tour&&this.tour.options&&this.tour.options.defaultStepOptions;r=Yg({},r||{}),this.options=Object.assign({arrow:!0},r,e,bB(r,e));let{when:n}=this.options;this.options.classes=this._getClassOptions(e),this.destroy(),this.id=this.options.id||`step-${Jg()}`,n&&Object.keys(n).forEach(i=>{this.on(i,n[i],this)})}_setupElements(){Yr(this.el)||this.destroy(),this.el=this._createTooltipContent(),this.options.advanceOn&&W5(this),TB(this)}_show(){this.trigger("before-show"),this._resolveAttachToOptions(),this._setupElements(),this.tour.modal||this.tour._setupModal(),this.tour.modal.setupForStep(this),this._styleTargetElementForStep(this),this.el.hidden=!1,this.options.scrollTo&&setTimeout(()=>{this._scrollTo(this.options.scrollTo)}),this.el.hidden=!1;let e=this.shepherdElementComponent.getElement(),r=this.target||document.body;r.classList.add(`${this.classPrefix}shepherd-enabled`),r.classList.add(`${this.classPrefix}shepherd-target`),e.classList.add("shepherd-enabled"),this.trigger("show")}_styleTargetElementForStep(e){let r=e.target;r&&(e.options.highlightClass&&r.classList.add(e.options.highlightClass),r.classList.remove("shepherd-target-click-disabled"),e.options.canClickTarget===!1&&r.classList.add("shepherd-target-click-disabled"))}_updateStepTargetOnHide(){let e=this.target||document.body;this.options.highlightClass&&e.classList.remove(this.options.highlightClass),e.classList.remove("shepherd-target-click-disabled",`${this.classPrefix}shepherd-enabled`,`${this.classPrefix}shepherd-target`)}};function uU(t){if(t){let{steps:e}=t;e.forEach(r=>{r.options&&r.options.canClickTarget===!1&&r.options.attachTo&&r.target instanceof HTMLElement&&r.target.classList.remove("shepherd-target-click-disabled")})}}function hU({width:t,height:e,x:r=0,y:n=0,r:i=0}){let{innerWidth:s,innerHeight:a}=window,{topLeft:o=0,topRight:c=0,bottomRight:l=0,bottomLeft:h=0}=typeof i=="number"?{topLeft:i,topRight:i,bottomRight:i,bottomLeft:i}:i;return`M${s},${a}H0V0H${s}V${a}ZM${r+o},${n}a${o},${o},0,0,0-${o},${o}V${e+n-h}a${h},${h},0,0,0,${h},${h}H${t+r-l}a${l},${l},0,0,0,${l}-${l}V${n+c}a${c},${c},0,0,0-${c}-${c}Z`}function fU(t){let e,r,n,i,s;return{c(){e=TI("svg"),r=TI("path"),Ft(r,"d",t[2]),Ft(e,"class",n=`${t[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)},m(a,o){fi(a,e,o),kc(e,r),t[11](e),i||(s=Td(e,"touchmove",t[3]),i=!0)},p(a,[o]){o&4&&Ft(r,"d",a[2]),o&2&&n!==(n=`${a[1]?"shepherd-modal-is-visible":""} shepherd-modal-overlay-container`)&&Ft(e,"class",n)},i:Cn,o:Cn,d(a){a&&Qn(e),t[11](null),i=!1,s()}}}function eA(t){if(!t)return null;let r=t instanceof HTMLElement&&window.getComputedStyle(t).overflowY;return r!=="hidden"&&r!=="visible"&&t.scrollHeight>=t.clientHeight?t:eA(t.parentElement)}function dU(t,e){let r=t.getBoundingClientRect(),n=r.y||r.top,i=r.bottom||n+r.height;if(e){let a=e.getBoundingClientRect(),o=a.y||a.top,c=a.bottom||o+a.height;n=Math.max(n,o),i=Math.min(i,c)}let s=Math.max(i-n,0);return{y:n,height:s}}function pU(t,e,r){let{element:n,openingProperties:i}=e;Jg();let s=!1,a,o;l();let c=()=>n;function l(){r(4,i={width:0,height:0,x:0,y:0,r:0})}function h(){r(1,s=!1),T()}function f(O=0,V=0,B,x){if(x){let{y:w,height:E}=dU(x,B),{x:C,width:D,left:A}=x.getBoundingClientRect();r(4,i={width:D+O*2,height:E+O*2,x:(C||A)-O,y:w-O,r:V})}else l()}function d(O){T(),O.tour.options.useModalOverlay?(S(O),m()):h()}function m(){r(1,s=!0)}let v=O=>{O.preventDefault()},p=O=>{O.stopPropagation()};function _(){window.addEventListener("touchmove",v,{passive:!1})}function T(){a&&(cancelAnimationFrame(a),a=void 0),window.removeEventListener("touchmove",v,{passive:!1})}function S(O){let{modalOverlayOpeningPadding:V,modalOverlayOpeningRadius:B}=O.options,x=eA(O.target),w=()=>{a=void 0,f(V,B,x,O.target),a=requestAnimationFrame(w)};w(),_()}function b(O){Dc[O?"unshift":"push"](()=>{n=O,r(0,n)})}return t.$$set=O=>{"element"in O&&r(0,n=O.element),"openingProperties"in O&&r(4,i=O.openingProperties)},t.$$.update=()=>{t.$$.dirty&16&&r(2,o=hU(i))},[n,s,o,p,i,c,l,h,f,d,m,b]}var Kg=class extends hi{constructor(e){super(),us(this,e,pU,fU,ls,{element:0,openingProperties:4,getElement:5,closeModalOpening:6,hide:7,positionModal:8,setupForStep:9,show:10})}get getElement(){return this.$$.ctx[5]}get closeModalOpening(){return this.$$.ctx[6]}get hide(){return this.$$.ctx[7]}get positionModal(){return this.$$.ctx[8]}get setupForStep(){return this.$$.ctx[9]}get show(){return this.$$.ctx[10]}},Js=new Mu,Xg=class extends Mu{constructor(e={}){super(e),LI(this);let r={exitOnEsc:!0,keyboardNavigation:!0};return this.options=Object.assign({},r,e),this.classPrefix=VI(this.options.classPrefix),this.steps=[],this.addSteps(this.options.steps),["active","cancel","complete","inactive","show","start"].map(i=>{(s=>{this.on(s,a=>{a=a||{},a.tour=this,Js.trigger(s,a)})})(i)}),this._setTourID(),this}addStep(e,r){let n=e;return n instanceof Vu?n.tour=this:n=new Vu(this,n),Yr(r)?this.steps.push(n):this.steps.splice(r,0,n),n}addSteps(e){return Array.isArray(e)&&e.forEach(r=>{this.addStep(r)}),this}back(){let e=this.steps.indexOf(this.currentStep);this.show(e-1,!1)}cancel(){return te(this,null,function*(){if(this.options.confirmCancel){let e=typeof this.options.confirmCancel=="function",r=this.options.confirmCancelMessage||"Are you sure you want to stop the tour?";(e?yield this.options.confirmCancel():window.confirm(r))&&this._done("cancel")}else this._done("cancel")})}complete(){this._done("complete")}getById(e){return this.steps.find(r=>r.id===e)}getCurrentStep(){return this.currentStep}hide(){let e=this.getCurrentStep();if(e)return e.hide()}isActive(){return Js.activeTour===this}next(){let e=this.steps.indexOf(this.currentStep);e===this.steps.length-1?this.complete():this.show(e+1,!0)}removeStep(e){let r=this.getCurrentStep();this.steps.some((n,i)=>{if(n.id===e)return n.isOpen()&&n.hide(),n.destroy(),this.steps.splice(i,1),!0}),r&&r.id===e&&(this.currentStep=void 0,this.steps.length?this.show(0):this.cancel())}show(e=0,r=!0){let n=Nu(e)?this.getById(e):this.steps[e];n&&(this._updateStateBeforeShow(),oo(n.options.showOn)&&!n.options.showOn()?this._skipStep(n,r):(this.trigger("show",{step:n,previous:this.currentStep}),this.currentStep=n,n.show()))}start(){this.trigger("start"),this.focusedElBeforeOpen=document.activeElement,this.currentStep=null,this._setupModal(),this._setupActiveTour(),this.next()}_done(e){let r=this.steps.indexOf(this.currentStep);if(Array.isArray(this.steps)&&this.steps.forEach(n=>n.destroy()),uU(this),this.trigger(e,{index:r}),Js.activeTour=null,this.trigger("inactive",{tour:this}),this.modal&&this.modal.hide(),(e==="cancel"||e==="complete")&&this.modal){let n=document.querySelector(".shepherd-modal-overlay-container");n&&n.remove()}Qg(this.focusedElBeforeOpen)&&this.focusedElBeforeOpen.focus()}_setupActiveTour(){this.trigger("active",{tour:this}),Js.activeTour=this}_setupModal(){this.modal=new Kg({target:this.options.modalContainer||document.body,props:{classPrefix:this.classPrefix,styles:this.styles}})}_skipStep(e,r){let n=this.steps.indexOf(e);if(n===this.steps.length-1)this.complete();else{let i=r?n+1:n-1;this.show(i,r)}}_updateStateBeforeShow(){this.currentStep&&this.currentStep.hide(),this.isActive()||this._setupActiveTour()}_setTourID(){let e=this.options.tourName||"tour";this.id=`${e}--${Jg()}`}},mU=typeof window>"u",_d=class{constructor(){}};mU?Object.assign(Js,{Tour:_d,Step:_d}):Object.assign(Js,{Tour:Xg,Step:Vu});function gU(t){return t.offsetWidth===0&&t.offsetHeight===0}function vU(t){let{classes:e,disabled:r,label:n,secondary:i,type:s,text:a}=t,o=["back","cancel","next"];if(!s)return t;if(o.indexOf(s)===-1)throw new Error("'type' property must be one of 'back', 'cancel', or 'next'");return{action:this[s].bind(this),classes:e,disabled:r,label:n,secondary:i,text:a}}var tA=(()=>{let e=class e{constructor(){this.confirmCancel=!1,this.confirmCancelMessage=null,this.defaultStepOptions={},this.errorTitle=null,this.isActive=!1,this.keyboardNavigation=!0,this.messageForUser=null,this.modal=!1,this.requiredElements=[],this.tourName=void 0,this.tourObject=null,this.exitOnEsc=!0}back(){this.tourObject.back()}cancel(){this.tourObject.cancel()}complete(){this.tourObject.complete()}hide(){this.tourObject.hide()}next(){this.tourObject.next()}show(n){this.tourObject.show(n)}start(){this.isActive=!0,this.tourObject.start()}onTourFinish(n){this.isActive=!1}addSteps(n){this._initialize();let i=this.tourObject;if(!(!n||!Array.isArray(n)||n.length===0)){if(!this.requiredElementsPresent()){i.addStep({buttons:[{text:"Exit",action:i.cancel}],id:"error",title:this.errorTitle,text:[this.messageForUser]});return}n.forEach(s=>{s.buttons&&(s.buttons=s.buttons.map(vU.bind(this),this)),i.addStep(s)})}}requiredElementsPresent(){let n=!0;return this.requiredElements.forEach(i=>{let s=document.querySelector(i.selector);n&&(!s||gU(s))&&(n=!1,this.errorTitle=i.title,this.messageForUser=i.message)}),n}_initialize(){let n=new Js.Tour({confirmCancel:this.confirmCancel,confirmCancelMessage:this.confirmCancelMessage,defaultStepOptions:this.defaultStepOptions,keyboardNavigation:this.keyboardNavigation,tourName:this.tourName,useModalOverlay:this.modal,exitOnEsc:this.exitOnEsc});n.on("complete",this.onTourFinish.bind(this,"complete")),n.on("cancel",this.onTourFinish.bind(this,"cancel")),this.tourObject=n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var yU=(t,e,r)=>({"bg-red-500":t,"bg-gray-300 cursor-not-allowed":e,"hover:bg-red-600":r});function xU(t,e){if(t&1&&(Z(0,"li",37),ve(1),J()),t&2){let r=e.$implicit;De(),ks(" ",r," ")}}function wU(t,e){if(t&1&&(Z(0,"div",32)(1,"div",33)(2,"div",34),ve(3),J()(),Z(4,"ul",35),gt(5,xU,2,1,"li",36),J()()),t&2){let r=e.$implicit,n=e.index;De(3),Ny("",n+1,". ",r.pregunta,""),De(2),Me("ngForOf",r.respuesta)}}function EU(t,e){if(t&1){let r=Ki();Z(0,"app-header",38),ct("guardarHeader",function(i){_i(r);let s=_r();return yi(s.actualizarHeader(i))})("cerrarModal",function(){_i(r);let i=_r();return yi(i.mostrarModal=!1)}),J()}}function TU(t,e){t&1&&(Z(0,"div",39),ve(1," No se pueden crear m\xE1s de 30 evaluaciones en celular. "),J())}function bU(t,e){t&1&&(Z(0,"div",39),ve(1," La cantidad de evaluaciones debe ser al menos 1. "),J())}function IU(t,e){t&1&&(Z(0,"div",39),ve(1," No se puede tener m\xE1s de 20 preguntas por evaluaci\xF3n. "),J())}function AU(t,e){t&1&&(Z(0,"div",39),ve(1," La cantidad de preguntas debe ser al menos 1. "),J())}function SU(t,e){if(t&1){let r=Ki();Z(0,"div",40)(1,"label",41),ve(2,"Cantidad de preguntas por evaluaci\xF3n:"),J(),Z(3,"input",18),xn("ngModelChange",function(i){_i(r);let s=_r();return yn(s.preguntasPorExamen,i)||(s.preguntasPorExamen=i),yi(i)}),J(),gt(4,IU,2,0,"div",19)(5,AU,2,0,"div",19),J()}if(t&2){let r=_r();De(3),Cs("border-red-500",r.preguntasPorExamen>20&&r.isMobile||r.preguntasPorExamen<1),_n("ngModel",r.preguntasPorExamen),Me("min",1),De(),Me("ngIf",r.preguntasPorExamen>20&&r.isMobile),De(),Me("ngIf",r.preguntasPorExamen<1)}}function CU(t,e){if(t&1){let r=Ki();Z(0,"div")(1,"label",42),ve(2,"Puntaje total por examen:"),J(),Z(3,"input",43),xn("ngModelChange",function(i){_i(r);let s=_r();return yn(s.puntajeTotal,i)||(s.puntajeTotal=i),yi(i)}),J()()}if(t&2){let r=_r();De(3),_n("ngModel",r.puntajeTotal)}}function kU(t,e){t&1&&ze(0,"i",44)}function DU(t,e){t&1&&ze(0,"div",45)}function RU(t,e){t&1&&ze(0,"app-loading-print",46)}var rA=(()=>{let e=class e{constructor(n,i,s,a,o){this.fb=n,this.http=i,this.examService=s,this.headerDataService=a,this.shepherdService=o,this.toastService=Ce(Qs),this.mapeoDificultad={facil:"F\xE1cil",f\u00E1cil:"F\xE1cil",media:"Media",dificil:"Dif\xEDcil",dif\u00EDcil:"Dif\xEDcil"},this.toast={message:"",type:"",active:!1},this.tutorialSeen=localStorage.getItem("tutorialSeen"),this.information=localStorage.getItem("information"),this.preguntasList=[],this.dificultad=1,this.preguntasPorExamen=1,this.cantidadExamenes=1,this.puntajeTotal=0,this.criterioSeleccionado="questionsPerExam",this.cargandoPDF=!1,this.mostrarModal=!1,this.institucion="",this.examen="",this.fecha="",this.duracion="",this.profesor="",this.catedra="",this.dniChecked=!1,this.puntosChecked=!1,this.logoFiles=[],this.loading=!1;let c=`
    Qu\xE9 gusto tiene la sal?
    Salada
    Amarga
    Dulce
    
    Cu\xE1ntos a\xF1os tiene Mirtha Legrand?
    98
    95
    97
`,l=navigator.userAgent;this.isMobile=/Mobi|Android|iPhone|iPad|iPod/.test(l),this.isMobile&&this.toastService.showToast({type:"info",message:"Ya est\xE1 disponible la descarga del PDF en dispositivos m\xF3viles.",active:!0}),this.questionForm=this.fb.group({preguntasTextarea:[c,[si.required]]})}ngAfterViewInit(){this.shepherdService.defaultStepOptions={arrow:!0,cancelIcon:{enabled:!0},scrollTo:{behavior:"smooth",block:"center"},when:{show:function(){if(this.id!="firstStep"){let i=this.getElement()?.querySelector(".shepherd-footer");i?.classList.remove("single-button","multiple-buttons"),i?.classList.add("multiple-buttons")}}}},this.shepherdService.modal=!0,this.shepherdService.confirmCancel=!1,this.shepherdService.addSteps([{id:"firstStep",text:"Gracias por elegir nuestra aplicaci\xF3n. Te voy a guiar en un recorrido breve para que puedas aprovechar todas sus funcionalidades.",modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Siguiente",action(){return this.next()}}]},{text:"Ac\xE1 pod\xE9s modificar el membrete de la evaluaci\xF3n. Hac\xE9 clic para abrir el popup.",attachTo:{element:"#buttonModal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.next()},1))}]},{text:`
        Estos son los campos opcionales que pod\xE9s modificar en el membrete. Si no los complet\xE1s, se mostrar\xE1n la fecha, el puntaje total y el nombre del examen.
        <br><br>
        <strong>Instituci\xF3n:</strong> Nombre de la instituci\xF3n.
        <br><br>
        <strong>Logos:</strong> Agreg\xE1 uno o varios logos.
        <br><br>
        <strong>Examen:</strong> Nombre del examen.
        <br><br>
        <strong>Fecha:</strong> Fecha del examen.
        <br><br>
        <strong>Duraci\xF3n:</strong> Duraci\xF3n (en horas o minutos).
        <br><br>
        <strong>Profesor:</strong> Nombre del profesor.
        <br><br>
        <strong>C\xE1tedra:</strong> Nombre de la materia.
        <br><br>
        <strong>DNI Alumno:</strong> Incluir campo DNI.
        <br><br>
        <strong>Puntos:</strong> Mostrar los puntos por pregunta (calculados autom\xE1ticamente).
        `,attachTo:{element:"#modal",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!1,this.shepherdService.back())},{text:"Siguiente",action:()=>(this.mostrarModal=!1,this.shepherdService.next())}]},{text:`
        Ac\xE1 se ingresan las preguntas.
        <br><br>
        El formato a seguir es:
        <br><br>
        <strong>Pregunta:</strong>
        <br>
        <strong>Opciones de respuesta</strong> <span class="text-sm text-gray-500">(opcional)</span>
        <br>
        <strong>Presionar la tecla Enter</strong> para agregar la siguiente pregunta.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        - Si no se agregan opciones de respuesta, solo se mostrar\xE1 la pregunta.
        <br>
        - Record\xE1 presionar Enter despu\xE9s de ingresar cada pregunta para a\xF1adir la siguiente.
        `,attachTo:{element:"#preguntasTextarea",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action:()=>(this.mostrarModal=!0,setTimeout(()=>{this.shepherdService.back()},1))},{text:"Siguiente",action(){return this.next()}}]},{text:"Una vez que hayas ingresado todas las preguntas, hac\xE9 clic en este bot\xF3n para guardarlas.",attachTo:{element:"#guardarPreguntas",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Aqu\xED es donde ingres\xE1s las cantidades deseadas. 
        Si no se completan estos campos, no se podr\xE1 generar el PDF.
        <br><br>
        <strong>Cantidad de evaluaciones:</strong> Indica cu\xE1ntas evaluaciones quer\xE9s generar.
        <br><br>
        <strong>Cantidad de preguntas por evaluaci\xF3n:</strong> Define cu\xE1ntas preguntas tendr\xE1 cada evaluaci\xF3n.
        <br><br>
        <strong>IMPORTANTE:</strong>
        <br>
        La cantidad de preguntas no puede superar el total de preguntas ingresadas.
        `,attachTo:{element:"#cantidades",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        Estos son los tres botones m\xE1s importantes de la aplicaci\xF3n:
        <br><br>
        <strong class="text-green-600">Verde:</strong> Descarga un Excel con las preguntas de la evaluaci\xF3n.
        <br><br>
        <strong class="text-yellow-600">Amarillo:</strong> Permite cargar el Excel que descargaste, evitando que tengas que volver a escribir las preguntas.
        <br><br>
        <strong class="text-red-600">Rojo:</strong> Genera el PDF con los ex\xE1menes.
        `,attachTo:{element:"#botones",on:"right"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:"En esta secci\xF3n se mostrar\xE1n todas las preguntas que hayas agregado.",attachTo:{element:"#listadoPreguntas",on:"left"},modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Siguiente",action(){return this.next()}}]},{text:`
        \xA1Mucho \xE9xito! Si ten\xE9s alguna duda o sugerencia, no dudes en <a href="#contacto" class="text-blue-600 hover:text-blue-800 underline">contactarnos</a>. 
        Estamos para ayudarte en lo que necesites.
      `,modalOverlayOpeningPadding:10,floatingUIOptions:{middleware:[Pi({mainAxis:30,crossAxis:40})]},buttons:[{text:"Anterior",action(){return this.back()}},{text:"Finalizar",action(){return this.next()}}]}]),!this.tutorialSeen&&!this.isMobile&&(this.shepherdService.start(),localStorage.setItem("tutorialSeen","true"))}actualizarHeader(n){this.institucion=n.institucion,this.examen=n.examen,this.fecha=n.fecha,this.duracion=n.duracion,this.profesor=n.profesor,this.catedra=n.catedra,this.logoFiles=n.logoFile,this.dniChecked=n.dniChecked,this.puntosChecked=n.puntosChecked,this.mostrarModal=!1}formatDate(n){return new Intl.DateTimeFormat("es-ES",{day:"numeric",month:"long",year:"numeric"}).format(n)}updateDificultad(n){return this.dificultad=n.target.value,this.dificultad.toString()}createRespuesta(){return this.fb.group({respuesta:["",si.required]})}addRespuesta(){this.questionForm.get("respuestas").push(this.createRespuesta())}deleteRespuesta(n){this.questionForm.get("respuestas").removeAt(n)}normalizarDificultad(n){return n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}verificarDificultad(n,i){return this.normalizarDificultad(n.dificultad)===i}convertToExcelData(){let n=[];return this.preguntasList.forEach(i=>{let s={Pregunta:i.pregunta,Respuestas:i.respuesta.join(", ")};n.push(s)}),n}downloadExcel(){let n=this.convertToExcelData(),i=to.json_to_sheet(n),s=to.book_new();to.book_append_sheet(s,i,"Preguntas"),iI(s,"lista-preguntas.xlsx")}onFileChange(n){let i=n.target.files[0];i&&this.loadExcelFile(i)}loadExcelFile(n){let i=new FileReader;i.onload=s=>{this.preguntasList=[];let a=s.target?.result;if(a){let o=pc(a,{type:"binary"}),c=o.SheetNames[0],l=o.Sheets[c],h=to.sheet_to_json(l);this.preguntasList=h.map(f=>({pregunta:f.Pregunta,respuesta:f.Respuestas.split(", ").map(d=>d.trim())}))}},i.readAsBinaryString(n)}generarPDF(){return te(this,null,function*(){this.loading=!0,this.cargandoPDF=!0;let n=this.cantidadExamenes,i=this.preguntasPorExamen,s=this.puntajeTotal,a=this.preguntasList,o="";if(this.examen!=""?o=this.institucion!=""?`${this.examen}-${this.institucion}`:`${this.profesor}-${this.examen}`:o="Evaluaciones",this.isMobile){let c={Preguntas:this.preguntasList.map(_=>({enunciado:_.pregunta,respuestas:_.respuesta})),CantidadExamenes:this.cantidadExamenes,PreguntasPorExamen:this.preguntasPorExamen,Institucion:this.institucion,NombreExamen:this.examen,Duracion:this.duracion,Profesor:this.profesor,Catedra:this.catedra,DniChecked:this.dniChecked,PuntosChecked:this.puntosChecked,Logos:this.logoFiles?yield Promise.all(this.logoFiles.map(_=>this.convertFileToBase64(_).toPromise())):[]},h=yield this.http.post(ro.endpointReporte,c,{responseType:"text"}).toPromise(),f=atob(h),d=new Array(f.length);for(let _=0;_<f.length;_++)d[_]=f.charCodeAt(_);let m=new Uint8Array(d),v=new Blob([m],{type:"application/pdf"}),p=document.createElement("a");p.href=window.URL.createObjectURL(v),p.download=o,p.click(),window.URL.revokeObjectURL(p.href),this.loading=!1,this.cargandoPDF=!1}else{let c=this.examService.generateExams(n,i,s,a),l=document.createElement("div");l.id="printDiv";for(let h=0;h<c.length;h++){let f=c[h],d=document.createElement("div"),m=yield this.http.get("assets/reporteExamen.html",{responseType:"text"}).toPromise();d.innerHTML=m;let v=document.createElement("div"),p=document.createElement("div");if(p.classList.add("header-info","text-right"),this.logoFiles?.length>0&&(v.classList.add("header-img"),Array.from(this.logoFiles).forEach(O=>{this.convertFileToBase64(O).subscribe(V=>{let B=document.createElement("img");B.src=V,B.width=150,B.height=100,v.appendChild(B)})})),this.institucion){let O=document.createElement("h1");O.textContent=`${this.institucion}`,O.classList.add("text-xl","font-bold"),p.appendChild(O)}if(this.examen){let O=document.createElement("h2");O.textContent=`${this.examen??""}`,p.appendChild(O)}let _=document.createElement("p"),T=this.fecha!==""?new Date(this.fecha):new Date;if(this.duracion?_.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(T)} | <strong>Duraci\xF3n:</strong> ${this.duracion??""} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`:_.innerHTML=`<strong>Fecha:</strong> ${this.formatDate(T)} | <strong>Puntaje:</strong><span style="margin-left: 40px;"></span>  puntos`,p.appendChild(_),this.profesor){let O=document.createElement("p");O.innerHTML=`<strong>Profesor:</strong> ${this.profesor??""} | <strong>C\xE1tedra:</strong> ${this.catedra??""}`,p.appendChild(O)}let S=document.createElement("p");this.dniChecked?S.innerHTML='<strong>Nombre:</strong> <span style="margin-left: 240px;"></span>| <strong>DNI:</strong>':S.innerHTML="<strong>Nombre:</strong>",p.appendChild(S),d.insertBefore(p,d.firstChild),d.insertBefore(v,d.firstChild);let b=d.querySelector("#preguntasContainer");b&&(b.innerHTML="",h>0&&(d.style.pageBreakBefore="always"),f.forEach((O,V)=>{let B=document.createElement("div");B.classList.add("mb-6");let x=document.createElement("div");x.classList.add("text-lg","font-semibold","mb-2"),x.textContent=`${V+1}. ${O.pregunta}`;let w=document.createElement("span");w.classList.add("text-sm","font-bold","text-gray-600","ml-2"),this.puntosChecked&&(w.textContent=` (${O.puntaje} pts)`),x.appendChild(w),B.appendChild(x);let E=document.createElement("ul");E.classList.add("space-y-2"),O.respuesta.forEach((C,D)=>{let A=document.createElement("li"),R=document.createElement("input");R.style.verticalAlign="middle",R.style.marginLeft="35px",R.type="checkbox",R.value=C,R.classList.add("mr-2");let oe=document.createElement("label");oe.style.fontSize="13px",oe.style.verticalAlign="middle",oe.htmlFor=R.id,oe.textContent=C,A.appendChild(R),A.appendChild(oe),E.appendChild(A)}),B.appendChild(E),b.appendChild(B)}),l.appendChild(d))}document.body.appendChild(l),console.log(document.documentElement.outerHTML),this.cargandoPDF=!1,document.title=o,yield new Promise(h=>setTimeout(h,1e3)),window.print(),l.remove(),this.loading=!1}document.title="EvaluAr"})}base64ToArrayBuffer(n){let i=window.atob(n),s=i.length,a=new Uint8Array(s);for(let o=0;o<s;o++)a[o]=i.charCodeAt(o);return a.buffer}convertFileToBase64(n){return new Gi(i=>{let s=new FileReader;s.onload=()=>{let a=s.result;i.next(a),i.complete()},s.onerror=a=>{i.error(a)},s.readAsDataURL(n)})}onSubmit(){this.questionForm.value.preguntasTextarea.trim().split(/\n\s*\n/).forEach(s=>{let a=s.split(`
`),[o,...c]=a,[l,h,f]=o.split(" - "),d=f?.toLowerCase(),m=this.mapeoDificultad[d]||f,v={pregunta:l.trim(),respuesta:c.map(p=>p.trim()).filter(p=>p!=="")};this.preguntasList.push(v)}),this.questionForm.reset()}isFormInvalid(){return!!(this.isMobile&&this.cantidadExamenes>30||this.isMobile&&this.preguntasPorExamen>20||this.cantidadExamenes==0||this.preguntasPorExamen==0)}};e.\u0275fac=function(i){return new(i||e)(Pe(kf),Pe(Tl),Pe(gI),Pe(ud),Pe(tA))},e.\u0275cmp=Dt({type:e,selectors:[["app-preguntas"]],standalone:!0,features:[Rt],decls:40,vars:20,consts:[[1,"no-print","container","mx-auto","px-4","py-6",2,"margin-bottom","200px"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],["id","listadoPreguntas",1,"bg-white","p-6","rounded-lg","shadow-lg","max-h-[400px]","overflow-y-auto"],[1,"text-2xl","font-semibold","mb-4"],["id","listadoPreguntas",1,"space-y-4"],["class","border rounded-lg p-4 shadow-sm",4,"ngFor","ngForOf"],[1,"bg-white","p-6","rounded-lg","shadow-lg"],[1,"flex","flex-row","justify-between","mb-4"],[1,"text-2xl","font-semibold"],["id","buttonModal",1,"w-20","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600",3,"click"],[1,"fas","fa-file-alt"],[3,"guardarHeader","cerrarModal",4,"ngIf"],[1,"space-y-6","mb-4",3,"ngSubmit","formGroup"],["for","preguntasTextarea",1,"block","font-semibold","mb-2"],["id","preguntasTextarea","formControlName","preguntasTextarea","rows","10","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500"],["id","guardarPreguntas","type","submit",1,"w-full","bg-blue-500","text-white","font-bold","py-2","rounded","hover:bg-blue-600"],["id","cantidades"],["for","cantidadExamenes",1,"block","font-semibold","mb-2"],["type","number","required","",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel","min"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["class","mt-2",4,"ngIf"],[4,"ngIf"],["id","botones",1,"flex","flex-row","mt-6"],["id","descargarExcel",1,"w-full","bg-green-500","text-white","font-bold","py-2","rounded","hover:bg-green-600",3,"click"],[1,"fas","fa-file-excel"],["id","importarExcel","onclick","document.getElementById('importExcelInput').click()",1,"w-full","bg-yellow-500","hover:bg-yellow-600","border","p-2","rounded","text-white","font-bold","text-center"],[1,"fas","fa-upload"],["id","importExcelInput","type","file","accept",".xls, .xlsx",2,"display","none",3,"change"],["id","descargarPDF",1,"w-full","text-white","font-bold","py-2","rounded","hover:bg-red-600",3,"click","ngClass","disabled"],["class","fas fa-file-pdf",4,"ngIf"],["class","inline-block h-4 w-4 animate-spin rounded-full border-2 border-solid border-current border-e-transparent align-[-0.125em] text-surface motion-reduce:animate-[spin_1.5s_linear_infinite] dark:text-white",4,"ngIf"],["class","no-print",4,"ngIf"],[1,"border","rounded-lg","p-4","shadow-sm"],[1,"flex","items-center","justify-between","mb-2"],[1,"font-semibold","text-lg"],[1,"list-[lower-alpha]","pl-6"],["class","mb-2",4,"ngFor","ngForOf"],[1,"mb-2"],[3,"guardarHeader","cerrarModal"],[1,"text-red-500","text-sm","mt-1"],[1,"mt-2"],["for","preguntasPorExamen",1,"block","font-semibold","mb-2"],["for","puntajeTotal"],["type","puntajeTotal",1,"w-full","border","rounded","p-2","focus:outline-none","focus:border-blue-500",3,"ngModelChange","ngModel"],[1,"fas","fa-file-pdf"],[1,"inline-block","h-4","w-4","animate-spin","rounded-full","border-2","border-solid","border-current","border-e-transparent","align-[-0.125em]","text-surface","motion-reduce:animate-[spin_1.5s_linear_infinite]","dark:text-white"],[1,"no-print"]],template:function(i,s){i&1&&(Z(0,"div",0)(1,"div",1)(2,"div",2)(3,"h2",3),ve(4,"Listado de Preguntas"),J(),Z(5,"div",4),gt(6,wU,6,3,"div",5),J()(),Z(7,"div",6)(8,"div",7)(9,"h2",8),ve(10,"Agregar Configuraci\xF3n"),J(),Z(11,"button",9),ct("click",function(){return s.mostrarModal=!0}),ze(12,"i",10),J()(),gt(13,EU,1,0,"app-header",11),Z(14,"form",12),ct("ngSubmit",function(){return s.onSubmit()}),Z(15,"div")(16,"label",13),ve(17,"Preguntas:"),J(),ze(18,"textarea",14),J(),Z(19,"button",15),ve(20," Guardar Preguntas "),J()(),Z(21,"div",16)(22,"div")(23,"label",17),ve(24,"Cantidad de evaluaciones a crear:"),J(),Z(25,"input",18),xn("ngModelChange",function(o){return yn(s.cantidadExamenes,o)||(s.cantidadExamenes=o),o}),J(),gt(26,TU,2,0,"div",19)(27,bU,2,0,"div",19),J(),gt(28,SU,6,6,"div",20),J(),gt(29,CU,4,1,"div",21),Z(30,"div",22)(31,"button",23),ct("click",function(){return s.downloadExcel()}),ze(32,"i",24),J(),Z(33,"button",25),ze(34,"i",26),J(),Z(35,"input",27),ct("change",function(o){return s.onFileChange(o)}),J(),Z(36,"button",28),ct("click",function(){return s.generarPDF()}),gt(37,kU,1,0,"i",29)(38,DU,1,0,"div",30),J()()()()(),gt(39,RU,1,0,"app-loading-print",31)),i&2&&(De(6),Me("ngForOf",s.preguntasList),De(7),Me("ngIf",s.mostrarModal),De(),Me("formGroup",s.questionForm),De(11),Cs("border-red-500",s.cantidadExamenes>30&&s.isMobile||s.cantidadExamenes<1),_n("ngModel",s.cantidadExamenes),Me("min",1),De(),Me("ngIf",s.cantidadExamenes>30&&s.isMobile),De(),Me("ngIf",s.cantidadExamenes<1),De(),Me("ngIf",s.criterioSeleccionado==="questionsPerExam"),De(),Me("ngIf",s.criterioSeleccionado==="puntajeTotal"),De(7),Me("ngClass",yl(16,yU,!s.isFormInvalid(),s.isFormInvalid(),!s.isFormInvalid()))("disabled",s.isFormInvalid()),De(),Me("ngIf",!s.cargandoPDF),De(),Me("ngIf",s.cargandoPDF),De(),Me("ngIf",s.loading))},dependencies:[ii,jh,Bo,wi,Zo,Us,Ii,om,Vs,Bs,Oa,cm,Fa,Pa,Kw,Yh,Jo,Xl,uI,mI],encapsulation:2});let t=e;return t})();var iA=function(t){let e=[],r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e},FU=function(t){let e=[],r=0,n=0;for(;r<t.length;){let i=t[r++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){let s=t[r++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=t[r++],a=t[r++],o=t[r++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|o&63)-65536;e[n++]=String.fromCharCode(55296+(c>>10)),e[n++]=String.fromCharCode(56320+(c&1023))}else{let s=t[r++],a=t[r++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},sA={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<t.length;i+=3){let s=t[i],a=i+1<t.length,o=a?t[i+1]:0,c=i+2<t.length,l=c?t[i+2]:0,h=s>>2,f=(s&3)<<4|o>>4,d=(o&15)<<2|l>>6,m=l&63;c||(m=64,a||(d=64)),n.push(r[h],r[f],r[d],r[m])}return n.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(iA(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):FU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();let r=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<t.length;){let s=r[t.charAt(i++)],o=i<t.length?r[t.charAt(i)]:0;++i;let l=i<t.length?r[t.charAt(i)]:64;++i;let f=i<t.length?r[t.charAt(i)]:64;if(++i,s==null||o==null||l==null||f==null)throw new cv;let d=s<<2|o>>4;if(n.push(d),l!==64){let m=o<<4&240|l>>2;if(n.push(m),f!==64){let v=l<<6&192|f;n.push(v)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},cv=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},PU=function(t){let e=iA(t);return sA.encodeByteArray(e,!0)},ju=function(t){return PU(t).replace(/\./g,"")},uv=function(t){try{return sA.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function OU(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var NU=()=>OU().__FIREBASE_DEFAULTS__,MU=()=>{if(typeof process>"u"||typeof process.env>"u")return;let t=process.env.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},LU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=t&&uv(t[1]);return e&&JSON.parse(e)},Id=()=>{try{return NU()||MU()||LU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},aA=t=>{var e,r;return(r=(e=Id())===null||e===void 0?void 0:e.emulatorHosts)===null||r===void 0?void 0:r[t]},oA=t=>{let e=aA(t);if(!e)return;let r=e.lastIndexOf(":");if(r<=0||r+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let n=parseInt(e.substring(r+1),10);return e[0]==="["?[e.substring(1,r-1),n]:[e.substring(0,r),n]},hv=()=>{var t;return(t=Id())===null||t===void 0?void 0:t.config},cA=t=>{var e;return(e=Id())===null||e===void 0?void 0:e[`_${t}`]};var bd=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,n)=>{r?this.reject(r):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,n))}}};function lA(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r={alg:"none",type:"JWT"},n=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[ju(JSON.stringify(r)),ju(JSON.stringify(a)),""].join(".")}function kn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function uA(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(kn())}function VU(){var t;let e=(t=Id())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function hA(){let t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function fA(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function dA(){return!VU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fv(){try{return typeof indexedDB=="object"}catch{return!1}}function pA(){return new Promise((t,e)=>{try{let r=!0,n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),r||self.indexedDB.deleteDatabase(n),t(!0)},i.onupgradeneeded=()=>{r=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(r){e(r)}})}var BU="FirebaseError",Jn=class t extends Error{constructor(e,r,n){super(r),this.code=e,this.customData=n,this.name=BU,Object.setPrototypeOf(this,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hs.prototype.create)}},hs=class{constructor(e,r,n){this.service=e,this.serviceName=r,this.errors=n}create(e,...r){let n=r[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?UU(s,n):"Error",o=`${this.serviceName}: ${a} (${i}).`;return new Jn(i,o,n)}};function UU(t,e){return t.replace(jU,(r,n)=>{let i=e[n];return i!=null?String(i):`<${n}?>`})}var jU=/\{\$([^}]+)}/g;function Rc(t,e){if(t===e)return!0;let r=Object.keys(t),n=Object.keys(e);for(let i of r){if(!n.includes(i))return!1;let s=t[i],a=e[i];if(nA(s)&&nA(a)){if(!Rc(s,a))return!1}else if(s!==a)return!1}for(let i of n)if(!r.includes(i))return!1;return!0}function nA(t){return t!==null&&typeof t=="object"}function dv(t){let e=[];for(let[r,n]of Object.entries(t))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function mA(t,e){let r=new lv(t,e);return r.subscribe.bind(r)}var lv=class{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,n){let i;if(e===void 0&&r===void 0&&n===void 0)throw new Error("Missing Observer.");WU(e,["next","error","complete"])?i=e:i={next:e,error:r,complete:n},i.next===void 0&&(i.next=ov),i.error===void 0&&(i.error=ov),i.complete===void 0&&(i.complete=ov);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function WU(t,e){if(typeof t!="object"||t===null)return!1;for(let r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function ov(){}var Aq=4*60*60*1e3;function di(t){return t&&t._delegate?t._delegate:t}var Zn=class{constructor(e,r,n){this.name=e,this.instanceFactory=r,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ho="[DEFAULT]";var pv=class{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){let n=new bd;if(this.instancesDeferred.set(r,n),this.isInitialized(r)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:r});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){var r;let n=this.normalizeInstanceIdentifier(e?.identifier),i=(r=e?.optional)!==null&&r!==void 0?r:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(HU(e))try{this.getOrInitializeService({instanceIdentifier:ho})}catch{}for(let[r,n]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(r);try{let s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=ho){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return te(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=ho){return this.instances.has(e)}getOptions(e=ho){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:r={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:n,options:r});for(let[s,a]of this.instancesDeferred.entries()){let o=this.normalizeInstanceIdentifier(s);n===o&&a.resolve(i)}return i}onInit(e,r){var n;let i=this.normalizeInstanceIdentifier(r),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,r){let n=this.onInitCallbacks.get(r);if(n)for(let i of n)try{i(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$U(e),options:r}),this.instances.set(e,n),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ho){return this.component?this.component.multipleInstances?e:ho:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function $U(t){return t===ho?void 0:t}function HU(t){return t.instantiationMode==="EAGER"}var Ad=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let r=new pv(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}};var zU=[],tt=function(t){return t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT",t}(tt||{}),GU={debug:tt.DEBUG,verbose:tt.VERBOSE,info:tt.INFO,warn:tt.WARN,error:tt.ERROR,silent:tt.SILENT},qU=tt.INFO,KU={[tt.DEBUG]:"log",[tt.VERBOSE]:"log",[tt.INFO]:"info",[tt.WARN]:"warn",[tt.ERROR]:"error"},XU=(t,e,...r)=>{if(e<t.logLevel)return;let n=new Date().toISOString(),i=KU[e];if(i)console[i](`[${n}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},na=class{constructor(e){this.name=e,this._logLevel=qU,this._logHandler=XU,this._userLogHandler=null,zU.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in tt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?GU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,tt.DEBUG,...e),this._logHandler(this,tt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,tt.VERBOSE,...e),this._logHandler(this,tt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,tt.INFO,...e),this._logHandler(this,tt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,tt.WARN,...e),this._logHandler(this,tt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,tt.ERROR,...e),this._logHandler(this,tt.ERROR,...e)}};var YU=(t,e)=>e.some(r=>t instanceof r),gA,vA;function QU(){return gA||(gA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function JU(){return vA||(vA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var _A=new WeakMap,gv=new WeakMap,yA=new WeakMap,mv=new WeakMap,_v=new WeakMap;function ZU(t){let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",a)},s=()=>{r(Mi(t.result)),i()},a=()=>{n(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",a)});return e.then(r=>{r instanceof IDBCursor&&_A.set(r,t)}).catch(()=>{}),_v.set(e,t),e}function e9(t){if(gv.has(t))return;let e=new Promise((r,n)=>{let i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",a),t.removeEventListener("abort",a)},s=()=>{r(),i()},a=()=>{n(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",a),t.addEventListener("abort",a)});gv.set(t,e)}var vv={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return gv.get(t);if(e==="objectStoreNames")return t.objectStoreNames||yA.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return Mi(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function xA(t){vv=t(vv)}function t9(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){let n=t.call(Sd(this),e,...r);return yA.set(n,e.sort?e.sort():[e]),Mi(n)}:JU().includes(t)?function(...e){return t.apply(Sd(this),e),Mi(_A.get(this))}:function(...e){return Mi(t.apply(Sd(this),e))}}function r9(t){return typeof t=="function"?t9(t):(t instanceof IDBTransaction&&e9(t),YU(t,QU())?new Proxy(t,vv):t)}function Mi(t){if(t instanceof IDBRequest)return ZU(t);if(mv.has(t))return mv.get(t);let e=r9(t);return e!==t&&(mv.set(t,e),_v.set(e,t)),e}var Sd=t=>_v.get(t);function EA(t,e,{blocked:r,upgrade:n,blocking:i,terminated:s}={}){let a=indexedDB.open(t,e),o=Mi(a);return n&&a.addEventListener("upgradeneeded",c=>{n(Mi(a.result),c.oldVersion,c.newVersion,Mi(a.transaction),c)}),r&&a.addEventListener("blocked",c=>r(c.oldVersion,c.newVersion,c)),o.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",l=>i(l.oldVersion,l.newVersion,l))}).catch(()=>{}),o}var n9=["get","getKey","getAll","getAllKeys","count"],i9=["put","add","delete","clear"],yv=new Map;function wA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(yv.get(e))return yv.get(e);let r=e.replace(/FromIndex$/,""),n=e!==r,i=i9.includes(r);if(!(r in(n?IDBIndex:IDBObjectStore).prototype)||!(i||n9.includes(r)))return;let s=function(a,...o){return te(this,null,function*(){let c=this.transaction(a,i?"readwrite":"readonly"),l=c.store;return n&&(l=l.index(o.shift())),(yield Promise.all([l[r](...o),i&&c.done]))[0]})};return yv.set(e,s),s}xA(t=>mt(Ie({},t),{get:(e,r,n)=>wA(e,r)||t.get(e,r,n),has:(e,r)=>!!wA(e,r)||t.has(e,r)}));var wv=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(s9(r)){let n=r.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(r=>r).join(" ")}};function s9(t){let e=t.getComponent();return e?.type==="VERSION"}var Ev="@firebase/app",TA="0.10.8";var fo=new na("@firebase/app"),a9="@firebase/app-compat",o9="@firebase/analytics-compat",c9="@firebase/analytics",l9="@firebase/app-check-compat",u9="@firebase/app-check",h9="@firebase/auth",f9="@firebase/auth-compat",d9="@firebase/database",p9="@firebase/database-compat",m9="@firebase/functions",g9="@firebase/functions-compat",v9="@firebase/installations",_9="@firebase/installations-compat",y9="@firebase/messaging",x9="@firebase/messaging-compat",w9="@firebase/performance",E9="@firebase/performance-compat",T9="@firebase/remote-config",b9="@firebase/remote-config-compat",I9="@firebase/storage",A9="@firebase/storage-compat",S9="@firebase/firestore",C9="@firebase/vertexai-preview",k9="@firebase/firestore-compat",D9="firebase",R9="10.12.5";var Tv="[DEFAULT]",F9={[Ev]:"fire-core",[a9]:"fire-core-compat",[c9]:"fire-analytics",[o9]:"fire-analytics-compat",[u9]:"fire-app-check",[l9]:"fire-app-check-compat",[h9]:"fire-auth",[f9]:"fire-auth-compat",[d9]:"fire-rtdb",[p9]:"fire-rtdb-compat",[m9]:"fire-fn",[g9]:"fire-fn-compat",[v9]:"fire-iid",[_9]:"fire-iid-compat",[y9]:"fire-fcm",[x9]:"fire-fcm-compat",[w9]:"fire-perf",[E9]:"fire-perf-compat",[T9]:"fire-rc",[b9]:"fire-rc-compat",[I9]:"fire-gcs",[A9]:"fire-gcs-compat",[S9]:"fire-fst",[k9]:"fire-fst-compat",[C9]:"fire-vertex","fire-js":"fire-js",[D9]:"fire-js-all"};var Wu=new Map,P9=new Map,bv=new Map;function bA(t,e){try{t.container.addComponent(e)}catch(r){fo.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function sa(t){let e=t.name;if(bv.has(e))return fo.debug(`There were multiple attempts to register component ${e}.`),!1;bv.set(e,t);for(let r of Wu.values())bA(r,t);for(let r of P9.values())bA(r,t);return!0}function Cv(t,e){let r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Fc(t){return t.settings!==void 0}var O9={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ia=new hs("app","Firebase",O9);var Iv=class{constructor(e,r,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},r),this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Zn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ia.create("app-deleted",{appName:this._name})}};var Pc=R9;function kv(t,e={}){let r=t;typeof e!="object"&&(e={name:e});let n=Object.assign({name:Tv,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw ia.create("bad-app-name",{appName:String(i)});if(r||(r=hv()),!r)throw ia.create("no-options");let s=Wu.get(i);if(s){if(Rc(r,s.options)&&Rc(n,s.config))return s;throw ia.create("duplicate-app",{appName:i})}let a=new Ad(i);for(let c of bv.values())a.addComponent(c);let o=new Iv(r,n,a);return Wu.set(i,o),o}function Hu(t=Tv){let e=Wu.get(t);if(!e&&t===Tv&&hv())return kv();if(!e)throw ia.create("no-app",{appName:t});return e}function Cd(){return Array.from(Wu.values())}function br(t,e,r){var n;let i=(n=F9[t])!==null&&n!==void 0?n:t;r&&(i+=`-${r}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let o=[`Unable to register library "${i}" with version "${e}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&o.push("and"),a&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fo.warn(o.join(" "));return}sa(new Zn(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var N9="firebase-heartbeat-database",M9=1,$u="firebase-heartbeat-store",xv=null;function CA(){return xv||(xv=EA(N9,M9,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore($u)}catch(r){console.warn(r)}}}}).catch(t=>{throw ia.create("idb-open",{originalErrorMessage:t.message})})),xv}function L9(t){return te(this,null,function*(){try{let r=(yield CA()).transaction($u),n=yield r.objectStore($u).get(kA(t));return yield r.done,n}catch(e){if(e instanceof Jn)fo.warn(e.message);else{let r=ia.create("idb-get",{originalErrorMessage:e?.message});fo.warn(r.message)}}})}function IA(t,e){return te(this,null,function*(){try{let n=(yield CA()).transaction($u,"readwrite");yield n.objectStore($u).put(e,kA(t)),yield n.done}catch(r){if(r instanceof Jn)fo.warn(r.message);else{let n=ia.create("idb-set",{originalErrorMessage:r?.message});fo.warn(n.message)}}})}function kA(t){return`${t.name}!${t.options.appId}`}var V9=1024,B9=30*24*60*60*1e3,Av=class{constructor(e){this.container=e,this._heartbeatsCache=null;let r=this.container.getProvider("app").getImmediate();this._storage=new Sv(r),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}triggerHeartbeat(){return te(this,null,function*(){var e,r;let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=AA();if(!(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((r=this._heartbeatsCache)===null||r===void 0?void 0:r.heartbeats)==null))&&!(this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)))return this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let o=new Date(a.date).valueOf();return Date.now()-o<=B9}),this._storage.overwrite(this._heartbeatsCache)})}getHeartbeatsHeader(){return te(this,null,function*(){var e;if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let r=AA(),{heartbeatsToSend:n,unsentEntries:i}=U9(this._heartbeatsCache.heartbeats),s=ju(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=r,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s})}};function AA(){return new Date().toISOString().substring(0,10)}function U9(t,e=V9){let r=[],n=t.slice();for(let i of t){let s=r.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),SA(r)>e){s.dates.pop();break}}else if(r.push({agent:i.agent,dates:[i.date]}),SA(r)>e){r.pop();break}n=n.slice(1)}return{heartbeatsToSend:r,unsentEntries:n}}var Sv=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return te(this,null,function*(){return fv()?pA().then(()=>!0).catch(()=>!1):!1})}read(){return te(this,null,function*(){if(yield this._canUseIndexedDBPromise){let r=yield L9(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return te(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return te(this,null,function*(){var r;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return IA(this.app,{lastSentHeartbeatDate:(r=e.lastSentHeartbeatDate)!==null&&r!==void 0?r:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function SA(t){return ju(JSON.stringify({version:2,heartbeats:t})).length}function j9(t){sa(new Zn("platform-logger",e=>new wv(e),"PRIVATE")),sa(new Zn("heartbeat",e=>new Av(e),"PRIVATE")),br(Ev,TA,t),br(Ev,TA,"esm2017"),br("fire-js","")}j9("");var W9="firebase",$9="10.12.5";br(W9,$9,"app");var Nc=new Lo("ANGULARFIRE2_VERSION");function Rv(t,e,r){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===r);if(s.length===1)return s[0]}return r.container.getProvider(t).getImmediate({optional:!0})}var Gu=(t,e)=>{let r=e?[e]:Cd(),n=[];return r.forEach(i=>{i.container.getProvider(t).instances.forEach(a=>{n.includes(a)||n.push(a)})}),n},zu=class{constructor(){return Gu(H9)}},H9="app-check";function Oc(){}var kd=class{zone;delegate;constructor(e,r=gy){this.zone=e,this.delegate=r}now(){return this.delegate.now()}schedule(e,r,n){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,r,n)}},Dv=class{zone;task=null;constructor(e){this.zone=e}call(e,r){let n=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Oc,{},Oc,Oc)),r.pipe(hr({next:n,complete:n,error:n})).subscribe(e).add(n)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},qu=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(r){this.ngZone=r,this.outsideAngular=r.runOutsideAngular(()=>new kd(Zone.current)),this.insideAngular=r.run(()=>new kd(Zone.current,my)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(n){return new(n||t)($e(Wt))};static \u0275prov=Oe({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Dd(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function z9(t){return Dd().ngZone.runOutsideAngular(()=>t())}function po(t){return Dd().ngZone.run(()=>t())}function G9(t){return q9(Dd())(t)}function q9(t){return function(r){return r=r.lift(new Dv(t.ngZone)),r.pipe(L0(t.outsideAngular),M0(t.insideAngular))}}var K9=(t,e)=>function(){let n=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),po(()=>t.apply(void 0,n))},Ku=(t,e)=>function(){let r,n=arguments;for(let s=0;s<arguments.length;s++)typeof n[s]=="function"&&(e&&(r||=po(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Oc,{},Oc,Oc))),n[s]=K9(n[s],r));let i=z9(()=>t.apply(this,n));if(!e)if(i instanceof Gi){let s=Dd();return i.pipe(L0(s.outsideAngular),M0(s.insideAngular))}else return po(()=>i);return i instanceof Gi?i.pipe(G9):i instanceof Promise?po(()=>new Promise((s,a)=>i.then(o=>po(()=>s(o)),o=>po(()=>a(o))))):typeof i=="function"&&r?function(){return setTimeout(()=>{r&&r.state==="scheduled"&&r.invoke()},10),i.apply(this,arguments)}:po(()=>i)};var mo=class{constructor(e){return e}},Xu=class{constructor(){return Cd()}};function X9(t){return t&&t.length===1?t[0]:new mo(Hu())}var Fv=new it("angularfire2._apps"),Y9={provide:mo,useFactory:X9,deps:[[new vi,Fv]]},Q9={provide:Xu,deps:[[new vi,Fv]]};function J9(t){return(e,r)=>{let n=r.get(ni);br("angularfire",Nc.full,"core"),br("angularfire",Nc.full,"app"),br("angular",My.full,n.toString());let i=e.runOutsideAngular(()=>t(r));return new mo(i)}}function DA(t,...e){return ti([Y9,Q9,{provide:Fv,useFactory:J9(t),multi:!0,deps:[Wt,wa,qu,...e]}])}var RA=Ku(kv,!0);function BA(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var UA=BA,jA=new hs("auth","Firebase",BA());var Od=new na("@firebase/auth");function e7(t,...e){Od.logLevel<=tt.WARN&&Od.warn(`Auth (${Pc}): ${t}`,...e)}function Fd(t,...e){Od.logLevel<=tt.ERROR&&Od.error(`Auth (${Pc}): ${t}`,...e)}function FA(t,...e){throw Hv(t,...e)}function $v(t,...e){return Hv(t,...e)}function WA(t,e,r){let n=Object.assign(Object.assign({},UA()),{[e]:r});return new hs("auth","Firebase",n).create(e,{appName:t.name})}function Pd(t){return WA(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Hv(t,...e){if(typeof t!="string"){let r=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=t.name),t._errorFactory.create(r,...n)}return jA.create(t,...e)}function pt(t,e,...r){if(!t)throw Hv(e,...r)}function Yu(t){let e="INTERNAL ASSERTION FAILED: "+t;throw Fd(e),new Error(e)}function Nd(t,e){t||Yu(e)}function t7(){return PA()==="http:"||PA()==="https:"}function PA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}function r7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(t7()||hA()||"connection"in navigator)?navigator.onLine:!0}function n7(){if(typeof navigator>"u")return null;let t=navigator;return t.languages&&t.languages[0]||t.language||null}var vo=class{constructor(e,r){this.shortDelay=e,this.longDelay=r,Nd(r>e,"Short delay should be less than long delay!"),this.isMobile=uA()||fA()}get(){return r7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function i7(t,e){Nd(t.emulator,"Emulator should always be set here");let{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}var Md=class{static initialize(e,r,n){this.fetchImpl=e,r&&(this.headersImpl=r),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Yu("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Yu("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Yu("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var s7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var a7=new vo(3e4,6e4);function $A(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}function Ud(s,a,o,c){return te(this,arguments,function*(t,e,r,n,i={}){return HA(t,i,()=>te(this,null,function*(){let l={},h={};n&&(e==="GET"?h=n:l={body:JSON.stringify(n)});let f=dv(Object.assign({key:t.config.apiKey},h)).slice(1),d=yield t._getAdditionalHeaders();return d["Content-Type"]="application/json",t.languageCode&&(d["X-Firebase-Locale"]=t.languageCode),Md.fetch()(zA(t,t.config.apiHost,r,f),Object.assign({method:e,headers:d,referrerPolicy:"no-referrer"},l))}))})}function HA(t,e,r){return te(this,null,function*(){t._canInitEmulator=!1;let n=Object.assign(Object.assign({},s7),e);try{let i=new Nv(t),s=yield Promise.race([r(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Rd(t,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let o=s.ok?a.errorMessage:a.error.message,[c,l]=o.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Rd(t,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Rd(t,"email-already-in-use",a);if(c==="USER_DISABLED")throw Rd(t,"user-disabled",a);let h=n[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(l)throw WA(t,h,l);FA(t,h)}}catch(i){if(i instanceof Jn)throw i;FA(t,"network-request-failed",{message:String(i)})}})}function zA(t,e,r,n){let i=`${e}${r}?${n}`;return t.config.emulator?i7(t.config,i):`${t.config.apiScheme}://${i}`}var Nv=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,n)=>{this.timer=setTimeout(()=>n($v(this.auth,"network-request-failed")),a7.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Rd(t,e,r){let n={appName:t.name};r.email&&(n.email=r.email),r.phoneNumber&&(n.phoneNumber=r.phoneNumber);let i=$v(t,e,n);return i.customData._tokenResponse=r,i}function o7(t,e){return te(this,null,function*(){return Ud(t,"POST","/v1/accounts:delete",e)})}function GA(t,e){return te(this,null,function*(){return Ud(t,"POST","/v1/accounts:lookup",e)})}function Qu(t){if(t)try{let e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function zv(t,e=!1){return te(this,null,function*(){let r=di(t),n=yield r.getIdToken(e),i=qA(n);pt(i&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:n,authTime:Qu(Pv(i.auth_time)),issuedAtTime:Qu(Pv(i.iat)),expirationTime:Qu(Pv(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Pv(t){return Number(t)*1e3}function qA(t){let[e,r,n]=t.split(".");if(e===void 0||r===void 0||n===void 0)return Fd("JWT malformed, contained fewer than 3 sections"),null;try{let i=uv(r);return i?JSON.parse(i):(Fd("Failed to decode base64 JWT payload"),null)}catch(i){return Fd("Caught error parsing JWT payload as JSON",i?.toString()),null}}function OA(t){let e=qA(t);return pt(e,"internal-error"),pt(typeof e.exp<"u","internal-error"),pt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Mv(t,e,r=!1){return te(this,null,function*(){if(r)return e;try{return yield e}catch(n){throw n instanceof Jn&&c7(n)&&t.auth.currentUser===t&&(yield t.auth.signOut()),n}})}function c7({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}var Lv=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var r;if(e){let n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;let i=((r=this.user.stsTokenManager.expirationTime)!==null&&r!==void 0?r:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let r=this.getInterval(e);this.timerId=setTimeout(()=>te(this,null,function*(){yield this.iteration()}),r)}iteration(){return te(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var Zu=class{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=Qu(this.lastLoginAt),this.creationTime=Qu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Ld(t){return te(this,null,function*(){var e;let r=t.auth,n=yield t.getIdToken(),i=yield Mv(t,GA(r,{idToken:n}));pt(i?.users.length,r,"internal-error");let s=i.users[0];t._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?KA(s.providerUserInfo):[],o=l7(t.providerData,a),c=t.isAnonymous,l=!(t.email&&s.passwordHash)&&!o?.length,h=c?l:!1,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Zu(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(t,f)})}function Gv(t){return te(this,null,function*(){let e=di(t);yield Ld(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function l7(t,e){return[...t.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function KA(t){return t.map(e=>{var{providerId:r}=e,n=N0(e,["providerId"]);return{providerId:r,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}function u7(t,e){return te(this,null,function*(){let r=yield HA(t,{},()=>te(this,null,function*(){let n=dv({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,a=zA(t,i,"/v1/token",`key=${s}`),o=yield t._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Md.fetch()(a,{method:"POST",headers:o,body:n})}));return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}})}function h7(t,e){return te(this,null,function*(){return Ud(t,"POST","/v2/accounts:revokeToken",$A(t,e))})}var Ju=class t{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){pt(e.idToken,"internal-error"),pt(typeof e.idToken<"u","internal-error"),pt(typeof e.refreshToken<"u","internal-error");let r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):OA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){pt(e.length!==0,"internal-error");let r=OA(e);this.updateTokensAndExpiration(e,null,r)}getToken(e,r=!1){return te(this,null,function*(){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(pt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,r){return te(this,null,function*(){let{accessToken:n,refreshToken:i,expiresIn:s}=yield u7(e,r);this.updateTokensAndExpiration(n,i,Number(s))})}updateTokensAndExpiration(e,r,n){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,r){let{refreshToken:n,accessToken:i,expirationTime:s}=r,a=new t;return n&&(pt(typeof n=="string","internal-error",{appName:e}),a.refreshToken=n),i&&(pt(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(pt(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new t,this.toJSON())}_performRefresh(){return Yu("not implemented")}};function aa(t,e){pt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}var eh=class t{constructor(e){var{uid:r,auth:n,stsTokenManager:i}=e,s=N0(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Lv(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=r,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Zu(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return te(this,null,function*(){let r=yield Mv(this,this.stsTokenManager.getToken(this.auth,e));return pt(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r})}getIdTokenResult(e){return zv(this,e)}reload(){return Gv(this)}_assign(e){this!==e&&(pt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>Object.assign({},r)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let r=new t(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return r.metadata._copy(this.metadata),r}_onReload(e){pt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,r=!1){return te(this,null,function*(){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),r&&(yield Ld(this)),yield this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)})}delete(){return te(this,null,function*(){if(Fc(this.auth.app))return Promise.reject(Pd(this.auth));let e=yield this.getIdToken();return yield Mv(this,o7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){var n,i,s,a,o,c,l,h;let f=(n=r.displayName)!==null&&n!==void 0?n:void 0,d=(i=r.email)!==null&&i!==void 0?i:void 0,m=(s=r.phoneNumber)!==null&&s!==void 0?s:void 0,v=(a=r.photoURL)!==null&&a!==void 0?a:void 0,p=(o=r.tenantId)!==null&&o!==void 0?o:void 0,_=(c=r._redirectEventId)!==null&&c!==void 0?c:void 0,T=(l=r.createdAt)!==null&&l!==void 0?l:void 0,S=(h=r.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:b,emailVerified:O,isAnonymous:V,providerData:B,stsTokenManager:x}=r;pt(b&&x,e,"internal-error");let w=Ju.fromJSON(this.name,x);pt(typeof b=="string",e,"internal-error"),aa(f,e.name),aa(d,e.name),pt(typeof O=="boolean",e,"internal-error"),pt(typeof V=="boolean",e,"internal-error"),aa(m,e.name),aa(v,e.name),aa(p,e.name),aa(_,e.name),aa(T,e.name),aa(S,e.name);let E=new t({uid:b,auth:e,email:d,emailVerified:O,displayName:f,isAnonymous:V,photoURL:v,phoneNumber:m,tenantId:p,stsTokenManager:w,createdAt:T,lastLoginAt:S});return B&&Array.isArray(B)&&(E.providerData=B.map(C=>Object.assign({},C))),_&&(E._redirectEventId=_),E}static _fromIdTokenResponse(e,r,n=!1){return te(this,null,function*(){let i=new Ju;i.updateFromServerResponse(r);let s=new t({uid:r.localId,auth:e,stsTokenManager:i,isAnonymous:n});return yield Ld(s),s})}static _fromGetAccountInfoResponse(e,r,n){return te(this,null,function*(){let i=r.users[0];pt(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?KA(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,o=new Ju;o.updateFromIdToken(n);let c=new t({uid:i.localId,auth:e,stsTokenManager:o,isAnonymous:a}),l={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Zu(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,l),c})}};var NA=new Map;function go(t){Nd(t instanceof Function,"Expected a class definition");let e=NA.get(t);return e?(Nd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,NA.set(t,e),e)}var f7=(()=>{class t{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return te(this,null,function*(){return!0})}_set(r,n){return te(this,null,function*(){this.storage[r]=n})}_get(r){return te(this,null,function*(){let n=this.storage[r];return n===void 0?null:n})}_remove(r){return te(this,null,function*(){delete this.storage[r]})}_addListener(r,n){}_removeListener(r,n){}}return t.type="NONE",t})(),Vv=f7;function Ov(t,e,r){return`firebase:${t}:${e}:${r}`}var Vd=class t{constructor(e,r,n){this.persistence=e,this.auth=r,this.userKey=n;let{config:i,name:s}=this.auth;this.fullUserKey=Ov(this.userKey,i.apiKey,s),this.fullPersistenceKey=Ov("persistence",i.apiKey,s),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return te(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?eh._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return te(this,null,function*(){if(this.persistence===e)return;let r=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,r,n="authUser"){return te(this,null,function*(){if(!r.length)return new t(go(Vv),e,n);let i=(yield Promise.all(r.map(l=>te(this,null,function*(){if(yield l._isAvailable())return l})))).filter(l=>l),s=i[0]||go(Vv),a=Ov(n,e.config.apiKey,e.name),o=null;for(let l of r)try{let h=yield l._get(a);if(h){let f=eh._fromJSON(e,h);l!==s&&(o=f),s=l;break}}catch{}let c=i.filter(l=>l._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new t(s,e,n):(s=c[0],o&&(yield s._set(a,o.toJSON())),yield Promise.all(r.map(l=>te(this,null,function*(){if(l!==s)try{yield l._remove(a)}catch{}}))),new t(s,e,n))})}};function MA(t){let e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(g7(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d7(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_7(e))return"Blackberry";if(y7(e))return"Webos";if(p7(e))return"Safari";if((e.includes("chrome/")||m7(e))&&!e.includes("edge/"))return"Chrome";if(v7(e))return"Android";{let r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=t.match(r);if(n?.length===2)return n[1]}return"Other"}function d7(t=kn()){return/firefox\//i.test(t)}function p7(t=kn()){let e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function m7(t=kn()){return/crios\//i.test(t)}function g7(t=kn()){return/iemobile/i.test(t)}function v7(t=kn()){return/android/i.test(t)}function _7(t=kn()){return/blackberry/i.test(t)}function y7(t=kn()){return/webos/i.test(t)}function XA(t,e=[]){let r;switch(t){case"Browser":r=MA(kn());break;case"Worker":r=`${MA(kn())}-${t}`;break;default:r=t}let n=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${Pc}/${n}`}var Bv=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){let n=s=>new Promise((a,o)=>{try{let c=e(s);a(c)}catch(c){o(c)}});n.onAbort=r,this.queue.push(n);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return te(this,null,function*(){if(this.auth.currentUser===e)return;let r=[];try{for(let n of this.queue)yield n(e),n.onAbort&&r.push(n.onAbort)}catch(n){r.reverse();for(let i of r)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}})}};function x7(r){return te(this,arguments,function*(t,e={}){return Ud(t,"GET","/v2/passwordPolicy",$A(t,e))})}var w7=6,Uv=class{constructor(e){var r,n,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(r=a.minPasswordLength)!==null&&r!==void 0?r:w7,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var r,n,i,s,a,o;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(r=c.meetsMinPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(n=c.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(o=c.containsNonAlphanumericCharacter)!==null&&o!==void 0?o:!0),c}validatePasswordLengthOptions(e,r){let n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(r.meetsMinPasswordLength=e.length>=n),i&&(r.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(r,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,r,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var jv=class{constructor(e,r,n,i){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Bd(this),this.idTokenSubscription=new Bd(this),this.beforeStateQueue=new Bv(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=jA,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=go(r)),this._initializationPromise=this.queue(()=>te(this,null,function*(){var n,i;if(!this._deleted&&(this.persistenceManager=yield Vd.create(this,e),!this._deleted)){if(!((n=this._popupRedirectResolver)===null||n===void 0)&&n._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(r),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return te(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return te(this,null,function*(){try{let r=yield GA(this,{idToken:e}),n=yield eh._fromGetAccountInfoResponse(this,r,e);yield this.directlySetCurrentUser(n)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return te(this,null,function*(){var r;if(Fc(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(o,o))}):this.directlySetCurrentUser(null)}let n=yield this.assertedPersistence.getCurrentUser(),i=n,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId,o=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===o)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return pt(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return te(this,null,function*(){let r=null;try{r=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return r})}reloadAndSetCurrentUserOrClear(e){return te(this,null,function*(){try{yield Ld(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=n7()}_delete(){return te(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return te(this,null,function*(){if(Fc(this.app))return Promise.reject(Pd(this));let r=e?di(e):null;return r&&pt(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))})}_updateCurrentUser(e,r=!1){return te(this,null,function*(){if(!this._deleted)return e&&pt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>te(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return te(this,null,function*(){return Fc(this.app)?Promise.reject(Pd(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Fc(this.app)?Promise.reject(Pd(this)):this.queue(()=>te(this,null,function*(){yield this.assertedPersistence.setPersistence(go(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return te(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return te(this,null,function*(){let e=yield x7(this),r=new Uv(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new hs("auth","Firebase",e())}onAuthStateChanged(e,r,n){return this.registerStateListener(this.authStateSubscription,e,r,n)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,n){return this.registerStateListener(this.idTokenSubscription,e,r,n)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{let n=this.onAuthStateChanged(()=>{n(),e()},r)}})}revokeAccessToken(e){return te(this,null,function*(){if(this.currentUser){let r=yield this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(n.tenantId=this.tenantId),yield h7(this,n)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,r){return te(this,null,function*(){let n=yield this.getOrInitRedirectPersistenceManager(r);return e===null?n.removeCurrentUser():n.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return te(this,null,function*(){if(!this.redirectPersistenceManager){let r=e&&go(e)||this._popupRedirectResolver;pt(r,this,"argument-error"),this.redirectPersistenceManager=yield Vd.create(this,[go(r._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return te(this,null,function*(){var r,n;return this._isInitialized&&(yield this.queue(()=>te(this,null,function*(){}))),((r=this._currentUser)===null||r===void 0?void 0:r._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return te(this,null,function*(){if(e===this.currentUser)return this.queue(()=>te(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,r;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=(r=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&r!==void 0?r:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,n,i){if(this._deleted)return()=>{};let s=typeof r=="function"?r:r.next.bind(r),a=!1,o=this._isInitialized?Promise.resolve():this._initializationPromise;if(pt(o,this,"internal-error"),o.then(()=>{a||s(this.currentUser)}),typeof r=="function"){let c=e.addObserver(r,n,i);return()=>{a=!0,c()}}else{let c=e.addObserver(r);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return te(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return pt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=XA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return te(this,null,function*(){var e;let r={"X-Client-Version":this.clientVersion};this.app.options.appId&&(r["X-Firebase-gmpid"]=this.app.options.appId);let n=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();n&&(r["X-Firebase-Client"]=n);let i=yield this._getAppCheckToken();return i&&(r["X-Firebase-AppCheck"]=i),r})}_getAppCheckToken(){return te(this,null,function*(){var e;let r=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return r?.error&&e7(`Error while retrieving App Check token: ${r.error}`),r?.token})}};function E7(t){return di(t)}var Bd=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=mA(r=>this.observer=r)}get next(){return pt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var T7={loadJS(){return te(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function b7(t){T7=t}function I7(t){return`__${t}${Math.floor(Math.random()*1e6)}`}function A7(t,e){let r=e?.persistence||[],n=(Array.isArray(r)?r:[r]).map(go);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(n,e?.popupRedirectResolver)}var TK=I7("rcb"),bK=new vo(3e4,6e4);var IK=new vo(2e3,1e4);var AK=10*60*1e3;var SK=new vo(3e4,6e4);var CK=new vo(5e3,15e3);var kK=encodeURIComponent("fac");var LA="@firebase/auth",VA="1.7.6";var Wv=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return te(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let r=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){pt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function S7(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function C7(t){sa(new Zn("auth",(e,{options:r})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=n.options;pt(a&&!a.includes(":"),"invalid-api-key",{appName:n.name});let c={apiKey:a,authDomain:o,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:XA(t)},l=new jv(n,i,s,c);return A7(l,r),l},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,n)=>{e.getProvider("auth-internal").initialize()})),sa(new Zn("auth-internal",e=>{let r=E7(e.getProvider("auth").getImmediate());return(n=>new Wv(n))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),br(LA,VA,S7(t)),br(LA,VA,"esm2017")}var k7=5*60,DK=cA("authIdTokenMaxAge")||k7;function D7(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}b7({loadJS(t){return new Promise((e,r)=>{let n=document.createElement("script");n.setAttribute("src",t),n.onload=e,n.onerror=i=>{let s=$v("internal-error");s.customData=i,r(s)},n.type="text/javascript",n.charset="UTF-8",D7().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});C7("Browser");var kj="auth";var jd=class{constructor(){return Gu(kj)}};var YA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},QA={};var qv,JA;(function(){var t;function e(x,w){function E(){}E.prototype=w.prototype,x.D=w.prototype,x.prototype=new E,x.prototype.constructor=x,x.C=function(C,D,A){for(var R=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)R[oe-2]=arguments[oe];return w.prototype[D].apply(C,R)}}function r(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,r),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,w,E){E||(E=0);var C=Array(16);if(typeof w=="string")for(var D=0;16>D;++D)C[D]=w.charCodeAt(E++)|w.charCodeAt(E++)<<8|w.charCodeAt(E++)<<16|w.charCodeAt(E++)<<24;else for(D=0;16>D;++D)C[D]=w[E++]|w[E++]<<8|w[E++]<<16|w[E++]<<24;w=x.g[0],E=x.g[1],D=x.g[2];var A=x.g[3],R=w+(A^E&(D^A))+C[0]+3614090360&4294967295;w=E+(R<<7&4294967295|R>>>25),R=A+(D^w&(E^D))+C[1]+3905402710&4294967295,A=w+(R<<12&4294967295|R>>>20),R=D+(E^A&(w^E))+C[2]+606105819&4294967295,D=A+(R<<17&4294967295|R>>>15),R=E+(w^D&(A^w))+C[3]+3250441966&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(A^E&(D^A))+C[4]+4118548399&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(D^w&(E^D))+C[5]+1200080426&4294967295,A=w+(R<<12&4294967295|R>>>20),R=D+(E^A&(w^E))+C[6]+2821735955&4294967295,D=A+(R<<17&4294967295|R>>>15),R=E+(w^D&(A^w))+C[7]+4249261313&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(A^E&(D^A))+C[8]+1770035416&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(D^w&(E^D))+C[9]+2336552879&4294967295,A=w+(R<<12&4294967295|R>>>20),R=D+(E^A&(w^E))+C[10]+4294925233&4294967295,D=A+(R<<17&4294967295|R>>>15),R=E+(w^D&(A^w))+C[11]+2304563134&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(A^E&(D^A))+C[12]+1804603682&4294967295,w=E+(R<<7&4294967295|R>>>25),R=A+(D^w&(E^D))+C[13]+4254626195&4294967295,A=w+(R<<12&4294967295|R>>>20),R=D+(E^A&(w^E))+C[14]+2792965006&4294967295,D=A+(R<<17&4294967295|R>>>15),R=E+(w^D&(A^w))+C[15]+1236535329&4294967295,E=D+(R<<22&4294967295|R>>>10),R=w+(D^A&(E^D))+C[1]+4129170786&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^D&(w^E))+C[6]+3225465664&4294967295,A=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(A^w))+C[11]+643717713&4294967295,D=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(D^A))+C[0]+3921069994&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^A&(E^D))+C[5]+3593408605&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^D&(w^E))+C[10]+38016083&4294967295,A=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(A^w))+C[15]+3634488961&4294967295,D=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(D^A))+C[4]+3889429448&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^A&(E^D))+C[9]+568446438&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^D&(w^E))+C[14]+3275163606&4294967295,A=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(A^w))+C[3]+4107603335&4294967295,D=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(D^A))+C[8]+1163531501&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(D^A&(E^D))+C[13]+2850285829&4294967295,w=E+(R<<5&4294967295|R>>>27),R=A+(E^D&(w^E))+C[2]+4243563512&4294967295,A=w+(R<<9&4294967295|R>>>23),R=D+(w^E&(A^w))+C[7]+1735328473&4294967295,D=A+(R<<14&4294967295|R>>>18),R=E+(A^w&(D^A))+C[12]+2368359562&4294967295,E=D+(R<<20&4294967295|R>>>12),R=w+(E^D^A)+C[5]+4294588738&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^D)+C[8]+2272392833&4294967295,A=w+(R<<11&4294967295|R>>>21),R=D+(A^w^E)+C[11]+1839030562&4294967295,D=A+(R<<16&4294967295|R>>>16),R=E+(D^A^w)+C[14]+4259657740&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^A)+C[1]+2763975236&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^D)+C[4]+1272893353&4294967295,A=w+(R<<11&4294967295|R>>>21),R=D+(A^w^E)+C[7]+4139469664&4294967295,D=A+(R<<16&4294967295|R>>>16),R=E+(D^A^w)+C[10]+3200236656&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^A)+C[13]+681279174&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^D)+C[0]+3936430074&4294967295,A=w+(R<<11&4294967295|R>>>21),R=D+(A^w^E)+C[3]+3572445317&4294967295,D=A+(R<<16&4294967295|R>>>16),R=E+(D^A^w)+C[6]+76029189&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(E^D^A)+C[9]+3654602809&4294967295,w=E+(R<<4&4294967295|R>>>28),R=A+(w^E^D)+C[12]+3873151461&4294967295,A=w+(R<<11&4294967295|R>>>21),R=D+(A^w^E)+C[15]+530742520&4294967295,D=A+(R<<16&4294967295|R>>>16),R=E+(D^A^w)+C[2]+3299628645&4294967295,E=D+(R<<23&4294967295|R>>>9),R=w+(D^(E|~A))+C[0]+4096336452&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~D))+C[7]+1126891415&4294967295,A=w+(R<<10&4294967295|R>>>22),R=D+(w^(A|~E))+C[14]+2878612391&4294967295,D=A+(R<<15&4294967295|R>>>17),R=E+(A^(D|~w))+C[5]+4237533241&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~A))+C[12]+1700485571&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~D))+C[3]+2399980690&4294967295,A=w+(R<<10&4294967295|R>>>22),R=D+(w^(A|~E))+C[10]+4293915773&4294967295,D=A+(R<<15&4294967295|R>>>17),R=E+(A^(D|~w))+C[1]+2240044497&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~A))+C[8]+1873313359&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~D))+C[15]+4264355552&4294967295,A=w+(R<<10&4294967295|R>>>22),R=D+(w^(A|~E))+C[6]+2734768916&4294967295,D=A+(R<<15&4294967295|R>>>17),R=E+(A^(D|~w))+C[13]+1309151649&4294967295,E=D+(R<<21&4294967295|R>>>11),R=w+(D^(E|~A))+C[4]+4149444226&4294967295,w=E+(R<<6&4294967295|R>>>26),R=A+(E^(w|~D))+C[11]+3174756917&4294967295,A=w+(R<<10&4294967295|R>>>22),R=D+(w^(A|~E))+C[2]+718787259&4294967295,D=A+(R<<15&4294967295|R>>>17),R=E+(A^(D|~w))+C[9]+3951481745&4294967295,x.g[0]=x.g[0]+w&4294967295,x.g[1]=x.g[1]+(D+(R<<21&4294967295|R>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+A&4294967295}n.prototype.u=function(x,w){w===void 0&&(w=x.length);for(var E=w-this.blockSize,C=this.B,D=this.h,A=0;A<w;){if(D==0)for(;A<=E;)i(this,x,A),A+=this.blockSize;if(typeof x=="string"){for(;A<w;)if(C[D++]=x.charCodeAt(A++),D==this.blockSize){i(this,C),D=0;break}}else for(;A<w;)if(C[D++]=x[A++],D==this.blockSize){i(this,C),D=0;break}}this.h=D,this.o+=w},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var w=1;w<x.length-8;++w)x[w]=0;var E=8*this.o;for(w=x.length-8;w<x.length;++w)x[w]=E&255,E/=256;for(this.u(x),x=Array(16),w=E=0;4>w;++w)for(var C=0;32>C;C+=8)x[E++]=this.g[w]>>>C&255;return x};function s(x,w){var E=o;return Object.prototype.hasOwnProperty.call(E,x)?E[x]:E[x]=w(x)}function a(x,w){this.h=w;for(var E=[],C=!0,D=x.length-1;0<=D;D--){var A=x[D]|0;C&&A==w||(E[D]=A,C=!1)}this.g=E}var o={};function c(x){return-128<=x&&128>x?s(x,function(w){return new a([w|0],0>w?-1:0)}):new a([x|0],0>x?-1:0)}function l(x){if(isNaN(x)||!isFinite(x))return f;if(0>x)return _(l(-x));for(var w=[],E=1,C=0;x>=E;C++)w[C]=x/E|0,E*=4294967296;return new a(w,0)}function h(x,w){if(x.length==0)throw Error("number format error: empty string");if(w=w||10,2>w||36<w)throw Error("radix out of range: "+w);if(x.charAt(0)=="-")return _(h(x.substring(1),w));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(w,8)),C=f,D=0;D<x.length;D+=8){var A=Math.min(8,x.length-D),R=parseInt(x.substring(D,D+A),w);8>A?(A=l(Math.pow(w,A)),C=C.j(A).add(l(R))):(C=C.j(E),C=C.add(l(R)))}return C}var f=c(0),d=c(1),m=c(16777216);t=a.prototype,t.m=function(){if(p(this))return-_(this).m();for(var x=0,w=1,E=0;E<this.g.length;E++){var C=this.i(E);x+=(0<=C?C:4294967296+C)*w,w*=4294967296}return x},t.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(v(this))return"0";if(p(this))return"-"+_(this).toString(x);for(var w=l(Math.pow(x,6)),E=this,C="";;){var D=O(E,w).g;E=T(E,D.j(w));var A=((0<E.g.length?E.g[0]:E.h)>>>0).toString(x);if(E=D,v(E))return A+C;for(;6>A.length;)A="0"+A;C=A+C}},t.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function v(x){if(x.h!=0)return!1;for(var w=0;w<x.g.length;w++)if(x.g[w]!=0)return!1;return!0}function p(x){return x.h==-1}t.l=function(x){return x=T(this,x),p(x)?-1:v(x)?0:1};function _(x){for(var w=x.g.length,E=[],C=0;C<w;C++)E[C]=~x.g[C];return new a(E,~x.h).add(d)}t.abs=function(){return p(this)?_(this):this},t.add=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0,D=0;D<=w;D++){var A=C+(this.i(D)&65535)+(x.i(D)&65535),R=(A>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);C=R>>>16,A&=65535,R&=65535,E[D]=R<<16|A}return new a(E,E[E.length-1]&-2147483648?-1:0)};function T(x,w){return x.add(_(w))}t.j=function(x){if(v(this)||v(x))return f;if(p(this))return p(x)?_(this).j(_(x)):_(_(this).j(x));if(p(x))return _(this.j(_(x)));if(0>this.l(m)&&0>x.l(m))return l(this.m()*x.m());for(var w=this.g.length+x.g.length,E=[],C=0;C<2*w;C++)E[C]=0;for(C=0;C<this.g.length;C++)for(var D=0;D<x.g.length;D++){var A=this.i(C)>>>16,R=this.i(C)&65535,oe=x.i(D)>>>16,ce=x.i(D)&65535;E[2*C+2*D]+=R*ce,S(E,2*C+2*D),E[2*C+2*D+1]+=A*ce,S(E,2*C+2*D+1),E[2*C+2*D+1]+=R*oe,S(E,2*C+2*D+1),E[2*C+2*D+2]+=A*oe,S(E,2*C+2*D+2)}for(C=0;C<w;C++)E[C]=E[2*C+1]<<16|E[2*C];for(C=w;C<2*w;C++)E[C]=0;return new a(E,0)};function S(x,w){for(;(x[w]&65535)!=x[w];)x[w+1]+=x[w]>>>16,x[w]&=65535,w++}function b(x,w){this.g=x,this.h=w}function O(x,w){if(v(w))throw Error("division by zero");if(v(x))return new b(f,f);if(p(x))return w=O(_(x),w),new b(_(w.g),_(w.h));if(p(w))return w=O(x,_(w)),new b(_(w.g),w.h);if(30<x.g.length){if(p(x)||p(w))throw Error("slowDivide_ only works with positive integers.");for(var E=d,C=w;0>=C.l(x);)E=V(E),C=V(C);var D=B(E,1),A=B(C,1);for(C=B(C,2),E=B(E,2);!v(C);){var R=A.add(C);0>=R.l(x)&&(D=D.add(E),A=R),C=B(C,1),E=B(E,1)}return w=T(x,D.j(w)),new b(D,w)}for(D=f;0<=x.l(w);){for(E=Math.max(1,Math.floor(x.m()/w.m())),C=Math.ceil(Math.log(E)/Math.LN2),C=48>=C?1:Math.pow(2,C-48),A=l(E),R=A.j(w);p(R)||0<R.l(x);)E-=C,A=l(E),R=A.j(w);v(A)&&(A=d),D=D.add(A),x=T(x,R)}return new b(D,x)}t.A=function(x){return O(this,x).h},t.and=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)&x.i(C);return new a(E,this.h&x.h)},t.or=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)|x.i(C);return new a(E,this.h|x.h)},t.xor=function(x){for(var w=Math.max(this.g.length,x.g.length),E=[],C=0;C<w;C++)E[C]=this.i(C)^x.i(C);return new a(E,this.h^x.h)};function V(x){for(var w=x.g.length+1,E=[],C=0;C<w;C++)E[C]=x.i(C)<<1|x.i(C-1)>>>31;return new a(E,x.h)}function B(x,w){var E=w>>5;w%=32;for(var C=x.g.length-E,D=[],A=0;A<C;A++)D[A]=0<w?x.i(A+E)>>>w|x.i(A+E+1)<<32-w:x.i(A+E);return new a(D,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,JA=QA.Md5=n,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=l,a.fromString=h,qv=QA.Integer=a}).apply(typeof YA<"u"?YA:typeof self<"u"?self:typeof window<"u"?window:{});var Wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},fs={};var Kv,Xv,Mc,Yv,th,$d,Qv,Jv,Zv;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,y){return u==Array.prototype||u==Object.prototype||(u[g]=y.value),u};function r(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Wd=="object"&&Wd];for(var g=0;g<u.length;++g){var y=u[g];if(y&&y.Math==Math)return y}throw Error("Cannot find global object")}var n=r(this);function i(u,g){if(g)e:{var y=n;u=u.split(".");for(var k=0;k<u.length-1;k++){var z=u[k];if(!(z in y))break e;y=y[z]}u=u[u.length-1],k=y[u],g=g(k),g!=k&&g!=null&&e(y,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var y=0,k=!1,z={next:function(){if(!k&&y<u.length){var Q=y++;return{value:g(Q,u[Q]),done:!1}}return k=!0,{done:!0,value:void 0}}};return z[Symbol.iterator]=function(){return z},z}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,y){return y})}});var a=a||{},o=this||self;function c(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function l(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function h(u,g,y){return u.call.apply(u.bind,arguments)}function f(u,g,y){if(!u)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var z=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(z,k),u.apply(g,z)}}return function(){return u.apply(g,arguments)}}function d(u,g,y){return d=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,d.apply(null,arguments)}function m(u,g){var y=Array.prototype.slice.call(arguments,1);return function(){var k=y.slice();return k.push.apply(k,arguments),u.apply(this,k)}}function v(u,g){function y(){}y.prototype=g.prototype,u.aa=g.prototype,u.prototype=new y,u.prototype.constructor=u,u.Qb=function(k,z,Q){for(var Ee=Array(arguments.length-2),St=2;St<arguments.length;St++)Ee[St-2]=arguments[St];return g.prototype[z].apply(k,Ee)}}function p(u){let g=u.length;if(0<g){let y=Array(g);for(let k=0;k<g;k++)y[k]=u[k];return y}return[]}function _(u,g){for(let y=1;y<arguments.length;y++){let k=arguments[y];if(c(k)){let z=u.length||0,Q=k.length||0;u.length=z+Q;for(let Ee=0;Ee<Q;Ee++)u[z+Ee]=k[Ee]}else u.push(k)}}class T{constructor(g,y){this.i=g,this.j=y,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function S(u){return/^[\s\xa0]*$/.test(u)}function b(){var u=o.navigator;return u&&(u=u.userAgent)?u:""}function O(u){return O[" "](u),u}O[" "]=function(){};var V=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function B(u,g,y){for(let k in u)g.call(y,u[k],k,u)}function x(u,g){for(let y in u)g.call(void 0,u[y],y,u)}function w(u){let g={};for(let y in u)g[y]=u[y];return g}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function C(u,g){let y,k;for(let z=1;z<arguments.length;z++){k=arguments[z];for(y in k)u[y]=k[y];for(let Q=0;Q<E.length;Q++)y=E[Q],Object.prototype.hasOwnProperty.call(k,y)&&(u[y]=k[y])}}function D(u){var g=1;u=u.split(":");let y=[];for(;0<g&&u.length;)y.push(u.shift()),g--;return u.length&&y.push(u.join(":")),y}function A(u){o.setTimeout(()=>{throw u},0)}function R(){var u=de;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class oe{constructor(){this.h=this.g=null}add(g,y){let k=ce.get();k.set(g,y),this.h?this.h.next=k:this.g=k,this.h=k}}var ce=new T(()=>new ke,u=>u.reset());class ke{constructor(){this.next=this.g=this.h=null}set(g,y){this.h=g,this.g=y,this.next=null}reset(){this.next=this.g=this.h=null}}let we,Ne=!1,de=new oe,Ae=()=>{let u=o.Promise.resolve(void 0);we=()=>{u.then(ie)}};var ie=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(y){A(y)}var g=ce;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}Ne=!1};function j(){this.s=this.s,this.C=this.C}j.prototype.s=!1,j.prototype.ma=function(){this.s||(this.s=!0,this.N())},j.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function G(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}G.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let y=()=>{};o.addEventListener("test",y,g),o.removeEventListener("test",y,g)}catch{}return u}();function W(u,g){if(G.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var y=this.type=u.type,k=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(V){e:{try{O(g.nodeName);var z=!0;break e}catch{}z=!1}z||(g=null)}}else y=="mouseover"?g=u.fromElement:y=="mouseout"&&(g=u.toElement);this.relatedTarget=g,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ne[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&W.aa.h.call(this)}}v(W,G);var ne={2:"touch",3:"pen",4:"mouse"};W.prototype.h=function(){W.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var me="closure_listenable_"+(1e6*Math.random()|0),ue=0;function fe(u,g,y,k,z){this.listener=u,this.proxy=null,this.src=g,this.type=y,this.capture=!!k,this.ha=z,this.key=++ue,this.da=this.fa=!1}function se(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function We(u){this.src=u,this.g={},this.h=0}We.prototype.add=function(u,g,y,k,z){var Q=u.toString();u=this.g[Q],u||(u=this.g[Q]=[],this.h++);var Ee=at(u,g,k,z);return-1<Ee?(g=u[Ee],y||(g.fa=!1)):(g=new fe(g,this.src,Q,!!k,z),g.fa=y,u.push(g)),g};function U(u,g){var y=g.type;if(y in u.g){var k=u.g[y],z=Array.prototype.indexOf.call(k,g,void 0),Q;(Q=0<=z)&&Array.prototype.splice.call(k,z,1),Q&&(se(g),u.g[y].length==0&&(delete u.g[y],u.h--))}}function at(u,g,y,k){for(var z=0;z<u.length;++z){var Q=u[z];if(!Q.da&&Q.listener==g&&Q.capture==!!y&&Q.ha==k)return z}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),ot={};function Je(u,g,y,k,z){if(k&&k.once)return tn(u,g,y,k,z);if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)Je(u,g[Q],y,k,z);return null}return y=Fn(y),u&&u[me]?u.K(g,y,l(k)?!!k.capture:!!k,z):be(u,g,y,!1,k,z)}function be(u,g,y,k,z,Q){if(!g)throw Error("Invalid event type");var Ee=l(z)?!!z.capture:!!z,St=Sr(u);if(St||(u[qe]=St=new We(u)),y=St.add(g,y,k,Ee,Q),y.proxy)return y;if(k=jt(),y.proxy=k,k.src=u,k.listener=y,u.addEventListener)H||(z=Ee),z===void 0&&(z=!1),u.addEventListener(g.toString(),k,z);else if(u.attachEvent)u.attachEvent(vs(g.toString()),k);else if(u.addListener&&u.removeListener)u.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return y}function jt(){function u(y){return g.call(u.src,u.listener,y)}let g=pi;return u}function tn(u,g,y,k,z){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)tn(u,g[Q],y,k,z);return null}return y=Fn(y),u&&u[me]?u.L(g,y,l(k)?!!k.capture:!!k,z):be(u,g,y,!0,k,z)}function fn(u,g,y,k,z){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)fn(u,g[Q],y,k,z);else k=l(k)?!!k.capture:!!k,y=Fn(y),u&&u[me]?(u=u.i,g=String(g).toString(),g in u.g&&(Q=u.g[g],y=at(Q,y,k,z),-1<y&&(se(Q[y]),Array.prototype.splice.call(Q,y,1),Q.length==0&&(delete u.g[g],u.h--)))):u&&(u=Sr(u))&&(g=u.g[g.toString()],u=-1,g&&(u=at(g,y,k,z)),(y=-1<u?g[u]:null)&&dn(y))}function dn(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[me])U(g.i,u);else{var y=u.type,k=u.proxy;g.removeEventListener?g.removeEventListener(y,k,u.capture):g.detachEvent?g.detachEvent(vs(y),k):g.addListener&&g.removeListener&&g.removeListener(k),(y=Sr(g))?(U(y,u),y.h==0&&(y.src=null,g[qe]=null)):se(u)}}}function vs(u){return u in ot?ot[u]:ot[u]="on"+u}function pi(u,g){if(u.da)u=!0;else{g=new W(g,this);var y=u.listener,k=u.ha||u.src;u.fa&&dn(u),u=y.call(k,g)}return u}function Sr(u){return u=u[qe],u instanceof We?u:null}var pn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fn(u){return typeof u=="function"?u:(u[pn]||(u[pn]=function(g){return u.handleEvent(g)}),u[pn])}function zt(){j.call(this),this.i=new We(this),this.M=this,this.F=null}v(zt,j),zt.prototype[me]=!0,zt.prototype.removeEventListener=function(u,g,y,k){fn(this,u,g,y,k)};function dt(u,g){var y,k=u.F;if(k)for(y=[];k;k=k.F)y.push(k);if(u=u.M,k=g.type||g,typeof g=="string")g=new G(g,u);else if(g instanceof G)g.target=g.target||u;else{var z=g;g=new G(k,u),C(g,z)}if(z=!0,y)for(var Q=y.length-1;0<=Q;Q--){var Ee=g.g=y[Q];z=rn(Ee,k,!0,g)&&z}if(Ee=g.g=u,z=rn(Ee,k,!0,g)&&z,z=rn(Ee,k,!1,g)&&z,y)for(Q=0;Q<y.length;Q++)Ee=g.g=y[Q],z=rn(Ee,k,!1,g)&&z}zt.prototype.N=function(){if(zt.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var y=u.g[g],k=0;k<y.length;k++)se(y[k]);delete u.g[g],u.h--}}this.F=null},zt.prototype.K=function(u,g,y,k){return this.i.add(String(u),g,!1,y,k)},zt.prototype.L=function(u,g,y,k){return this.i.add(String(u),g,!0,y,k)};function rn(u,g,y,k){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var z=!0,Q=0;Q<g.length;++Q){var Ee=g[Q];if(Ee&&!Ee.da&&Ee.capture==y){var St=Ee.listener,kr=Ee.ha||Ee.src;Ee.fa&&U(u.i,Ee),z=St.call(kr,k)!==!1&&z}}return z&&!k.defaultPrevented}function Ke(u,g,y){if(typeof u=="function")y&&(u=d(u,y));else if(u&&typeof u.handleEvent=="function")u=d(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:o.setTimeout(u,g||0)}function Ut(u){u.g=Ke(()=>{u.g=null,u.i&&(u.i=!1,Ut(u))},u.l);let g=u.h;u.h=null,u.m.apply(null,g)}class cn extends j{constructor(g,y){super(),this.m=g,this.l=y,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ut(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nt(u){j.call(this),this.h=u,this.g={}}v(Nt,j);var mi=[];function tl(u){B(u.g,function(g,y){this.g.hasOwnProperty(y)&&dn(g)},u),u.g={}}Nt.prototype.N=function(){Nt.aa.N.call(this),tl(this)},Nt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var rl=o.JSON.stringify,b0=o.JSON.parse,mh=class{stringify(u){return o.JSON.stringify(u,void 0)}parse(u){return o.JSON.parse(u,void 0)}};function Co(){}Co.prototype.h=null;function nl(u){return u.h||(u.h=u.i())}function gh(){}var fa={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function _s(){G.call(this,"d")}v(_s,G);function il(){G.call(this,"c")}v(il,G);var Wi={},vh=null;function ko(){return vh=vh||new zt}Wi.La="serverreachability";function _h(u){G.call(this,Wi.La,u)}v(_h,G);function da(u){let g=ko();dt(g,new _h(g))}Wi.STAT_EVENT="statevent";function yh(u,g){G.call(this,Wi.STAT_EVENT,u),this.stat=g}v(yh,G);function Cr(u){let g=ko();dt(g,new yh(g,u))}Wi.Ma="timingevent";function Do(u,g){G.call(this,Wi.Ma,u),this.size=g}v(Do,G);function pa(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){u()},g)}function ma(){this.g=!0}ma.prototype.xa=function(){this.g=!1};function I0(u,g,y,k,z,Q){u.info(function(){if(u.g)if(Q)for(var Ee="",St=Q.split("&"),kr=0;kr<St.length;kr++){var ht=St[kr].split("=");if(1<ht.length){var Br=ht[0];ht=ht[1];var Ur=Br.split("_");Ee=2<=Ur.length&&Ur[1]=="type"?Ee+(Br+"="+ht+"&"):Ee+(Br+"=redacted&")}}else Ee=null;else Ee=Q;return"XMLHTTP REQ ("+k+") [attempt "+z+"]: "+g+`
`+y+`
`+Ee})}function I(u,g,y,k,z,Q,Ee){u.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+z+"]: "+g+`
`+y+`
`+Q+" "+Ee})}function N(u,g,y,k){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+P(u,y)+(k?" "+k:"")})}function F(u,g){u.info(function(){return"TIMEOUT: "+g})}ma.prototype.info=function(){};function P(u,g){if(!u.g)return g;if(!g)return null;try{var y=JSON.parse(g);if(y){for(u=0;u<y.length;u++)if(Array.isArray(y[u])){var k=y[u];if(!(2>k.length)){var z=k[1];if(Array.isArray(z)&&!(1>z.length)){var Q=z[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var Ee=1;Ee<z.length;Ee++)z[Ee]=""}}}}return rl(y)}catch{return g}}var M={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},L={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},K;function ee(){}v(ee,Co),ee.prototype.g=function(){return new XMLHttpRequest},ee.prototype.i=function(){return{}},K=new ee;function q(u,g,y,k){this.j=u,this.i=g,this.l=y,this.R=k||1,this.U=new Nt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new X}function X(){this.i=null,this.g="",this.h=!1}var Y={},le={};function pe(u,g,y){u.L=1,u.v=Eh(Hi(g)),u.m=y,u.P=!0,Se(u,null)}function Se(u,g){u.F=Date.now(),Be(u),u.A=Hi(u.v);var y=u.A,k=u.R;Array.isArray(k)||(k=[String(k)]),z1(y.i,"t",k),u.C=0,y=u.j.J,u.h=new X,u.g=ly(u.j,y?g:null,!u.m),0<u.O&&(u.M=new cn(d(u.Y,u,u.g),u.O)),g=u.U,y=u.g,k=u.ca;var z="readystatechange";Array.isArray(z)||(z&&(mi[0]=z.toString()),z=mi);for(var Q=0;Q<z.length;Q++){var Ee=Je(y,z[Q],k||g.handleEvent,!1,g.h||g);if(!Ee)break;g.g[Ee.key]=Ee}g=u.H?w(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),da(),I0(u.i,u.u,u.A,u.l,u.R,u.m)}q.prototype.ca=function(u){u=u.target;let g=this.M;g&&zi(u)==3?g.j():this.Y(u)},q.prototype.Y=function(u){try{if(u==this.g)e:{let Ur=zi(this.g);var g=this.g.Ba();let Oo=this.g.Z();if(!(3>Ur)&&(Ur!=3||this.g&&(this.h.h||this.g.oa()||J1(this.g)))){this.J||Ur!=4||g==7||(g==8||0>=Oo?da(3):da(2)),gr(this);var y=this.g.Z();this.X=y;t:if(ge(this)){var k=J1(this.g);u="";var z=k.length,Q=zi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qt(this),Ct(this);var Ee="";break t}this.h.i=new o.TextDecoder}for(g=0;g<z;g++)this.h.h=!0,u+=this.h.i.decode(k[g],{stream:!(Q&&g==z-1)});k.length=0,this.h.g+=u,this.C=0,Ee=this.h.g}else Ee=this.g.oa();if(this.o=y==200,I(this.i,this.u,this.A,this.l,this.R,Ur,y),this.o){if(this.T&&!this.K){t:{if(this.g){var St,kr=this.g;if((St=kr.g?kr.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(St)){var ht=St;break t}}ht=null}if(y=ht)N(this.i,this.l,y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$i(this,y);else{this.o=!1,this.s=3,Cr(12),Qt(this),Ct(this);break e}}if(this.P){y=!0;let ei;for(;!this.J&&this.C<Ee.length;)if(ei=Te(this,Ee),ei==le){Ur==4&&(this.s=4,Cr(14),y=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(ei==Y){this.s=4,Cr(15),N(this.i,this.l,Ee,"[Invalid Chunk]"),y=!1;break}else N(this.i,this.l,ei,null),$i(this,ei);if(ge(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ur!=4||Ee.length!=0||this.h.h||(this.s=1,Cr(16),y=!1),this.o=this.o&&y,!y)N(this.i,this.l,Ee,"[Invalid Chunked Response]"),Qt(this),Ct(this);else if(0<Ee.length&&!this.W){this.W=!0;var Br=this.j;Br.g==this&&Br.ba&&!Br.M&&(Br.j.info("Great, no buffering proxy detected. Bytes received: "+Ee.length),R0(Br),Br.M=!0,Cr(11))}}else N(this.i,this.l,Ee,null),$i(this,Ee);Ur==4&&Qt(this),this.o&&!this.J&&(Ur==4?sy(this.j,this):(this.o=!1,Be(this)))}else j2(this.g),y==400&&0<Ee.indexOf("Unknown SID")?(this.s=3,Cr(12)):(this.s=0,Cr(13)),Qt(this),Ct(this)}}}catch{}finally{}};function ge(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Te(u,g){var y=u.C,k=g.indexOf(`
`,y);return k==-1?le:(y=Number(g.substring(y,k)),isNaN(y)?Y:(k+=1,k+y>g.length?le:(g=g.slice(k,k+y),u.C=k+y,g)))}q.prototype.cancel=function(){this.J=!0,Qt(this)};function Be(u){u.S=Date.now()+u.I,It(u,u.I)}function It(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=pa(d(u.ba,u),g)}function gr(u){u.B&&(o.clearTimeout(u.B),u.B=null)}q.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(F(this.i,this.A),this.L!=2&&(da(),Cr(17)),Qt(this),this.s=2,Ct(this)):It(this,this.S-u)};function Ct(u){u.j.G==0||u.J||sy(u.j,u)}function Qt(u){gr(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,tl(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function $i(u,g){try{var y=u.j;if(y.G!=0&&(y.g==u||A0(y.h,u))){if(!u.K&&A0(y.h,u)&&y.G==3){try{var k=y.Da.g.parse(g)}catch{k=null}if(Array.isArray(k)&&k.length==3){var z=k;if(z[0]==0){e:if(!y.u){if(y.g)if(y.g.F+3e3<u.F)Sh(y),Ih(y);else break e;D0(y),Cr(18)}}else y.za=z[1],0<y.za-y.T&&37500>z[2]&&y.F&&y.v==0&&!y.C&&(y.C=pa(d(y.Za,y),6e3));if(1>=Pn(y.h)&&y.ca){try{y.ca()}catch{}y.ca=void 0}}else _a(y,11)}else if((u.K||y.g==u)&&Sh(y),!S(g))for(z=y.Da.g.parse(g),g=0;g<z.length;g++){let ht=z[g];if(y.T=ht[0],ht=ht[1],y.G==2)if(ht[0]=="c"){y.K=ht[1],y.ia=ht[2];let Br=ht[3];Br!=null&&(y.la=Br,y.j.info("VER="+y.la));let Ur=ht[4];Ur!=null&&(y.Aa=Ur,y.j.info("SVER="+y.Aa));let Oo=ht[5];Oo!=null&&typeof Oo=="number"&&0<Oo&&(k=1.5*Oo,y.L=k,y.j.info("backChannelRequestTimeoutMs_="+k)),k=y;let ei=u.g;if(ei){let kh=ei.g?ei.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(kh){var Q=k.h;Q.g||kh.indexOf("spdy")==-1&&kh.indexOf("quic")==-1&&kh.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(S0(Q,Q.h),Q.h=null))}if(k.D){let F0=ei.g?ei.g.getResponseHeader("X-HTTP-Session-Id"):null;F0&&(k.ya=F0,Mt(k.I,k.D,F0))}}y.G=3,y.l&&y.l.ua(),y.ba&&(y.R=Date.now()-u.F,y.j.info("Handshake RTT: "+y.R+"ms")),k=y;var Ee=u;if(k.qa=cy(k,k.J?k.ia:null,k.W),Ee.K){L1(k.h,Ee);var St=Ee,kr=k.L;kr&&(St.I=kr),St.B&&(gr(St),Be(St)),k.g=Ee}else ny(k);0<y.i.length&&Ah(y)}else ht[0]!="stop"&&ht[0]!="close"||_a(y,7);else y.G==3&&(ht[0]=="stop"||ht[0]=="close"?ht[0]=="stop"?_a(y,7):k0(y):ht[0]!="noop"&&y.l&&y.l.ta(ht),y.v=0)}}da(4)}catch{}}var ga=class{constructor(u,g){this.g=u,this.map=g}};function gi(u){this.l=u||10,o.PerformanceNavigationTiming?(u=o.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ro(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Pn(u){return u.h?1:u.g?u.g.size:0}function A0(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function S0(u,g){u.g?u.g.add(g):u.h=g}function L1(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}gi.prototype.cancel=function(){if(this.i=V1(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function V1(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(let y of u.g.values())g=g.concat(y.D);return g}return p(u.i)}function A2(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var g=[],y=u.length,k=0;k<y;k++)g.push(u[k]);return g}g=[],y=0;for(k in u)g[y++]=u[k];return g}function S2(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var g=[];u=u.length;for(var y=0;y<u;y++)g.push(y);return g}g=[],y=0;for(let k in u)g[y++]=k;return g}}}function B1(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var y=S2(u),k=A2(u),z=k.length,Q=0;Q<z;Q++)g.call(void 0,k[Q],y&&y[Q],u)}var U1=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function C2(u,g){if(u){u=u.split("&");for(var y=0;y<u.length;y++){var k=u[y].indexOf("="),z=null;if(0<=k){var Q=u[y].substring(0,k);z=u[y].substring(k+1)}else Q=u[y];g(Q,z?decodeURIComponent(z.replace(/\+/g," ")):"")}}}function va(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof va){this.h=u.h,xh(this,u.j),this.o=u.o,this.g=u.g,wh(this,u.s),this.l=u.l;var g=u.i,y=new ol;y.i=g.i,g.g&&(y.g=new Map(g.g),y.h=g.h),j1(this,y),this.m=u.m}else u&&(g=String(u).match(U1))?(this.h=!1,xh(this,g[1]||"",!0),this.o=sl(g[2]||""),this.g=sl(g[3]||"",!0),wh(this,g[4]),this.l=sl(g[5]||"",!0),j1(this,g[6]||"",!0),this.m=sl(g[7]||"")):(this.h=!1,this.i=new ol(null,this.h))}va.prototype.toString=function(){var u=[],g=this.j;g&&u.push(al(g,W1,!0),":");var y=this.g;return(y||g=="file")&&(u.push("//"),(g=this.o)&&u.push(al(g,W1,!0),"@"),u.push(encodeURIComponent(String(y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y=this.s,y!=null&&u.push(":",String(y))),(y=this.l)&&(this.g&&y.charAt(0)!="/"&&u.push("/"),u.push(al(y,y.charAt(0)=="/"?R2:D2,!0))),(y=this.i.toString())&&u.push("?",y),(y=this.m)&&u.push("#",al(y,P2)),u.join("")};function Hi(u){return new va(u)}function xh(u,g,y){u.j=y?sl(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function wh(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function j1(u,g,y){g instanceof ol?(u.i=g,O2(u.i,u.h)):(y||(g=al(g,F2)),u.i=new ol(g,u.h))}function Mt(u,g,y){u.i.set(g,y)}function Eh(u){return Mt(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function sl(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function al(u,g,y){return typeof u=="string"?(u=encodeURI(u).replace(g,k2),y&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function k2(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var W1=/[#\/\?@]/g,D2=/[#\?:]/g,R2=/[#\?]/g,F2=/[#\?@]/g,P2=/#/g;function ol(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function ys(u){u.g||(u.g=new Map,u.h=0,u.i&&C2(u.i,function(g,y){u.add(decodeURIComponent(g.replace(/\+/g," ")),y)}))}t=ol.prototype,t.add=function(u,g){ys(this),this.i=null,u=Fo(this,u);var y=this.g.get(u);return y||this.g.set(u,y=[]),y.push(g),this.h+=1,this};function $1(u,g){ys(u),g=Fo(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function H1(u,g){return ys(u),g=Fo(u,g),u.g.has(g)}t.forEach=function(u,g){ys(this),this.g.forEach(function(y,k){y.forEach(function(z){u.call(g,z,k,this)},this)},this)},t.na=function(){ys(this);let u=Array.from(this.g.values()),g=Array.from(this.g.keys()),y=[];for(let k=0;k<g.length;k++){let z=u[k];for(let Q=0;Q<z.length;Q++)y.push(g[k])}return y},t.V=function(u){ys(this);let g=[];if(typeof u=="string")H1(this,u)&&(g=g.concat(this.g.get(Fo(this,u))));else{u=Array.from(this.g.values());for(let y=0;y<u.length;y++)g=g.concat(u[y])}return g},t.set=function(u,g){return ys(this),this.i=null,u=Fo(this,u),H1(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function z1(u,g,y){$1(u,g),0<y.length&&(u.i=null,u.g.set(Fo(u,g),p(y)),u.h+=y.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],g=Array.from(this.g.keys());for(var y=0;y<g.length;y++){var k=g[y];let Q=encodeURIComponent(String(k)),Ee=this.V(k);for(k=0;k<Ee.length;k++){var z=Q;Ee[k]!==""&&(z+="="+encodeURIComponent(String(Ee[k]))),u.push(z)}}return this.i=u.join("&")};function Fo(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function O2(u,g){g&&!u.j&&(ys(u),u.i=null,u.g.forEach(function(y,k){var z=k.toLowerCase();k!=z&&($1(this,k),z1(this,z,y))},u)),u.j=g}function N2(u,g){let y=new ma;if(o.Image){let k=new Image;k.onload=m(xs,y,"TestLoadImage: loaded",!0,g,k),k.onerror=m(xs,y,"TestLoadImage: error",!1,g,k),k.onabort=m(xs,y,"TestLoadImage: abort",!1,g,k),k.ontimeout=m(xs,y,"TestLoadImage: timeout",!1,g,k),o.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=u}else g(!1)}function M2(u,g){let y=new ma,k=new AbortController,z=setTimeout(()=>{k.abort(),xs(y,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:k.signal}).then(Q=>{clearTimeout(z),Q.ok?xs(y,"TestPingServer: ok",!0,g):xs(y,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(z),xs(y,"TestPingServer: error",!1,g)})}function xs(u,g,y,k,z){try{z&&(z.onload=null,z.onerror=null,z.onabort=null,z.ontimeout=null),k(y)}catch{}}function L2(){this.g=new mh}function V2(u,g,y){let k=y||"";try{B1(u,function(z,Q){let Ee=z;l(z)&&(Ee=rl(z)),g.push(k+Q+"="+encodeURIComponent(Ee))})}catch(z){throw g.push(k+"type="+encodeURIComponent("_badmap")),z}}function cl(u){this.l=u.Ub||null,this.j=u.eb||!1}v(cl,Co),cl.prototype.g=function(){return new Th(this.l,this.j)},cl.prototype.i=function(u){return function(){return u}}({});function Th(u,g){zt.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Th,zt),t=Th.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,ul(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||o).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ll(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,ul(this)),this.g&&(this.readyState=3,ul(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;G1(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function G1(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?ll(this):ul(this),this.readyState==3&&G1(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,ll(this))},t.Qa=function(u){this.g&&(this.response=u,ll(this))},t.ga=function(){this.g&&ll(this)};function ll(u){u.readyState=4,u.l=null,u.j=null,u.v=null,ul(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],g=this.h.entries();for(var y=g.next();!y.done;)y=y.value,u.push(y[0]+": "+y[1]),y=g.next();return u.join(`\r
`)};function ul(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Th.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function q1(u){let g="";return B(u,function(y,k){g+=k,g+=":",g+=y,g+=`\r
`}),g}function C0(u,g,y){e:{for(k in y){var k=!1;break e}k=!0}k||(y=q1(y),typeof u=="string"?y!=null&&encodeURIComponent(String(y)):Mt(u,g,y))}function Gt(u){zt.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(Gt,zt);var B2=/^https?$/i,U2=["POST","PUT"];t=Gt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,y,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():K.g(),this.v=this.o?nl(this.o):nl(K),this.g.onreadystatechange=d(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(Q){K1(this,Q);return}if(u=y||"",y=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var z in k)y.set(z,k[z]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(let Q of k.keys())y.set(Q,k.get(Q));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(y.keys()).find(Q=>Q.toLowerCase()=="content-type"),z=o.FormData&&u instanceof o.FormData,!(0<=Array.prototype.indexOf.call(U2,g,void 0))||k||z||y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[Q,Ee]of y)this.g.setRequestHeader(Q,Ee);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Q1(this),this.u=!0,this.g.send(u),this.u=!1}catch(Q){K1(this,Q)}};function K1(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,X1(u),bh(u)}function X1(u){u.A||(u.A=!0,dt(u,"complete"),dt(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,dt(this,"complete"),dt(this,"abort"),bh(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bh(this,!0)),Gt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Y1(this):this.bb())},t.bb=function(){Y1(this)};function Y1(u){if(u.h&&typeof a<"u"&&(!u.v[1]||zi(u)!=4||u.Z()!=2)){if(u.u&&zi(u)==4)Ke(u.Ea,0,u);else if(dt(u,"readystatechange"),zi(u)==4){u.h=!1;try{let Ee=u.Z();e:switch(Ee){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var y;if(!(y=g)){var k;if(k=Ee===0){var z=String(u.D).match(U1)[1]||null;!z&&o.self&&o.self.location&&(z=o.self.location.protocol.slice(0,-1)),k=!B2.test(z?z.toLowerCase():"")}y=k}if(y)dt(u,"complete"),dt(u,"success");else{u.m=6;try{var Q=2<zi(u)?u.g.statusText:""}catch{Q=""}u.l=Q+" ["+u.Z()+"]",X1(u)}}finally{bh(u)}}}}function bh(u,g){if(u.g){Q1(u);let y=u.g,k=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||dt(u,"ready");try{y.onreadystatechange=k}catch{}}}function Q1(u){u.I&&(o.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function zi(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<zi(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),b0(g)}};function J1(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function j2(u){let g={};u=(u.g&&2<=zi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<u.length;k++){if(S(u[k]))continue;var y=D(u[k]);let z=y[0];if(y=y[1],typeof y!="string")continue;y=y.trim();let Q=g[z]||[];g[z]=Q,Q.push(y)}x(g,function(k){return k.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function hl(u,g,y){return y&&y.internalChannelParams&&y.internalChannelParams[u]||g}function Z1(u){this.Aa=0,this.i=[],this.j=new ma,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=hl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=hl("baseRetryDelayMs",5e3,u),this.cb=hl("retryDelaySeedMs",1e4,u),this.Wa=hl("forwardChannelMaxRetries",2,u),this.wa=hl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new gi(u&&u.concurrentRequestLimit),this.Da=new L2,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Z1.prototype,t.la=8,t.G=1,t.connect=function(u,g,y,k){Cr(0),this.W=u,this.H=g||{},y&&k!==void 0&&(this.H.OSID=y,this.H.OAID=k),this.F=this.X,this.I=cy(this,null,this.W),Ah(this)};function k0(u){if(ey(u),u.G==3){var g=u.U++,y=Hi(u.I);if(Mt(y,"SID",u.K),Mt(y,"RID",g),Mt(y,"TYPE","terminate"),fl(u,y),g=new q(u,u.j,g),g.L=2,g.v=Eh(Hi(y)),y=!1,o.navigator&&o.navigator.sendBeacon)try{y=o.navigator.sendBeacon(g.v.toString(),"")}catch{}!y&&o.Image&&(new Image().src=g.v,y=!0),y||(g.g=ly(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Be(g)}oy(u)}function Ih(u){u.g&&(R0(u),u.g.cancel(),u.g=null)}function ey(u){Ih(u),u.u&&(o.clearTimeout(u.u),u.u=null),Sh(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&o.clearTimeout(u.s),u.s=null)}function Ah(u){if(!Ro(u.h)&&!u.s){u.s=!0;var g=u.Ga;we||Ae(),Ne||(we(),Ne=!0),de.add(g,u),u.B=0}}function W2(u,g){return Pn(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=pa(d(u.Ga,u,g),ay(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let z=new q(this,this.j,u),Q=this.o;if(this.S&&(Q?(Q=w(Q),C(Q,this.S)):Q=this.S),this.m!==null||this.O||(z.H=Q,Q=null),this.P)e:{for(var g=0,y=0;y<this.i.length;y++){t:{var k=this.i[y];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(g+=k,4096<g){g=y;break e}if(g===4096||y===this.i.length-1){g=y+1;break e}}g=1e3}else g=1e3;g=ry(this,z,g),y=Hi(this.I),Mt(y,"RID",u),Mt(y,"CVER",22),this.D&&Mt(y,"X-HTTP-Session-Id",this.D),fl(this,y),Q&&(this.O?g="headers="+encodeURIComponent(String(q1(Q)))+"&"+g:this.m&&C0(y,this.m,Q)),S0(this.h,z),this.Ua&&Mt(y,"TYPE","init"),this.P?(Mt(y,"$req",g),Mt(y,"SID","null"),z.T=!0,pe(z,y,null)):pe(z,y,g),this.G=2}}else this.G==3&&(u?ty(this,u):this.i.length==0||Ro(this.h)||ty(this))};function ty(u,g){var y;g?y=g.l:y=u.U++;let k=Hi(u.I);Mt(k,"SID",u.K),Mt(k,"RID",y),Mt(k,"AID",u.T),fl(u,k),u.m&&u.o&&C0(k,u.m,u.o),y=new q(u,u.j,y,u.B+1),u.m===null&&(y.H=u.o),g&&(u.i=g.D.concat(u.i)),g=ry(u,y,1e3),y.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),S0(u.h,y),pe(y,k,g)}function fl(u,g){u.H&&B(u.H,function(y,k){Mt(g,k,y)}),u.l&&B1({},function(y,k){Mt(g,k,y)})}function ry(u,g,y){y=Math.min(u.i.length,y);var k=u.l?d(u.l.Na,u.l,u):null;e:{var z=u.i;let Q=-1;for(;;){let Ee=["count="+y];Q==-1?0<y?(Q=z[0].g,Ee.push("ofs="+Q)):Q=0:Ee.push("ofs="+Q);let St=!0;for(let kr=0;kr<y;kr++){let ht=z[kr].g,Br=z[kr].map;if(ht-=Q,0>ht)Q=Math.max(0,z[kr].g-100),St=!1;else try{V2(Br,Ee,"req"+ht+"_")}catch{k&&k(Br)}}if(St){k=Ee.join("&");break e}}}return u=u.i.splice(0,y),g.D=u,k}function ny(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;we||Ae(),Ne||(we(),Ne=!0),de.add(g,u),u.v=0}}function D0(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=pa(d(u.Fa,u),ay(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,iy(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=pa(d(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Cr(10),Ih(this),iy(this))};function R0(u){u.A!=null&&(o.clearTimeout(u.A),u.A=null)}function iy(u){u.g=new q(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Hi(u.qa);Mt(g,"RID","rpc"),Mt(g,"SID",u.K),Mt(g,"AID",u.T),Mt(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Mt(g,"TO",u.ja),Mt(g,"TYPE","xmlhttp"),fl(u,g),u.m&&u.o&&C0(g,u.m,u.o),u.L&&(u.g.I=u.L);var y=u.g;u=u.ia,y.L=1,y.v=Eh(Hi(g)),y.m=null,y.P=!0,Se(y,u)}t.Za=function(){this.C!=null&&(this.C=null,Ih(this),D0(this),Cr(19))};function Sh(u){u.C!=null&&(o.clearTimeout(u.C),u.C=null)}function sy(u,g){var y=null;if(u.g==g){Sh(u),R0(u),u.g=null;var k=2}else if(A0(u.h,g))y=g.D,L1(u.h,g),k=1;else return;if(u.G!=0){if(g.o)if(k==1){y=g.m?g.m.length:0,g=Date.now()-g.F;var z=u.B;k=ko(),dt(k,new Do(k,y)),Ah(u)}else ny(u);else if(z=g.s,z==3||z==0&&0<g.X||!(k==1&&W2(u,g)||k==2&&D0(u)))switch(y&&0<y.length&&(g=u.h,g.i=g.i.concat(y)),z){case 1:_a(u,5);break;case 4:_a(u,10);break;case 3:_a(u,6);break;default:_a(u,2)}}}function ay(u,g){let y=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(y*=2),y*g}function _a(u,g){if(u.j.info("Error code "+g),g==2){var y=d(u.fb,u),k=u.Xa;let z=!k;k=new va(k||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||xh(k,"https"),Eh(k),z?N2(k.toString(),y):M2(k.toString(),y)}else Cr(2);u.G=0,u.l&&u.l.sa(g),oy(u),ey(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Cr(2)):(this.j.info("Failed to ping google.com"),Cr(1))};function oy(u){if(u.G=0,u.ka=[],u.l){let g=V1(u.h);(g.length!=0||u.i.length!=0)&&(_(u.ka,g),_(u.ka,u.i),u.h.i.length=0,p(u.i),u.i.length=0),u.l.ra()}}function cy(u,g,y){var k=y instanceof va?Hi(y):new va(y);if(k.g!="")g&&(k.g=g+"."+k.g),wh(k,k.s);else{var z=o.location;k=z.protocol,g=g?g+"."+z.hostname:z.hostname,z=+z.port;var Q=new va(null);k&&xh(Q,k),g&&(Q.g=g),z&&wh(Q,z),y&&(Q.l=y),k=Q}return y=u.D,g=u.ya,y&&g&&Mt(k,y,g),Mt(k,"VER",u.la),fl(u,k),k}function ly(u,g,y){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new Gt(new cl({eb:y})):new Gt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function uy(){}t=uy.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ch(){}Ch.prototype.g=function(u,g){return new mn(u,g)};function mn(u,g){zt.call(this),this.g=new Z1(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!S(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!S(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Po(this)}v(mn,zt),mn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},mn.prototype.close=function(){k0(this.g)},mn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var y={};y.__data__=u,u=y}else this.u&&(y={},y.__data__=rl(u),u=y);g.i.push(new ga(g.Ya++,u)),g.G==3&&Ah(g)},mn.prototype.N=function(){this.g.l=null,delete this.j,k0(this.g),delete this.g,mn.aa.N.call(this)};function hy(u){_s.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(let y in g){u=y;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(hy,_s);function fy(){il.call(this),this.status=1}v(fy,il);function Po(u){this.g=u}v(Po,uy),Po.prototype.ua=function(){dt(this.g,"a")},Po.prototype.ta=function(u){dt(this.g,new hy(u))},Po.prototype.sa=function(u){dt(this.g,new fy)},Po.prototype.ra=function(){dt(this.g,"b")},Ch.prototype.createWebChannel=Ch.prototype.g,mn.prototype.send=mn.prototype.o,mn.prototype.open=mn.prototype.m,mn.prototype.close=mn.prototype.close,Zv=fs.createWebChannelTransport=function(){return new Ch},Jv=fs.getStatEventTarget=function(){return ko()},Qv=fs.Event=Wi,$d=fs.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},M.NO_ERROR=0,M.TIMEOUT=8,M.HTTP_ERROR=6,th=fs.ErrorCode=M,L.COMPLETE="complete",Yv=fs.EventType=L,gh.EventType=fa,fa.OPEN="a",fa.CLOSE="b",fa.ERROR="c",fa.MESSAGE="d",zt.prototype.listen=zt.prototype.K,Mc=fs.WebChannel=gh,Xv=fs.FetchXmlHttpFactory=cl,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,Kv=fs.XhrIo=Gt}).apply(typeof Wd<"u"?Wd:typeof self<"u"?self:typeof window<"u"?window:{});var ZA="@firebase/firestore";var Ir=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ir.UNAUTHENTICATED=new Ir(null),Ir.GOOGLE_CREDENTIALS=new Ir("google-credentials-uid"),Ir.FIRST_PARTY=new Ir("first-party-uid"),Ir.MOCK_USER=new Ir("mock-user");var el="10.12.5";var wo=new na("@firebase/firestore");function rh(){return wo.logLevel}function Fe(t,...e){if(wo.logLevel<=tt.DEBUG){let r=e.map(w1);wo.debug(`Firestore (${el}): ${t}`,...r)}}function Eo(t,...e){if(wo.logLevel<=tt.ERROR){let r=e.map(w1);wo.error(`Firestore (${el}): ${t}`,...r)}}function Xd(t,...e){if(wo.logLevel<=tt.WARN){let r=e.map(w1);wo.warn(`Firestore (${el}): ${t}`,...r)}}function w1(t){if(typeof t=="string")return t;try{return function(r){return JSON.stringify(r)}(t)}catch{return t}}function rt(t="Unexpected state"){let e=`FIRESTORE (${el}) INTERNAL ASSERTION FAILED: `+t;throw Eo(e),new Error(e)}function mr(t,e){t||rt()}function Ot(t,e){return t}var he={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Ve=class extends Jn{constructor(e,r){super(e,r),this.code=e,this.message=r,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var ds=class{constructor(){this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}};var Yd=class{constructor(e,r){this.user=r,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},n_=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,r){e.enqueueRetryable(()=>r(Ir.UNAUTHENTICATED))}shutdown(){}},i_=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,r){this.changeListener=r,e.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}},s_=class{constructor(e){this.t=e,this.currentUser=Ir.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,r){let n=this.i,i=c=>this.i!==n?(n=this.i,r(c)):Promise.resolve(),s=new ds;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ds,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let c=s;e.enqueueRetryable(()=>te(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},o=c=>{Fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),a()};this.t.onInit(c=>o(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?o(c):(Fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ds)}},0),a()}getToken(){let e=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(n=>this.i!==e?(Fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(mr(typeof n.accessToken=="string"),new Yd(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return mr(e===null||typeof e=="string"),new Ir(e)}},a_=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n,this.type="FirstParty",this.user=Ir.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},o_=class{constructor(e,r,n){this.l=e,this.h=r,this.P=n}getToken(){return Promise.resolve(new a_(this.l,this.h,this.P))}start(e,r){e.enqueueRetryable(()=>r(Ir.FIRST_PARTY))}shutdown(){}invalidateToken(){}},c_=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},l_=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,r){let n=s=>{s.error!=null&&Fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,Fe("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?r(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};let i=s=>{Fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):Fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(r=>r?(mr(typeof r.token=="string"),this.R=r.token,new c_(r.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function Dj(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),r=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(r);else for(let n=0;n<t;n++)r[n]=Math.floor(256*Math.random());return r}var Qd=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let i=Dj(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<r&&(n+=e.charAt(i[s]%e.length))}return n}};function Pt(t,e){return t<e?-1:t>e?1:0}function Uc(t,e,r){return t.length===e.length&&t.every((n,i)=>r(n,e[i]))}var en=class t{constructor(e,r){if(this.seconds=e,this.nanoseconds=r,r<0)throw new Ve(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new Ve(he.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(e<-62135596800)throw new Ve(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(he.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let r=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*r));return new t(r,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Pt(this.nanoseconds,e.nanoseconds):Pt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var ir=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new en(0,0))}static max(){return new t(new en(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Jd=class t{constructor(e,r,n){r===void 0?r=0:r>e.length&&rt(),n===void 0?n=e.length-r:n>e.length-r&&rt(),this.segments=e,this.offset=r,this.len=n}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let r=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(n=>{r.push(n)}):r.push(e),this.construct(r)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==e.get(r))return!1;return!0}forEach(e){for(let r=this.offset,n=this.limit();r<n;r++)e(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,r){let n=Math.min(e.length,r.length);for(let i=0;i<n;i++){let s=e.get(i),a=r.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<r.length?-1:e.length>r.length?1:0}},ur=class t extends Jd{construct(e,r,n){return new t(e,r,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let r=[];for(let n of e){if(n.indexOf("//")>=0)throw new Ve(he.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);r.push(...n.split("/").filter(i=>i.length>0))}return new t(r)}static emptyPath(){return new t([])}},Rj=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Dn=class t extends Jd{construct(e,r,n){return new t(e,r,n)}static isValidIdentifier(e){return Rj.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let r=[],n="",i=0,s=()=>{if(n.length===0)throw new Ve(he.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(n),n=""},a=!1;for(;i<e.length;){let o=e[i];if(o==="\\"){if(i+1===e.length)throw new Ve(he.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new Ve(he.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=c,i+=2}else o==="`"?(a=!a,i++):o!=="."||a?(n+=o,i++):(s(),i++)}if(s(),a)throw new Ve(he.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(r)}static emptyPath(){return new t([])}};var et=class t{constructor(e){this.path=e}static fromPath(e){return new t(ur.fromString(e))}static fromName(e){return new t(ur.fromString(e).popFirst(5))}static empty(){return new t(ur.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ur.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,r){return ur.comparator(e.path,r.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new ur(e.slice()))}};var u_=class{constructor(e,r,n,i){this.indexId=e,this.collectionGroup=r,this.fields=n,this.indexState=i}};u_.UNKNOWN_ID=-1;function Fj(t,e){let r=t.toTimestamp().seconds,n=t.toTimestamp().nanoseconds+1,i=ir.fromTimestamp(n===1e9?new en(r+1,0):new en(r,n));return new To(i,et.empty(),e)}function Pj(t){return new To(t.readTime,t.key,-1)}var To=class t{constructor(e,r,n){this.readTime=e,this.documentKey=r,this.largestBatchId=n}static min(){return new t(ir.min(),et.empty(),-1)}static max(){return new t(ir.max(),et.empty(),-1)}};function Oj(t,e){let r=t.readTime.compareTo(e.readTime);return r!==0?r:(r=et.comparator(t.documentKey,e.documentKey),r!==0?r:Pt(t.largestBatchId,e.largestBatchId))}var Nj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",h_=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function xS(t){return te(this,null,function*(){if(t.code!==he.FAILED_PRECONDITION||t.message!==Nj)throw t;Fe("LocalStore","Unexpectedly lost primary lease")})}var xe=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(e){return this.next(void 0,e)}next(e,r){return this.callbackAttached&&rt(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(e,this.result):new t((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(r,s).next(n,i)}})}toPromise(){return new Promise((e,r)=>{this.next(e,r)})}wrapUserFunction(e){try{let r=e();return r instanceof t?r:t.resolve(r)}catch(r){return t.reject(r)}}wrapSuccess(e,r){return e?this.wrapUserFunction(()=>e(r)):t.resolve(r)}wrapFailure(e,r){return e?this.wrapUserFunction(()=>e(r)):t.reject(r)}static resolve(e){return new t((r,n)=>{r(e)})}static reject(e){return new t((r,n)=>{n(e)})}static waitFor(e){return new t((r,n)=>{let i=0,s=0,a=!1;e.forEach(o=>{++i,o.next(()=>{++s,a&&s===i&&r()},c=>n(c))}),a=!0,s===i&&r()})}static or(e){let r=t.resolve(!1);for(let n of e)r=r.next(i=>i?t.resolve(i):n());return r}static forEach(e,r){let n=[];return e.forEach((i,s)=>{n.push(r.call(this,i,s))}),this.waitFor(n)}static mapArray(e,r){return new t((n,i)=>{let s=e.length,a=new Array(s),o=0;for(let c=0;c<s;c++){let l=c;r(e[l]).next(h=>{a[l]=h,++o,o===s&&n(a)},h=>i(h))}})}static doWhile(e,r){return new t((n,i)=>{let s=()=>{e()===!0?r().next(()=>{s()},i):n()};s()})}};function Mj(t){let e=t.match(/Android ([\d.]+)/i),r=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(r)}function g0(t){return t.name==="IndexedDbTransactionError"}var Lj=(()=>{class t{constructor(r,n){this.previousValue=r,n&&(n.sequenceNumberHandler=i=>this.ie(i),this.se=i=>n.writeSequenceNumber(i))}ie(r){return this.previousValue=Math.max(r,this.previousValue),this.previousValue}next(){let r=++this.previousValue;return this.se&&this.se(r),r}}return t.oe=-1,t})();function E1(t){return t==null}function ch(t){return t===0&&1/t==-1/0}function Vj(t){return typeof t=="number"&&Number.isInteger(t)&&!ch(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}var Bj=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],RX=[...Bj,"documentOverlays"],Uj=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],jj=Uj,Wj=[...jj,"indexConfiguration","indexState","indexEntries"];var FX=[...Wj,"globals"];function eS(t){let e=0;for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e++;return e}function fh(t,e){for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&e(r,t[r])}function wS(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var Rn=class t{constructor(e,r){this.comparator=e,this.root=r||Ui.EMPTY}insert(e,r){return new t(this.comparator,this.root.insert(e,r,this.comparator).copy(null,null,Ui.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ui.BLACK,null,null))}get(e){let r=this.root;for(;!r.isEmpty();){let n=this.comparator(e,r.key);if(n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}indexOf(e){let r=0,n=this.root;for(;!n.isEmpty();){let i=this.comparator(e,n.key);if(i===0)return r+n.left.size;i<0?n=n.left:(r+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((r,n)=>(e(r,n),!1))}toString(){let e=[];return this.inorderTraversal((r,n)=>(e.push(`${r}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vc(this.root,e,this.comparator,!0)}},Vc=class{constructor(e,r,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=r?n(e.key,r):1,r&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),r={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Ui=class t{constructor(e,r,n,i,s){this.key=e,this.value=r,this.color=n??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,r,n,i,s){return new t(e??this.key,r??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,r,n){let i=this,s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,r,n),null):s===0?i.copy(null,r,null,null,null):i.copy(null,null,null,null,i.right.insert(e,r,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,r){let n,i=this;if(r(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,r),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),r(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,r))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,r)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw rt();let e=this.left.check();if(e!==this.right.check())throw rt();return e+(this.isRed()?0:1)}};Ui.EMPTY=null,Ui.RED=!0,Ui.BLACK=!1;Ui.EMPTY=new class{constructor(){this.size=0}get key(){throw rt()}get value(){throw rt()}get color(){throw rt()}get left(){throw rt()}get right(){throw rt()}copy(e,r,n,i,s){return this}insert(e,r,n){return new Ui(e,r)}remove(e,r){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var on=class t{constructor(e){this.comparator=e,this.data=new Rn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((r,n)=>(e(r),!1))}forEachInRange(e,r){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;r(i.key)}}forEachWhile(e,r){let n;for(n=r!==void 0?this.data.getIteratorFrom(r):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let r=this.data.getIteratorFrom(e);return r.hasNext()?r.getNext().key:null}getIterator(){return new Zd(this.data.getIterator())}getIteratorFrom(e){return new Zd(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let r=this;return r.size<e.size&&(r=e,e=this),e.forEach(n=>{r=r.add(n)}),r}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let r=this.data.getIterator(),n=e.data.getIterator();for(;r.hasNext();){let i=r.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(r=>{e.push(r)}),e}toString(){let e=[];return this.forEach(r=>e.push(r)),"SortedSet("+e.toString()+")"}copy(e){let r=new t(this.comparator);return r.data=e,r}},Zd=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Bi=class t{constructor(e){this.fields=e,e.sort(Dn.comparator)}static empty(){return new t([])}unionWith(e){let r=new on(Dn.comparator);for(let n of this.fields)r=r.add(n);for(let n of e)r=r.add(n);return new t(r.toArray())}covers(e){for(let r of this.fields)if(r.isPrefixOf(e))return!0;return!1}isEqual(e){return Uc(this.fields,e.fields,(r,n)=>r.isEqual(n))}};var f_=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ms=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let r=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new f_("Invalid base64 string: "+s):s}}(e);return new t(r)}static fromUint8Array(e){let r=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new t(r)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(r){return btoa(r)}(this.binaryString)}toUint8Array(){return function(r){let n=new Uint8Array(r.length);for(let i=0;i<r.length;i++)n[i]=r.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Pt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ms.EMPTY_BYTE_STRING=new ms("");var $j=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ca(t){if(mr(!!t),typeof t=="string"){let e=0,r=$j.exec(t);if(mr(!!r),r[1]){let i=r[1];i=(i+"000000000").substr(0,9),e=Number(i)}let n=new Date(t);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:pr(t.seconds),nanos:pr(t.nanos)}}function pr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function jc(t){return typeof t=="string"?ms.fromBase64String(t):ms.fromUint8Array(t)}function T1(t){var e,r;return((r=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||r===void 0?void 0:r.stringValue)==="server_timestamp"}function ES(t){let e=t.mapValue.fields.__previous_value__;return T1(e)?ES(e):e}function e0(t){let e=ca(t.mapValue.fields.__local_write_time__.timestampValue);return new en(e.seconds,e.nanos)}var d_=class{constructor(e,r,n,i,s,a,o,c,l){this.databaseId=e,this.appId=r,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=o,this.longPollingOptions=c,this.useFetchStreams=l}},p_=class t{constructor(e,r){this.projectId=e,this.database=r||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Hd={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Wc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?T1(t)?4:TS(t)?9007199254740991:10:rt()}function ji(t,e){if(t===e)return!0;let r=Wc(t);if(r!==Wc(e))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return e0(t).isEqual(e0(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=ca(i.timestampValue),o=ca(s.timestampValue);return a.seconds===o.seconds&&a.nanos===o.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return jc(i.bytesValue).isEqual(jc(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return pr(i.geoPointValue.latitude)===pr(s.geoPointValue.latitude)&&pr(i.geoPointValue.longitude)===pr(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return pr(i.integerValue)===pr(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=pr(i.doubleValue),o=pr(s.doubleValue);return a===o?ch(a)===ch(o):isNaN(a)&&isNaN(o)}return!1}(t,e);case 9:return Uc(t.arrayValue.values||[],e.arrayValue.values||[],ji);case 10:return function(i,s){let a=i.mapValue.fields||{},o=s.mapValue.fields||{};if(eS(a)!==eS(o))return!1;for(let c in a)if(a.hasOwnProperty(c)&&(o[c]===void 0||!ji(a[c],o[c])))return!1;return!0}(t,e);default:return rt()}}function lh(t,e){return(t.values||[]).find(r=>ji(r,e))!==void 0}function $c(t,e){if(t===e)return 0;let r=Wc(t),n=Wc(e);if(r!==n)return Pt(r,n);switch(r){case 0:case 9007199254740991:return 0;case 1:return Pt(t.booleanValue,e.booleanValue);case 2:return function(s,a){let o=pr(s.integerValue||s.doubleValue),c=pr(a.integerValue||a.doubleValue);return o<c?-1:o>c?1:o===c?0:isNaN(o)?isNaN(c)?0:-1:1}(t,e);case 3:return tS(t.timestampValue,e.timestampValue);case 4:return tS(e0(t),e0(e));case 5:return Pt(t.stringValue,e.stringValue);case 6:return function(s,a){let o=jc(s),c=jc(a);return o.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(s,a){let o=s.split("/"),c=a.split("/");for(let l=0;l<o.length&&l<c.length;l++){let h=Pt(o[l],c[l]);if(h!==0)return h}return Pt(o.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,a){let o=Pt(pr(s.latitude),pr(a.latitude));return o!==0?o:Pt(pr(s.longitude),pr(a.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,a){let o=s.values||[],c=a.values||[];for(let l=0;l<o.length&&l<c.length;++l){let h=$c(o[l],c[l]);if(h)return h}return Pt(o.length,c.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,a){if(s===Hd.mapValue&&a===Hd.mapValue)return 0;if(s===Hd.mapValue)return 1;if(a===Hd.mapValue)return-1;let o=s.fields||{},c=Object.keys(o),l=a.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){let d=Pt(c[f],h[f]);if(d!==0)return d;let m=$c(o[c[f]],l[h[f]]);if(m!==0)return m}return Pt(c.length,h.length)}(t.mapValue,e.mapValue);default:throw rt()}}function tS(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Pt(t,e);let r=ca(t),n=ca(e),i=Pt(r.seconds,n.seconds);return i!==0?i:Pt(r.nanos,n.nanos)}function Hc(t){return m_(t)}function m_(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){let n=ca(r);return`time(${n.seconds},${n.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(r){return jc(r).toBase64()}(t.bytesValue):"referenceValue"in t?function(r){return et.fromName(r).toString()}(t.referenceValue):"geoPointValue"in t?function(r){return`geo(${r.latitude},${r.longitude})`}(t.geoPointValue):"arrayValue"in t?function(r){let n="[",i=!0;for(let s of r.values||[])i?i=!1:n+=",",n+=m_(s);return n+"]"}(t.arrayValue):"mapValue"in t?function(r){let n=Object.keys(r.fields||{}).sort(),i="{",s=!0;for(let a of n)s?s=!1:i+=",",i+=`${a}:${m_(r.fields[a])}`;return i+"}"}(t.mapValue):rt()}function g_(t){return!!t&&"integerValue"in t}function b1(t){return!!t&&"arrayValue"in t}function qd(t){return!!t&&"mapValue"in t}function ih(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return fh(t.mapValue.fields,(r,n)=>e.mapValue.fields[r]=ih(n)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let r=0;r<(t.arrayValue.values||[]).length;++r)e.arrayValue.values[r]=ih(t.arrayValue.values[r]);return e}return Object.assign({},t)}function TS(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Vi=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let r=this.value;for(let n=0;n<e.length-1;++n)if(r=(r.mapValue.fields||{})[e.get(n)],!qd(r))return null;return r=(r.mapValue.fields||{})[e.lastSegment()],r||null}}set(e,r){this.getFieldsMap(e.popLast())[e.lastSegment()]=ih(r)}setAll(e){let r=Dn.emptyPath(),n={},i=[];e.forEach((a,o)=>{if(!r.isImmediateParentOf(o)){let c=this.getFieldsMap(r);this.applyChanges(c,n,i),n={},i=[],r=o.popLast()}a?n[o.lastSegment()]=ih(a):i.push(o.lastSegment())});let s=this.getFieldsMap(r);this.applyChanges(s,n,i)}delete(e){let r=this.field(e.popLast());qd(r)&&r.mapValue.fields&&delete r.mapValue.fields[e.lastSegment()]}isEqual(e){return ji(this.value,e.value)}getFieldsMap(e){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=r.mapValue.fields[e.get(n)];qd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},r.mapValue.fields[e.get(n)]=i),r=i}return r.mapValue.fields}applyChanges(e,r,n){fh(r,(i,s)=>e[i]=s);for(let i of n)delete e[i]}clone(){return new t(ih(this.value))}};function bS(t){let e=[];return fh(t.fields,(r,n)=>{let i=new Dn([r]);if(qd(n)){let s=bS(n.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Bi(e)}var zc=class t{constructor(e,r,n,i,s,a,o){this.key=e,this.documentType=r,this.version=n,this.readTime=i,this.createTime=s,this.data=a,this.documentState=o}static newInvalidDocument(e){return new t(e,0,ir.min(),ir.min(),ir.min(),Vi.empty(),0)}static newFoundDocument(e,r,n,i){return new t(e,1,r,ir.min(),n,i,0)}static newNoDocument(e,r){return new t(e,2,r,ir.min(),ir.min(),Vi.empty(),0)}static newUnknownDocument(e,r){return new t(e,3,r,ir.min(),ir.min(),Vi.empty(),2)}convertToFoundDocument(e,r){return!this.createTime.isEqual(ir.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Vi.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Vi.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ir.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Gc=class{constructor(e,r){this.position=e,this.inclusive=r}};function rS(t,e,r){let n=0;for(let i=0;i<t.position.length;i++){let s=e[i],a=t.position[i];if(s.field.isKeyField()?n=et.comparator(et.fromName(a.referenceValue),r.key):n=$c(a,r.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function nS(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let r=0;r<t.position.length;r++)if(!ji(t.position[r],e.position[r]))return!1;return!0}var qc=class{constructor(e,r="asc"){this.field=e,this.dir=r}};function Hj(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var t0=class{},Ar=class t extends t0{constructor(e,r,n){super(),this.field=e,this.op=r,this.value=n}static create(e,r,n){return e.isKeyField()?r==="in"||r==="not-in"?this.createKeyFieldInFilter(e,r,n):new __(e,r,n):r==="array-contains"?new w_(e,n):r==="in"?new E_(e,n):r==="not-in"?new T_(e,n):r==="array-contains-any"?new b_(e,n):new t(e,r,n)}static createKeyFieldInFilter(e,r,n){return r==="in"?new y_(e,n):new x_(e,n)}matches(e){let r=e.data.field(this.field);return this.op==="!="?r!==null&&this.matchesComparison($c(r,this.value)):r!==null&&Wc(this.value)===Wc(r)&&this.matchesComparison($c(r,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return rt()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},la=class t extends t0{constructor(e,r){super(),this.filters=e,this.op=r,this.ae=null}static create(e,r){return new t(e,r)}matches(e){return IS(this)?this.filters.find(r=>!r.matches(e))===void 0:this.filters.find(r=>r.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,r)=>e.concat(r.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function IS(t){return t.op==="and"}function AS(t){return zj(t)&&IS(t)}function zj(t){for(let e of t.filters)if(e instanceof la)return!1;return!0}function v_(t){if(t instanceof Ar)return t.field.canonicalString()+t.op.toString()+Hc(t.value);if(AS(t))return t.filters.map(e=>v_(e)).join(",");{let e=t.filters.map(r=>v_(r)).join(",");return`${t.op}(${e})`}}function SS(t,e){return t instanceof Ar?function(n,i){return i instanceof Ar&&n.op===i.op&&n.field.isEqual(i.field)&&ji(n.value,i.value)}(t,e):t instanceof la?function(n,i){return i instanceof la&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,a,o)=>s&&SS(a,i.filters[o]),!0):!1}(t,e):void rt()}function CS(t){return t instanceof Ar?function(r){return`${r.field.canonicalString()} ${r.op} ${Hc(r.value)}`}(t):t instanceof la?function(r){return r.op.toString()+" {"+r.getFilters().map(CS).join(" ,")+"}"}(t):"Filter"}var __=class extends Ar{constructor(e,r,n){super(e,r,n),this.key=et.fromName(n.referenceValue)}matches(e){let r=et.comparator(e.key,this.key);return this.matchesComparison(r)}},y_=class extends Ar{constructor(e,r){super(e,"in",r),this.keys=kS("in",r)}matches(e){return this.keys.some(r=>r.isEqual(e.key))}},x_=class extends Ar{constructor(e,r){super(e,"not-in",r),this.keys=kS("not-in",r)}matches(e){return!this.keys.some(r=>r.isEqual(e.key))}};function kS(t,e){var r;return(((r=e.arrayValue)===null||r===void 0?void 0:r.values)||[]).map(n=>et.fromName(n.referenceValue))}var w_=class extends Ar{constructor(e,r){super(e,"array-contains",r)}matches(e){let r=e.data.field(this.field);return b1(r)&&lh(r.arrayValue,this.value)}},E_=class extends Ar{constructor(e,r){super(e,"in",r)}matches(e){let r=e.data.field(this.field);return r!==null&&lh(this.value.arrayValue,r)}},T_=class extends Ar{constructor(e,r){super(e,"not-in",r)}matches(e){if(lh(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let r=e.data.field(this.field);return r!==null&&!lh(this.value.arrayValue,r)}},b_=class extends Ar{constructor(e,r){super(e,"array-contains-any",r)}matches(e){let r=e.data.field(this.field);return!(!b1(r)||!r.arrayValue.values)&&r.arrayValue.values.some(n=>lh(this.value.arrayValue,n))}};var I_=class{constructor(e,r=null,n=[],i=[],s=null,a=null,o=null){this.path=e,this.collectionGroup=r,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=a,this.endAt=o,this.ue=null}};function iS(t,e=null,r=[],n=[],i=null,s=null,a=null){return new I_(t,e,r,n,i,s,a)}function I1(t){let e=Ot(t);if(e.ue===null){let r=e.path.canonicalString();e.collectionGroup!==null&&(r+="|cg:"+e.collectionGroup),r+="|f:",r+=e.filters.map(n=>v_(n)).join(","),r+="|ob:",r+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),E1(e.limit)||(r+="|l:",r+=e.limit),e.startAt&&(r+="|lb:",r+=e.startAt.inclusive?"b:":"a:",r+=e.startAt.position.map(n=>Hc(n)).join(",")),e.endAt&&(r+="|ub:",r+=e.endAt.inclusive?"a:":"b:",r+=e.endAt.position.map(n=>Hc(n)).join(",")),e.ue=r}return e.ue}function A1(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let r=0;r<t.orderBy.length;r++)if(!Hj(t.orderBy[r],e.orderBy[r]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let r=0;r<t.filters.length;r++)if(!SS(t.filters[r],e.filters[r]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!nS(t.startAt,e.startAt)&&nS(t.endAt,e.endAt)}var Kc=class{constructor(e,r=null,n=[],i=[],s=null,a="F",o=null,c=null){this.path=e,this.collectionGroup=r,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=a,this.startAt=o,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Gj(t,e,r,n,i,s,a,o){return new Kc(t,e,r,n,i,s,a,o)}function qj(t){return new Kc(t)}function sS(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Kj(t){return t.collectionGroup!==null}function sh(t){let e=Ot(t);if(e.ce===null){e.ce=[];let r=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),r.add(s.field.canonicalString());let n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let o=new on(Dn.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(o=o.add(l.field))})}),o})(e).forEach(s=>{r.has(s.canonicalString())||s.isKeyField()||e.ce.push(new qc(s,n))}),r.has(Dn.keyField().canonicalString())||e.ce.push(new qc(Dn.keyField(),n))}return e.ce}function yo(t){let e=Ot(t);return e.le||(e.le=Xj(e,sh(t))),e.le}function Xj(t,e){if(t.limitType==="F")return iS(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new qc(i.field,s)});let r=t.endAt?new Gc(t.endAt.position,t.endAt.inclusive):null,n=t.startAt?new Gc(t.startAt.position,t.startAt.inclusive):null;return iS(t.path,t.collectionGroup,e,t.filters,t.limit,r,n)}}function A_(t,e,r){return new Kc(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,r,t.startAt,t.endAt)}function DS(t,e){return A1(yo(t),yo(e))&&t.limitType===e.limitType}function RS(t){return`${I1(yo(t))}|lt:${t.limitType}`}function nh(t){return`Query(target=${function(r){let n=r.path.canonicalString();return r.collectionGroup!==null&&(n+=" collectionGroup="+r.collectionGroup),r.filters.length>0&&(n+=`, filters: [${r.filters.map(i=>CS(i)).join(", ")}]`),E1(r.limit)||(n+=", limit: "+r.limit),r.orderBy.length>0&&(n+=`, orderBy: [${r.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),r.startAt&&(n+=", startAt: ",n+=r.startAt.inclusive?"b:":"a:",n+=r.startAt.position.map(i=>Hc(i)).join(",")),r.endAt&&(n+=", endAt: ",n+=r.endAt.inclusive?"a:":"b:",n+=r.endAt.position.map(i=>Hc(i)).join(",")),`Target(${n})`}(yo(t))}; limitType=${t.limitType})`}function S1(t,e){return e.isFoundDocument()&&function(n,i){let s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):et.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(t,e)&&function(n,i){for(let s of sh(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(n,i){for(let s of n.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(n,i){return!(n.startAt&&!function(a,o,c){let l=rS(a,o,c);return a.inclusive?l<=0:l<0}(n.startAt,sh(n),i)||n.endAt&&!function(a,o,c){let l=rS(a,o,c);return a.inclusive?l>=0:l>0}(n.endAt,sh(n),i))}(t,e)}function Yj(t){return(e,r)=>{let n=!1;for(let i of sh(t)){let s=Qj(i,e,r);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function Qj(t,e,r){let n=t.field.isKeyField()?et.comparator(e.key,r.key):function(s,a,o){let c=a.data.field(s),l=o.data.field(s);return c!==null&&l!==null?$c(c,l):rt()}(t.field,e,r);switch(t.dir){case"asc":return n;case"desc":return-1*n;default:return rt()}}var ua=class{constructor(e,r){this.mapKeyFn=e,this.equalsFn=r,this.inner={},this.innerSize=0}get(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n!==void 0){for(let[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,r){let n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,r]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,r]);i.push([e,r]),this.innerSize++}delete(e){let r=this.mapKeyFn(e),n=this.inner[r];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[r]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){fh(this.inner,(r,n)=>{for(let[i,s]of n)e(i,s)})}isEmpty(){return wS(this.inner)}size(){return this.innerSize}};var Jj=new Rn(et.comparator);function r0(){return Jj}var FS=new Rn(et.comparator);function zd(...t){let e=FS;for(let r of t)e=e.insert(r.key,r);return e}function PS(t){let e=FS;return t.forEach((r,n)=>e=e.insert(r,n.overlayedDocument)),e}function _o(){return ah()}function OS(){return ah()}function ah(){return new ua(t=>t.toString(),(t,e)=>t.isEqual(e))}var Zj=new Rn(et.comparator),eW=new on(et.comparator);function Zr(...t){let e=eW;for(let r of t)e=e.add(r);return e}var tW=new on(Pt);function rW(){return tW}function NS(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ch(e)?"-0":e}}function MS(t){return{integerValue:""+t}}function nW(t,e){return Vj(e)?MS(e):NS(t,e)}var Xc=class{constructor(){this._=void 0}};function iW(t,e,r){return t instanceof Yc?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&T1(s)&&(s=ES(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(r,e):t instanceof bo?VS(t,e):t instanceof Io?BS(t,e):function(i,s){let a=LS(i,s),o=aS(a)+aS(i.Pe);return g_(a)&&g_(i.Pe)?MS(o):NS(i.serializer,o)}(t,e)}function sW(t,e,r){return t instanceof bo?VS(t,e):t instanceof Io?BS(t,e):r}function LS(t,e){return t instanceof Qc?function(n){return g_(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}var Yc=class extends Xc{},bo=class extends Xc{constructor(e){super(),this.elements=e}};function VS(t,e){let r=US(e);for(let n of t.elements)r.some(i=>ji(i,n))||r.push(n);return{arrayValue:{values:r}}}var Io=class extends Xc{constructor(e){super(),this.elements=e}};function BS(t,e){let r=US(e);for(let n of t.elements)r=r.filter(i=>!ji(i,n));return{arrayValue:{values:r}}}var Qc=class extends Xc{constructor(e,r){super(),this.serializer=e,this.Pe=r}};function aS(t){return pr(t.integerValue||t.doubleValue)}function US(t){return b1(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function aW(t,e){return t.field.isEqual(e.field)&&function(n,i){return n instanceof bo&&i instanceof bo||n instanceof Io&&i instanceof Io?Uc(n.elements,i.elements,ji):n instanceof Qc&&i instanceof Qc?ji(n.Pe,i.Pe):n instanceof Yc&&i instanceof Yc}(t.transform,e.transform)}var S_=class{constructor(e,r){this.version=e,this.transformResults=r}},xo=class t{constructor(e,r){this.updateTime=e,this.exists=r}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Kd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Jc=class{};function jS(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new n0(t.key,xo.none()):new Ao(t.key,t.data,xo.none());{let r=t.data,n=Vi.empty(),i=new on(Dn.comparator);for(let s of e.fields)if(!i.has(s)){let a=r.field(s);a===null&&s.length>1&&(s=s.popLast(),a=r.field(s)),a===null?n.delete(s):n.set(s,a),i=i.add(s)}return new gs(t.key,n,new Bi(i.toArray()),xo.none())}}function oW(t,e,r){t instanceof Ao?function(i,s,a){let o=i.value.clone(),c=cS(i.fieldTransforms,s,a.transformResults);o.setAll(c),s.convertToFoundDocument(a.version,o).setHasCommittedMutations()}(t,e,r):t instanceof gs?function(i,s,a){if(!Kd(i.precondition,s))return void s.convertToUnknownDocument(a.version);let o=cS(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(WS(i)),c.setAll(o),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(t,e,r):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,r)}function oh(t,e,r,n){return t instanceof Ao?function(s,a,o,c){if(!Kd(s.precondition,a))return o;let l=s.value.clone(),h=lS(s.fieldTransforms,c,a);return l.setAll(h),a.convertToFoundDocument(a.version,l).setHasLocalMutations(),null}(t,e,r,n):t instanceof gs?function(s,a,o,c){if(!Kd(s.precondition,a))return o;let l=lS(s.fieldTransforms,c,a),h=a.data;return h.setAll(WS(s)),h.setAll(l),a.convertToFoundDocument(a.version,h).setHasLocalMutations(),o===null?null:o.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(f=>f.field))}(t,e,r,n):function(s,a,o){return Kd(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):o}(t,e,r)}function cW(t,e){let r=null;for(let n of t.fieldTransforms){let i=e.data.field(n.field),s=LS(n.transform,i||null);s!=null&&(r===null&&(r=Vi.empty()),r.set(n.field,s))}return r||null}function oS(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Uc(n,i,(s,a)=>aW(s,a))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Ao=class extends Jc{constructor(e,r,n,i=[]){super(),this.key=e,this.value=r,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},gs=class extends Jc{constructor(e,r,n,i,s=[]){super(),this.key=e,this.data=r,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function WS(t){let e=new Map;return t.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let n=t.data.field(r);e.set(r,n)}}),e}function cS(t,e,r){let n=new Map;mr(t.length===r.length);for(let i=0;i<r.length;i++){let s=t[i],a=s.transform,o=e.data.field(s.field);n.set(s.field,sW(a,o,r[i]))}return n}function lS(t,e,r){let n=new Map;for(let i of t){let s=i.transform,a=r.data.field(i.field);n.set(i.field,iW(s,a,e))}return n}var n0=class extends Jc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},C_=class extends Jc{constructor(e,r){super(),this.key=e,this.precondition=r,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var k_=class{constructor(e,r,n,i){this.batchId=e,this.localWriteTime=r,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,r){let n=r.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&oW(s,e,n[i])}}applyToLocalView(e,r){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(r=oh(n,e,r,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(r=oh(n,e,r,this.localWriteTime));return r}applyToLocalDocumentSet(e,r){let n=OS();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,o=this.applyToLocalView(a,s.mutatedFields);o=r.has(i.key)?null:o;let c=jS(a,o);c!==null&&n.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(ir.min())}),n}keys(){return this.mutations.reduce((e,r)=>e.add(r.key),Zr())}isEqual(e){return this.batchId===e.batchId&&Uc(this.mutations,e.mutations,(r,n)=>oS(r,n))&&Uc(this.baseMutations,e.baseMutations,(r,n)=>oS(r,n))}},D_=class t{constructor(e,r,n,i){this.batch=e,this.commitVersion=r,this.mutationResults=n,this.docVersions=i}static from(e,r,n){mr(e.mutations.length===n.length);let i=function(){return Zj}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,n[a].version);return new t(e,r,n,i)}};var R_=class{constructor(e,r){this.largestBatchId=e,this.mutation=r}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var cr,st;function lW(t){switch(t){default:return rt();case he.CANCELLED:case he.UNKNOWN:case he.DEADLINE_EXCEEDED:case he.RESOURCE_EXHAUSTED:case he.INTERNAL:case he.UNAVAILABLE:case he.UNAUTHENTICATED:return!1;case he.INVALID_ARGUMENT:case he.NOT_FOUND:case he.ALREADY_EXISTS:case he.PERMISSION_DENIED:case he.FAILED_PRECONDITION:case he.ABORTED:case he.OUT_OF_RANGE:case he.UNIMPLEMENTED:case he.DATA_LOSS:return!0}}function uW(t){if(t===void 0)return Eo("GRPC error has no .code"),he.UNKNOWN;switch(t){case cr.OK:return he.OK;case cr.CANCELLED:return he.CANCELLED;case cr.UNKNOWN:return he.UNKNOWN;case cr.DEADLINE_EXCEEDED:return he.DEADLINE_EXCEEDED;case cr.RESOURCE_EXHAUSTED:return he.RESOURCE_EXHAUSTED;case cr.INTERNAL:return he.INTERNAL;case cr.UNAVAILABLE:return he.UNAVAILABLE;case cr.UNAUTHENTICATED:return he.UNAUTHENTICATED;case cr.INVALID_ARGUMENT:return he.INVALID_ARGUMENT;case cr.NOT_FOUND:return he.NOT_FOUND;case cr.ALREADY_EXISTS:return he.ALREADY_EXISTS;case cr.PERMISSION_DENIED:return he.PERMISSION_DENIED;case cr.FAILED_PRECONDITION:return he.FAILED_PRECONDITION;case cr.ABORTED:return he.ABORTED;case cr.OUT_OF_RANGE:return he.OUT_OF_RANGE;case cr.UNIMPLEMENTED:return he.UNIMPLEMENTED;case cr.DATA_LOSS:return he.DATA_LOSS;default:return rt()}}(st=cr||(cr={}))[st.OK=0]="OK",st[st.CANCELLED=1]="CANCELLED",st[st.UNKNOWN=2]="UNKNOWN",st[st.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",st[st.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",st[st.NOT_FOUND=5]="NOT_FOUND",st[st.ALREADY_EXISTS=6]="ALREADY_EXISTS",st[st.PERMISSION_DENIED=7]="PERMISSION_DENIED",st[st.UNAUTHENTICATED=16]="UNAUTHENTICATED",st[st.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",st[st.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",st[st.ABORTED=10]="ABORTED",st[st.OUT_OF_RANGE=11]="OUT_OF_RANGE",st[st.UNIMPLEMENTED=12]="UNIMPLEMENTED",st[st.INTERNAL=13]="INTERNAL",st[st.UNAVAILABLE=14]="UNAVAILABLE",st[st.DATA_LOSS=15]="DATA_LOSS";var OX=new qv([4294967295,4294967295],0);var F_=class{constructor(e,r){this.databaseId=e,this.useProto3Json=r}};function P_(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hW(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fW(t,e){return P_(t,e.toTimestamp())}function Bc(t){return mr(!!t),ir.fromTimestamp(function(r){let n=ca(r);return new en(n.seconds,n.nanos)}(t))}function $S(t,e){return O_(t,e).canonicalString()}function O_(t,e){let r=function(i){return new ur(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?r:r.child(e)}function dW(t){let e=ur.fromString(t);return mr(wW(e)),e}function N_(t,e){return $S(t.databaseId,e.path)}function pW(t){let e=dW(t);return e.length===4?ur.emptyPath():gW(e)}function mW(t){return new ur(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gW(t){return mr(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function uS(t,e,r){return{name:N_(t,e),fields:r.value.mapValue.fields}}function vW(t,e){let r;if(e instanceof Ao)r={update:uS(t,e.key,e.value)};else if(e instanceof n0)r={delete:N_(t,e.key)};else if(e instanceof gs)r={update:uS(t,e.key,e.data),updateMask:xW(e.fieldMask)};else{if(!(e instanceof C_))return rt();r={verify:N_(t,e.key)}}return e.fieldTransforms.length>0&&(r.updateTransforms=e.fieldTransforms.map(n=>function(s,a){let o=a.transform;if(o instanceof Yc)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof bo)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof Io)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof Qc)return{fieldPath:a.field.canonicalString(),increment:o.Pe};throw rt()}(0,n))),e.precondition.isNone||(r.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:fW(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:rt()}(t,e.precondition)),r}function _W(t,e){return t&&t.length>0?(mr(e!==void 0),t.map(r=>function(i,s){let a=i.updateTime?Bc(i.updateTime):Bc(s);return a.isEqual(ir.min())&&(a=Bc(s)),new S_(a,i.transformResults||[])}(r,e))):[]}function yW(t){let e=pW(t.parent),r=t.structuredQuery,n=r.from?r.from.length:0,i=null;if(n>0){mr(n===1);let h=r.from[0];h.allDescendants?i=h.collectionId:e=e.child(h.collectionId)}let s=[];r.where&&(s=function(f){let d=HS(f);return d instanceof la&&AS(d)?d.getFilters():[d]}(r.where));let a=[];r.orderBy&&(a=function(f){return f.map(d=>function(v){return new qc(Lc(v.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(d))}(r.orderBy));let o=null;r.limit&&(o=function(f){let d;return d=typeof f=="object"?f.value:f,E1(d)?null:d}(r.limit));let c=null;r.startAt&&(c=function(f){let d=!!f.before,m=f.values||[];return new Gc(m,d)}(r.startAt));let l=null;return r.endAt&&(l=function(f){let d=!f.before,m=f.values||[];return new Gc(m,d)}(r.endAt)),Gj(e,i,a,s,o,"F",c,l)}function HS(t){return t.unaryFilter!==void 0?function(r){switch(r.unaryFilter.op){case"IS_NAN":let n=Lc(r.unaryFilter.field);return Ar.create(n,"==",{doubleValue:NaN});case"IS_NULL":let i=Lc(r.unaryFilter.field);return Ar.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Lc(r.unaryFilter.field);return Ar.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Lc(r.unaryFilter.field);return Ar.create(a,"!=",{nullValue:"NULL_VALUE"});default:return rt()}}(t):t.fieldFilter!==void 0?function(r){return Ar.create(Lc(r.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rt()}}(r.fieldFilter.op),r.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(r){return la.create(r.compositeFilter.filters.map(n=>HS(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return rt()}}(r.compositeFilter.op))}(t):rt()}function Lc(t){return Dn.fromServerFormat(t.fieldPath)}function xW(t){let e=[];return t.fields.forEach(r=>e.push(r.canonicalString())),{fieldPaths:e}}function wW(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var M_=class{constructor(e){this.ct=e}};function EW(t){let e=yW({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?A_(e,e.limit,"L"):e}var i0=class{constructor(){}It(e,r){this.Tt(e,r),r.Et()}Tt(e,r){if("nullValue"in e)this.dt(r,5);else if("booleanValue"in e)this.dt(r,10),r.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(r,15),r.At(pr(e.integerValue));else if("doubleValue"in e){let n=pr(e.doubleValue);isNaN(n)?this.dt(r,13):(this.dt(r,15),ch(n)?r.At(0):r.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(r,20),typeof n=="string"&&(n=ca(n)),r.Rt(`${n.seconds||""}`),r.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,r),this.ft(r);else if("bytesValue"in e)this.dt(r,30),r.gt(jc(e.bytesValue)),this.ft(r);else if("referenceValue"in e)this.yt(e.referenceValue,r);else if("geoPointValue"in e){let n=e.geoPointValue;this.dt(r,45),r.At(n.latitude||0),r.At(n.longitude||0)}else"mapValue"in e?TS(e)?this.dt(r,Number.MAX_SAFE_INTEGER):(this.wt(e.mapValue,r),this.ft(r)):"arrayValue"in e?(this.St(e.arrayValue,r),this.ft(r)):rt()}Vt(e,r){this.dt(r,25),this.bt(e,r)}bt(e,r){r.Rt(e)}wt(e,r){let n=e.fields||{};this.dt(r,55);for(let i of Object.keys(n))this.Vt(i,r),this.Tt(n[i],r)}St(e,r){let n=e.values||[];this.dt(r,50);for(let i of n)this.Tt(i,r)}yt(e,r){this.dt(r,37),et.fromName(e).path.forEach(n=>{this.dt(r,60),this.bt(n,r)})}dt(e,r){e.At(r)}ft(e){e.At(2)}};i0.Dt=new i0;var L_=class{constructor(){this.an=new V_}addToCollectionParentIndex(e,r){return this.an.add(r),xe.resolve()}getCollectionParents(e,r){return xe.resolve(this.an.getEntries(r))}addFieldIndex(e,r){return xe.resolve()}deleteFieldIndex(e,r){return xe.resolve()}deleteAllFieldIndexes(e){return xe.resolve()}createTargetIndexes(e,r){return xe.resolve()}getDocumentsMatchingTarget(e,r){return xe.resolve(null)}getIndexType(e,r){return xe.resolve(0)}getFieldIndexes(e,r){return xe.resolve([])}getNextCollectionGroupToUpdate(e){return xe.resolve(null)}getMinOffset(e,r){return xe.resolve(To.min())}getMinOffsetFromCollectionGroup(e,r){return xe.resolve(To.min())}updateCollectionGroup(e,r,n){return xe.resolve()}updateIndexEntries(e,r){return xe.resolve()}},V_=class{constructor(){this.index={}}add(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r]||new on(ur.comparator),s=!i.has(n);return this.index[r]=i.add(n),s}has(e){let r=e.lastSegment(),n=e.popLast(),i=this.index[r];return i&&i.has(n)}getEntries(e){return(this.index[e]||new on(ur.comparator)).toArray()}};var NX=new Uint8Array(0);var Li=class t{constructor(e,r,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};Li.DEFAULT_COLLECTION_PERCENTILE=10,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Li.DEFAULT=new Li(41943040,Li.DEFAULT_COLLECTION_PERCENTILE,Li.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Li.DISABLED=new Li(-1,0,0);var uh=class t{constructor(e){this.Nn=e}next(){return this.Nn+=2,this.Nn}static Ln(){return new t(0)}static Bn(){return new t(-1)}};var B_=class{constructor(){this.changes=new ua(e=>e.toString(),(e,r)=>e.isEqual(r)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,r){this.assertNotApplied(),this.changes.set(e,zc.newInvalidDocument(e).setReadTime(r))}getEntry(e,r){this.assertNotApplied();let n=this.changes.get(r);return n!==void 0?xe.resolve(n):this.getFromCache(e,r)}getEntries(e,r){return this.getAllFromCache(e,r)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var U_=class{constructor(e,r){this.overlayedDocument=e,this.mutatedFields=r}};var j_=class{constructor(e,r,n,i){this.remoteDocumentCache=e,this.mutationQueue=r,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,r){let n=null;return this.documentOverlayCache.getOverlay(e,r).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,r))).next(i=>(n!==null&&oh(n.mutation,i,Bi.empty(),en.now()),i))}getDocuments(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.getLocalViewOfDocuments(e,n,Zr()).next(()=>n))}getLocalViewOfDocuments(e,r,n=Zr()){let i=_o();return this.populateOverlays(e,i,r).next(()=>this.computeViews(e,r,i,n).next(s=>{let a=zd();return s.forEach((o,c)=>{a=a.insert(o,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,r){let n=_o();return this.populateOverlays(e,n,r).next(()=>this.computeViews(e,r,n,Zr()))}populateOverlays(e,r,n){let i=[];return n.forEach(s=>{r.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,o)=>{r.set(a,o)})})}computeViews(e,r,n,i){let s=r0(),a=ah(),o=function(){return ah()}();return r.forEach((c,l)=>{let h=n.get(l.key);i.has(l.key)&&(h===void 0||h.mutation instanceof gs)?s=s.insert(l.key,l):h!==void 0?(a.set(l.key,h.mutation.getFieldMask()),oh(h.mutation,l,h.mutation.getFieldMask(),en.now())):a.set(l.key,Bi.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((l,h)=>a.set(l,h)),r.forEach((l,h)=>{var f;return o.set(l,new U_(h,(f=a.get(l))!==null&&f!==void 0?f:null))}),o))}recalculateAndSaveOverlays(e,r){let n=ah(),i=new Rn((a,o)=>a-o),s=Zr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,r).next(a=>{for(let o of a)o.keys().forEach(c=>{let l=r.get(c);if(l===null)return;let h=n.get(c)||Bi.empty();h=o.applyToLocalView(l,h),n.set(c,h);let f=(i.get(o.batchId)||Zr()).add(c);i=i.insert(o.batchId,f)})}).next(()=>{let a=[],o=i.getReverseIterator();for(;o.hasNext();){let c=o.getNext(),l=c.key,h=c.value,f=OS();h.forEach(d=>{if(!s.has(d)){let m=jS(r.get(d),n.get(d));m!==null&&f.set(d,m),s=s.add(d)}}),a.push(this.documentOverlayCache.saveOverlays(e,l,f))}return xe.waitFor(a)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,r){return this.remoteDocumentCache.getEntries(e,r).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,r,n,i){return function(a){return et.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(r)?this.getDocumentsMatchingDocumentQuery(e,r.path):Kj(r)?this.getDocumentsMatchingCollectionGroupQuery(e,r,n,i):this.getDocumentsMatchingCollectionQuery(e,r,n,i)}getNextDocuments(e,r,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,r,n,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,r,n.largestBatchId,i-s.size):xe.resolve(_o()),o=-1,c=s;return a.next(l=>xe.forEach(l,(h,f)=>(o<f.largestBatchId&&(o=f.largestBatchId),s.get(h)?xe.resolve():this.remoteDocumentCache.getEntry(e,h).next(d=>{c=c.insert(h,d)}))).next(()=>this.populateOverlays(e,l,s)).next(()=>this.computeViews(e,c,l,Zr())).next(h=>({batchId:o,changes:PS(h)})))})}getDocumentsMatchingDocumentQuery(e,r){return this.getDocument(e,new et(r)).next(n=>{let i=zd();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,r,n,i){let s=r.collectionGroup,a=zd();return this.indexManager.getCollectionParents(e,s).next(o=>xe.forEach(o,c=>{let l=function(f,d){return new Kc(d,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(r,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,l,n,i).next(h=>{h.forEach((f,d)=>{a=a.insert(f,d)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,r,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,r.path,n.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,r,n,s,i))).next(a=>{s.forEach((c,l)=>{let h=l.getKey();a.get(h)===null&&(a=a.insert(h,zc.newInvalidDocument(h)))});let o=zd();return a.forEach((c,l)=>{let h=s.get(c);h!==void 0&&oh(h.mutation,l,Bi.empty(),en.now()),S1(r,l)&&(o=o.insert(c,l))}),o})}};var W_=class{constructor(e){this.serializer=e,this.lr=new Map,this.hr=new Map}getBundleMetadata(e,r){return xe.resolve(this.lr.get(r))}saveBundleMetadata(e,r){return this.lr.set(r.id,function(i){return{id:i.id,version:i.version,createTime:Bc(i.createTime)}}(r)),xe.resolve()}getNamedQuery(e,r){return xe.resolve(this.hr.get(r))}saveNamedQuery(e,r){return this.hr.set(r.name,function(i){return{name:i.name,query:EW(i.bundledQuery),readTime:Bc(i.readTime)}}(r)),xe.resolve()}};var $_=class{constructor(){this.overlays=new Rn(et.comparator),this.Pr=new Map}getOverlay(e,r){return xe.resolve(this.overlays.get(r))}getOverlays(e,r){let n=_o();return xe.forEach(r,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,r,n){return n.forEach((i,s)=>{this.ht(e,r,s)}),xe.resolve()}removeOverlaysForBatchId(e,r,n){let i=this.Pr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Pr.delete(n)),xe.resolve()}getOverlaysForCollection(e,r,n){let i=_o(),s=r.length+1,a=new et(r.child("")),o=this.overlays.getIteratorFrom(a);for(;o.hasNext();){let c=o.getNext().value,l=c.getKey();if(!r.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>n&&i.set(c.getKey(),c)}return xe.resolve(i)}getOverlaysForCollectionGroup(e,r,n,i){let s=new Rn((l,h)=>l-h),a=this.overlays.getIterator();for(;a.hasNext();){let l=a.getNext().value;if(l.getKey().getCollectionGroup()===r&&l.largestBatchId>n){let h=s.get(l.largestBatchId);h===null&&(h=_o(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let o=_o(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>o.set(l,h)),!(o.size()>=i)););return xe.resolve(o)}ht(e,r,n){let i=this.overlays.get(n.key);if(i!==null){let a=this.Pr.get(i.largestBatchId).delete(n.key);this.Pr.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new R_(r,n));let s=this.Pr.get(r);s===void 0&&(s=Zr(),this.Pr.set(r,s)),this.Pr.set(r,s.add(n.key))}};var H_=class{constructor(){this.sessionToken=ms.EMPTY_BYTE_STRING}getSessionToken(e){return xe.resolve(this.sessionToken)}setSessionToken(e,r){return this.sessionToken=r,xe.resolve()}};var hh=class{constructor(){this.Ir=new on(lr.Tr),this.Er=new on(lr.dr)}isEmpty(){return this.Ir.isEmpty()}addReference(e,r){let n=new lr(e,r);this.Ir=this.Ir.add(n),this.Er=this.Er.add(n)}Ar(e,r){e.forEach(n=>this.addReference(n,r))}removeReference(e,r){this.Rr(new lr(e,r))}Vr(e,r){e.forEach(n=>this.removeReference(n,r))}mr(e){let r=new et(new ur([])),n=new lr(r,e),i=new lr(r,e+1),s=[];return this.Er.forEachInRange([n,i],a=>{this.Rr(a),s.push(a.key)}),s}gr(){this.Ir.forEach(e=>this.Rr(e))}Rr(e){this.Ir=this.Ir.delete(e),this.Er=this.Er.delete(e)}pr(e){let r=new et(new ur([])),n=new lr(r,e),i=new lr(r,e+1),s=Zr();return this.Er.forEachInRange([n,i],a=>{s=s.add(a.key)}),s}containsKey(e){let r=new lr(e,0),n=this.Ir.firstAfterOrEqual(r);return n!==null&&e.isEqual(n.key)}},lr=class{constructor(e,r){this.key=e,this.yr=r}static Tr(e,r){return et.comparator(e.key,r.key)||Pt(e.yr,r.yr)}static dr(e,r){return Pt(e.yr,r.yr)||et.comparator(e.key,r.key)}};var z_=class{constructor(e,r){this.indexManager=e,this.referenceDelegate=r,this.mutationQueue=[],this.wr=1,this.Sr=new on(lr.Tr)}checkEmpty(e){return xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,r,n,i){let s=this.wr;this.wr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new k_(s,r,n,i);this.mutationQueue.push(a);for(let o of i)this.Sr=this.Sr.add(new lr(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return xe.resolve(a)}lookupMutationBatch(e,r){return xe.resolve(this.br(r))}getNextMutationBatchAfterBatchId(e,r){let n=r+1,i=this.Dr(n),s=i<0?0:i;return xe.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return xe.resolve(this.mutationQueue.length===0?-1:this.wr-1)}getAllMutationBatches(e){return xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,r){let n=new lr(r,0),i=new lr(r,Number.POSITIVE_INFINITY),s=[];return this.Sr.forEachInRange([n,i],a=>{let o=this.br(a.yr);s.push(o)}),xe.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,r){let n=new on(Pt);return r.forEach(i=>{let s=new lr(i,0),a=new lr(i,Number.POSITIVE_INFINITY);this.Sr.forEachInRange([s,a],o=>{n=n.add(o.yr)})}),xe.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,r){let n=r.path,i=n.length+1,s=n;et.isDocumentKey(s)||(s=s.child(""));let a=new lr(new et(s),0),o=new on(Pt);return this.Sr.forEachWhile(c=>{let l=c.key.path;return!!n.isPrefixOf(l)&&(l.length===i&&(o=o.add(c.yr)),!0)},a),xe.resolve(this.Cr(o))}Cr(e){let r=[];return e.forEach(n=>{let i=this.br(n);i!==null&&r.push(i)}),r}removeMutationBatch(e,r){mr(this.vr(r.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Sr;return xe.forEach(r.mutations,i=>{let s=new lr(i.key,r.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Sr=n})}xn(e){}containsKey(e,r){let n=new lr(r,0),i=this.Sr.firstAfterOrEqual(n);return xe.resolve(r.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,xe.resolve()}vr(e,r){return this.Dr(e)}Dr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}br(e){let r=this.Dr(e);return r<0||r>=this.mutationQueue.length?null:this.mutationQueue[r]}};var G_=class{constructor(e){this.Fr=e,this.docs=function(){return new Rn(et.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,r){let n=r.key,i=this.docs.get(n),s=i?i.size:0,a=this.Fr(r);return this.docs=this.docs.insert(n,{document:r.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let r=this.docs.get(e);r&&(this.docs=this.docs.remove(e),this.size-=r.size)}getEntry(e,r){let n=this.docs.get(r);return xe.resolve(n?n.document.mutableCopy():zc.newInvalidDocument(r))}getEntries(e,r){let n=r0();return r.forEach(i=>{let s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():zc.newInvalidDocument(i))}),xe.resolve(n)}getDocumentsMatchingQuery(e,r,n,i){let s=r0(),a=r.path,o=new et(a.child("")),c=this.docs.getIteratorFrom(o);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!a.isPrefixOf(l.path))break;l.path.length>a.length+1||Oj(Pj(h),n)<=0||(i.has(h.key)||S1(r,h))&&(s=s.insert(h.key,h.mutableCopy()))}return xe.resolve(s)}getAllFromCollectionGroup(e,r,n,i){rt()}Mr(e,r){return xe.forEach(this.docs,n=>r(n))}newChangeBuffer(e){return new q_(this)}getSize(e){return xe.resolve(this.size)}},q_=class extends B_{constructor(e){super(),this.ur=e}applyChanges(e){let r=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?r.push(this.ur.addEntry(e,i)):this.ur.removeEntry(n)}),xe.waitFor(r)}getFromCache(e,r){return this.ur.getEntry(e,r)}getAllFromCache(e,r){return this.ur.getEntries(e,r)}};var K_=class{constructor(e){this.persistence=e,this.Or=new ua(r=>I1(r),A1),this.lastRemoteSnapshotVersion=ir.min(),this.highestTargetId=0,this.Nr=0,this.Lr=new hh,this.targetCount=0,this.Br=uh.Ln()}forEachTarget(e,r){return this.Or.forEach((n,i)=>r(i)),xe.resolve()}getLastRemoteSnapshotVersion(e){return xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return xe.resolve(this.Nr)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),xe.resolve(this.highestTargetId)}setTargetsMetadata(e,r,n){return n&&(this.lastRemoteSnapshotVersion=n),r>this.Nr&&(this.Nr=r),xe.resolve()}Qn(e){this.Or.set(e.target,e);let r=e.targetId;r>this.highestTargetId&&(this.Br=new uh(r),this.highestTargetId=r),e.sequenceNumber>this.Nr&&(this.Nr=e.sequenceNumber)}addTargetData(e,r){return this.Qn(r),this.targetCount+=1,xe.resolve()}updateTargetData(e,r){return this.Qn(r),xe.resolve()}removeTargetData(e,r){return this.Or.delete(r.target),this.Lr.mr(r.targetId),this.targetCount-=1,xe.resolve()}removeTargets(e,r,n){let i=0,s=[];return this.Or.forEach((a,o)=>{o.sequenceNumber<=r&&n.get(o.targetId)===null&&(this.Or.delete(a),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),i++)}),xe.waitFor(s).next(()=>i)}getTargetCount(e){return xe.resolve(this.targetCount)}getTargetData(e,r){let n=this.Or.get(r)||null;return xe.resolve(n)}addMatchingKeys(e,r,n){return this.Lr.Ar(r,n),xe.resolve()}removeMatchingKeys(e,r,n){this.Lr.Vr(r,n);let i=this.persistence.referenceDelegate,s=[];return i&&r.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),xe.waitFor(s)}removeMatchingKeysForTargetId(e,r){return this.Lr.mr(r),xe.resolve()}getMatchingKeysForTargetId(e,r){let n=this.Lr.pr(r);return xe.resolve(n)}containsKey(e,r){return xe.resolve(this.Lr.containsKey(r))}};var X_=class{constructor(e,r){this.kr={},this.overlays={},this.qr=new Lj(0),this.Qr=!1,this.Qr=!0,this.Kr=new H_,this.referenceDelegate=e(this),this.$r=new K_(this),this.indexManager=new L_,this.remoteDocumentCache=function(i){return new G_(i)}(n=>this.referenceDelegate.Ur(n)),this.serializer=new M_(r),this.Wr=new W_(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Qr=!1,Promise.resolve()}get started(){return this.Qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let r=this.overlays[e.toKey()];return r||(r=new $_,this.overlays[e.toKey()]=r),r}getMutationQueue(e,r){let n=this.kr[e.toKey()];return n||(n=new z_(r,this.referenceDelegate),this.kr[e.toKey()]=n),n}getGlobalsCache(){return this.Kr}getTargetCache(){return this.$r}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Wr}runTransaction(e,r,n){Fe("MemoryPersistence","Starting transaction:",e);let i=new Y_(this.qr.next());return this.referenceDelegate.Gr(),n(i).next(s=>this.referenceDelegate.zr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}jr(e,r){return xe.or(Object.values(this.kr).map(n=>()=>n.containsKey(e,r)))}},Y_=class extends h_{constructor(e){super(),this.currentSequenceNumber=e}},Q_=class t{constructor(e){this.persistence=e,this.Hr=new hh,this.Jr=null}static Yr(e){return new t(e)}get Zr(){if(this.Jr)return this.Jr;throw rt()}addReference(e,r,n){return this.Hr.addReference(n,r),this.Zr.delete(n.toString()),xe.resolve()}removeReference(e,r,n){return this.Hr.removeReference(n,r),this.Zr.add(n.toString()),xe.resolve()}markPotentiallyOrphaned(e,r){return this.Zr.add(r.toString()),xe.resolve()}removeTarget(e,r){this.Hr.mr(r.targetId).forEach(i=>this.Zr.add(i.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,r.targetId).next(i=>{i.forEach(s=>this.Zr.add(s.toString()))}).next(()=>n.removeTargetData(e,r))}Gr(){this.Jr=new Set}zr(e){let r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return xe.forEach(this.Zr,n=>{let i=et.fromPath(n);return this.Xr(e,i).next(s=>{s||r.removeEntry(i,ir.min())})}).next(()=>(this.Jr=null,r.apply(e)))}updateLimboDocument(e,r){return this.Xr(e,r).next(n=>{n?this.Zr.delete(r.toString()):this.Zr.add(r.toString())})}Ur(e){return 0}Xr(e,r){return xe.or([()=>xe.resolve(this.Hr.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(e,r),()=>this.persistence.jr(e,r)])}};var J_=class t{constructor(e,r,n,i){this.targetId=e,this.fromCache=r,this.Ki=n,this.$i=i}static Ui(e,r){let n=Zr(),i=Zr();for(let s of r.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,r.fromCache,n,i)}};var Z_=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var e1=class{constructor(){this.Wi=!1,this.Gi=!1,this.zi=100,this.ji=function(){return dA()?8:Mj(kn())>0?6:4}()}initialize(e,r){this.Hi=e,this.indexManager=r,this.Wi=!0}getDocumentsMatchingQuery(e,r,n,i){let s={result:null};return this.Ji(e,r).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Yi(e,r,i,n).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Z_;return this.Zi(e,r,a).next(o=>{if(s.result=o,this.Gi)return this.Xi(e,r,a,o.size)})}).next(()=>s.result)}Xi(e,r,n,i){return n.documentReadCount<this.zi?(rh()<=tt.DEBUG&&Fe("QueryEngine","SDK will not create cache indexes for query:",nh(r),"since it only creates cache indexes for collection contains","more than or equal to",this.zi,"documents"),xe.resolve()):(rh()<=tt.DEBUG&&Fe("QueryEngine","Query:",nh(r),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ji*i?(rh()<=tt.DEBUG&&Fe("QueryEngine","The SDK decides to create cache indexes for query:",nh(r),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,yo(r))):xe.resolve())}Ji(e,r){if(sS(r))return xe.resolve(null);let n=yo(r);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(r.limit!==null&&i===1&&(r=A_(r,null,"F"),n=yo(r)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{let a=Zr(...s);return this.Hi.getDocuments(e,a).next(o=>this.indexManager.getMinOffset(e,n).next(c=>{let l=this.es(r,o);return this.ts(r,l,a,c.readTime)?this.Ji(e,A_(r,null,"F")):this.ns(e,l,r,c)}))})))}Yi(e,r,n,i){return sS(r)||i.isEqual(ir.min())?xe.resolve(null):this.Hi.getDocuments(e,n).next(s=>{let a=this.es(r,s);return this.ts(r,a,n,i)?xe.resolve(null):(rh()<=tt.DEBUG&&Fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),nh(r)),this.ns(e,a,r,Fj(i,-1)).next(o=>o))})}es(e,r){let n=new on(Yj(e));return r.forEach((i,s)=>{S1(e,s)&&(n=n.add(s))}),n}ts(e,r,n,i){if(e.limit===null)return!1;if(n.size!==r.size)return!0;let s=e.limitType==="F"?r.last():r.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Zi(e,r,n){return rh()<=tt.DEBUG&&Fe("QueryEngine","Using full collection scan to execute query:",nh(r)),this.Hi.getDocumentsMatchingQuery(e,r,To.min(),n)}ns(e,r,n,i){return this.Hi.getDocumentsMatchingQuery(e,n,i).next(s=>(r.forEach(a=>{s=s.insert(a.key,a)}),s))}};var t1=class{constructor(e,r,n,i){this.persistence=e,this.rs=r,this.serializer=i,this.ss=new Rn(Pt),this.os=new ua(s=>I1(s),A1),this._s=new Map,this.us=e.getRemoteDocumentCache(),this.$r=e.getTargetCache(),this.Wr=e.getBundleCache(),this.cs(n)}cs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new j_(this.us,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.us.setIndexManager(this.indexManager),this.rs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>e.collect(r,this.ss))}};function TW(t,e,r,n){return new t1(t,e,r,n)}function zS(t,e){return te(this,null,function*(){let r=Ot(t);return yield r.persistence.runTransaction("Handle user change","readonly",n=>{let i;return r.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,r.cs(e),r.mutationQueue.getAllMutationBatches(n))).next(s=>{let a=[],o=[],c=Zr();for(let l of i){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of s){o.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return r.localDocuments.getDocuments(n,c).next(l=>({ls:l,removedBatchIds:a,addedBatchIds:o}))})})})}function bW(t,e){let r=Ot(t);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{let i=e.batch.keys(),s=r.us.newChangeBuffer({trackRemovals:!0});return function(o,c,l,h){let f=l.batch,d=f.keys(),m=xe.resolve();return d.forEach(v=>{m=m.next(()=>h.getEntry(c,v)).next(p=>{let _=l.docVersions.get(v);mr(_!==null),p.version.compareTo(_)<0&&(f.applyToRemoteDocument(p,l),p.isValidDocument()&&(p.setReadTime(l.commitVersion),h.addEntry(p)))})}),m.next(()=>o.mutationQueue.removeMutationBatch(c,f))}(r,n,e,s).next(()=>s.apply(n)).next(()=>r.mutationQueue.performConsistencyCheck(n)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(o){let c=Zr();for(let l=0;l<o.mutationResults.length;++l)o.mutationResults[l].transformResults.length>0&&(c=c.add(o.batch.mutations[l].key));return c}(e))).next(()=>r.localDocuments.getDocuments(n,i))})}function IW(t){let e=Ot(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",r=>e.$r.getLastRemoteSnapshotVersion(r))}function AW(t,e){let r=Ot(t);return r.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=-1),r.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}var s0=class{constructor(){this.activeTargetIds=rW()}Vs(e){this.activeTargetIds=this.activeTargetIds.add(e)}fs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Rs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var r1=class{constructor(){this.io=new s0,this.so={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,r,n){}addLocalQueryTarget(e){return this.io.Vs(e),this.so[e]||"not-current"}updateQueryState(e,r,n){this.so[e]=r}removeLocalQueryTarget(e){this.io.fs(e)}isLocalQueryTarget(e){return this.io.activeTargetIds.has(e)}clearQueryState(e){delete this.so[e]}getAllActiveQueryTargets(){return this.io.activeTargetIds}isActiveQueryTarget(e){return this.io.activeTargetIds.has(e)}start(){return this.io=new s0,Promise.resolve()}handleUserChange(e,r,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var n1=class{oo(e){}shutdown(){}};var a0=class{constructor(){this._o=()=>this.ao(),this.uo=()=>this.co(),this.lo=[],this.ho()}oo(e){this.lo.push(e)}shutdown(){window.removeEventListener("online",this._o),window.removeEventListener("offline",this.uo)}ho(){window.addEventListener("online",this._o),window.addEventListener("offline",this.uo)}ao(){Fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.lo)e(0)}co(){Fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.lo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Gd=null;function e_(){return Gd===null?Gd=function(){return 268435456+Math.round(2147483648*Math.random())}():Gd++,"0x"+Gd.toString(16)}var SW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var i1=class{constructor(e){this.Po=e.Po,this.Io=e.Io}To(e){this.Eo=e}Ao(e){this.Ro=e}Vo(e){this.mo=e}onMessage(e){this.fo=e}close(){this.Io()}send(e){this.Po(e)}po(){this.Eo()}yo(){this.Ro()}wo(e){this.mo(e)}So(e){this.fo(e)}};var Jr="WebChannelConnection",s1=class extends class{constructor(r){this.databaseInfo=r,this.databaseId=r.databaseId;let n=r.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.bo=n+"://"+r.host,this.Do=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get vo(){return!1}Fo(r,n,i,s,a){let o=e_(),c=this.Mo(r,n.toUriEncodedString());Fe("RestConnection",`Sending RPC '${r}' ${o}:`,c,i);let l={"google-cloud-resource-prefix":this.Do,"x-goog-request-params":this.Co};return this.xo(l,s,a),this.Oo(r,c,l,i).then(h=>(Fe("RestConnection",`Received RPC '${r}' ${o}: `,h),h),h=>{throw Xd("RestConnection",`RPC '${r}' ${o} failed with error: `,h,"url: ",c,"request:",i),h})}No(r,n,i,s,a,o){return this.Fo(r,n,i,s,a)}xo(r,n,i){r["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+el}(),r["Content-Type"]="text/plain",this.databaseInfo.appId&&(r["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,a)=>r[a]=s),i&&i.headers.forEach((s,a)=>r[a]=s)}Mo(r,n){let i=SW[r];return`${this.bo}/v1/${n}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Oo(e,r,n,i){let s=e_();return new Promise((a,o)=>{let c=new Kv;c.setWithCredentials(!0),c.listenOnce(Yv.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case th.NO_ERROR:let h=c.getResponseJson();Fe(Jr,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(h)),a(h);break;case th.TIMEOUT:Fe(Jr,`RPC '${e}' ${s} timed out`),o(new Ve(he.DEADLINE_EXCEEDED,"Request time out"));break;case th.HTTP_ERROR:let f=c.getStatus();if(Fe(Jr,`RPC '${e}' ${s} failed with status:`,f,"response text:",c.getResponseText()),f>0){let d=c.getResponseJson();Array.isArray(d)&&(d=d[0]);let m=d?.error;if(m&&m.status&&m.message){let v=function(_){let T=_.toLowerCase().replace(/_/g,"-");return Object.values(he).indexOf(T)>=0?T:he.UNKNOWN}(m.status);o(new Ve(v,m.message))}else o(new Ve(he.UNKNOWN,"Server responded with status "+c.getStatus()))}else o(new Ve(he.UNAVAILABLE,"Connection failed."));break;default:rt()}}finally{Fe(Jr,`RPC '${e}' ${s} completed.`)}});let l=JSON.stringify(i);Fe(Jr,`RPC '${e}' ${s} sending request:`,i),c.send(r,"POST",l,n,15)})}Lo(e,r,n){let i=e_(),s=[this.bo,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Zv(),o=Jv(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new Xv({})),this.xo(c.initMessageHeaders,r,n),c.encodeInitMessageHeaders=!0;let h=s.join("");Fe(Jr,`Creating RPC '${e}' stream ${i}: ${h}`,c);let f=a.createWebChannel(h,c),d=!1,m=!1,v=new i1({Po:_=>{m?Fe(Jr,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(d||(Fe(Jr,`Opening RPC '${e}' stream ${i} transport.`),f.open(),d=!0),Fe(Jr,`RPC '${e}' stream ${i} sending:`,_),f.send(_))},Io:()=>f.close()}),p=(_,T,S)=>{_.listen(T,b=>{try{S(b)}catch(O){setTimeout(()=>{throw O},0)}})};return p(f,Mc.EventType.OPEN,()=>{m||(Fe(Jr,`RPC '${e}' stream ${i} transport opened.`),v.po())}),p(f,Mc.EventType.CLOSE,()=>{m||(m=!0,Fe(Jr,`RPC '${e}' stream ${i} transport closed`),v.wo())}),p(f,Mc.EventType.ERROR,_=>{m||(m=!0,Xd(Jr,`RPC '${e}' stream ${i} transport errored:`,_),v.wo(new Ve(he.UNAVAILABLE,"The operation could not be completed")))}),p(f,Mc.EventType.MESSAGE,_=>{var T;if(!m){let S=_.data[0];mr(!!S);let b=S,O=b.error||((T=b[0])===null||T===void 0?void 0:T.error);if(O){Fe(Jr,`RPC '${e}' stream ${i} received error:`,O);let V=O.status,B=function(E){let C=cr[E];if(C!==void 0)return uW(C)}(V),x=O.message;B===void 0&&(B=he.INTERNAL,x="Unknown error status: "+V+" with message "+O.message),m=!0,v.wo(new Ve(B,x)),f.close()}else Fe(Jr,`RPC '${e}' stream ${i} received:`,S),v.So(S)}}),p(o,Qv.STAT_EVENT,_=>{_.stat===$d.PROXY?Fe(Jr,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===$d.NOPROXY&&Fe(Jr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.yo()},0),v}};function t_(){return typeof document<"u"?document:null}function v0(t){return new F_(t,!0)}var o0=class{constructor(e,r,n=1e3,i=1.5,s=6e4){this.ai=e,this.timerId=r,this.Bo=n,this.ko=i,this.qo=s,this.Qo=0,this.Ko=null,this.$o=Date.now(),this.reset()}reset(){this.Qo=0}Uo(){this.Qo=this.qo}Wo(e){this.cancel();let r=Math.floor(this.Qo+this.Go()),n=Math.max(0,Date.now()-this.$o),i=Math.max(0,r-n);i>0&&Fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Qo} ms, delay with jitter: ${r} ms, last attempt: ${n} ms ago)`),this.Ko=this.ai.enqueueAfterDelay(this.timerId,i,()=>(this.$o=Date.now(),e())),this.Qo*=this.ko,this.Qo<this.Bo&&(this.Qo=this.Bo),this.Qo>this.qo&&(this.Qo=this.qo)}zo(){this.Ko!==null&&(this.Ko.skipDelay(),this.Ko=null)}cancel(){this.Ko!==null&&(this.Ko.cancel(),this.Ko=null)}Go(){return(Math.random()-.5)*this.Qo}};var a1=class{constructor(e,r,n,i,s,a,o,c){this.ai=e,this.jo=n,this.Ho=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=o,this.listener=c,this.state=0,this.Jo=0,this.Yo=null,this.Zo=null,this.stream=null,this.Xo=0,this.e_=new o0(e,r)}t_(){return this.state===1||this.state===5||this.n_()}n_(){return this.state===2||this.state===3}start(){this.Xo=0,this.state!==4?this.auth():this.r_()}stop(){return te(this,null,function*(){this.t_()&&(yield this.close(0))})}i_(){this.state=0,this.e_.reset()}s_(){this.n_()&&this.Yo===null&&(this.Yo=this.ai.enqueueAfterDelay(this.jo,6e4,()=>this.o_()))}__(e){this.a_(),this.stream.send(e)}o_(){return te(this,null,function*(){if(this.n_())return this.close(0)})}a_(){this.Yo&&(this.Yo.cancel(),this.Yo=null)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}close(e,r){return te(this,null,function*(){this.a_(),this.u_(),this.e_.cancel(),this.Jo++,e!==4?this.e_.reset():r&&r.code===he.RESOURCE_EXHAUSTED?(Eo(r.toString()),Eo("Using maximum backoff delay to prevent overloading the backend."),this.e_.Uo()):r&&r.code===he.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.c_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.Vo(r)})}c_(){}auth(){this.state=1;let e=this.l_(this.Jo),r=this.Jo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.Jo===r&&this.h_(n,i)},n=>{e(()=>{let i=new Ve(he.UNKNOWN,"Fetching auth token failed: "+n.message);return this.P_(i)})})}h_(e,r){let n=this.l_(this.Jo);this.stream=this.I_(e,r),this.stream.To(()=>{n(()=>this.listener.To())}),this.stream.Ao(()=>{n(()=>(this.state=2,this.Zo=this.ai.enqueueAfterDelay(this.Ho,1e4,()=>(this.n_()&&(this.state=3),Promise.resolve())),this.listener.Ao()))}),this.stream.Vo(i=>{n(()=>this.P_(i))}),this.stream.onMessage(i=>{n(()=>++this.Xo==1?this.T_(i):this.onNext(i))})}r_(){this.state=5,this.e_.Wo(()=>te(this,null,function*(){this.state=0,this.start()}))}P_(e){return Fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}l_(e){return r=>{this.ai.enqueueAndForget(()=>this.Jo===e?r():(Fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}};var o1=class extends a1{constructor(e,r,n,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,n,i,a),this.serializer=s}get R_(){return this.Xo>0}start(){this.lastStreamToken=void 0,super.start()}c_(){this.R_&&this.V_([])}I_(e,r){return this.connection.Lo("Write",e,r)}T_(e){return mr(!!e.streamToken),this.lastStreamToken=e.streamToken,mr(!e.writeResults||e.writeResults.length===0),this.listener.m_()}onNext(e){mr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.e_.reset();let r=_W(e.writeResults,e.commitTime),n=Bc(e.commitTime);return this.listener.f_(n,r)}g_(){let e={};e.database=mW(this.serializer),this.__(e)}V_(e){let r={streamToken:this.lastStreamToken,writes:e.map(n=>vW(this.serializer,n))};this.__(r)}};var c1=class extends class{}{constructor(e,r,n,i){super(),this.authCredentials=e,this.appCheckCredentials=r,this.connection=n,this.serializer=i,this.p_=!1}y_(){if(this.p_)throw new Ve(he.FAILED_PRECONDITION,"The client has already been terminated.")}Fo(e,r,n,i){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Fo(e,O_(r,n),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ve(he.UNKNOWN,s.toString())})}No(e,r,n,i,s){return this.y_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,o])=>this.connection.No(e,O_(r,n),i,a,o,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===he.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ve(he.UNKNOWN,a.toString())})}terminate(){this.p_=!0,this.connection.terminate()}},l1=class{constructor(e,r){this.asyncQueue=e,this.onlineStateHandler=r,this.state="Unknown",this.w_=0,this.S_=null,this.b_=!0}D_(){this.w_===0&&(this.C_("Unknown"),this.S_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.S_=null,this.v_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}F_(e){this.state==="Online"?this.C_("Unknown"):(this.w_++,this.w_>=1&&(this.M_(),this.v_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.M_(),this.w_=0,e==="Online"&&(this.b_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}v_(e){let r=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.b_?(Eo(r),this.b_=!1):Fe("OnlineStateTracker",r)}M_(){this.S_!==null&&(this.S_.cancel(),this.S_=null)}};var u1=class{constructor(e,r,n,i,s){this.localStore=e,this.datastore=r,this.asyncQueue=n,this.remoteSyncer={},this.x_=[],this.O_=new Map,this.N_=new Set,this.L_=[],this.B_=s,this.B_.oo(a=>{n.enqueueAndForget(()=>te(this,null,function*(){ph(this)&&(Fe("RemoteStore","Restarting streams for network reachability change."),yield function(c){return te(this,null,function*(){let l=Ot(c);l.N_.add(4),yield dh(l),l.k_.set("Unknown"),l.N_.delete(4),yield _0(l)})}(this))}))}),this.k_=new l1(n,i)}};function _0(t){return te(this,null,function*(){if(ph(t))for(let e of t.L_)yield e(!0)})}function dh(t){return te(this,null,function*(){for(let e of t.L_)yield e(!1)})}function ph(t){return Ot(t).N_.size===0}function GS(t,e,r){return te(this,null,function*(){if(!g0(e))throw e;t.N_.add(1),yield dh(t),t.k_.set("Offline"),r||(r=()=>IW(t.localStore)),t.asyncQueue.enqueueRetryable(()=>te(this,null,function*(){Fe("RemoteStore","Retrying IndexedDB access"),yield r(),t.N_.delete(1),yield _0(t)}))})}function qS(t,e){return e().catch(r=>GS(t,r,e))}function y0(t){return te(this,null,function*(){let e=Ot(t),r=ha(e),n=e.x_.length>0?e.x_[e.x_.length-1].batchId:-1;for(;CW(e);)try{let i=yield AW(e.localStore,n);if(i===null){e.x_.length===0&&r.s_();break}n=i.batchId,kW(e,i)}catch(i){yield GS(e,i)}KS(e)&&XS(e)})}function CW(t){return ph(t)&&t.x_.length<10}function kW(t,e){t.x_.push(e);let r=ha(t);r.n_()&&r.R_&&r.V_(e.mutations)}function KS(t){return ph(t)&&!ha(t).t_()&&t.x_.length>0}function XS(t){ha(t).start()}function DW(t){return te(this,null,function*(){ha(t).g_()})}function RW(t){return te(this,null,function*(){let e=ha(t);for(let r of t.x_)e.V_(r.mutations)})}function FW(t,e,r){return te(this,null,function*(){let n=t.x_.shift(),i=D_.from(n,e,r);yield qS(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield y0(t)})}function PW(t,e){return te(this,null,function*(){e&&ha(t).R_&&(yield function(n,i){return te(this,null,function*(){if(function(a){return lW(a)&&a!==he.ABORTED}(i.code)){let s=n.x_.shift();ha(n).i_(),yield qS(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield y0(n)}})}(t,e)),KS(t)&&XS(t)})}function hS(t,e){return te(this,null,function*(){let r=Ot(t);r.asyncQueue.verifyOperationInProgress(),Fe("RemoteStore","RemoteStore received new credentials");let n=ph(r);r.N_.add(3),yield dh(r),n&&r.k_.set("Unknown"),yield r.remoteSyncer.handleCredentialChange(e),r.N_.delete(3),yield _0(r)})}function OW(t,e){return te(this,null,function*(){let r=Ot(t);e?(r.N_.delete(2),yield _0(r)):e||(r.N_.add(2),yield dh(r),r.k_.set("Unknown"))})}function ha(t){return t.K_||(t.K_=function(r,n,i){let s=Ot(r);return s.y_(),new o1(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{To:()=>Promise.resolve(),Ao:DW.bind(null,t),Vo:PW.bind(null,t),m_:RW.bind(null,t),f_:FW.bind(null,t)}),t.L_.push(e=>te(this,null,function*(){e?(t.K_.i_(),yield y0(t)):(yield t.K_.stop(),t.x_.length>0&&(Fe("RemoteStore",`Stopping write stream with ${t.x_.length} pending writes`),t.x_=[]))}))),t.K_}var h1=class t{constructor(e,r,n,i,s){this.asyncQueue=e,this.timerId=r,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ds,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,r,n,i,s){let a=Date.now()+n,o=new t(e,r,a,i,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(he.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function YS(t,e){if(Eo("AsyncQueue",`${e}: ${t}`),g0(t))return new Ve(he.UNAVAILABLE,`${e}: ${t}`);throw t}var f1=class{constructor(){this.queries=fS(),this.onlineState="Unknown",this.J_=new Set}terminate(){(function(r,n){let i=Ot(r),s=i.queries;i.queries=fS(),s.forEach((a,o)=>{for(let c of o.z_)c.onError(n)})})(this,new Ve(he.ABORTED,"Firestore shutting down"))}};function fS(){return new ua(t=>RS(t),DS)}function NW(t){t.J_.forEach(e=>{e.next()})}var dS,pS;(pS=dS||(dS={})).X_="default",pS.Cache="cache";var d1=class{constructor(e,r,n,i,s,a){this.localStore=e,this.remoteStore=r,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.va=new ua(o=>RS(o),DS),this.Fa=new Map,this.Ma=new Set,this.xa=new Rn(et.comparator),this.Oa=new Map,this.Na=new hh,this.La={},this.Ba=new Map,this.ka=uh.Bn(),this.onlineState="Unknown",this.qa=void 0}get isPrimaryClient(){return this.qa===!0}};function MW(t,e,r){return te(this,null,function*(){let n=UW(t);try{let i=yield function(a,o){let c=Ot(a),l=en.now(),h=o.reduce((m,v)=>m.add(v.key),Zr()),f,d;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=r0(),p=Zr();return c.us.getEntries(m,h).next(_=>{v=_,v.forEach((T,S)=>{S.isValidDocument()||(p=p.add(T))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,v)).next(_=>{f=_;let T=[];for(let S of o){let b=cW(S,f.get(S.key).overlayedDocument);b!=null&&T.push(new gs(S.key,b,bS(b.value.mapValue),xo.exists(!0)))}return c.mutationQueue.addMutationBatch(m,l,T,o)}).next(_=>{d=_;let T=_.applyToLocalDocumentSet(f,p);return c.documentOverlayCache.saveOverlays(m,_.batchId,T)})}).then(()=>({batchId:d.batchId,changes:PS(f)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(a,o,c){let l=a.La[a.currentUser.toKey()];l||(l=new Rn(Pt)),l=l.insert(o,c),a.La[a.currentUser.toKey()]=l}(n,i.batchId,r),yield x0(n,i.changes),yield y0(n.remoteStore)}catch(i){let s=YS(i,"Failed to persist write");r.reject(s)}})}function mS(t,e,r){let n=Ot(t);if(n.isPrimaryClient&&r===0||!n.isPrimaryClient&&r===1){let i=[];n.va.forEach((s,a)=>{let o=a.view.Y_(e);o.snapshot&&i.push(o.snapshot)}),function(a,o){let c=Ot(a);c.onlineState=o;let l=!1;c.queries.forEach((h,f)=>{for(let d of f.z_)d.Y_(o)&&(l=!0)}),l&&NW(c)}(n.eventManager,e),i.length&&n.Ca.E_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}function LW(t,e){return te(this,null,function*(){let r=Ot(t),n=e.batch.batchId;try{let i=yield bW(r.localStore,e);JS(r,n,null),QS(r,n),r.sharedClientState.updateMutationState(n,"acknowledged"),yield x0(r,i)}catch(i){yield xS(i)}})}function VW(t,e,r){return te(this,null,function*(){let n=Ot(t);try{let i=yield function(a,o){let c=Ot(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,o).next(f=>(mr(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(l,f))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,o)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(n.localStore,e);JS(n,e,r),QS(n,e),n.sharedClientState.updateMutationState(e,"rejected",r),yield x0(n,i)}catch(i){yield xS(i)}})}function QS(t,e){(t.Ba.get(e)||[]).forEach(r=>{r.resolve()}),t.Ba.delete(e)}function JS(t,e,r){let n=Ot(t),i=n.La[n.currentUser.toKey()];if(i){let s=i.get(e);s&&(r?s.reject(r):s.resolve(),i=i.remove(e)),n.La[n.currentUser.toKey()]=i}}function x0(t,e,r){return te(this,null,function*(){let n=Ot(t),i=[],s=[],a=[];n.va.isEmpty()||(n.va.forEach((o,c)=>{a.push(n.Qa(c,e,r).then(l=>{var h;if((l||r)&&n.isPrimaryClient){let f=l?!l.fromCache:(h=r?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;n.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(l){i.push(l);let f=J_.Ui(c.targetId,l);s.push(f)}}))}),yield Promise.all(a),n.Ca.E_(i),yield function(c,l){return te(this,null,function*(){let h=Ot(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>xe.forEach(l,d=>xe.forEach(d.Ki,m=>h.persistence.referenceDelegate.addReference(f,d.targetId,m)).next(()=>xe.forEach(d.$i,m=>h.persistence.referenceDelegate.removeReference(f,d.targetId,m)))))}catch(f){if(!g0(f))throw f;Fe("LocalStore","Failed to update sequence numbers: "+f)}for(let f of l){let d=f.targetId;if(!f.fromCache){let m=h.ss.get(d),v=m.snapshotVersion,p=m.withLastLimboFreeSnapshotVersion(v);h.ss=h.ss.insert(d,p)}}})}(n.localStore,s))})}function BW(t,e){return te(this,null,function*(){let r=Ot(t);if(!r.currentUser.isEqual(e)){Fe("SyncEngine","User change. New user:",e.toKey());let n=yield zS(r.localStore,e);r.currentUser=e,function(s,a){s.Ba.forEach(o=>{o.forEach(c=>{c.reject(new Ve(he.CANCELLED,a))})}),s.Ba.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),yield x0(r,n.ls)}})}function UW(t){let e=Ot(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=VW.bind(null,e),e}var c0=class{constructor(){this.synchronizeTabs=!1}initialize(e){return te(this,null,function*(){this.serializer=v0(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,r){return null}createIndexBackfillerScheduler(e,r){return null}createLocalStore(e){return TW(this.persistence,new e1,e.initialUser,this.serializer)}createPersistence(e){return new X_(Q_.Yr,this.serializer)}createSharedClientState(e){return new r1}terminate(){return te(this,null,function*(){var e,r;(e=this.gcScheduler)===null||e===void 0||e.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var p1=class{initialize(e,r){return te(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>mS(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=BW.bind(null,this.syncEngine),yield OW(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new f1}()}createDatastore(e){let r=v0(e.databaseInfo.databaseId),n=function(s){return new s1(s)}(e.databaseInfo);return function(s,a,o,c){return new c1(s,a,o,c)}(e.authCredentials,e.appCheckCredentials,n,r)}createRemoteStore(e){return function(n,i,s,a,o){return new u1(n,i,s,a,o)}(this.localStore,this.datastore,e.asyncQueue,r=>mS(this.syncEngine,r,0),function(){return a0.D()?new a0:new n1}())}createSyncEngine(e,r){return function(i,s,a,o,c,l,h){let f=new d1(i,s,a,o,c,l);return h&&(f.qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,r)}terminate(){return te(this,null,function*(){var e,r;yield function(i){return te(this,null,function*(){let s=Ot(i);Fe("RemoteStore","RemoteStore shutting down."),s.N_.add(5),yield dh(s),s.B_.shutdown(),s.k_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}};var m1=class{constructor(e,r,n,i){this.authCredentials=e,this.appCheckCredentials=r,this.asyncQueue=n,this.databaseInfo=i,this.user=Ir.UNAUTHENTICATED,this.clientId=Qd.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,s=>te(this,null,function*(){Fe("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(n,s=>(Fe("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ve(he.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ds;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>te(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let n=YS(r,"Failed to shutdown persistence");e.reject(n)}})),e.promise}};function r_(t,e){return te(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),Fe("FirestoreClient","Initializing OfflineComponentProvider");let r=t.configuration;yield e.initialize(r);let n=r.initialUser;t.setCredentialChangeListener(i=>te(this,null,function*(){n.isEqual(i)||(yield zS(e.localStore,i),n=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function gS(t,e){return te(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let r=yield WW(t);Fe("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(r,t.configuration),t.setCredentialChangeListener(n=>hS(e.remoteStore,n)),t.setAppCheckTokenChangeListener((n,i)=>hS(e.remoteStore,i)),t._onlineComponents=e})}function jW(t){return t.name==="FirebaseError"?t.code===he.FAILED_PRECONDITION||t.code===he.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function WW(t){return te(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Fe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield r_(t,t._uninitializedComponentsProvider._offline)}catch(e){let r=e;if(!jW(r))throw r;Xd("Error using user provided cache. Falling back to memory cache: "+r),yield r_(t,new c0)}}else Fe("FirestoreClient","Using default OfflineComponentProvider"),yield r_(t,new c0);return t._offlineComponents})}function $W(t){return te(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(Fe("FirestoreClient","Using user provided OnlineComponentProvider"),yield gS(t,t._uninitializedComponentsProvider._online)):(Fe("FirestoreClient","Using default OnlineComponentProvider"),yield gS(t,new p1))),t._onlineComponents})}function HW(t){return $W(t).then(e=>e.syncEngine)}function ZS(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var vS=new Map;function e2(t,e,r){if(!r)throw new Ve(he.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function zW(t,e,r,n){if(e===!0&&n===!0)throw new Ve(he.INVALID_ARGUMENT,`${t} and ${r} cannot be used together.`)}function _S(t){if(!et.isDocumentKey(t))throw new Ve(he.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function yS(t){if(et.isDocumentKey(t))throw new Ve(he.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function C1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(n){return n.constructor?n.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":rt()}function t2(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new Ve(he.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let r=C1(t);throw new Ve(he.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${r}`)}}return t}var l0=class{constructor(e){var r,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(he.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(r=e.ssl)===null||r===void 0||r;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new Ve(he.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}zW("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ZS((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ve(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ve(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ve(he.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Zc=class{constructor(e,r,n,i){this._authCredentials=e,this._appCheckCredentials=r,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new l0({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ve(he.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new Ve(he.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new l0(e),e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new n_;switch(n.type){case"firstParty":return new o_(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ve(he.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(r){let n=vS.get(r);n&&(Fe("ComponentProvider","Removing Datastore"),vS.delete(r),n.terminate())}(this),Promise.resolve()}};function r2(t,e,r,n={}){var i;let s=(t=t2(t,Zc))._getSettings(),a=`${e}:${r}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Xd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),n.mockUserToken){let o,c;if(typeof n.mockUserToken=="string")o=n.mockUserToken,c=Ir.MOCK_USER;else{o=lA(n.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let l=n.mockUserToken.sub||n.mockUserToken.user_id;if(!l)throw new Ve(he.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ir(l)}t._authCredentials=new i_(new Yd(o,c))}}var g1=class t{constructor(e,r,n){this.converter=r,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},ps=class t{constructor(e,r,n){this.converter=r,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new oa(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},oa=class t extends g1{constructor(e,r,n){super(e,r,qj(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new ps(this.firestore,null,new et(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function k1(t,e,...r){if(t=di(t),e2("collection","path",e),t instanceof Zc){let n=ur.fromString(e,...r);return yS(n),new oa(t,null,n)}{if(!(t instanceof ps||t instanceof oa))throw new Ve(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(ur.fromString(e,...r));return yS(n),new oa(t.firestore,null,n)}}function n2(t,e,...r){if(t=di(t),arguments.length===1&&(e=Qd.newId()),e2("doc","path",e),t instanceof Zc){let n=ur.fromString(e,...r);return _S(n),new ps(t,null,new et(n))}{if(!(t instanceof ps||t instanceof oa))throw new Ve(he.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let n=t._path.child(ur.fromString(e,...r));return _S(n),new ps(t.firestore,t instanceof oa?t.converter:null,new et(n))}}var v1=class{constructor(){this._u=Promise.resolve(),this.au=[],this.uu=!1,this.cu=[],this.lu=null,this.hu=!1,this.Pu=!1,this.Iu=[],this.e_=new o0(this,"async_queue_retry"),this.Tu=()=>{let r=t_();r&&Fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.e_.zo()};let e=t_();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this.Tu)}get isShuttingDown(){return this.uu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Eu(),this.du(e)}enterRestrictedMode(e){if(!this.uu){this.uu=!0,this.Pu=e||!1;let r=t_();r&&typeof r.removeEventListener=="function"&&r.removeEventListener("visibilitychange",this.Tu)}}enqueue(e){if(this.Eu(),this.uu)return new Promise(()=>{});let r=new ds;return this.du(()=>this.uu&&this.Pu?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.au.push(e),this.Au()))}Au(){return te(this,null,function*(){if(this.au.length!==0){try{yield this.au[0](),this.au.shift(),this.e_.reset()}catch(e){if(!g0(e))throw e;Fe("AsyncQueue","Operation failed with retryable error: "+e)}this.au.length>0&&this.e_.Wo(()=>this.Au())}})}du(e){let r=this._u.then(()=>(this.hu=!0,e().catch(n=>{this.lu=n,this.hu=!1;let i=function(a){let o=a.message||"";return a.stack&&(o=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),o}(n);throw Eo("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.hu=!1,n))));return this._u=r,r}enqueueAfterDelay(e,r,n){this.Eu(),this.Iu.indexOf(e)>-1&&(r=0);let i=h1.createAndSchedule(this,e,r,n,s=>this.Ru(s));return this.cu.push(i),i}Eu(){this.lu&&rt()}verifyOperationInProgress(){}Vu(){return te(this,null,function*(){let e;do e=this._u,yield e;while(e!==this._u)})}mu(e){for(let r of this.cu)if(r.timerId===e)return!0;return!1}fu(e){return this.Vu().then(()=>{this.cu.sort((r,n)=>r.targetTimeMs-n.targetTimeMs);for(let r of this.cu)if(r.skipDelay(),e!=="all"&&r.timerId===e)break;return this.Vu()})}gu(e){this.Iu.push(e)}Ru(e){let r=this.cu.indexOf(e);this.cu.splice(r,1)}};var u0=class extends Zc{constructor(e,r,n,i){super(e,r,n,i),this.type="firestore",this._queue=function(){return new v1}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||s2(this),this._firestoreClient.terminate()}};function i2(t,e){let r=typeof t=="object"?t:Hu(),n=typeof t=="string"?t:e||"(default)",i=Cv(r,"firestore").getImmediate({identifier:n});if(!i._initialized){let s=oA("firestore");s&&r2(i,...s)}return i}function GW(t){return t._firestoreClient||s2(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function s2(t){var e,r,n;let i=t._freezeSettings(),s=function(o,c,l,h){return new d_(o,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,ZS(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new m1(t._authCredentials,t._appCheckCredentials,t._queue,s),!((r=i.localCache)===null||r===void 0)&&r._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}var h0=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(ms.fromBase64String(e))}catch(r){throw new Ve(he.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(e){return new t(ms.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var f0=class{constructor(...e){for(let r=0;r<e.length;++r)if(e[r].length===0)throw new Ve(he.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var d0=class{constructor(e){this._methodName=e}};var p0=class{constructor(e,r){if(!isFinite(e)||e<-90||e>90)throw new Ve(he.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(r)||r<-180||r>180)throw new Ve(he.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=e,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Pt(this._lat,e._lat)||Pt(this._long,e._long)}};var qW=/^__.*__$/,_1=class{constructor(e,r,n){this.data=e,this.fieldMask=r,this.fieldTransforms=n}toMutation(e,r){return this.fieldMask!==null?new gs(e,this.data,this.fieldMask,r,this.fieldTransforms):new Ao(e,this.data,r,this.fieldTransforms)}};function a2(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rt()}}var y1=class t{constructor(e,r,n,i,s,a){this.settings=e,this.databaseId=r,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.pu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get yu(){return this.settings.yu}wu(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Su(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.Du(e),i}Cu(e){var r;let n=(r=this.path)===null||r===void 0?void 0:r.child(e),i=this.wu({path:n,bu:!1});return i.pu(),i}vu(e){return this.wu({path:void 0,bu:!0})}Fu(e){return m0(e,this.settings.methodName,this.settings.Mu||!1,this.path,this.settings.xu)}contains(e){return this.fieldMask.find(r=>e.isPrefixOf(r))!==void 0||this.fieldTransforms.find(r=>e.isPrefixOf(r.field))!==void 0}pu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Du(this.path.get(e))}Du(e){if(e.length===0)throw this.Fu("Document fields must not be empty");if(a2(this.yu)&&qW.test(e))throw this.Fu('Document fields cannot begin and end with "__"')}},x1=class{constructor(e,r,n){this.databaseId=e,this.ignoreUndefinedProperties=r,this.serializer=n||v0(e)}Ou(e,r,n,i=!1){return new y1({yu:e,methodName:r,xu:n,path:Dn.emptyPath(),bu:!1,Mu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function KW(t){let e=t._freezeSettings(),r=v0(t._databaseId);return new x1(t._databaseId,!!e.ignoreUndefinedProperties,r)}function XW(t,e,r,n,i,s={}){let a=t.Ou(s.merge||s.mergeFields?2:0,e,r,i);u2("Data must be an object, but it was:",a,n);let o=c2(n,a),c,l;if(s.merge)c=new Bi(a.fieldMask),l=a.fieldTransforms;else if(s.mergeFields){let h=[];for(let f of s.mergeFields){let d=YW(e,f,r);if(!a.contains(d))throw new Ve(he.INVALID_ARGUMENT,`Field '${d}' is specified in your field mask but missing from your input data.`);ZW(h,d)||h.push(d)}c=new Bi(h),l=a.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,l=a.fieldTransforms;return new _1(new Vi(o),c,l)}function o2(t,e){if(l2(t=di(t)))return u2("Unsupported field value:",e,t),c2(t,e);if(t instanceof d0)return function(n,i){if(!a2(i.yu))throw i.Fu(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fu(`${n._methodName}() is not currently supported inside arrays`);let s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.bu&&e.yu!==4)throw e.Fu("Nested arrays are not supported");return function(n,i){let s=[],a=0;for(let o of n){let c=o2(o,i.vu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(t,e)}return function(n,i){if((n=di(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return nW(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){let s=en.fromDate(n);return{timestampValue:P_(i.serializer,s)}}if(n instanceof en){let s=new en(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:P_(i.serializer,s)}}if(n instanceof p0)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof h0)return{bytesValue:hW(i.serializer,n._byteString)};if(n instanceof ps){let s=i.databaseId,a=n.firestore._databaseId;if(!a.isEqual(s))throw i.Fu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:$S(n.firestore._databaseId||i.databaseId,n._key.path)}}throw i.Fu(`Unsupported field value: ${C1(n)}`)}(t,e)}function c2(t,e){let r={};return wS(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fh(t,(n,i)=>{let s=o2(i,e.Su(n));s!=null&&(r[n]=s)}),{mapValue:{fields:r}}}function l2(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof en||t instanceof p0||t instanceof h0||t instanceof ps||t instanceof d0)}function u2(t,e,r){if(!l2(r)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(r)){let n=C1(r);throw n==="an object"?e.Fu(t+" a custom object"):e.Fu(t+" "+n)}}function YW(t,e,r){if((e=di(e))instanceof f0)return e._internalPath;if(typeof e=="string")return JW(t,e);throw m0("Field path arguments must be of type string or ",t,!1,void 0,r)}var QW=new RegExp("[~\\*/\\[\\]]");function JW(t,e,r){if(e.search(QW)>=0)throw m0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,r);try{return new f0(...e.split("."))._internalPath}catch{throw m0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,r)}}function m0(t,e,r,n,i){let s=n&&!n.isEmpty(),a=i!==void 0,o=`Function ${e}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${n}`),a&&(c+=` in document ${i}`),c+=")"),new Ve(he.INVALID_ARGUMENT,o+t+c)}function ZW(t,e){return t.some(r=>r.isEqual(e))}function e$(t,e,r){let n;return n=t?r&&(r.merge||r.mergeFields)?t.toFirestore(e,r):t.toFirestore(e):e,n}function D1(t,e){let r=t2(t.firestore,u0),n=n2(t),i=e$(t.converter,e);return t$(r,[XW(KW(t.firestore),"addDoc",n._key,i,t.converter!==null,{}).toMutation(n._key,xo.exists(!1))]).then(()=>n)}function t$(t,e){return function(n,i){let s=new ds;return n.asyncQueue.enqueueAndForget(()=>te(this,null,function*(){return MW(yield HW(n),i,s)})),s.promise}(GW(t),e)}(function(e,r=!0){(function(i){el=i})(Pc),sa(new Zn("firestore",(n,{instanceIdentifier:i,options:s})=>{let a=n.getProvider("app").getImmediate(),o=new u0(new s_(n.getProvider("auth-internal")),new l_(n.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new Ve(he.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new p_(l.options.projectId,h)}(a,i),a);return s=Object.assign({useFetchStreams:r},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),br(ZA,"4.6.5",e),br(ZA,"4.6.5","esm2017")})();var So=class{constructor(e){return e}},h2="firestore",R1=class{constructor(){return Gu(h2)}};var F1=new it("angularfire2.firestore-instances");function r$(t,e){let r=Rv(h2,t,e);return r&&new So(r)}function n$(t){return(e,r)=>{let n=e.runOutsideAngular(()=>t(r));return new So(n)}}var i$={provide:R1,deps:[[new vi,F1]]},s$={provide:So,useFactory:r$,deps:[[new vi,F1],mo]};function f2(t,...e){return br("angularfire",Nc.full,"fst"),ti([s$,i$,{provide:F1,useFactory:n$(t),multi:!0,deps:[Wt,wa,qu,Xu,[new vi,jd],[new vi,zu],...e]}])}var d2=Ku(i2,!0);var w0=(()=>{let e=class e{constructor(){this.firestore=Ce(So),this.toastService=Ce(Qs),this.toast={message:"",type:"",active:!1},this.sugerenciaForm=new Ls({nombre:new bi(""),email:new bi(""),mensaje:new bi(""),fecha:new bi(new Date)})}enviarSugerencia(){let n=this.sugerenciaForm.value,i=k1(this.firestore,"sugerencias");D1(i,n).then(()=>{this.toastService.showToast({type:"success",message:"\xA1La sugerencia se ha enviado con \xE9xito! Gracias por tu aporte.",active:!0}),this.sugerenciaForm.reset()}).catch(()=>{this.toastService.showToast({type:"error",message:"No se pudo enviar la sugerencia, int\xE9ntalo nuevamente.",active:!0})}),this.sugerenciaForm.reset()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-contacto"]],standalone:!0,features:[Rt],decls:26,vars:1,consts:[["id","contacto",1,"bg-white"],[1,"bg-white","py-8","lg:py-16","px-4","mx-auto","max-w-screen-xl"],[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"flex-1","flex","flex-col","justify-center","p-4","sm:items-start","sm:text-left","items-center","text-center"],[1,"mb-4","text-4xl","font-extrabold","text-gray-900"],[1,"mb-8","text-gray-500","sm:text-lg","max-w-lg"],[1,"text-gray-700","max-w-lg"],[1,"flex-1","bg-gray-50","p-6","rounded-lg","shadow-md"],["action","#",1,"space-y-6",3,"formGroup"],["for","email",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","email","type","email","id","email","placeholder","mail@mail.com","required","",1,"shadow-sm","bg-white","border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-indigo-500","focus:border-indigo-500","block","w-full","p-2.5"],["for","subject",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","nombre","type","text","id","subject","placeholder","Coloc\xE1 tu nombre para poder ayudarte","required","",1,"block","p-3","w-full","text-sm","text-gray-900","bg-white","rounded-lg","border","border-gray-300","shadow-sm","focus:ring-indigo-500","focus:border-indigo-500"],["for","message",1,"block","mb-2","text-sm","font-medium","text-gray-900"],["formControlName","mensaje","id","message","rows","6","placeholder","Escrib\xED tu mensaje o sugerencia...",1,"block","p-2.5","w-full","text-sm","text-gray-900","bg-white","rounded-lg","shadow-sm","border","border-gray-300","focus:ring-indigo-500","focus:border-indigo-500"],["type","submit",1,"py-3","px-5","text-sm","font-medium","text-center","text-white","rounded-lg","bg-indigo-600","hover:bg-indigo-500",3,"click"]],template:function(i,s){i&1&&(Z(0,"div",0)(1,"section",1)(2,"div",2)(3,"div",3)(4,"h2",4),ve(5,"Contacto"),J(),Z(6,"p",5),ve(7," \xBFTenes un problema t\xE9cnico? \xBFQueres sugerir nuevas funcionalidades? \xBFNecesitas informaci\xF3n sobre nuestras herramientas? Escribinos. "),J(),Z(8,"p",6),ve(9," Estamos aqu\xED para ayudarte. Envia tus comentarios, errores o sugerencias para poder mejorar juntos el portal. "),J()(),Z(10,"div",7)(11,"form",8)(12,"div")(13,"label",9),ve(14,"Mail"),J(),ze(15,"input",10),J(),Z(16,"div")(17,"label",11),ve(18,"Nombre"),J(),ze(19,"input",12),J(),Z(20,"div")(21,"label",13),ve(22,"Mensaje"),J(),ze(23,"textarea",14),J(),Z(24,"button",15),ct("click",function(){return s.enviarSugerencia()}),ve(25,"Enviar"),J()()()()()()),i&2&&(De(11),Me("formGroup",s.sugerenciaForm))},dependencies:[Jo,Us,Ii,Vs,Bs,Oa,Zo,Fa,Pa],encapsulation:2});let t=e;return t})();function a$(t,e){t&1&&(Z(0,"div",12),ve(1,"\xA1Nuevo!"),J())}function o$(t,e){if(t&1&&(Z(0,"div",6)(1,"div",7),ze(2,"img",8),J(),Z(3,"h3",9),ve(4),J(),Z(5,"p",10),ve(6),J(),gt(7,a$,2,0,"div",11),J()),t&2){let r=_r().$implicit;Me("routerLink",r.routerLink),De(2),Me("src",r.src,Dy),De(2),_l(r.titulo),De(2),_l(r.descripcion),De(),Me("ngIf",r.esNuevo)}}function c$(t,e){if(t&1&&(Ta(0),gt(1,o$,8,5,"div",5),ba()),t&2){let r=e.$implicit;De(),Me("ngIf",r.mostrar)}}var p2=(()=>{let e=class e{constructor(){this.tarjetas=[{mostrar:!0,routerLink:"/evaluaciones",src:"https://img.icons8.com/fluency/48/untested--v1.png",titulo:"Evaluaciones",descripcion:"Defin\xED las preguntas y nosotros las ordenamos de forma \xFAnica para cada estudiante.",esNuevo:!0},{mostrar:!1,routerLink:"/recordatorios",src:"https://img.icons8.com/dusk/64/alarm.png",titulo:"Recordatorios",descripcion:"Env\xEDa notificaciones por correo electr\xF3nico a los usuarios para recordarles ex\xE1menes, tareas u otras actividades importantes.",esNuevo:!0}]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-home"]],standalone:!0,features:[Rt],decls:8,vars:1,consts:[[1,"bg-[#f5f5fa]","py-8","h-full","px-4"],[1,"text-2xl","sm:text-3xl","md:text-4xl","lg:text-5xl","font-bold","text-center","text-gray-800"],[1,"text-center","text-sm","sm:text-base","md:text-lg","lg:text-xl","text-gray-600","mb-12","max-w-[22rem]","md:max-w-[38rem]","lg:max-w-2xl","mx-auto","mt-2"],[1,"flex","flex-wrap","gap-4","justify-center"],[4,"ngFor","ngForOf"],["class","flex flex-col items-center cursor-pointer bg-white shadow-md rounded-lg p-6 text-center relative hover:shadow-lg transition-shadow duration-300 w-full sm:w-1/2 md:w-1/3 lg:w-1/4 xl:w-1/6 max-h-64",3,"routerLink",4,"ngIf"],[1,"flex","flex-col","items-center","cursor-pointer","bg-white","shadow-md","rounded-lg","p-6","text-center","relative","hover:shadow-lg","transition-shadow","duration-300","w-full","sm:w-1/2","md:w-1/3","lg:w-1/4","xl:w-1/6","max-h-64",3,"routerLink"],[1,"mb-4"],["width","48","height","48",3,"src"],[1,"text-lg","font-semibold","text-gray-800"],[1,"text-center","text-sm","text-wrap","tracking-tight","text-gray-600","mt-2"],["class","absolute top-2 right-2 text-white text-xs font-bold py-1 px-2 rounded-full shadow-md bg-cyan-600",4,"ngIf"],[1,"absolute","top-2","right-2","text-white","text-xs","font-bold","py-1","px-2","rounded-full","shadow-md","bg-cyan-600"]],template:function(i,s){i&1&&(Z(0,"section",0)(1,"h2",1),ve(2," Herramientas Automatizadas para Docentes "),J(),Z(3,"p",2),ve(4," Nuestras herramientas online son completamente gratuitas y est\xE1n dise\xF1adas para facilitar las tareas diarias de los docentes. \xA1Simplifica tu trabajo con un par de clics! "),J(),Z(5,"div",3),gt(6,c$,2,1,"ng-container",4),J()(),ze(7,"app-contacto")),i&2&&(De(6),Me("ngForOf",s.tarjetas))},dependencies:[$x,w0,ii,Bo,wi],encapsulation:2});let t=e;return t})();var m2=(()=>{let e=class e{setToken(n){localStorage.setItem("access_token",n)}getToken(){return localStorage.getItem("access_token")??""}setExpireTime(n){let i=new Date,s=new Date(i.getTime()+n*1e3);localStorage.setItem("expire_time",s.toISOString())}getExpireTime(){let n=localStorage.getItem("expire_time")??"0";return new Date(n)}isTokenExpired(){let n=this.getExpireTime();return n?new Date(n.getTime()-10*60*1e3)>=n:!0}clearToken(){localStorage.removeItem("expire_time"),localStorage.removeItem("access_token")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=Oe({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Vr=[];for(E0=0;E0<256;++E0)Vr.push((E0+256).toString(16).slice(1));var E0;function g2(t,e=0){return(Vr[t[e+0]]+Vr[t[e+1]]+Vr[t[e+2]]+Vr[t[e+3]]+"-"+Vr[t[e+4]]+Vr[t[e+5]]+"-"+Vr[t[e+6]]+Vr[t[e+7]]+"-"+Vr[t[e+8]]+Vr[t[e+9]]+"-"+Vr[t[e+10]]+Vr[t[e+11]]+Vr[t[e+12]]+Vr[t[e+13]]+Vr[t[e+14]]+Vr[t[e+15]]).toLowerCase()}var T0,l$=new Uint8Array(16);function P1(){if(!T0&&(T0=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!T0))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return T0(l$)}var u$=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),O1={randomUUID:u$};function h$(t,e,r){if(O1.randomUUID&&!e&&!t)return O1.randomUUID();t=t||{};var n=t.random||(t.rng||P1)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return g2(n)}var N1=h$;function d$(t,e){t&1&&(Z(0,"div",36),ve(1," El t\xEDtulo es obligatorio. "),J())}function p$(t,e){t&1&&(Z(0,"div",36),ve(1," La fecha es obligatoria. "),J())}function m$(t,e){t&1&&(Z(0,"div",36),ve(1," La hora de inicio es obligatoria. "),J())}function g$(t,e){t&1&&(Z(0,"div",36),ve(1," La hora de fin es obligatoria. "),J())}function v$(t,e){t&1&&(Z(0,"div"),ve(1,"El archivo es obligatorio."),J())}function _$(t,e){t&1&&(Z(0,"div"),ve(1,"No se encontraron correos electr\xF3nicos v\xE1lidos en el archivo."),J())}function y$(t,e){t&1&&(Z(0,"div"),ve(1,"La lista de correos electr\xF3nicos no puede estar vac\xEDa. Por favor, agrega al menos un correo electr\xF3nico."),J())}function x$(t,e){if(t&1&&(Z(0,"div",36),gt(1,v$,2,0,"div",37)(2,_$,2,0,"div",37)(3,y$,2,0,"div",37),J()),t&2){let r,n,i,s=_r();De(),Me("ngIf",(r=s.eventForm.get("file"))==null||r.errors==null?null:r.errors.required),De(),Me("ngIf",(n=s.eventForm.get("file"))==null||n.errors==null?null:n.errors.fileNoValidEmails),De(),Me("ngIf",(i=s.eventForm.get("file"))==null||i.errors==null?null:i.errors.mailsEmpty)}}function w$(t,e){if(t&1){let r=Ki();Ta(0),Z(1,"div",42)(2,"span"),ve(3),J(),Z(4,"button",43),ct("click",function(){let i=_i(r).$implicit,s=_r(2);return yi(s.removeEmail(i))}),Dr(),Z(5,"svg",44),ze(6,"path",45),J()()(),ba()}if(t&2){let r=e.$implicit;De(3),_l(r)}}function E$(t,e){if(t&1&&(Z(0,"div",38)(1,"h3",39),ve(2,"Correos Electr\xF3nicos Importados:"),J(),Z(3,"div",40),gt(4,w$,7,1,"ng-container",41),J()()),t&2){let r=_r();De(4),Me("ngForOf",r.emails)}}var v2=(()=>{let e=class e{constructor(){this.toastService=Ce(Qs),this.tokenService=Ce(m2),this.httpClient=Ce(Tl),this.fb=Ce(kf),this.route=Ce(Qi),this.router=Ce(ka),this.toast={message:"",type:"",active:!1},this.emails=[],this.eventForm=this.fb.group({title:["",si.required],description:[""],eventDate:[new Date().toISOString().split("T")[0],si.required],startTime:["00:00",si.required],endTime:["00:00",si.required],repeats:["no"],meet:["no"],file:[null,si.required]})}ngOnInit(){this.route.fragment.subscribe(n=>{if(n){let i=localStorage.getItem("eventFormData");if(i){let c=JSON.parse(i);this.eventForm.patchValue(c)}let s=new URLSearchParams(n),a=s.get("access_token")??"";this.tokenService.setToken(a);let o=s.get("expires_in")??"";this.tokenService.setExpireTime(parseInt(o)),this.router.navigate(["/eventos"]),this.onSubmit()}})}redirectToGoogleAuth(){this.tokenService.isTokenExpired()||this.tokenService.getToken()==""?(localStorage.setItem("eventFormData",JSON.stringify(this.eventForm.value)),window.location.href=ro.endpointGoogleAccessToken):this.onSubmit()}addEvento(){if(this.emails.length===0){this.eventForm.get("file")?.setErrors({mailsEmpty:!0});return}let n=ro.endpointGoogleCalendar,i=this.eventForm.value,s={summary:i.title,description:i.description,start:{dateTime:`${i.eventDate}T${i.startTime}:00-03:00`,timeZone:"America/Argentina/Buenos_Aires"},end:{dateTime:`${i.eventDate}T${i.endTime}:00-03:00`,timeZone:"America/Argentina/Buenos_Aires"},attendees:this.emails.map(o=>({email:o})),reminders:{useDefault:!1,overrides:[{method:"email",minutes:24*60},{method:"popup",minutes:120}]},recurrence:this.getRecurrenceRule(i.repeats),conferenceData:i.meet==="si"?{createRequest:{requestId:N1(),conferenceSolutionKey:{type:"hangoutsMeet"}}}:void 0},a=new Yi({Authorization:`Bearer ${this.tokenService.getToken()}`,"Content-Type":"application/json"});this.httpClient.post(n,s,{headers:a}).pipe(bs(o=>o.status===401?(this.toastService.showToast({type:"error",message:"Vuelva a iniciar sesi\xF3n nuevamente en Google.",active:!0}),this.redirectToGoogleAuth(),Es(()=>new Error("Autenticaci\xF3n requerida."))):(this.toastService.showToast({type:"error",message:"Ha ocurrido un error inesperado, reinicie la p\xE1gina e int\xE9ntelo nuevamente.",active:!0}),this.tokenService.clearToken(),Es(()=>o))),Ty({count:1,delay:0})).subscribe({next:o=>{console.log("Evento creado:",o),this.toastService.showToast({type:"success",message:"Evento creado exitosamente.",active:!0})},error:o=>{console.error("Error al crear el evento despu\xE9s de reintentos:",o)}})}getRecurrenceRule(n){switch(n){case"diariamente":return["RRULE:FREQ=DAILY;COUNT=10"];case"semanalmente":return["RRULE:FREQ=WEEKLY;COUNT=10"];case"mensualmente":return["RRULE:FREQ=MONTHLY;COUNT=10"];default:return[]}}onFileChange(n){let i=n.target;if(i.files&&i.files.length>0){let s=i.files[0];this.eventForm.get("file")?.setValue(s);let a=new FileReader;a.onload=o=>{let c=o.target?.result,l=pc(c,{type:"binary"}),h=l.SheetNames[0],f=l.Sheets[h],d=to.sheet_to_json(f,{defval:""});this.emails=d.map(m=>m.Mail).filter(m=>this.validateEmail(m)),this.emails.length===0&&this.eventForm.get("file")?.setErrors({fileNoValidEmails:!0}),console.log(this.emails)},a.readAsBinaryString(s)}else this.eventForm.get("file")?.setErrors({required:!0})}validateEmail(n){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)}removeEmail(n){this.emails=this.emails.filter(i=>i!==n)}onSubmit(){this.eventForm.valid?(localStorage.removeItem("eventFormData"),this.addEvento()):this.eventForm.markAllAsTouched()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-eventos"]],standalone:!0,features:[Rt],decls:63,vars:7,consts:[[1,"container","mx-auto","px-4","py-12"],[1,"max-w-2xl","mx-auto","p-6","bg-white","shadow-md","rounded-md"],[1,"text-2xl","font-bold","mb-6","text-center"],[1,"space-y-4",3,"formGroup"],["for","title",1,"block","text-sm","font-medium","text-gray-700","required"],["type","text","id","title","formControlName","title",1,"mt-1","block","w-full","p-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring","focus:ring-indigo-200"],["class","text-red-500 text-sm mt-1",4,"ngIf"],["for","description",1,"block","text-sm","font-medium","text-gray-700"],["id","description","formControlName","description","rows","3",1,"mt-1","block","w-full","p-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring","focus:ring-indigo-200"],[1,"relative","mb-6"],["for","event-date",1,"block","text-sm","font-medium","text-gray-700","required"],[1,"relative"],[1,"absolute","inset-y-0","start-0","flex","items-center","ps-3","pointer-events-none"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","currentColor","viewBox","0 0 20 20",1,"w-4","h-4","text-gray-500"],["d","M20 4a2 2 0 0 0-2-2h-2V1a1 1 0 0 0-2 0v1h-3V1a1 1 0 0 0-2 0v1H6V1a1 1 0 0 0-2 0v1H2a2 2 0 0 0-2 2v2h20V4ZM0 18a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V8H0v10Zm5-8h10a1 1 0 0 1 0 2H5a1 1 0 0 1 0-2Z"],["type","date","id","event-date","formControlName","eventDate","placeholder","Seleccionar fecha",1,"border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","ps-10","p-2.5"],[1,"flex","gap-4"],[1,"flex-1"],["for","start-time",1,"block","text-sm","font-medium","text-gray-700","required"],["type","time","id","start-time","formControlName","startTime","value","12:00","placeholder","HH:MM",1,"border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5"],["for","end-time",1,"block","text-sm","font-medium","text-gray-700","required"],["type","time","id","end-time","formControlName","endTime","value","12:00:00","placeholder","HH:MM",1,"border","border-gray-300","text-gray-900","text-sm","rounded-lg","focus:ring-blue-500","focus:border-blue-500","block","w-full","p-2.5"],["for","repeats",1,"block","text-sm","font-medium","text-gray-700"],["formControlName","repeats","id","repeats",1,"mt-1","block","w-full","p-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring","focus:ring-indigo-200"],["value","no"],["value","diariamente"],["value","semanalmente"],["value","mensualmente"],["for","meet",1,"block","text-sm","font-medium","text-gray-700"],["formControlName","meet","id","meet",1,"mt-1","block","w-full","p-2","border","border-gray-300","rounded-md","focus:outline-none","focus:ring","focus:ring-indigo-200"],["value","si"],["for","file",1,"block","text-sm","font-medium","text-gray-700","required"],["type","file","id","file",1,"mt-1","block","w-full","text-sm","text-gray-500","file:cursor-pointer","file:mr-4","file:py-2","file:px-4","file:rounded-md","file:border-0","file:text-sm","file:font-semibold","file:bg-indigo-50","file:text-indigo-700","hover:file:bg-indigo-100",3,"change"],["class","mt-4",4,"ngIf"],[1,"text-center"],["type","submit",1,"mt-4","w-full","bg-indigo-600","text-white","py-2","px-4","rounded-md","hover:bg-indigo-700","focus:outline-none","focus:ring-2","focus:ring-indigo-200",3,"click"],[1,"text-red-500","text-sm","mt-1"],[4,"ngIf"],[1,"mt-4"],[1,"text-lg","font-medium","text-gray-700","mb-2"],[1,"flex","flex-wrap","gap-2","max-h-40","overflow-y-auto","p-2","rounded-md"],[4,"ngFor","ngForOf"],[1,"bg-indigo-100","text-indigo-700","px-3","py-1","rounded-full","flex","items-center","gap-1"],["type","button",1,"text-indigo-500","hover:text-indigo-800","focus:outline-none",3,"click"],["fill","currentColor","viewBox","0 0 20 20","xmlns","http://www.w3.org/2000/svg",1,"w-4","h-4"],["fill-rule","evenodd","d","M10 9l-4-4m0 0l-4 4m4-4v10M6 7h8m2 0a2 2 0 01-2 2h-8a2 2 0 010-4h8a2 2 0 012 2z","clip-rule","evenodd"]],template:function(i,s){if(i&1&&(Z(0,"div",0)(1,"div",1)(2,"h2",2),ve(3,"Crear Recordatorio"),J(),Z(4,"form",3)(5,"div")(6,"label",4),ve(7,"T\xEDtulo del Recordatorio"),J(),ze(8,"input",5),gt(9,d$,2,0,"div",6),J(),Z(10,"div")(11,"label",7),ve(12,"Descripci\xF3n"),J(),ze(13,"textarea",8),J(),Z(14,"div",9)(15,"label",10),ve(16,"Fecha"),J(),Z(17,"div",11)(18,"div",12),Dr(),Z(19,"svg",13),ze(20,"path",14),J()(),xi(),ze(21,"input",15),J(),gt(22,p$,2,0,"div",6),J(),Z(23,"div",16)(24,"div",17)(25,"label",18),ve(26,"Hora Inicio"),J(),ze(27,"input",19),gt(28,m$,2,0,"div",6),J(),Z(29,"div",17)(30,"label",20),ve(31,"Hora Fin"),J(),ze(32,"input",21),gt(33,g$,2,0,"div",6),J()(),Z(34,"div")(35,"label",22),ve(36,"\xBFRepetir Evento?"),J(),Z(37,"select",23)(38,"option",24),ve(39,"No"),J(),Z(40,"option",25),ve(41,"Diariamente"),J(),Z(42,"option",26),ve(43,"Semanalmente"),J(),Z(44,"option",27),ve(45,"Mensualmente"),J()()(),Z(46,"div")(47,"label",28),ve(48,"\xBFIncluir Google Meet?"),J(),Z(49,"select",29)(50,"option",24),ve(51,"No"),J(),Z(52,"option",30),ve(53,"S\xED"),J()()(),Z(54,"div")(55,"label",31),ve(56,"Importar Correos Electr\xF3nicos"),J(),Z(57,"input",32),ct("change",function(o){return s.onFileChange(o)}),J(),gt(58,x$,4,3,"div",6),J(),gt(59,E$,5,1,"div",33),Z(60,"div",34)(61,"button",35),ct("click",function(){return s.redirectToGoogleAuth()}),ve(62," Crear Recordatorio "),J()()()()()),i&2){let a,o,c,l,h;De(4),Me("formGroup",s.eventForm),De(5),Me("ngIf",((a=s.eventForm.get("title"))==null?null:a.touched)&&((a=s.eventForm.get("title"))==null?null:a.invalid)),De(13),Me("ngIf",((o=s.eventForm.get("eventDate"))==null?null:o.touched)&&((o=s.eventForm.get("eventDate"))==null?null:o.invalid)),De(6),Me("ngIf",((c=s.eventForm.get("startTime"))==null?null:c.touched)&&((c=s.eventForm.get("startTime"))==null?null:c.invalid)),De(5),Me("ngIf",((l=s.eventForm.get("endTime"))==null?null:l.touched)&&((l=s.eventForm.get("endTime"))==null?null:l.invalid)),De(25),Me("ngIf",((h=s.eventForm.get("file"))==null?null:h.touched)&&((h=s.eventForm.get("file"))==null?null:h.invalid)),De(),Me("ngIf",s.emails.length>0)}},dependencies:[Zo,Us,Tw,Iw,Ii,Cf,Vs,Bs,Fa,Pa,ii,Bo,wi],encapsulation:2});let t=e;return t})();var _2=[{path:"",component:p2,pathMatch:"full"},{path:"evaluaciones",component:rA},{path:"contacto",component:w0},{path:"recordatorios",component:v2}];var T$="@",b$=(()=>{let e=class e{constructor(n,i,s,a,o){this.doc=n,this.delegate=i,this.zone=s,this.animationType=a,this.moduleImpl=o,this._rendererFactoryPromise=null,this.scheduler=Ce(Fy,{optional:!0})}ngOnDestroy(){this._engine?.flush()}loadImpl(){return(this.moduleImpl??import("./chunk-7EIPY67Z.js")).catch(i=>{throw new kt(5300,!1)}).then(({\u0275createEngine:i,\u0275AnimationRendererFactory:s})=>{this._engine=i(this.animationType,this.doc,this.scheduler);let a=new s(this.delegate,this._engine,this.zone);return this.delegate=a,a})}createRenderer(n,i){let s=this.delegate.createRenderer(n,i);if(s.\u0275type===0)return s;typeof s.throwOnSyntheticProps=="boolean"&&(s.throwOnSyntheticProps=!1);let a=new M1(s);return i?.data?.animation&&!this._rendererFactoryPromise&&(this._rendererFactoryPromise=this.loadImpl()),this._rendererFactoryPromise?.then(o=>{let c=o.createRenderer(n,i);a.use(c)}).catch(o=>{a.use(s)}),a}begin(){this.delegate.begin?.()}end(){this.delegate.end?.()}whenRenderingDone(){return this.delegate.whenRenderingDone?.()??Promise.resolve()}};e.\u0275fac=function(i){z0()},e.\u0275prov=Oe({token:e,factory:e.\u0275fac});let t=e;return t})(),M1=class{constructor(e){this.delegate=e,this.replay=[],this.\u0275type=1}use(e){if(this.delegate=e,this.replay!==null){for(let r of this.replay)r(e);this.replay=null}}get data(){return this.delegate.data}destroy(){this.replay=null,this.delegate.destroy()}createElement(e,r){return this.delegate.createElement(e,r)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}get destroyNode(){return this.delegate.destroyNode}appendChild(e,r){this.delegate.appendChild(e,r)}insertBefore(e,r,n,i){this.delegate.insertBefore(e,r,n,i)}removeChild(e,r,n){this.delegate.removeChild(e,r,n)}selectRootElement(e,r){return this.delegate.selectRootElement(e,r)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,r,n,i){this.delegate.setAttribute(e,r,n,i)}removeAttribute(e,r,n){this.delegate.removeAttribute(e,r,n)}addClass(e,r){this.delegate.addClass(e,r)}removeClass(e,r){this.delegate.removeClass(e,r)}setStyle(e,r,n,i){this.delegate.setStyle(e,r,n,i)}removeStyle(e,r,n){this.delegate.removeStyle(e,r,n)}setProperty(e,r,n){this.shouldReplay(r)&&this.replay.push(i=>i.setProperty(e,r,n)),this.delegate.setProperty(e,r,n)}setValue(e,r){this.delegate.setValue(e,r)}listen(e,r,n){return this.shouldReplay(r)&&this.replay.push(i=>i.listen(e,r,n)),this.delegate.listen(e,r,n)}shouldReplay(e){return this.replay!==null&&e.startsWith(T$)}};function y2(t="animations"){return G0("NgAsyncAnimations"),ti([{provide:Oh,useFactory:(e,r,n)=>new b$(e,r,n,t),deps:[yr,Jh,Wt]},{provide:H0,useValue:t==="noop"?"NoopAnimations":"BrowserAnimations"}])}var x2={providers:[Hx(_2),y2(),DA(()=>RA(ro.firebaseConfig)),rp(),f2(()=>d2())]};var w2=(()=>{let e=class e{constructor(n,i){this.router=n,this.viewportScroller=i}scrollTo(n){this.router.navigate(["/"]).then(()=>{this.viewportScroller.scrollToAnchor(n)})}};e.\u0275fac=function(i){return new(i||e)(Pe(ka),Pe(Y0))},e.\u0275cmp=Dt({type:e,selectors:[["app-navbar"]],standalone:!0,features:[Rt],decls:14,vars:0,consts:[[1,"flex","items-center","justify-between","p-5","bg-white","shadow-lg","sticky","top-0","z-10"],[1,"container","mx-auto","flex","items-center","justify-between"],["href","/",1,"flex","items-center","text-2xl","font-semibold","text-gray-900"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 32 32",1,"mr-2","h-8","w-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"flex","items-center","gap-5"],["href","/",1,"text-lg","text-gray-700","hover:text-blue-500"],["fragment","contacto",1,"text-lg","text-gray-700","hover:text-blue-500","cursor-pointer",3,"click"]],template:function(i,s){i&1&&(Z(0,"header",0)(1,"div",1)(2,"a",2),Dr(),Z(3,"svg",3),ze(4,"circle",4)(5,"circle",5)(6,"circle",6),J(),xi(),Z(7,"span"),ve(8,"EvaluAr"),J()(),Z(9,"nav",7)(10,"a",8),ve(11,"Inicio"),J(),Z(12,"a",9),ct("click",function(){return s.scrollTo("contacto")}),ve(13,"Contacto"),J()()()())},encapsulation:2});let t=e;return t})();var E2=(()=>{let e=class e{constructor(){this.anio=new Date().getFullYear()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-footer"]],standalone:!0,features:[Rt],decls:18,vars:1,consts:[[1,"p-4","bg-[f5f5fa]","md:p-8","lg:p-10","border-t-2","border-white","shadow-lg"],[1,"mx-auto","max-w-screen-xl","text-center"],[1,"flex","justify-center"],["href","/",1,"flex","justify-center","items-center","text-2xl","font-semibold","text-gray-900"],["width","32","height","32","xmlns","http://www.w3.org/2000/svg",1,"mr-2","h-8"],["cx","16","cy","16","r","14","fill","#3498db"],["cx","16","cy","16","r","10","fill","#ffffff"],["cx","16","cy","16","r","5","fill","#f1c40f"],[1,"my-6","text-gray-500"],[1,"bg-gray-100","py-4"],[1,"text-sm","text-gray-500","sm:text-center"],["href","https://www.linkedin.com/in/alejandrojorba/",1,"text-blue-500","hover:text-blue-700"]],template:function(i,s){i&1&&(Z(0,"footer",0)(1,"div",1)(2,"div",2)(3,"a",3),Dr(),Z(4,"svg",4),ze(5,"circle",5)(6,"circle",6)(7,"circle",7),J(),ve(8," EvaluAr "),J()(),xi(),Z(9,"p",8),ve(10,"Este sitio web ha sido desarrollado con el prop\xF3sito de automatizar tareas repetitivas o complejas para los docentes. "),ze(11,"br"),ve(12," Cabe destacar que este proyecto no tiene ninguna relaci\xF3n con el gobierno."),J(),Z(13,"div",9)(14,"span",10),ve(15),Z(16,"a",11),ve(17,"Alejandro Jorba"),J()()()()()),i&2&&(De(15),ks("\xA9 ",s.anio," - Desarrollado por "))},encapsulation:2});let t=e;return t})();var I$=(t,e,r)=>({"bg-blue-500":t,"bg-green-500":e,"bg-red-500":r}),A$=(t,e,r)=>({"bg-blue-800":t,"bg-green-700":e,"bg-red-700":r});function S$(t,e){t&1&&(Dr(),Z(0,"svg",13),ze(1,"path",14),J())}function C$(t,e){t&1&&(Dr(),Z(0,"svg",15),ze(1,"path",16),J())}function k$(t,e){t&1&&(Dr(),Z(0,"svg",17)(1,"g",18),ze(2,"path",19),J()())}function D$(t,e){if(t&1){let r=Ki();Ta(0),Z(1,"div",1)(2,"div",2),Ta(3,3),gt(4,S$,2,0,"svg",4)(5,C$,2,0,"svg",5)(6,k$,3,0,"svg",6),ba(),J(),Z(7,"div",7)(8,"div",8),ve(9),J(),Z(10,"div",9),ve(11),J()(),Z(12,"button",10),ct("click",function(){_i(r);let i=_r();return yi(i.closeToast())}),Dr(),Z(13,"svg",11),ze(14,"path",12),J()()(),ba()}if(t&2){let r=_r();De(),Me("ngClass",yl(8,I$,r.toast.type==="info",r.toast.type==="success",r.toast.type==="error")),De(),Me("ngClass",yl(12,A$,r.toast.type==="info",r.toast.type==="success",r.toast.type==="error")),De(),Me("ngSwitch",r.toast.type),De(),Me("ngSwitchCase","info"),De(),Me("ngSwitchCase","success"),De(),Me("ngSwitchCase","error"),De(3),ks(" ",r.toast.type==="info"?"Informaci\xF3n":r.toast.type==="success"?"\xC9xito":"Error"," "),De(2),ks(" ",r.toast.message," ")}}var T2=(()=>{let e=class e{constructor(){this.toast={message:"",type:"",active:!1},this.toastService=Ce(Qs),this.isMobile=!1}ngOnInit(){let n=navigator.userAgent;this.isMobile=/Mobi|Android|iPhone|iPad|iPod/.test(n),this.toastService.getToast().subscribe(i=>{this.toast=i,i&&setTimeout(()=>this.toast.active=!1,1e4)})}closeToast(){this.toast.active=!1}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-toast"]],standalone:!0,features:[Rt],decls:1,vars:1,consts:[[4,"ngIf"],[1,"fixed","z-50","rounded-lg","shadow-lg","flex","items-center","animate-bounce","text-white","w-full","max-w-xs","p-2","top-4","inset-x-0","mx-auto","sm:max-w-sm","sm:p-3","md:max-w-md","md:p-4","lg:max-w-lg","lg:right-8","lg:p-5","lg:top-24","lg:inset-auto","lg:mx-0",3,"ngClass"],[1,"inline-flex","items-center","justify-center","flex-shrink-0","w-8","h-8","rounded-lg",3,"ngClass"],[3,"ngSwitch"],["class","w-5 h-5","aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","white","viewBox","0 0 24 24",4,"ngSwitchCase"],["class","w-5 h-5","aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","white","viewBox","0 0 20 20",4,"ngSwitchCase"],["width","24px","height","24px","viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg",4,"ngSwitchCase"],[1,"ml-3"],[1,"text-xs","font-semibold","sm:text-xs","md:text-sm","lg:text-md"],[1,"text-xs","font-normal","sm:text-xs","md:text-sm","lg:text-md"],["type","button",1,"absolute","top-1","right-1","text-white","hover:text-gray-900","rounded-lg","p-1.5","inline-flex","items-center","justify-center","h-5","w-5","sm:h-5","sm:w-5","md:h-6","md:w-6","lg:h-8","sm:right-1","md:right-1","lg:right-2",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","white","viewBox","0 0 24 24",1,"w-5","h-5"],["fill-rule","evenodd","clip-rule","evenodd","d","M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12ZM12 17.75C12.4142 17.75 12.75 17.4142 12.75 17V11C12.75 10.5858 12.4142 10.25 12 10.25C11.5858 10.25 11.25 10.5858 11.25 11V17C11.25 17.4142 11.5858 17.75 12 17.75ZM12 7C12.5523 7 13 7.44772 13 8C13 8.55228 12.5523 9 12 9C11.4477 9 11 8.55228 11 8C11 7.44772 11.4477 7 12 7Z","fill","white"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","white","viewBox","0 0 20 20",1,"w-5","h-5"],["d","M10 .5a9.5 9.5 0 1 0 9.5 9.5A9.51 9.51 0 0 0 10 .5Zm3.707 8.207-4 4a1 1 0 0 1-1.414 0l-2-2a1 1 0 0 1 1.414-1.414L9 10.586l3.293-3.293a1 1 0 0 1 1.414 1.414Z"],["width","24px","height","24px","viewBox","0 0 512 512","xmlns","http://www.w3.org/2000/svg"],["fill","white","transform","translate(42.666667, 42.666667)"],["d","M213.333333,0 C331.136,0 426.666667,95.5306667 426.666667,213.333333 C426.666667,331.136 331.136,426.666667 213.333333,426.666667 C95.5306667,426.666667 0,331.136 0,213.333333 C0,95.5306667 95.5306667,0 213.333333,0 Z M262.250667,134.250667 L213.333333,183.168 L164.416,134.250667 L134.250667,164.416 L183.168,213.333333 L134.250667,262.250667 L164.416,292.416 L213.333333,243.498667 L262.250667,292.416 L292.416,262.250667 L243.498667,213.333333 L292.416,164.416 L262.250667,134.250667 Z"]],template:function(i,s){i&1&&gt(0,D$,15,16,"ng-container",0),i&2&&Me("ngIf",s.toast.active)},dependencies:[ii,jh,wi,Uy,jy],encapsulation:2});let t=e;return t})();var b2=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-mantenimiento"]],standalone:!0,features:[Rt],decls:8,vars:0,consts:[[1,"bg-white","dark:bg-gray-900"],[1,"py-8","px-4","mx-auto","max-w-screen-md","h-screen","flex","flex-col","justify-center","text-center","lg:py-16","lg:px-12"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 512 512",1,"mx-auto","mb-4","w-10","h-10","text-gray-400"],["fill","currentColor","d","M331.8 224.1c28.29 0 54.88 10.99 74.86 30.97l19.59 19.59c40.01-17.74 71.25-53.3 81.62-96.65c5.725-23.92 5.34-47.08 .2148-68.4c-2.613-10.88-16.43-14.51-24.34-6.604l-68.9 68.9h-75.6V97.2l68.9-68.9c7.912-7.912 4.275-21.73-6.604-24.34c-21.32-5.125-44.48-5.51-68.4 .2148c-55.3 13.23-98.39 60.22-107.2 116.4C224.5 128.9 224.2 137 224.3 145l82.78 82.86C315.2 225.1 323.5 224.1 331.8 224.1zM384 278.6c-23.16-23.16-57.57-27.57-85.39-13.9L191.1 158L191.1 95.99l-127.1-95.99L0 63.1l96 127.1l62.04 .0077l106.7 106.6c-13.67 27.82-9.251 62.23 13.91 85.39l117 117.1c14.62 14.5 38.21 14.5 52.71-.0016l52.75-52.75c14.5-14.5 14.5-38.08-.0016-52.71L384 278.6zM227.9 307L168.7 247.9l-148.9 148.9c-26.37 26.37-26.37 69.08 0 95.45C32.96 505.4 50.21 512 67.5 512s34.54-6.592 47.72-19.78l119.1-119.1C225.5 352.3 222.6 329.4 227.9 307zM64 472c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24S88 434.7 88 448C88 461.3 77.25 472 64 472z"],[1,"mb-4","text-4xl","font-bold","tracking-tight","leading-none","text-gray-900","lg:mb-6","md:text-5xl","xl:text-6xl","dark:text-white"],[1,"font-light","text-gray-500","md:text-lg","xl:text-xl","dark:text-gray-400"]],template:function(i,s){i&1&&(Z(0,"section",0)(1,"div",1),Dr(),Z(2,"svg",2),ze(3,"path",3),J(),xi(),Z(4,"h1",4),ve(5,"En Mantenimiento"),J(),Z(6,"p",5),ve(7,"Estamos realizando actualizaciones, pedimos paciencia, muchas gracias"),J()()())},encapsulation:2});let t=e;return t})();function R$(t,e){t&1&&(Z(0,"div"),ze(1,"app-mantenimiento"),J())}function F$(t,e){t&1&&(Z(0,"div",2),ze(1,"app-navbar",3)(2,"router-outlet")(3,"app-footer",3)(4,"app-toast",3),J())}var I2=(()=>{let e=class e{constructor(){this.title="examenes-app",this.mantenimiento=!1}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Dt({type:e,selectors:[["app-root"]],standalone:!0,features:[Rt],decls:2,vars:2,consts:[[4,"ngIf"],["class","h-full",4,"ngIf"],[1,"h-full"],[1,"no-print"]],template:function(i,s){i&1&&gt(0,R$,2,0,"div",0)(1,F$,5,0,"div",1),i&2&&(Me("ngIf",s.mantenimiento),De(),Me("ngIf",!s.mantenimiento))},dependencies:[ii,wi,Hp,w2,E2,Yh,T2,b2]});let t=e;return t})();ax(I2,x2).catch(t=>console.error(t));
